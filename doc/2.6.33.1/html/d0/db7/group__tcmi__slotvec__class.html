<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Clondike: tcmi_slotvec class</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Clondike
   </div>
   <div id="projectbrief">Supported Linux kernel 2.6.33.1</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d0/db7/group__tcmi__slotvec__class.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">tcmi_slotvec class<div class="ingroups"><a class="el" href="../../dc/d84/group__tcmi__lib__group.html">lib</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>This class represents a data structure widely used in implementation of TCMI.  
<a href="#details">More...</a></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for tcmi_slotvec class:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<center><table><tr><td><img src="../../d0/db7/group__tcmi__slotvec__class.png" border="0" alt="" usemap="#d0_2db7_2group____tcmi____slotvec____class"/>
<map name="d0_2db7_2group____tcmi____slotvec____class" id="d0_2db7_2group____tcmi____slotvec____class">
<area shape="rect" id="node1" href="../../dc/d84/group__tcmi__lib__group.html" title="Classes in this group provide basic objects used commonly throughout the whole framework." alt="" coords="6,5,45,32"/></map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:da/ded/structtcmi__slotvec"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a></td></tr>
<tr class="memdesc:da/ded/structtcmi__slotvec"><td class="mdescLeft">&#160;</td><td class="mdescRight">A slot vector compound structure.  <a href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">More...</a><br/></td></tr>
<tr class="separator:da/ded/structtcmi__slotvec"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga49082f04567681a98c6d39eacbc1e4ed"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#ga49082f04567681a98c6d39eacbc1e4ed">tcmi_slotvec_for_each_used_slot</a>(slot, slotvec)&#160;&#160;&#160;list_for_each_entry(slot, &amp;slotvec-&gt;used_slots, slot_list)</td></tr>
<tr class="memdesc:ga49082f04567681a98c6d39eacbc1e4ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Iterates through all used slots in the slot vector.  <a href="#ga49082f04567681a98c6d39eacbc1e4ed">More...</a><br/></td></tr>
<tr class="separator:ga49082f04567681a98c6d39eacbc1e4ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab5b0d32f725e8e183d35c99550cd5e16"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#gab5b0d32f725e8e183d35c99550cd5e16">tcmi_slotvec_for_each_used_slot_safe</a>(slot, slot2, slotvec)&#160;&#160;&#160;list_for_each_entry_safe(slot, slot2, &amp;slotvec-&gt;used_slots, slot_list)</td></tr>
<tr class="memdesc:gab5b0d32f725e8e183d35c99550cd5e16"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Iterates through all used slots in the slot vector - safe version.  <a href="#gab5b0d32f725e8e183d35c99550cd5e16">More...</a><br/></td></tr>
<tr class="separator:gab5b0d32f725e8e183d35c99550cd5e16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga681c2b9052d7f134030da2df6f0186b2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#ga681c2b9052d7f134030da2df6f0186b2">tcmi_slotvec_entry</a>(ptr, <a class="el" href="../../da/d20/tcmi__ckpt__vm__area_8h.html#a976c268fd0b6ffe448e05822bc0bb364">type</a>, member)&#160;&#160;&#160;list_entry(ptr, <a class="el" href="../../da/d20/tcmi__ckpt__vm__area_8h.html#a976c268fd0b6ffe448e05822bc0bb364">type</a>, member)</td></tr>
<tr class="memdesc:ga681c2b9052d7f134030da2df6f0186b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extracts the actual slot from the list.  <a href="#ga681c2b9052d7f134030da2df6f0186b2">More...</a><br/></td></tr>
<tr class="separator:ga681c2b9052d7f134030da2df6f0186b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga988bdfe5beaa8839a8fbc788570a64a7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#ga988bdfe5beaa8839a8fbc788570a64a7">tcmi_slotvec_remove_one_entry</a>(slotvec, obj, member)</td></tr>
<tr class="memdesc:ga988bdfe5beaa8839a8fbc788570a64a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Removes one entry from the slotvector and returns it.  <a href="#ga988bdfe5beaa8839a8fbc788570a64a7">More...</a><br/></td></tr>
<tr class="separator:ga988bdfe5beaa8839a8fbc788570a64a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaf11359c8cb20ddd7549296737eaf348d"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#gaf11359c8cb20ddd7549296737eaf348d">tcmi_slotvec_new</a> (u_int <a class="el" href="../../d8/d08/tcmi__ppm__p__emigrate__msg_8h.html#af8fd9ce16b371c8a3bf5e0b37a69419f">size</a>)</td></tr>
<tr class="memdesc:gaf11359c8cb20ddd7549296737eaf348d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates a new slot vector.  <a href="#gaf11359c8cb20ddd7549296737eaf348d">More...</a><br/></td></tr>
<tr class="separator:gaf11359c8cb20ddd7549296737eaf348d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga25d6b55df23662a9fc2c613762134a85"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#ga25d6b55df23662a9fc2c613762134a85">tcmi_slotvec_hnew</a> (u_int order)</td></tr>
<tr class="memdesc:ga25d6b55df23662a9fc2c613762134a85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates a new slot vector with 2^order buckets.  <a href="#ga25d6b55df23662a9fc2c613762134a85">More...</a><br/></td></tr>
<tr class="separator:ga25d6b55df23662a9fc2c613762134a85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6a2d964210027d8403cfa186df17eabf"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#ga6a2d964210027d8403cfa186df17eabf">tcmi_slotvec_get</a> (struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:ga6a2d964210027d8403cfa186df17eabf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Slot vector instance accessor.  <a href="#ga6a2d964210027d8403cfa186df17eabf">More...</a><br/></td></tr>
<tr class="separator:ga6a2d964210027d8403cfa186df17eabf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2376bcc84e5bbd48a8f92400f5ad5f25"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#ga2376bcc84e5bbd48a8f92400f5ad5f25">tcmi_slotvec_put</a> (struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:ga2376bcc84e5bbd48a8f92400f5ad5f25"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Releases the instance.  <a href="#ga2376bcc84e5bbd48a8f92400f5ad5f25">More...</a><br/></td></tr>
<tr class="separator:ga2376bcc84e5bbd48a8f92400f5ad5f25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga876670f605631a5deb930412dae02b28"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot">tcmi_slot</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#ga876670f605631a5deb930412dae02b28">tcmi_slotvec_at</a> (struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, u_int index)</td></tr>
<tr class="memdesc:ga876670f605631a5deb930412dae02b28"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Accesses a slot at a given index.  <a href="#ga876670f605631a5deb930412dae02b28">More...</a><br/></td></tr>
<tr class="separator:ga876670f605631a5deb930412dae02b28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabd12f97cda4c9b4b4142f6de475645d9"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot">tcmi_slot</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#gabd12f97cda4c9b4b4142f6de475645d9">tcmi_slotvec_reserve_empty</a> (struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:gabd12f97cda4c9b4b4142f6de475645d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Finds the first empty slot.  <a href="#gabd12f97cda4c9b4b4142f6de475645d9">More...</a><br/></td></tr>
<tr class="separator:gabd12f97cda4c9b4b4142f6de475645d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4f973395848150fbebecf3cc292c80ba"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot">tcmi_slot</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4f973395848150fbebecf3cc292c80ba">tcmi_slotvec_insert_at</a> (struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, u_int index, struct hlist_node *node)</td></tr>
<tr class="memdesc:ga4f973395848150fbebecf3cc292c80ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Inserts an item in a slot at a given index.  <a href="#ga4f973395848150fbebecf3cc292c80ba">More...</a><br/></td></tr>
<tr class="separator:ga4f973395848150fbebecf3cc292c80ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7108e653b4e81eaf33a9ea6e37adbf4d"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot">tcmi_slot</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#ga7108e653b4e81eaf33a9ea6e37adbf4d">tcmi_slotvec_insert_at_empty</a> (struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, struct hlist_node *node)</td></tr>
<tr class="memdesc:ga7108e653b4e81eaf33a9ea6e37adbf4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Inserts an item into an empty slot at a given index.  <a href="#ga7108e653b4e81eaf33a9ea6e37adbf4d">More...</a><br/></td></tr>
<tr class="separator:ga7108e653b4e81eaf33a9ea6e37adbf4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga03946dfe98a88a916f30eaf3f2eed1be"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#ga03946dfe98a88a916f30eaf3f2eed1be">tcmi_slotvec_empty</a> (struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:ga03946dfe98a88a916f30eaf3f2eed1be"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Tester method for slotvec emptyness  <a href="#ga03946dfe98a88a916f30eaf3f2eed1be">More...</a><br/></td></tr>
<tr class="separator:ga03946dfe98a88a916f30eaf3f2eed1be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5b4586b2e897ec306862a0b6901f39e7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7">tcmi_slotvec_lock</a> (struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:ga5b4586b2e897ec306862a0b6901f39e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Locks the instance data.  <a href="#ga5b4586b2e897ec306862a0b6901f39e7">More...</a><br/></td></tr>
<tr class="separator:ga5b4586b2e897ec306862a0b6901f39e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4df343d549736d3dc994ad0f43529a57"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57">tcmi_slotvec_unlock</a> (struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:ga4df343d549736d3dc994ad0f43529a57"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Unlocks the instance data.  <a href="#ga4df343d549736d3dc994ad0f43529a57">More...</a><br/></td></tr>
<tr class="separator:ga4df343d549736d3dc994ad0f43529a57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga463d8dd03bd30b24c3ebfed5a0239d8a"><td class="memItemLeft" align="right" valign="top">static u_int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#ga463d8dd03bd30b24c3ebfed5a0239d8a">tcmi_slotvec_hashmask</a> (struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:ga463d8dd03bd30b24c3ebfed5a0239d8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Hashmask accessor.  <a href="#ga463d8dd03bd30b24c3ebfed5a0239d8a">More...</a><br/></td></tr>
<tr class="separator:ga463d8dd03bd30b24c3ebfed5a0239d8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>This class represents a data structure widely used in implementation of TCMI. </p>
<p>It is a vector of slots where each slot is head of a doubly linked list of the respective objects. </p>
<pre class="fragment">   +-------+
  0| slot  | -&gt; object1 -&gt; object 2 -&gt; object 3...
   +-------+
  1| slot  | empty
   +-------+
  2| slot  | -&gt; object 5 -&gt; object 6...
   +-------+
  3| slot  | empty 
   +-------+
   .       .
   .       .
   .       .
   +-------+
   | slot  | -&gt; objectX
   +-------+
  n| slot  | empty
   +-------+
</pre><ul>
<li>The vector has limited size specified during initialization by the user. The benefit is that it provides O(1) access to all its slots based on index.</li>
<li>Allows iterating through non-empty slots</li>
<li>Allows allocating an empty slot with O(1) time complexity</li>
</ul>
<p>The data structure internally keeps track of used and unused slots. The user can exclusively insert objects into empty slots only. This way, it can be used as a data structure describing some limited resource. On the other hand(as seen in the figure), the user is able to insert new elements into any slots, thus yielding a hashtable. The user needs to select only a suitable hashing function. The general requirement on the hash function is to yield the index 0 to n-1 with an approximately uniform distribution.</p>
<p>Since the datastructure is expected to be accessed from multiple threads of execution a reference counting is implemented. The user should always access the slot vector by means of <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#ga6a2d964210027d8403cfa186df17eabf" title="Slot vector instance accessor.">tcmi_slotvec_get()</a> method and release the instance by means of <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#ga2376bcc84e5bbd48a8f92400f5ad5f25" title="&lt;&lt;public&gt;&gt; Decrements the reference counter, when the count reaches 0, the instance is destroyed...">tcmi_slotvec_put()</a>. The last accessing thread causes the slot vector to be freed from memory. </p>
<hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="da/ded/structtcmi__slotvec" id="da/ded/structtcmi__slotvec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct tcmi_slotvec</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>A slot vector compound structure. </p>
<p>Contains the used/unused slot lists and the actual vector. </p>

<p>Definition at line <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html#l00145">145</a> of file <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html">tcmi_slotvec.h</a>.</p>
</div><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for tcmi_slotvec:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../de/da5/structtcmi__slotvec__coll__graph.png" border="0" usemap="#tcmi__slotvec_coll__map" alt="Collaboration graph"/></div>
<map name="tcmi__slotvec_coll__map" id="tcmi__slotvec_coll__map">
<area shape="rect" id="node2" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot" title="A slot compound structure." alt="" coords="5,5,115,171"/></map>
</div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a976cb221fe7d80633fa7ac415230e364"></a>u_int</td>
<td class="fieldname">
hashmsk</td>
<td class="fielddoc">
Hash mask - valid only when slot_count is $2^order$ and the slot vector has been created by <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#ga25d6b55df23662a9fc2c613762134a85" title="&lt;&lt;public&gt;&gt; This method creates a slot vector of the size $2^{order}$.">tcmi_slotvec_hnew()</a>. </td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a4241b2ba21acbcbad13d8b4503566ace"></a>unsigned long</td>
<td class="fieldname">
lock_flags</td>
<td class="fielddoc">
Technical field used for irq safe spinlocks. </td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a510c521e990e3999f7f01f5a2151b033"></a>atomic_t</td>
<td class="fieldname">
ref_count</td>
<td class="fielddoc">
reference counter </td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a0da7101e2fc5d4a7015f24300998a1d1"></a>spinlock_t</td>
<td class="fieldname">
s_lock</td>
<td class="fielddoc">
current instance reference - used when freeing <p>Protects the slotvector from concurrent modification </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a5c5c298ba4017eeacd49ac706916f638"></a>u_int</td>
<td class="fieldname">
slot_count</td>
<td class="fielddoc">
Number of slots in the vector. </td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a6eb1f9f3b1184ee2e4401c0a33691d61"></a>struct <a class="el" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot">tcmi_slot</a> *</td>
<td class="fieldname">
slots</td>
<td class="fielddoc">
The actual slot vector. </td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="aa8ec1680a89d2e47c3b7e4a9f45d35b2"></a>struct list_head</td>
<td class="fieldname">
unused_slots</td>
<td class="fielddoc">
list of unused slots </td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a60a6a5a8dd5c8aaef0fd134a7c6b190a"></a>struct list_head</td>
<td class="fieldname">
used_slots</td>
<td class="fielddoc">
list of used slots </td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga681c2b9052d7f134030da2df6f0186b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define tcmi_slotvec_entry</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ptr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../da/d20/tcmi__ckpt__vm__area_8h.html#a976c268fd0b6ffe448e05822bc0bb364">type</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">member&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;list_entry(ptr, <a class="el" href="../../da/d20/tcmi__ckpt__vm__area_8h.html#a976c268fd0b6ffe448e05822bc0bb364">type</a>, member)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extracts the actual slot from the list. </p>

<p>Definition at line <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html#l00118">118</a> of file <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html">tcmi_slotvec.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga49082f04567681a98c6d39eacbc1e4ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define tcmi_slotvec_for_each_used_slot</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">slot, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">slotvec&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;list_for_each_entry(slot, &amp;slotvec-&gt;used_slots, slot_list)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Iterates through all used slots in the slot vector. </p>
<p>This is intended for traversals only, no removals should take place. We still need to ensure the slot vector protection against concurrent manipulation from other threads.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">slot</td><td>- every iteration points to a new object </td></tr>
    <tr><td class="paramname">slotvec</td><td>- slot vector we are iterating through </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html#l00100">100</a> of file <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html">tcmi_slotvec.h</a>.</p>

<p>Referenced by <a class="el" href="../../d9/d86/tcmi__penman_8c_source.html#l00134">check_duplicates()</a>, <a class="el" href="../../d6/d82/tcmi__migman_8c_source.html#l00307">kill_all_tasks()</a>, <a class="el" href="../../d2/de0/tcmi__ccnman_8c_source.html#l00552">tcmi_ccnman_thread()</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00372">tcmi_man_get_non_shutdowning_migman()</a>, and <a class="el" href="../../d9/ded/tcmi__penmigman_8c_source.html#l00195">tcmi_penmigman_migrate_all_home()</a>.</p>

</div>
</div>
<a class="anchor" id="gab5b0d32f725e8e183d35c99550cd5e16"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define tcmi_slotvec_for_each_used_slot_safe</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">slot, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">slot2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">slotvec&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;list_for_each_entry_safe(slot, slot2, &amp;slotvec-&gt;used_slots, slot_list)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Iterates through all used slots in the slot vector - safe version. </p>
<p>This is a version safe against removals. If the current slot, will be removed during the iteration, no issues will arise. We still need to ensure the slot vector protection against concurrent manipulation from other threads.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">slot</td><td>- every iteration points to a new object </td></tr>
    <tr><td class="paramname">slot2</td><td>- temporary storage for the current slot </td></tr>
    <tr><td class="paramname">slotvec</td><td>- slot vector we are iterating through </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html#l00114">114</a> of file <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html">tcmi_slotvec.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga988bdfe5beaa8839a8fbc788570a64a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define tcmi_slotvec_remove_one_entry</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">slotvec, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">obj, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">member&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> {                                \</div>
<div class="line">    struct <a class="code" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot" title="A slot compound structure.">tcmi_slot</a> *__slot;               \</div>
<div class="line">    obj = NULL;                     \</div>
<div class="line">    tcmi_slotvec_for_each_used_slot(__slot, slotvec) {  \</div>
<div class="line">        tcmi_slot_remove_first(obj, __slot, member);    \</div>
<div class="line">        break;                      \</div>
<div class="line">    }                           \</div>
<div class="line">} <span class="keywordflow">while</span>(0)</div>
</div><!-- fragment -->
<p>&lt;&lt;public&gt;&gt; Removes one entry from the slotvector and returns it. </p>
<p>Takes first used slot and obtains first element from it. Removes the element from the slot.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">slotvec</td><td>- slotvector where the removal is to be done </td></tr>
    <tr><td class="paramname">obj</td><td>- a pointer where to store the object retrieved from </td></tr>
    <tr><td class="paramname">member</td><td>- name of the object member used for linking into the slot. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html#l00131">131</a> of file <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html">tcmi_slotvec.h</a>.</p>

<p>Referenced by <a class="el" href="../../d2/de0/tcmi__ccnman_8c_source.html#l00366">tcmi_ccnman_stop_listen_all()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga876670f605631a5deb930412dae02b28"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot">tcmi_slot</a>* tcmi_slotvec_at </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Accesses a slot at a given index. </p>
<p>If the index is not valid (exceeds the vector length), NULL is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this vector instance </td></tr>
    <tr><td class="paramname">index</td><td>- index of a slot to be accessed. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to a slot at a given index or NULL </dd></dl>

<p>Definition at line <a class="el" href="../../d3/dc2/tcmi__slotvec_8c_source.html#l00148">148</a> of file <a class="el" href="../../d3/dc2/tcmi__slotvec_8c_source.html">tcmi_slotvec.c</a>.</p>

<p>References <a class="el" href="../../d3/d94/tcmi__slot_8h_source.html#l00156">tcmi_slot::index</a>.</p>

<p>Referenced by <a class="el" href="../../d2/de0/tcmi__ccnman_8c_source.html#l00402">tcmi_ccnman_stop_listen_one()</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00504">tcmi_man_emig_npm()</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00455">tcmi_man_emig_ppm_p()</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00542">tcmi_man_fork()</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00173">tcmi_man_send_generic_user_message()</a>, <a class="el" href="../../d6/d82/tcmi__migman_8c_source.html#l00728">tcmi_migman_remove_task()</a>, <a class="el" href="../../d3/dc2/tcmi__slotvec_8c_source.html#l00199">tcmi_slotvec_insert_at()</a>, and <a class="el" href="../../d4/d2c/tcmi__transaction_8c_source.html#l00279">tcmi_transaction_lookup()</a>.</p>
<div class="fragment"><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;{</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot" title="A slot compound structure.">tcmi_slot</a> *slot = NULL;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">if</span> (index &lt; self-&gt;slot_count)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        slot = &amp;<span class="keyword">self</span>-&gt;slots[<a class="code" href="../../da/d0c/group__tcmi__slot__class.html#a0d3c81604a37e7371825d749f92783d6" title="The slot number.">index</a>];</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">return</span> slot;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga03946dfe98a88a916f30eaf3f2eed1be"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_slotvec_empty </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Tester method for slotvec emptyness </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this vector instance </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if the slotvector is empty </dd></dl>

<p>Definition at line <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html#l00215">215</a> of file <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html">tcmi_slotvec.h</a>.</p>

<p>References <a class="el" href="../../d0/dc1/proxyfs__server_8c_source.html#l00059">self</a>.</p>

<p>Referenced by <a class="el" href="../../d2/de0/tcmi__ccnman_8c_source.html#l00366">tcmi_ccnman_stop_listen_all()</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00113">tcmi_man_wait_for_migmans_termination()</a>, and <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00209">tcmi_task_put()</a>.</p>
<div class="fragment"><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;{</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">return</span> list_empty(&amp;self-&gt;<a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#a60a6a5a8dd5c8aaef0fd134a7c6b190a" title="list of used slots">used_slots</a>);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga6a2d964210027d8403cfa186df17eabf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a>* tcmi_slotvec_get </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Slot vector instance accessor. </p>
<p>Checks whether the instance is not currently being freed - if so, returns NULL. Otherwise increments the reference counter and returns self.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this vector instance </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- self </dd></dl>

<p>Definition at line <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html#l00185">185</a> of file <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html">tcmi_slotvec.h</a>.</p>

<p>References <a class="el" href="../../d0/dc1/proxyfs__server_8c_source.html#l00059">self</a>.</p>
<div class="fragment"><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;{</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">if</span> (!<span class="keyword">self</span>)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    atomic_inc(&amp;self-&gt;<a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#a510c521e990e3999f7f01f5a2151b033" title="reference counter">ref_count</a>);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">self</span>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga463d8dd03bd30b24c3ebfed5a0239d8a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u_int tcmi_slotvec_hashmask </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Hashmask accessor. </p>
<p>This method is to be used only if the slot vector has been created by <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#ga25d6b55df23662a9fc2c613762134a85" title="&lt;&lt;public&gt;&gt; This method creates a slot vector of the size $2^{order}$.">tcmi_slotvec_hnew()</a> and is intented to be used as a hashtable. Otherwise the hashmask is not valid and defaults to 0.</p>
<dl class="section return"><dt>Returns</dt><dd>hashmask of the slot vector </dd></dl>

<p>Definition at line <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html#l00250">250</a> of file <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html">tcmi_slotvec.h</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d82/tcmi__migman_8c_source.html#l00709">tcmi_migman_add_task()</a>, <a class="el" href="../../d6/d82/tcmi__migman_8c_source.html#l00728">tcmi_migman_remove_task()</a>, <a class="el" href="../../d4/d2c/tcmi__transaction_8c_source.html#l00279">tcmi_transaction_lookup()</a>, and <a class="el" href="../../d4/d2c/tcmi__transaction_8c_source.html#l00067">tcmi_transaction_new()</a>.</p>
<div class="fragment"><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;{</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">self</span>-&gt;hashmsk;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga25d6b55df23662a9fc2c613762134a85"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a>* tcmi_slotvec_hnew </td>
          <td>(</td>
          <td class="paramtype">u_int&#160;</td>
          <td class="paramname"><em>order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocates a new slot vector with 2^order buckets. </p>
<p>Allocates a new slot vector with 2^order buckets.</p>
<p>It is intended when using the slot vector as a hashtable with $2^{order}$ buckets. A hashmask is calculated as the vector size - 1.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">order</td><td>- $log_2(buckets)$ </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a new slot vector or NULL </dd></dl>

<p>Definition at line <a class="el" href="../../d3/dc2/tcmi__slotvec_8c_source.html#l00095">95</a> of file <a class="el" href="../../d3/dc2/tcmi__slotvec_8c_source.html">tcmi_slotvec.c</a>.</p>

<p>References <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html#l00152">tcmi_slotvec::hashmsk</a>, <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html#l00149">tcmi_slotvec::slot_count</a>, and <a class="el" href="../../d3/dc2/tcmi__slotvec_8c_source.html#l00050">tcmi_slotvec_new()</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d82/tcmi__migman_8c_source.html#l00081">tcmi_migman_init()</a>, and <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00112">tcmi_task_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;{</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec" title="A slot vector compound structure.">tcmi_slotvec</a> *vec;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">if</span> (!(vec = <a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#gaf11359c8cb20ddd7549296737eaf348d" title="&lt;&lt;public&gt;&gt; Creates new instance.">tcmi_slotvec_new</a>(1 &lt;&lt; order))) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Error creating a slot vector hashtable with 2^%d buckets&quot;</span>, order);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">/* precompute the hashmask */</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    vec-&gt;<a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#a976cb221fe7d80633fa7ac415230e364" title="Hash mask - valid only when slot_count is $2^order$ and the slot vector has been created by tcmi_slot...">hashmsk</a> = vec-&gt;<a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#a5c5c298ba4017eeacd49ac706916f638" title="Number of slots in the vector.">slot_count</a> - 1;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">return</span> vec;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; exit0:</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d0/db7/group__tcmi__slotvec__class_ga25d6b55df23662a9fc2c613762134a85_cgraph.png" border="0" usemap="#d0/db7/group__tcmi__slotvec__class_ga25d6b55df23662a9fc2c613762134a85_cgraph" alt=""/></div>
<map name="d0/db7/group__tcmi__slotvec__class_ga25d6b55df23662a9fc2c613762134a85_cgraph" id="d0/db7/group__tcmi__slotvec__class_ga25d6b55df23662a9fc2c613762134a85_cgraph">
<area shape="rect" id="node2" href="../../d0/db7/group__tcmi__slotvec__class.html#gaf11359c8cb20ddd7549296737eaf348d" title="&lt;&lt;public&gt;&gt; Creates new instance." alt="" coords="185,5,309,32"/><area shape="rect" id="node3" href="../../da/d0c/group__tcmi__slot__class.html#ga347147be22f868eacdae39a2846c0e3f" title="Initializes a slot." alt="" coords="357,5,456,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga4f973395848150fbebecf3cc292c80ba"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot">tcmi_slot</a>* tcmi_slotvec_insert_at </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct hlist_node *&#160;</td>
          <td class="paramname"><em>node</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Inserts an item in a slot at a given index. </p>
<p>&lt;&lt;public&gt;&gt; Inserts an item in a slot at a given index.</p>
<p>The work is then delegated to the slot.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this vector instance </td></tr>
    <tr><td class="paramname">index</td><td>- index of a slot to be accessed. </td></tr>
    <tr><td class="paramname">*node</td><td>- item to be inserted into an empty slot </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to a slot at a given index where the node has been inserted or NULL </dd></dl>

<p>Definition at line <a class="el" href="../../d3/dc2/tcmi__slotvec_8c_source.html#l00199">199</a> of file <a class="el" href="../../d3/dc2/tcmi__slotvec_8c_source.html">tcmi_slotvec.c</a>.</p>

<p>References <a class="el" href="../../d3/d94/tcmi__slot_8h_source.html#l00290">tcmi_slot_insert()</a>, and <a class="el" href="../../d3/dc2/tcmi__slotvec_8c_source.html#l00148">tcmi_slotvec_at()</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d82/tcmi__migman_8c_source.html#l00709">tcmi_migman_add_task()</a>, and <a class="el" href="../../d4/d2c/tcmi__transaction_8c_source.html#l00067">tcmi_transaction_new()</a>.</p>
<div class="fragment"><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;{</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot" title="A slot compound structure.">tcmi_slot</a> *slot = <a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#ga876670f605631a5deb930412dae02b28" title="&lt;&lt;public&gt;&gt; Accesses a slot at a given index.">tcmi_slotvec_at</a>(<span class="keyword">self</span>, <a class="code" href="../../da/d0c/group__tcmi__slot__class.html#a0d3c81604a37e7371825d749f92783d6" title="The slot number.">index</a>);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">if</span> (slot)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <a class="code" href="../../da/d0c/group__tcmi__slot__class.html#gaefe294678d9d6922b3af1e452a318fa1" title="&lt;&lt;public&gt;&gt; Inserts a new node into the slot.">tcmi_slot_insert</a>(slot, node);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">return</span> slot;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d0/db7/group__tcmi__slotvec__class_ga4f973395848150fbebecf3cc292c80ba_cgraph.png" border="0" usemap="#d0/db7/group__tcmi__slotvec__class_ga4f973395848150fbebecf3cc292c80ba_cgraph" alt=""/></div>
<map name="d0/db7/group__tcmi__slotvec__class_ga4f973395848150fbebecf3cc292c80ba_cgraph" id="d0/db7/group__tcmi__slotvec__class_ga4f973395848150fbebecf3cc292c80ba_cgraph">
<area shape="rect" id="node2" href="../../da/d0c/group__tcmi__slot__class.html#gaefe294678d9d6922b3af1e452a318fa1" title="&lt;&lt;public&gt;&gt; Inserts a new node into the slot." alt="" coords="205,56,320,83"/><area shape="rect" id="node6" href="../../d0/db7/group__tcmi__slotvec__class.html#ga876670f605631a5deb930412dae02b28" title="&lt;&lt;public&gt;&gt; Accesses a slot at a given index." alt="" coords="207,107,319,133"/><area shape="rect" id="node3" href="../../da/d0c/group__tcmi__slot__class.html#ga109d6d783ebf06046f364f970f84da1f" title="&lt;&lt;public&gt;&gt; Locks the slot data." alt="" coords="375,5,481,32"/><area shape="rect" id="node4" href="../../da/d0c/group__tcmi__slot__class.html#ga8d6885be2677819158e0d956f0cca5b2" title="&lt;&lt;private&gt;&gt; Moves a slot into the specified list." alt="" coords="372,56,484,83"/><area shape="rect" id="node5" href="../../da/d0c/group__tcmi__slot__class.html#ga5447231fec5f42040c40307eb2e6a13c" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="368,107,488,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga7108e653b4e81eaf33a9ea6e37adbf4d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot">tcmi_slot</a>* tcmi_slotvec_insert_at_empty </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct hlist_node *&#160;</td>
          <td class="paramname"><em>node</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Inserts an item into an empty slot at a given index. </p>
<p>&lt;&lt;public&gt;&gt; Inserts an item into an empty slot at a given index.</p>
<p>The slot is then asked to insert the new node.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this vector instance </td></tr>
    <tr><td class="paramname">*node</td><td>- item to be inserted into an empty slot </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a pointer to the slot where the insertion took place or NULL </dd></dl>

<p>Definition at line <a class="el" href="../../d3/dc2/tcmi__slotvec_8c_source.html#l00217">217</a> of file <a class="el" href="../../d3/dc2/tcmi__slotvec_8c_source.html">tcmi_slotvec.c</a>.</p>

<p>References <a class="el" href="../../d3/d94/tcmi__slot_8h_source.html#l00290">tcmi_slot_insert()</a>, and <a class="el" href="../../d3/dc2/tcmi__slotvec_8c_source.html#l00168">tcmi_slotvec_reserve_empty()</a>.</p>
<div class="fragment"><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;{</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot" title="A slot compound structure.">tcmi_slot</a> *slot = <a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#gabd12f97cda4c9b4b4142f6de475645d9" title="&lt;&lt;public&gt;&gt; Finds the first empty slot and reserves it.">tcmi_slotvec_reserve_empty</a>(<span class="keyword">self</span>);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">if</span> (slot)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <a class="code" href="../../da/d0c/group__tcmi__slot__class.html#gaefe294678d9d6922b3af1e452a318fa1" title="&lt;&lt;public&gt;&gt; Inserts a new node into the slot.">tcmi_slot_insert</a>(slot, node);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">return</span> slot;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d0/db7/group__tcmi__slotvec__class_ga7108e653b4e81eaf33a9ea6e37adbf4d_cgraph.png" border="0" usemap="#d0/db7/group__tcmi__slotvec__class_ga7108e653b4e81eaf33a9ea6e37adbf4d_cgraph" alt=""/></div>
<map name="d0/db7/group__tcmi__slotvec__class_ga7108e653b4e81eaf33a9ea6e37adbf4d_cgraph" id="d0/db7/group__tcmi__slotvec__class_ga7108e653b4e81eaf33a9ea6e37adbf4d_cgraph">
<area shape="rect" id="node2" href="../../da/d0c/group__tcmi__slot__class.html#gaefe294678d9d6922b3af1e452a318fa1" title="&lt;&lt;public&gt;&gt; Inserts a new node into the slot." alt="" coords="201,77,316,104"/><area shape="rect" id="node6" href="../../d0/db7/group__tcmi__slotvec__class.html#gabd12f97cda4c9b4b4142f6de475645d9" title="&lt;&lt;public&gt;&gt; Finds the first empty slot and reserves it." alt="" coords="187,150,330,191"/><area shape="rect" id="node3" href="../../da/d0c/group__tcmi__slot__class.html#ga109d6d783ebf06046f364f970f84da1f" title="&lt;&lt;public&gt;&gt; Locks the slot data." alt="" coords="395,5,501,32"/><area shape="rect" id="node4" href="../../da/d0c/group__tcmi__slot__class.html#ga8d6885be2677819158e0d956f0cca5b2" title="&lt;&lt;private&gt;&gt; Moves a slot into the specified list." alt="" coords="392,56,504,83"/><area shape="rect" id="node5" href="../../da/d0c/group__tcmi__slot__class.html#ga5447231fec5f42040c40307eb2e6a13c" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="388,107,508,133"/><area shape="rect" id="node7" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="385,157,511,184"/><area shape="rect" id="node8" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="379,208,517,235"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga5b4586b2e897ec306862a0b6901f39e7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_slotvec_lock </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Locks the instance data. </p>
<p>Spin lock used - no sleeping allowed!</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this vector instance </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html#l00226">226</a> of file <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html">tcmi_slotvec.h</a>.</p>

<p>References <a class="el" href="../../d0/dc1/proxyfs__server_8c_source.html#l00059">self</a>.</p>

<p>Referenced by <a class="el" href="../../d9/d86/tcmi__penman_8c_source.html#l00134">check_duplicates()</a>, <a class="el" href="../../d6/d82/tcmi__migman_8c_source.html#l00307">kill_all_tasks()</a>, <a class="el" href="../../d2/de0/tcmi__ccnman_8c_source.html#l00366">tcmi_ccnman_stop_listen_all()</a>, <a class="el" href="../../d2/de0/tcmi__ccnman_8c_source.html#l00402">tcmi_ccnman_stop_listen_one()</a>, <a class="el" href="../../d2/de0/tcmi__ccnman_8c_source.html#l00552">tcmi_ccnman_thread()</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00504">tcmi_man_emig_npm()</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00455">tcmi_man_emig_ppm_p()</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00542">tcmi_man_fork()</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00372">tcmi_man_get_non_shutdowning_migman()</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00173">tcmi_man_send_generic_user_message()</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00113">tcmi_man_wait_for_migmans_termination()</a>, <a class="el" href="../../d9/ded/tcmi__penmigman_8c_source.html#l00195">tcmi_penmigman_migrate_all_home()</a>, <a class="el" href="../../d3/dc2/tcmi__slotvec_8c_source.html#l00168">tcmi_slotvec_reserve_empty()</a>, <a class="el" href="../../d4/d2c/tcmi__transaction_8c_source.html#l00279">tcmi_transaction_lookup()</a>, and <a class="el" href="../../d4/d2c/tcmi__transaction_8c_source.html#l00328">tcmi_transaction_put()</a>.</p>
<div class="fragment"><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;{</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">// Have to be irqsave to avoid possible safe-&gt;unsafe conflict in forks</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    spin_lock_irqsave(&amp;self-&gt;<a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#a0da7101e2fc5d4a7015f24300998a1d1" title="current instance reference - used when freeing">s_lock</a>, self-&gt;<a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#a4241b2ba21acbcbad13d8b4503566ace" title="Technical field used for irq safe spinlocks.">lock_flags</a>);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaf11359c8cb20ddd7549296737eaf348d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a>* tcmi_slotvec_new </td>
          <td>(</td>
          <td class="paramtype">u_int&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocates a new slot vector. </p>
<p>Allocates a new slot vector.</p>
<ul>
<li>Vector of slots is allocated and all slots are initialized. Since we want the slot to do the management of unused/used lists on their own, we pass the vector lock as well as both list heads to the init method.</li>
<li>reference counter is initialized to 1 - the instantiator owns this slot vector now</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>- number of slots to be allocated in the vector. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a new slot vector or NULL </dd></dl>

<p>Definition at line <a class="el" href="../../d3/dc2/tcmi__slotvec_8c_source.html#l00050">50</a> of file <a class="el" href="../../d3/dc2/tcmi__slotvec_8c_source.html">tcmi_slotvec.c</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html#l00160">tcmi_slotvec::ref_count</a>, <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html#l00165">tcmi_slotvec::s_lock</a>, <a class="el" href="../../d5/d20/tcmi__p__emigrate__msg_8h_source.html#l00085">size</a>, <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html#l00149">tcmi_slotvec::slot_count</a>, <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html#l00147">tcmi_slotvec::slots</a>, <a class="el" href="../../d3/d94/tcmi__slot_8h_source.html#l00198">tcmi_slot_init()</a>, <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html#l00155">tcmi_slotvec::unused_slots</a>, and <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html#l00157">tcmi_slotvec::used_slots</a>.</p>

<p>Referenced by <a class="el" href="../../d2/de0/tcmi__ccnman_8c_source.html#l00065">tcmi_ccnman_init()</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00069">tcmi_man_init()</a>, and <a class="el" href="../../d3/dc2/tcmi__slotvec_8c_source.html#l00095">tcmi_slotvec_hnew()</a>.</p>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec" title="A slot vector compound structure.">tcmi_slotvec</a> *vec;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot" title="A slot compound structure.">tcmi_slot</a> *slots;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">if</span> (!(vec = kmalloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec" title="A slot vector compound structure.">tcmi_slotvec</a>), GFP_ATOMIC))) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Failed to allocate a slotvector&quot;</span>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">if</span> (!(slots = kmalloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot" title="A slot compound structure.">tcmi_slot</a>) * <a class="code" href="../../d5/d20/tcmi__p__emigrate__msg_8h.html#af8fd9ce16b371c8a3bf5e0b37a69419f" title="size of the checkpoint name in bytes (including trailing zero)">size</a>, GFP_ATOMIC))) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Failed to allocate a %d slots&quot;</span>, size);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordflow">goto</span> exit1;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    vec-&gt;<a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#a6eb1f9f3b1184ee2e4401c0a33691d61" title="The actual slot vector.">slots</a> = slots;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    vec-&gt;<a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#a5c5c298ba4017eeacd49ac706916f638" title="Number of slots in the vector.">slot_count</a> = <a class="code" href="../../d5/d20/tcmi__p__emigrate__msg_8h.html#af8fd9ce16b371c8a3bf5e0b37a69419f" title="size of the checkpoint name in bytes (including trailing zero)">size</a>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    INIT_LIST_HEAD(&amp;vec-&gt;<a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#aa8ec1680a89d2e47c3b7e4a9f45d35b2" title="list of unused slots">unused_slots</a>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    INIT_LIST_HEAD(&amp;vec-&gt;<a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#a60a6a5a8dd5c8aaef0fd134a7c6b190a" title="list of used slots">used_slots</a>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    atomic_set(&amp;vec-&gt;<a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#a510c521e990e3999f7f01f5a2151b033" title="reference counter">ref_count</a>, 1);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    spin_lock_init(&amp;vec-&gt;<a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#a0da7101e2fc5d4a7015f24300998a1d1" title="current instance reference - used when freeing">s_lock</a>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">/* initialize all slots */</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d5/d20/tcmi__p__emigrate__msg_8h.html#af8fd9ce16b371c8a3bf5e0b37a69419f" title="size of the checkpoint name in bytes (including trailing zero)">size</a>; i++) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <a class="code" href="../../da/d0c/group__tcmi__slot__class.html#ga347147be22f868eacdae39a2846c0e3f" title="Initializes a slot.">tcmi_slot_init</a>(slots, i, &amp;vec-&gt;<a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#aa8ec1680a89d2e47c3b7e4a9f45d35b2" title="list of unused slots">unused_slots</a>, </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                   &amp;vec-&gt;<a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#a60a6a5a8dd5c8aaef0fd134a7c6b190a" title="list of used slots">used_slots</a>, &amp;vec-&gt;<a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#a0da7101e2fc5d4a7015f24300998a1d1" title="current instance reference - used when freeing">s_lock</a>);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        slots++;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO4, <span class="stringliteral">&quot;Allocated %d slots (%lu bytes), memory=%p&quot;</span>, size, </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;         (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot" title="A slot compound structure.">tcmi_slot</a>) * size), vec);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">return</span> vec;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; exit1:</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    kfree(vec);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; exit0:</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d0/db7/group__tcmi__slotvec__class_gaf11359c8cb20ddd7549296737eaf348d_cgraph.png" border="0" usemap="#d0/db7/group__tcmi__slotvec__class_gaf11359c8cb20ddd7549296737eaf348d_cgraph" alt=""/></div>
<map name="d0/db7/group__tcmi__slotvec__class_gaf11359c8cb20ddd7549296737eaf348d_cgraph" id="d0/db7/group__tcmi__slotvec__class_gaf11359c8cb20ddd7549296737eaf348d_cgraph">
<area shape="rect" id="node2" href="../../da/d0c/group__tcmi__slot__class.html#ga347147be22f868eacdae39a2846c0e3f" title="Initializes a slot." alt="" coords="179,5,277,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga2376bcc84e5bbd48a8f92400f5ad5f25"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tcmi_slotvec_put </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Releases the instance. </p>
<p>&lt;&lt;public&gt;&gt; Releases the instance.</p>
<p>This requires releasing all slots and eventually releasing the instance itself.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this vector instance </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d3/dc2/tcmi__slotvec_8c_source.html#l00117">117</a> of file <a class="el" href="../../d3/dc2/tcmi__slotvec_8c_source.html">tcmi_slotvec.c</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d0/dc1/proxyfs__server_8c_source.html#l00059">self</a>, and <a class="el" href="../../d3/d94/tcmi__slot_8h_source.html#l00217">tcmi_slot_empty()</a>.</p>

<p>Referenced by <a class="el" href="../../d2/de0/tcmi__ccnman_8c_source.html#l00065">tcmi_ccnman_init()</a>, <a class="el" href="../../d2/de0/tcmi__ccnman_8c_source.html#l00107">tcmi_ccnman_shutdown()</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00069">tcmi_man_init()</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00142">tcmi_man_shutdown()</a>, <a class="el" href="../../d6/d82/tcmi__migman_8c_source.html#l00228">tcmi_migman_free()</a>, <a class="el" href="../../d6/d82/tcmi__migman_8c_source.html#l00081">tcmi_migman_init()</a>, <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00112">tcmi_task_init()</a>, and <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00209">tcmi_task_put()</a>.</p>
<div class="fragment"><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;{</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot" title="A slot compound structure.">tcmi_slot</a> *slots;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">if</span> (!<span class="keyword">self</span>)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Putting ref. count=%d (%p)&quot;</span>, </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;         atomic_read(&amp;self-&gt;<a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#a510c521e990e3999f7f01f5a2151b033" title="reference counter">ref_count</a>), <span class="keyword">self</span>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">if</span> (atomic_dec_and_test(&amp;self-&gt;<a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#a510c521e990e3999f7f01f5a2151b033" title="reference counter">ref_count</a>)) {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        slots = <span class="keyword">self</span>-&gt;slots;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <span class="keyword">self</span>-&gt;slot_count; i++, slots++) {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <span class="keywordflow">if</span> (!(<a class="code" href="../../da/d0c/group__tcmi__slot__class.html#ga6dd63ff2854a9939a5aa094f6543a5d1" title="&lt;&lt;public&gt;&gt; Checks if the slot is empty.">tcmi_slot_empty</a>(slots)))</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(WARN3, <span class="stringliteral">&quot;Warning - non empty slot %d&quot;</span>, i);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO4, <span class="stringliteral">&quot;Released %d slots (%lu bytes), memory=%p&quot;</span>, </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;             self-&gt;<a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#a5c5c298ba4017eeacd49ac706916f638" title="Number of slots in the vector.">slot_count</a>, </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;             (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot" title="A slot compound structure.">tcmi_slot</a>) * self-&gt;<a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#a5c5c298ba4017eeacd49ac706916f638" title="Number of slots in the vector.">slot_count</a>), <span class="keyword">self</span>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        kfree(self-&gt;<a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#a6eb1f9f3b1184ee2e4401c0a33691d61" title="The actual slot vector.">slots</a>);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        kfree(<span class="keyword">self</span>);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d0/db7/group__tcmi__slotvec__class_ga2376bcc84e5bbd48a8f92400f5ad5f25_cgraph.png" border="0" usemap="#d0/db7/group__tcmi__slotvec__class_ga2376bcc84e5bbd48a8f92400f5ad5f25_cgraph" alt=""/></div>
<map name="d0/db7/group__tcmi__slotvec__class_ga2376bcc84e5bbd48a8f92400f5ad5f25_cgraph" id="d0/db7/group__tcmi__slotvec__class_ga2376bcc84e5bbd48a8f92400f5ad5f25_cgraph">
<area shape="rect" id="node2" href="../../da/d0c/group__tcmi__slot__class.html#ga6dd63ff2854a9939a5aa094f6543a5d1" title="&lt;&lt;public&gt;&gt; Checks if the slot is empty." alt="" coords="174,5,293,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gabd12f97cda4c9b4b4142f6de475645d9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot">tcmi_slot</a>* tcmi_slotvec_reserve_empty </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Finds the first empty slot. </p>
<p>&lt;&lt;public&gt;&gt; Finds the first empty slot.</p>
<p>The slot is removed from the unused list, so that other threads won't consider it when searching for empty slots. The user of this method is responsible for either filling the slot with some data or releasing the slot back to unused list by means of tcmi_slot.h::tcmi_slot_move_unused()</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this vector instance </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to an empty slot or NULL </dd></dl>

<p>Definition at line <a class="el" href="../../d3/dc2/tcmi__slotvec_8c_source.html#l00168">168</a> of file <a class="el" href="../../d3/dc2/tcmi__slotvec_8c_source.html">tcmi_slotvec.c</a>.</p>

<p>References <a class="el" href="../../d3/d94/tcmi__slot_8h_source.html#l00156">tcmi_slot::index</a>, <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d0/dc1/proxyfs__server_8c_source.html#l00059">self</a>, <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html#l00226">tcmi_slotvec_lock()</a>, and <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html#l00237">tcmi_slotvec_unlock()</a>.</p>

<p>Referenced by <a class="el" href="../../d2/de0/tcmi__ccnman_8c_source.html#l00302">tcmi_ccnman_listen()</a>, <a class="el" href="../../df/db0/tcmi__man_8h_source.html#l00172">tcmi_man_reserve_migmanslot()</a>, and <a class="el" href="../../d3/dc2/tcmi__slotvec_8c_source.html#l00217">tcmi_slotvec_insert_at_empty()</a>.</p>
<div class="fragment"><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;{</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot" title="A slot compound structure.">tcmi_slot</a> *slot = NULL;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keyword">struct </span>list_head *list;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data.">tcmi_slotvec_lock</a>(<span class="keyword">self</span>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">if</span> (!list_empty(&amp;self-&gt;<a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#aa8ec1680a89d2e47c3b7e4a9f45d35b2" title="list of unused slots">unused_slots</a>)) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="comment">/* get the first slot */</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        list_for_each(list, &amp;self-&gt;<a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#aa8ec1680a89d2e47c3b7e4a9f45d35b2" title="list of unused slots">unused_slots</a>)</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            break;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        slot = list_entry(list, struct <a class="code" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot" title="A slot compound structure.">tcmi_slot</a>, slot_list);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="comment">/* remove the slot, from the unused list */</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        list_del_init(list);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO4, &quot;Found empty slot index = %d&quot;, slot-&gt;index);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data.">tcmi_slotvec_unlock</a>(self);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    return slot;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d0/db7/group__tcmi__slotvec__class_gabd12f97cda4c9b4b4142f6de475645d9_cgraph.png" border="0" usemap="#d0/db7/group__tcmi__slotvec__class_gabd12f97cda4c9b4b4142f6de475645d9_cgraph" alt=""/></div>
<map name="d0/db7/group__tcmi__slotvec__class_gabd12f97cda4c9b4b4142f6de475645d9_cgraph" id="d0/db7/group__tcmi__slotvec__class_gabd12f97cda4c9b4b4142f6de475645d9_cgraph">
<area shape="rect" id="node2" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="204,5,329,32"/><area shape="rect" id="node3" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="197,56,336,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga4df343d549736d3dc994ad0f43529a57"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_slotvec_unlock </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Unlocks the instance data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this vector instance </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html#l00237">237</a> of file <a class="el" href="../../d8/dc3/tcmi__slotvec_8h_source.html">tcmi_slotvec.h</a>.</p>

<p>References <a class="el" href="../../d0/dc1/proxyfs__server_8c_source.html#l00059">self</a>.</p>

<p>Referenced by <a class="el" href="../../d9/d86/tcmi__penman_8c_source.html#l00134">check_duplicates()</a>, <a class="el" href="../../d6/d82/tcmi__migman_8c_source.html#l00307">kill_all_tasks()</a>, <a class="el" href="../../d2/de0/tcmi__ccnman_8c_source.html#l00366">tcmi_ccnman_stop_listen_all()</a>, <a class="el" href="../../d2/de0/tcmi__ccnman_8c_source.html#l00402">tcmi_ccnman_stop_listen_one()</a>, <a class="el" href="../../d2/de0/tcmi__ccnman_8c_source.html#l00552">tcmi_ccnman_thread()</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00504">tcmi_man_emig_npm()</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00455">tcmi_man_emig_ppm_p()</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00542">tcmi_man_fork()</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00372">tcmi_man_get_non_shutdowning_migman()</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00173">tcmi_man_send_generic_user_message()</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00113">tcmi_man_wait_for_migmans_termination()</a>, <a class="el" href="../../d9/ded/tcmi__penmigman_8c_source.html#l00195">tcmi_penmigman_migrate_all_home()</a>, <a class="el" href="../../d3/dc2/tcmi__slotvec_8c_source.html#l00168">tcmi_slotvec_reserve_empty()</a>, <a class="el" href="../../d4/d2c/tcmi__transaction_8c_source.html#l00279">tcmi_transaction_lookup()</a>, and <a class="el" href="../../d4/d2c/tcmi__transaction_8c_source.html#l00328">tcmi_transaction_put()</a>.</p>
<div class="fragment"><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;{</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    spin_unlock_irqrestore(&amp;self-&gt;<a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#a0da7101e2fc5d4a7015f24300998a1d1" title="current instance reference - used when freeing">s_lock</a>, self-&gt;<a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#a4241b2ba21acbcbad13d8b4503566ace" title="Technical field used for irq safe spinlocks.">lock_flags</a>);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun May 12 2013 18:46:56 for Clondike by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
