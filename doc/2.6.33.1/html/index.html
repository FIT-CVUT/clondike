<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Clondike: Clondike(CTU FIT version converted from FEL version for kernel 2.6.33.1)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Clondike
   </div>
   <div id="projectbrief">Supported Linux kernel 2.6.33.1</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Clondike(CTU FIT version converted from FEL version for kernel 2.6.33.1) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Jan Capek, Petr Malat, Martin Stava, Jiri Rakosnik </dd></dl>
<dl class="section version"><dt>Version</dt><dd>KKC-1-02 TCMI-1-06 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2013-12-05</dd></dl>
<h1><a class="anchor" id="cnt"></a>
Content</h1>
<ul>
<li><a class="el" href="index.html#sec_mainpage_intro">Introduction</a></li>
<li><a class="el" href="index.html#sec_mainpage_install_manual">Install manual Clondike</a></li>
<li><a class="el" href="index.html#sec_mainpage_style">Software Design Style</a><ul>
<li><a class="el" href="index.html#subsec_mainpage_style_overall">Overall Considerations</a></li>
<li><a class="el" href="index.html#subsec_mainpage_style_ref">Reference Counting</a></li>
<li><a class="el" href="index.html#subsec_mainpage_style_synch">Synchronization</a></li>
<li><a class="el" href="index.html#subsec_mainpage_style_inheritance">Inheritance</a></li>
<li><a class="el" href="index.html#subsec_mainpage_style_polymorph">Polymorphism &amp; Template Design Patterns</a></li>
<li><a class="el" href="index.html#subsec_mainpage_style_coding">Coding Style</a></li>
</ul>
</li>
<li><a class="el" href="index.html#sec_mainpage_patch">Linux Kernel Patch</a><ul>
<li><a class="el" href="index.html#subsec_mainpage_patch_hooks">TCMI hooks (include/clondike/tcmi/tcmi_hooks.h)</a></li>
<li><a class="el" href="index.html#subsec_mainpage_patch_sig_unused">SIGUNUSED/SIGSYS (kernel/signal.c)</a></li>
<li><a class="el" href="index.html#subsec_mainpage_patch_task_struct">task_struct (include/linux/sched.h)</a></li>
<li><a class="el" href="index.html#subsec_mainpage_patch_do_exit">do_exit (kernel/exit.c)</a></li>
<li><a class="el" href="index.html#subsec_mainpage_patch_tmp_debug">Debugging (clondike/tcmi/tcmi_dbg.h, arch/i386/fault.c, mm/memory.c)</a></li>
<li><a class="el" href="index.html#subsec_mainpage_patch_kconfig">Kconfig(Makefile, arch/i386/Kconfig, clondike/tcmi/Kconfig)</a></li>
</ul>
</li>
<li><a class="el" href="dc/d0a/page_manual.html">Manual</a></li>
<li><a class="el" href="index.html#sec_mainpage_dir_layout">Source Directory Layout</a></li>
<li><a class="el" href="index.html#sec_old_changelogs">Historical changelogs</a><ul>
<li><a class="el" href="index.html#subsec_mainpage_tcmichangelogs">Changelogs - TCMI</a></li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="sec_mainpage_intro"></a>
Introduction</h1>
<p>Clondike is a project developed at FEE and FIT CTU, Prague. The main goal is to create a cluster of non-dedicated workstations. This web page is automatically generated from clondike sources and explains various implementation aspects. Currently, clondike has three main parts that are described in separate sections:</p>
<ul>
<li><a class="el" href="de/d96/group__kkc__class.html">Kernel-to-Kernel Communication library(KKC) </a></li>
<li><a class="el" href="d0/d20/group__tcmi__module__class.html">Task Checkpointing and Migration Infrastructure(TCMI) </a></li>
<li><a class="el" href="d3/d0e/group__proxyfs__module__class.html">Proxy File System(ProxyFS) </a></li>
<li>Cache Clondike Filesystem - Support cache file system for measuring</li>
</ul>
<p>All clondike classes can be viewed in a <a href="modules.html">tree-like structure </a></p>
<h1><a class="anchor" id="sec_mainpage_install_manual"></a>
Install manual Clondike</h1>
<pre class="fragment">Install for Linux distribution Debian:

1. Install the necessary tools and library for kernel compilation:
    1.1 gcc
    1.2 make
    1.3 initramfs-tools
    1.4 git
    1.5 ncurses-dev

   It can be done with one command "apt-get install ncurses-dev gcc make initramfs-tools git" as root.

2. Download Clondike patch from github.com: 
   https://github.com/FIT-CVUT/clondike.git (manually link Downloads at right).

3. Download the appropriate kernel from www.kernel.org/pub/linux/kernel/v2.6/linux-2.6.33.1.tar.gz.
   You can use commend "wget www.kernel.org/pub/linux/kernel/v2.6/linux-2.6.33.1.tar.gz".

4. Unpack downloaded kernel i.e. by command 
   "tar -xzf linux-2.6.33.1.tar.gz"

5. Go to the unpacked directory i.e. 
   "cd linux-2.6.33.1".

6. Make a new kernel patch by command 
   "patch -p1 &lt; path_to_the_downloaded_patch"  (clondike/patches/clondike_kernel_2.6.33.1.patch)
	
7. If we've old and functional kernel config file, for example config-2.6.32-5-xen-amd64, we can use it. If we haven't, skip this step.
   Rename it to actual config file .config and compile it: 
   "cp config-2.6.32-5-xen-amd64 .config"
   "make oldconfig"

8. Enable in kernel settings several required properties. 
   Use spacebar to change configuration in menu, after all configurations save it to .config 
   by Save an Alternate Configuration File and Exit.

	"make menuconfig"
	menu: Clondike &gt; Enable TCMI Enable TCMI CCN Enable TCMI PEN 
	menu: File systems/Network File systems/NFS client support (ENABLE *) 
          &gt; Enable ROOT_NFS (and also dependencies, search /root_nfs)
	menu: File systems/Network File Systems &gt; Enable Plan 9 Resource Sharing Support
	menu: Networking support &gt; Enable Plan 9 Resource Sharing Support

9. Copy recursively a directory Clondike/src to the directory clondike i.e. 
   "cp -R ../clondike/sources/kernel_X.X.X.X/src/ clondike/" # X.X.X.X is a version of your kernel in our case 2.6.33.1

10. The kernel compilation (in a directory linux-2.6.33.1)
	"make clean"
	"make -j4" # -j4 is a number of cores using to compilation
	"make modules"
	"make modules_install"
	"make install" # copy files to directory /boot

11. Go to directory /boot
	"cd /boot"

12. There create your own ramfs by command mkinitramfs 
    "mkinitramfs -o initrd.img-2.6.33.1 2.6.33.1"

13. GRUB: Add a line proxyfs.server=tcp:0.0.0.0:1112 to a grub config file to parameter GRUB_CMDLINE_LINUX using your favorite editor (i.e. nano) 
    "nano /etc/default/grub"
    # there replace GRUB_CMDLINE_LINUX="" for GRUB_CMDLINE_LINUX="proxyfs.server=tcp:0.0.0.0:1112"

14. Erase files with old indentity in the director 
    "rm -rf /root/clondike/userspace/simple-ruby-director/conf/*"
    
15. Add new kernel to grub by i.e. by command update-grub
	"update-grub"

16. Reboot system and load new kernel linux-2.6.33.1 
    "reboot"

17. Install ruby on the new system 
    "apt-get install ruby"

18. Compile npfs server for function 9p sharing filesystem:
	NPFS is in folder /root/npfs_install
	17.1. Compile NPFS command "make"
	17.2. Copy file /root/npfs_install/fs/npfs to folder /root/npfs
	17.3. Execute script /root/npfs/npfs-start &amp;
	17.4. Copy init script for NPFS from /etc/init.d/npfsd to same location in system 
                           for clondike /etc/init.d/rc.local to same location in system and overwrite it 

	Single commands:
	# cp /root/clondike/root/npfs_install/fs/npfs /root/npfs/
	# chmod +x /root/npfs/npfs-start
	# /root/npfs/npfs-start &amp;
	# cp /root/clondike/etc/init.d/npfsd /etc/init.d/

19	Replace modified init script for Clondike  
	# cp /root/clondike/etc/init.d/rc.local /etc/init.d/

20. Registered script for npfsd into INIT process by command:
	# update-rc.d npfsd defaults

20. Copy configuration file for migration
	"cp /root/clondike/root/.migration.conf /root/"

21. Execute script 
    "/root/clondike/scripts/install.sh"

22. Restart director to generate new unique certificate
	"/root/clondike/scripts/restart-director.sh"

===================================== Appendix for developers ====================================
Necessary installed libraries:
lbnl1
lbnl-dev

Compile director-api and ruby-director-api by Makefiles which are in same named folders
Execute in this folders:

#make

Install directorApi into Ruby libraries
In directory ruby-director-api execute

#make install
</pre><h1><a class="anchor" id="sec_mainpage_style"></a>
Software Design Style</h1>
<h2><a class="anchor" id="subsec_mainpage_style_overall"></a>
Overall Considerations</h2>
<p>All components are designed in a strict object-oriented style. Since we are on a C-based platform, the OO style can't be enforced by the compiler - it has to be respected by the developer. There is total encapsulation of all objects, all accessor methods are implemented with <code>static</code> <code>inline</code> memory class. All optimization is done by the compiler. Each class resides in a separate module(header file + optional .c file). Declaration section that is meant to be private is wrapped by a preprocessor directive: </p>
<pre class="fragment">#ifdef CLASS_NAME_PRIVATE
.
. declaration of private methods
.
#endif
</pre><p> The class definition file then prior to including the header file defines this macro which makes the private declarations visible.</p>
<p>All instance variables (even for singleton classes) are wrapped in a <code>struct</code>. Each regular instance method takes a pointer to this compound structure(denoted as <code>self</code>) as its first argument.</p>
<p>Singleton instance methods of a class that doesn't use inheritance don't use <code>self</code> as argument. They access the instance directly.</p>
<h2><a class="anchor" id="subsec_mainpage_style_ref"></a>
Reference Counting</h2>
<p>We have to realize that most of the objects are being accessed by multiple threads of execution. This fact requires a solid instance creation/destruction scheme. There is no garbage collecting present in kernel. This solution uses reference counters - each object is responsible for its reference counting. Each thread operating on an object retains its own reference to it. Threads don't destroy the objects, they merely release the reference. When the last reference to an object has been released, the object then performs a <b>self</b> <b>destruction</b>. This approach provides a robust solution and is generally recommended by kernel developers. In fact, not having a proper reference counting in a multithreaded 'kernel application' is considered a bug.</p>
<h2><a class="anchor" id="subsec_mainpage_style_synch"></a>
Synchronization</h2>
<p>Speaking of multiple threads of execution, some objects require synchronization of threads accessing them. Linux kernel provides various synchronization primitives(spinlocks, semaphores, completions). Their use is specific to each individual situation and object. As a rule of thumb, the approach - '<em>protect</em> <em>data</em> <em>not</em> <em>code'</em> has been used.</p>
<h2><a class="anchor" id="subsec_mainpage_style_inheritance"></a>
Inheritance</h2>
<p>Inheritance is a very important 'software tool' that prevents code duplication and yields lighter and easier to maintain code. There is more than one way how it can be implemented in C. For this project a simple object composition has been chosen as the most efficient variant. A <em>class_a</em> that inherits from <em>class_b</em> contains an instance of <em>class_b</em> in its compound structure. Example: </p>
<pre class="fragment">struct class_b {
 int b;
};
struct class_b* class_b_init(....);
</pre> <pre class="fragment">struct class_a {
 struct class_b super; -&gt; actual composition = inheritance
 int a;
};
struct class_b* class_a_new(....);
</pre><p>The <em>class_b</em> intentionally doesn't have a public constructor as it is considered abstract. The only public initializer, that it provides, is intended for the child classes to be called from their constructors.</p>
<p>It is <b>very</b> important that <code>super</code> (always denoted like this throughout the source code) is placed at the very top of the <em>class_a</em> compound structure. With this layout, we can guarantee that a pointer to child instance also points to parent instance. Thus, the parent methods will treat it properly. The <em>class_a_new</em> constructor intentionally returns a pointer to the parent class object. This is to support polymorphism(see further).</p>
<h2><a class="anchor" id="subsec_mainpage_style_polymorph"></a>
Polymorphism &amp; Template Design Patterns</h2>
<p>C is a language with type control, pure polymorphism is not possible. In order to have polymorphism we have to do inheritance (unless we want to get around with '<code>void</code> *' pointers only). The implementation takes a very efficient approach that is used everywhere in the kernel (e.g. VFS). The child class constructor supplies a vector of operations to the parent class and returns a pointer to the parent class instance. The parent class provides methods that are considered as the official object protocol. Instances of all classes that inherit from the same parent are thus considered <em>polymorphic</em>.</p>
<p>For some objects we want the parent class instance to do some work prior and after calling the child method from the operations vector. E.g. a <a class="el" href="d6/dc2/group__tcmi__msg__class.html">TCMI migration message </a> sends its header and delegates sending the body to the child class that knows how to do it. The <em>template</em> pattern can thus be considered as a natural extension of <em>polymorphism</em>. For example implementation see e.g. <a class="el" href="d6/dc2/group__tcmi__msg__class.html">tcmi_msg </a> and <a class="el" href="d4/d32/group__tcmi__skel__msg__class.html">tcmi_skel_msg </a>.</p>
<h2><a class="anchor" id="subsec_mainpage_style_coding"></a>
Coding Style</h2>
<p>The coding style follows recommendations for linux kernel including K&amp;R indentation. There are a few details that should be clearly stated here: Since there is no software exception/error handling mechanism(like try/catch or setjmp/longjmp statements), we have to deal with errors manually. This is a common approach used throughout the kernel. Each method (considering a non-trivial one) has two parts: - executive part (at the top, the actual functionality/work to be done) - error handling part (at the bottom)</p>
<p>When an error is detected a <code>goto</code> is issued to a corresponding handler at the bottom. The handler then unrolls all actions that have executed so far(if possible) and returns an error code. The error code is generally a negative number. For methods that return a pointer, NULL signals an error. A typical example method that implements this error handling is any constructor - class method. See e.g. tcmi_shadowtask.c::tcmi_shadowtask_new().</p>
<p>All class identifiers strictly have following prefix:</p>
<ul>
<li><code>tcmi_</code> for <a class="el" href="d0/d20/group__tcmi__module__class.html">TCMI </a></li>
<li><code>proxyfs_</code> for <a class="el" href="d3/d0e/group__proxyfs__module__class.html">ProxyFS </a></li>
<li><code>kkc_</code> for <a class="el" href="de/d96/group__kkc__class.html">KKC </a></li>
<li><code>ccfs_</code> for CCFS</li>
</ul>
<p>based on the subsystem they belong to. The implementation of a class is carried out in the .h and .c file of the same name as the class is.</p>
<p>Each method name carries the identifier of the class that it belongs to. This rather tedious(but consistent) coding decision increases code readibility. E.g. tcmi_task.c::tcmi_task_set_local_pid() represents a local PID setter of <a class="el" href="de/d2f/group__tcmi__task__class.html">tcmi_task</a>.</p>
<h1><a class="anchor" id="sec_mainpage_patch"></a>
Linux Kernel Patch</h1>
<p>Using <a class="el" href="d0/d20/group__tcmi__module__class.html">TCMI</a> with Linux kernel required a few modifications in the kernel itself. This section describes necessary changes.</p>
<h2><a class="anchor" id="subsec_mainpage_patch_hooks"></a>
TCMI hooks (include/clondike/tcmi/tcmi_hooks.h)</h2>
<p>This is an extension that provides an easy way to install hooks anywhere in the Linux kernel. A hook then provides a mechanism for external external subsystems register their functionality. Having the system setup like this allows having the entire TCMI outside the kernel.</p>
<p>Creating a new hook requires:</p>
<ul>
<li>declaring the hook in the <em>tcmi_hooks.h</em> header</li>
<li>adding the hook call at the desired place in the kernel</li>
</ul>
<p>E.g. the <a class="el" href="index.html#subsec_mainpage_patch_sig_unused">SIGUNUSED</a> is installed in <em>kernel/signal.c</em> as follows: </p>
<pre class="fragment">  .
  .
  if (signr == SIGUNUSED) {
   spin_unlock_irq(&amp;current-&gt;sighand-&gt;siglock);
   TCMI_HOOKS_CALL(sig_unused, regs);
   goto relock;
  }
  .
  .
</pre><h2><a class="anchor" id="subsec_mainpage_patch_sig_unused"></a>
SIGUNUSED/SIGSYS (kernel/signal.c)</h2>
<p>TCMI hook - the default handler for this signal (31) - has been installed into <em>get_signal_to_deliver()</em> function. In addition, the signal has been added among <em>kernel</em> <em>signals</em>. This prevents any user processes (effectively forbids) from setting their own signal handler for this signal.</p>
<h2><a class="anchor" id="subsec_mainpage_patch_task_struct"></a>
task_struct (include/linux/sched.h)</h2>
<p>Shadow and guest processes require an entry in process descriptor. The entry carries:</p>
<ul>
<li>pointer to the TCMI task (type void*, so that the actual <a class="el" href="de/d2f/group__tcmi__task__class.html">tcmi_task </a> doesn't need to be part of kernel sources).</li>
<li>pointer to the migration mode handler</li>
<li>pointer to data available for the handler (currently unused)</li>
</ul>
<h2><a class="anchor" id="subsec_mainpage_patch_do_exit"></a>
do_exit (kernel/exit.c)</h2>
<p>TCMI hook for this system call is installed, so that the framework is able to keep track of terminating migrated(<a class="el" href="d5/d85/group__tcmi__guesttask__class.html">guest </a>) processes.</p>
<h2><a class="anchor" id="subsec_mainpage_patch_tmp_debug"></a>
Debugging (clondike/tcmi/tcmi_dbg.h, arch/i386/fault.c, mm/memory.c)</h2>
<p>There are debug messages directly in the kernel that will show up in the kernel debug log only for tcmi_tasks. Currently, there are debug messages in page fault handler to verify correct checkpoint restart. This will be removed in the future.</p>
<h2><a class="anchor" id="subsec_mainpage_patch_kconfig"></a>
Kconfig(Makefile, arch/i386/Kconfig, clondike/tcmi/Kconfig)</h2>
<p>The kernel configuration has been extended. This allows enabling TCMI hooks in the kernel. Also, support for CCN and PEN on the same node can be configured.</p>
<h1><a class="anchor" id="sec_mainpage_dir_layout"></a>
Source Directory Layout</h1>
<pre class="fragment">Source tree organization
-------------------------
doc/ - Doxygen source code documentation
    clondike.cfg - configuration to generate docs

    html/index.html - main HTML documentation entry point

etc/ - configuration files for system
    init.d/rc.local - Modified config file for clondike startup after init system
		  /npfsd - Init script for startup NPFS

    bash.bashrc - Modified config file Bash if is installed clondike then change prompt

measurements/ - testing files for measurement

patch/ - the individual clondike patches for different kernels

root/ - Home folder user root
	npfsd_install - Sources for NPFS
	npfsd - Contains init script which is called during starting OS
	.migratable - configuration file for simple-ruby-director
				  defines which process can be migrate

scripts/
        devel/ folder with developmental or testing scripts
           load.sh - loads entire framework and mounts ctlfs filesystem
           unload.sh - unloads the framework if there are no migrated processes
           connect.sh - connects a CCN to specified PEN
           emig.sh - emigrates a process from CCN to PEN
           mig-home.sh - migrates a process to the home node
           gpl.pl - generic script, inserts a GPL into a file
           stripgpl.pl - strips GPL from a file
           clondike_gpl.sh - inserts clondike GPL(uses gpl.pl) into a file
           kkc_gpl.sh - inserts KKC GPL(uses gpl.pl) into a file
           tcmi_gpl.sh - inserts TCMI GPL(uses gpl.pl) into a file
           clondike-diff.sh - makes diff between 2 kernels, 
                              producing clondike patch

    listen.sh - CCN starts listening for incoming connections from PEN's
    
    clondike-init - Inicialization and start Clondike - userspace/simple-ruby-director	
    
    clear-current-config.sh - Clear current configuration simple-ruby-director
                              remove contain of userspace/simple-ruby-director/conf/*

    install.sh - Install script for create clondike user and the necessary directories

    parse-interface-ip.sh - Auxiliary script for parse current IP address on network interface

    restart-director.sh - Restarting simple-ruby-director


sources/kernel_2.6.33.1/
       /kernel_3.7.1/
                    src/kkc/ - Kernel-to-Kernel Communication Library
                               separate module(kkc_lib.ko)

                        tcmi/ - Task Checkpointing and Migration Infrastructure
                                ckpt/ - Process checkpointing component - 
                                        separate module(tcmickptcom.ko)

                            comm/ - Entire communication component, messages, 
                                    transactions etc.

                            ctlfs/ - control filesystem - separate module(tcmictlfs.ko)

                            lib/ - library - queue, slotvector, tcmi socket

                            manager/ - CCN manager, PEN manager, CCN migration manager,
                                       PEN migration manager

                            migration/ - migration component
                                     fs/ - implement 9p fs, mount, remount, umount etc.

                            syscall/ syscalls for shadow and quest process, rcp, syscallhooks

                            task/ - TCMI task - shadow/guest process abstraction

                            tcmi_module.c - main TCMI module, supports CCN and/or PEN
                                            based on kernel configuration

                        ccfs/ - Implement Cache clondike filesystem for measurement

                        director/ - Implement director comunnication over NETLINK 
                                    by individual defines message
                                    Comunnication between USERSPACE and KERNELSPACE
                                 
                                 netlink/ - Implement NETLINK interface

                        proxyfs/ - Implement proxy file system allowing the use of special files 
                                   for example pipe for migratable process

                        scripts/ - Precompile scripts
                               dbgenv.c - Implement generator debug messages
                               proxyfs_ioctl_sort.pl - sorter ioctl table for proxyfs

test/ - test cases for most components

userspace/  - Application in userspace contains of C-API and Ruby scripts
         director-api/ - C-API which communicate over NETLINK with kernel by individual messages
         ruby-director-api/ Ruby wrapper which make possible call function from C-API
         simple-ruby-director/ Ruby scripts provide directoring whole the Clondike mechanism
                              Director.rb - main scripts for execute director
</pre><h1><a class="anchor" id="sec_old_changelogs"></a>
Historical changelogs</h1>
<h2><a class="anchor" id="subsec_mainpage_tcmichangelogs"></a>
Changelogs - TCMI</h2>
<p><a class="el" href="d0/d20/group__tcmi__module__class.html">TCMI</a> (<em>src/tcmi/ChangeLog</em>) </p>
<pre class="fragment">2005-05-12  Jan Capek  &lt;capekj@clare.doma&gt;

	* tcmi_module.c: removed task reap file. It is not needed anymore,
	the shadow task after merging with a process migrating home
	destroys itself automaticall.
 
2005-05-08  Jan Capek  &lt;capekj@hpecko&gt;

	* tcmi_module.c (tcmi_module_init): Added checks for successful
	CCN/PEN initialization.  Removed #ifdef CONFIG_TCMI_*, the
	framework configuration is now internally handled by CCN/PEN
	managers. Module initialization thus always requests init of CCN
	and PEN. The subsystem that is not compiled has no effect.

</pre><p><a class="el" href="d4/dcf/group__tcmi__ckptcom__class.html">checkpointing component</a> (<em>src/tcmi/ckpt/ChangeLog</em>) </p>
<pre class="fragment">2005-05-12  Jan Capek  &lt;capekj@clare.doma&gt;

	* tcmi_ckpt.c (tcmi_ckpt_write_files, tcmi_ckpt_file_count): Both
	methods now use a new macro 'tcmi_ckpt_foreach_openfile' to
	iterate through open files.

</pre><p><a class="el" href="d4/d6b/group__tcmi__comm__group.html">communication</a> (<em>src/tcmi/comm/ChangeLog</em>) </p>
<pre class="fragment">2005-05-12  Jan Capek  &lt;capekj@clare.doma&gt;

	* tcmi_err_procmsg.h (tcmi_err_procmsg_code): 
	* tcmi_err_msg.h (tcmi_err_msg_code): 
	Added error code accessor method.
</pre><p><a class="el" href="d9/d0a/group__tcmi__ctlfs__class.html">control filesystem</a> (<em>src/tcmi/ctlfs/ChangeLog</em>) </p>
<pre class="fragment">2005-05-12  Jan Capek  &lt;capekj@clare.doma&gt;

	* tcmi_ctlfs_file.c (tcmi_ctlfs_rawfile_new): Added printf style
	format string and variable number of arguments similar to string file
	and integer file constructors.

</pre><p><a class="el" href="dc/d84/group__tcmi__lib__group.html">lib</a> (<em>src/tcmi/lib/ChangeLog</em>) </p>
<pre class="fragment"></pre><p><a class="el" href="db/d31/group__tcmi__managers__group.html">managers</a> (<em>src/tcmi/manager/ChangeLog</em>) </p>
<pre class="fragment">2005-05-08  Jan Capek  &lt;capekj@hpecko&gt;

	* tcmi_ccnman.h (tcmi_ccnman_init, tcmi_ccnman_shutdown):Added
	empty methods that are invoked when the CCN support is disabled in kernel 

	* tcmi_penman.h (tcmi_penman_init, tcmi_penman_shutdown): Added
	empty methods that are invoked when the CCN support is disabled in kernel

</pre><p><a class="el" href="d4/d99/group__tcmi__migration__group.html">migration</a> (<em>src/tcmi/migration/ChangeLog</em>) </p>
<pre class="fragment"></pre><p><a class="el" href="d3/d1d/group__tcmi__task__group.html">task component</a> (<em>src/tcmi/task/ChangeLog</em>) </p>
<pre class="fragment">2005-05-12  Jan Capek  &lt;capekj@clare.doma&gt;

	* tcmi_taskhelper.h (tcmi_taskhelper_flushfiles): Added method
	that flushes and closes all regular files that the current process
	has open.

	* tcmi_guesttask.c (tcmi_guesttask_migrateback_ppm_p):Before
	sending the migration message, all regular files and directories
	are flushed(closed).
	
	* tcmi_shadowtask.c (tcmi_shadowtask_emigrate_ppm_p): Before
	sending the migration message, all regular files and directories
	are flushed (closed).
	
	* tcmi_shadowtask.c (tcmi_shadowtask_execve): This method finishes
	merging of the shadow with the original process - schedules an
	exit that dettaches TCMI task from the running process.
	

	* tcmi_task.c (tcmi_task_execve): Prior to issueing the actual
	execve, the particular instance is notified. This is need by
	shadow tasks when merging with a process migrating home. 

2005-05-08  Jan Capek  &lt;capekj@hpecko&gt;

	* tcmi_task.c (tcmi_task_prepare_execve): Fixed an issue, the old
	execve context is now always being released upon preparing a new
	one. 

</pre><h2><a class="anchor" id="sec_mainpage_kkcchangelogs"></a>
Changelogs - KKC</h2>
<p><a class="el" href="de/d96/group__kkc__class.html">KKC</a>(<em>src/kkc/ChangeLog</em>) </p>
<pre class="fragment"></pre> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun May 12 2013 18:47:02 for Clondike by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
