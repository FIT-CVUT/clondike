<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Clondike: tcmi_syscallhooks class</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Clondike
   </div>
   <div id="projectbrief">Supported Linux kernel 2.6.33.1</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('db/d6c/group__tcmi__syscallhooks__class.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">tcmi_syscallhooks class<div class="ingroups"><a class="el" href="../../dc/d59/group__tcmi__syscall__group.html">syscall forwarding</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>A &lt;&lt;singleton&gt;&gt; class that installs syscalls hooks into the kernel.  
<a href="#details">More...</a></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for tcmi_syscallhooks class:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<center><table><tr><td><img src="../../db/d6c/group__tcmi__syscallhooks__class.png" border="0" alt="" usemap="#db_2d6c_2group____tcmi____syscallhooks____class"/>
<map name="db_2d6c_2group____tcmi____syscallhooks____class" id="db_2d6c_2group____tcmi____syscallhooks____class">
<area shape="rect" id="node1" href="../../db/d5e/group__tcmi__syscallhooks__other__class.html" title="A &lt;&lt;singleton&gt;&gt; class that installs syscalls hooks into the kernel." alt="" coords="393,57,559,98"/><area shape="rect" id="node2" href="../../d1/db6/group__tcmi__syscallhooks__userident__class.html" title="A &lt;&lt;singleton&gt;&gt; class that installs user identity manipulation syscalls hooks into the kernel..." alt="" coords="413,224,539,251"/><area shape="rect" id="node3" href="../../d8/dfc/group__tcmi__syscallhooks__signal__class.html" title="A &lt;&lt;singleton&gt;&gt; class that installs syscalls hooks into the kernel." alt="" coords="423,173,529,200"/><area shape="rect" id="node4" href="../../de/da7/group__tcmi__syscallhooks__groupident__class.html" title="A part of tcmi_syscallhooks class that installs group identity manipulation syscalls hooks into the k..." alt="" coords="409,5,543,32"/><area shape="rect" id="node5" href="../../d7/da0/group__tcmi__syscallhooks__pidman__class.html" title="A &lt;&lt;singleton&gt;&gt; class that installs PID manipulation syscalls hooks into the kernel." alt="" coords="397,123,555,149"/><area shape="rect" id="node6" href="../../dc/d59/group__tcmi__syscall__group.html" title="Classes in this group are used for system calls modification and forwarding to provide migration tran..." alt="" coords="5,123,131,149"/></map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:de/da7/group__tcmi__syscallhooks__groupident__class"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da7/group__tcmi__syscallhooks__groupident__class.html">Group identification</a></td></tr>
<tr class="memdesc:de/da7/group__tcmi__syscallhooks__groupident__class"><td class="mdescLeft">&#160;</td><td class="mdescRight">A part of tcmi_syscallhooks class that installs group identity manipulation syscalls hooks into the kernel. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:db/d5e/group__tcmi__syscallhooks__other__class"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d5e/group__tcmi__syscallhooks__other__class.html">tcmi_syscallhooks_other class</a></td></tr>
<tr class="memdesc:db/d5e/group__tcmi__syscallhooks__other__class"><td class="mdescLeft">&#160;</td><td class="mdescRight">A &lt;&lt;singleton&gt;&gt; class that installs syscalls hooks into the kernel. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d7/da0/group__tcmi__syscallhooks__pidman__class"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/da0/group__tcmi__syscallhooks__pidman__class.html">PID &amp; GID manipulation</a></td></tr>
<tr class="memdesc:d7/da0/group__tcmi__syscallhooks__pidman__class"><td class="mdescLeft">&#160;</td><td class="mdescRight">A &lt;&lt;singleton&gt;&gt; class that installs PID manipulation syscalls hooks into the kernel. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d8/dfc/group__tcmi__syscallhooks__signal__class"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dfc/group__tcmi__syscallhooks__signal__class.html">Signal sending</a></td></tr>
<tr class="memdesc:d8/dfc/group__tcmi__syscallhooks__signal__class"><td class="mdescLeft">&#160;</td><td class="mdescRight">A &lt;&lt;singleton&gt;&gt; class that installs syscalls hooks into the kernel. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d1/db6/group__tcmi__syscallhooks__userident__class"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/db6/group__tcmi__syscallhooks__userident__class.html">User identification</a></td></tr>
<tr class="memdesc:d1/db6/group__tcmi__syscallhooks__userident__class"><td class="mdescLeft">&#160;</td><td class="mdescRight">A &lt;&lt;singleton&gt;&gt; class that installs user identity manipulation syscalls hooks into the kernel. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga6da59bf397b6392287a3afe9a0305def"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d6c/group__tcmi__syscallhooks__class.html#ga6da59bf397b6392287a3afe9a0305def">tcmi_syscall_hooks_init</a> (void)</td></tr>
<tr class="memdesc:ga6da59bf397b6392287a3afe9a0305def"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Registers all syscalls hooks with the kernel.  <a href="#ga6da59bf397b6392287a3afe9a0305def">More...</a><br/></td></tr>
<tr class="separator:ga6da59bf397b6392287a3afe9a0305def"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1304a1a1820622da7dff8595d5b7fc8f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d6c/group__tcmi__syscallhooks__class.html#ga1304a1a1820622da7dff8595d5b7fc8f">tcmi_syscall_hooks_exit</a> (void)</td></tr>
<tr class="memdesc:ga1304a1a1820622da7dff8595d5b7fc8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Unregisters all syscalls hooks.  <a href="#ga1304a1a1820622da7dff8595d5b7fc8f">More...</a><br/></td></tr>
<tr class="separator:ga1304a1a1820622da7dff8595d5b7fc8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga919389ad6939b72a6e42950cb0472f3d"><td class="memItemLeft" align="right" valign="top">static long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d6c/group__tcmi__syscallhooks__class.html#ga919389ad6939b72a6e42950cb0472f3d">tcmi_syscall_hooks_sys_wait4</a> (pid_t <a class="el" href="../../d6/d23/tcmi__signal__msg_8h.html#ae0d46a978d5cd6707411f276ad869b9c">pid</a>, int __user *stat_addr, int options, struct rusage __user *ru)</td></tr>
<tr class="memdesc:ga919389ad6939b72a6e42950cb0472f3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; sys_wait4 system call hook.  <a href="#ga919389ad6939b72a6e42950cb0472f3d">More...</a><br/></td></tr>
<tr class="separator:ga919389ad6939b72a6e42950cb0472f3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga83a1e4217a65e4291ba10b3238b632b8"><td class="memItemLeft" align="right" valign="top">static long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d6c/group__tcmi__syscallhooks__class.html#ga83a1e4217a65e4291ba10b3238b632b8">tcmi_syscall_hooks_pre_fork</a> (unsigned long clone_flags, unsigned long stack_start, struct pt_regs *regs, unsigned long stack_size, int __user *parent_tidptr, int __user *child_tidptr)</td></tr>
<tr class="memdesc:ga83a1e4217a65e4291ba10b3238b632b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; pre-fork  <a href="#ga83a1e4217a65e4291ba10b3238b632b8">More...</a><br/></td></tr>
<tr class="separator:ga83a1e4217a65e4291ba10b3238b632b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8d308e4bffe9dabddb5b9ac3176d930b"><td class="memItemLeft" align="right" valign="top">static long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d6c/group__tcmi__syscallhooks__class.html#ga8d308e4bffe9dabddb5b9ac3176d930b">tcmi_syscall_hooks_in_fork</a> (struct task_struct *child)</td></tr>
<tr class="memdesc:ga8d308e4bffe9dabddb5b9ac3176d930b"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; in-fork...  <a href="#ga8d308e4bffe9dabddb5b9ac3176d930b">More...</a><br/></td></tr>
<tr class="separator:ga8d308e4bffe9dabddb5b9ac3176d930b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga818119b8855fe4b6eea69b3b28d1648b"><td class="memItemLeft" align="right" valign="top">static long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d6c/group__tcmi__syscallhooks__class.html#ga818119b8855fe4b6eea69b3b28d1648b">tcmi_syscall_hooks_post_fork</a> (struct task_struct *child, long res, pid_t remote_pid, int __user *parent_tidptr, int __user *child_tidptr)</td></tr>
<tr class="memdesc:ga818119b8855fe4b6eea69b3b28d1648b"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; post-fork  <a href="#ga818119b8855fe4b6eea69b3b28d1648b">More...</a><br/></td></tr>
<tr class="separator:ga818119b8855fe4b6eea69b3b28d1648b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabc5f26f1fc92e45829f3c23dc30439ac"><td class="memItemLeft" align="right" valign="top">static long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d6c/group__tcmi__syscallhooks__class.html#gabc5f26f1fc92e45829f3c23dc30439ac">tcmi_syscall_hooks_sys_kill</a> (int <a class="el" href="../../d6/d23/tcmi__signal__msg_8h.html#ae0d46a978d5cd6707411f276ad869b9c">pid</a>, int sig)</td></tr>
<tr class="memdesc:gabc5f26f1fc92e45829f3c23dc30439ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Kill system call hook.  <a href="#gabc5f26f1fc92e45829f3c23dc30439ac">More...</a><br/></td></tr>
<tr class="separator:gabc5f26f1fc92e45829f3c23dc30439ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0fd086d7662832ba7479a17248b548cd"><td class="memItemLeft" align="right" valign="top">static long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d6c/group__tcmi__syscallhooks__class.html#ga0fd086d7662832ba7479a17248b548cd">tcmi_syscall_hooks_do_tkill</a> (int tgid, int <a class="el" href="../../d6/d23/tcmi__signal__msg_8h.html#ae0d46a978d5cd6707411f276ad869b9c">pid</a>, int sig)</td></tr>
<tr class="memdesc:ga0fd086d7662832ba7479a17248b548cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; do_tkill hook.  <a href="#ga0fd086d7662832ba7479a17248b548cd">More...</a><br/></td></tr>
<tr class="separator:ga0fd086d7662832ba7479a17248b548cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf6e8e9ed1a9dbd61984fe4c82e6c4c97"><td class="memItemLeft" align="right" valign="top">static long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d6c/group__tcmi__syscallhooks__class.html#gaf6e8e9ed1a9dbd61984fe4c82e6c4c97">tcmi_syscall_hooks_sys_rt_sigqueueinfo</a> (int <a class="el" href="../../d6/d23/tcmi__signal__msg_8h.html#ae0d46a978d5cd6707411f276ad869b9c">pid</a>, int sig, siginfo_t *<a class="el" href="../../d6/d23/tcmi__signal__msg_8h.html#a7d5c5f5b173fb960963b2c44980dc940">info</a>)</td></tr>
<tr class="memdesc:gaf6e8e9ed1a9dbd61984fe4c82e6c4c97"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; sys_rt_sigqueueinfo hook.  <a href="#gaf6e8e9ed1a9dbd61984fe4c82e6c4c97">More...</a><br/></td></tr>
<tr class="separator:gaf6e8e9ed1a9dbd61984fe4c82e6c4c97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>A &lt;&lt;singleton&gt;&gt; class that installs syscalls hooks into the kernel. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga0fd086d7662832ba7479a17248b548cd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static long tcmi_syscall_hooks_do_tkill </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tgid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; do_tkill hook. </p>
<p>Handles both tkill and tgkill system call</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tgid</td><td>- the thread group ID of the thread </td></tr>
    <tr><td class="paramname">pid</td><td>- the PID of the thread </td></tr>
    <tr><td class="paramname">sig</td><td>- signal to be sent</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- zero on sucess. </dd></dl>

<p>Definition at line <a class="el" href="../../d0/d64/tcmi__syscallhooks__signal_8c_source.html#l00095">95</a> of file <a class="el" href="../../d0/d64/tcmi__syscallhooks__signal_8c_source.html">tcmi_syscallhooks_signal.c</a>.</p>

<p>References <a class="el" href="../../dd/dda/tcmi__guest__rpc_8c_source.html#l00036">tcmi_guest_rpc</a>, <a class="el" href="../../d2/d3e/tcmi__rpc_8h_source.html#l00108">tcmi_rpc_call3()</a>, and <a class="el" href="../../da/db2/tcmi__rpc__numbers_8h_source.html#l00007">TCMI_RPC_SYS_TKILL</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d64/tcmi__syscallhooks__signal_8c_source.html#l00046">tcmi_syscall_hooks_signal_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;{</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/group__tcmi__rpc__class.html#ga2c40c9a03386d2f72490604ae5d938d4" title="&lt;&lt;public&gt;&gt; Do a rpc with 3 parameters.">tcmi_rpc_call3</a>(<a class="code" href="../../d0/d35/group__tcmi__guest__rpc__class.html#ga7ce4b3abbe1bd16852396a951c25a9ad" title="tcmi_guest_rpc class declaration">tcmi_guest_rpc</a>, <a class="code" href="../../da/db2/tcmi__rpc__numbers_8h.html#a17551387664bad116b22819e5bff72fb">TCMI_RPC_SYS_TKILL</a>, tgid, <a class="code" href="../../d6/d23/tcmi__signal__msg_8h.html#ae0d46a978d5cd6707411f276ad869b9c" title="Target PID.">pid</a>, sig);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../db/d6c/group__tcmi__syscallhooks__class_ga0fd086d7662832ba7479a17248b548cd_cgraph.png" border="0" usemap="#db/d6c/group__tcmi__syscallhooks__class_ga0fd086d7662832ba7479a17248b548cd_cgraph" alt=""/></div>
<map name="db/d6c/group__tcmi__syscallhooks__class_ga0fd086d7662832ba7479a17248b548cd_cgraph" id="db/d6c/group__tcmi__syscallhooks__class_ga0fd086d7662832ba7479a17248b548cd_cgraph">
<area shape="rect" id="node2" href="../../d2/d43/group__tcmi__rpc__class.html#ga2c40c9a03386d2f72490604ae5d938d4" title="&lt;&lt;public&gt;&gt; Do a rpc with 3 parameters." alt="" coords="192,12,299,39"/><area shape="rect" id="node3" href="../../d2/d43/group__tcmi__rpc__class.html#ga3b19dd529d8c1bc18d24bca70107003f" title="&lt;&lt;public&gt;&gt; Universal procedure to do RPC" alt="" coords="347,12,440,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga1304a1a1820622da7dff8595d5b7fc8f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tcmi_syscall_hooks_exit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Unregisters all syscalls hooks. </p>
<p>&lt;&lt;public&gt;&gt; Unregisters all hooks.</p>

<p>Definition at line <a class="el" href="../../df/d7c/tcmi__syscallhooks_8c_source.html#l00065">65</a> of file <a class="el" href="../../df/d7c/tcmi__syscallhooks_8c_source.html">tcmi_syscallhooks.c</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00221">minfo</a>, <a class="el" href="../../dc/dd0/tcmi__syscallhooks__groupident_8c_source.html#l00066">tcmi_syscall_hooks_groupident_exit()</a>, <a class="el" href="../../db/d35/tcmi__syscallhooks__other_8c_source.html#l00071">tcmi_syscall_hooks_other_exit()</a>, <a class="el" href="../../d7/dc5/tcmi__syscallhooks__pidman_8c_source.html#l00064">tcmi_syscall_hooks_pidman_exit()</a>, <a class="el" href="../../d0/d64/tcmi__syscallhooks__signal_8c_source.html#l00059">tcmi_syscall_hooks_signal_exit()</a>, and <a class="el" href="../../d9/df7/tcmi__syscallhooks__userident_8c_source.html#l00063">tcmi_syscall_hooks_userident_exit()</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d0f/tcmi__module_8c_source.html#l00168">tcmi_module_exit()</a>.</p>
<div class="fragment"><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;{</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="../../d6/d01/dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(INFO1, <span class="stringliteral">&quot;Unregistering TCMI syscalls hooks&quot;</span>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="../../d8/dfc/group__tcmi__syscallhooks__signal__class.html#gacde8fdfd4c794b92f4707c9bb69d3879" title="&lt;&lt;public&gt;&gt; Unregisters all syscalls hooks.">tcmi_syscall_hooks_signal_exit</a>();</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="../../d7/da0/group__tcmi__syscallhooks__pidman__class.html#ga2e8a5f90575bcb32773dca34ad7709ec" title="&lt;&lt;public&gt;&gt; Unregisters all PID manipulation syscalls hooks.">tcmi_syscall_hooks_pidman_exit</a>();</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="../../d1/db6/group__tcmi__syscallhooks__userident__class.html#ga1c2f4380293f9be89fdb28119e2b62ea" title="&lt;&lt;public&gt;&gt; Unregisters all user identifikation syscalls hooks.">tcmi_syscall_hooks_userident_exit</a>();</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="../../de/da7/group__tcmi__syscallhooks__groupident__class.html#ga1da150fd25043357fdc04de7cb492eee" title="&lt;&lt;public&gt;&gt; Unregisters all user identifikation syscalls hooks.">tcmi_syscall_hooks_groupident_exit</a>();</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="../../db/d5e/group__tcmi__syscallhooks__other__class.html#ga832a46b9cefbc52fc454fd643e00bfe8" title="&lt;&lt;public&gt;&gt; Unregisters all syscalls hooks.">tcmi_syscall_hooks_other_exit</a>();</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../db/d6c/group__tcmi__syscallhooks__class_ga1304a1a1820622da7dff8595d5b7fc8f_cgraph.png" border="0" usemap="#db/d6c/group__tcmi__syscallhooks__class_ga1304a1a1820622da7dff8595d5b7fc8f_cgraph" alt=""/></div>
<map name="db/d6c/group__tcmi__syscallhooks__class_ga1304a1a1820622da7dff8595d5b7fc8f_cgraph" id="db/d6c/group__tcmi__syscallhooks__class_ga1304a1a1820622da7dff8595d5b7fc8f_cgraph">
<area shape="rect" id="node2" href="../../de/da7/group__tcmi__syscallhooks__groupident__class.html#ga1da150fd25043357fdc04de7cb492eee" title="&lt;&lt;public&gt;&gt; Unregisters all user identifikation syscalls hooks." alt="" coords="219,5,357,46"/><area shape="rect" id="node3" href="../../db/d5e/group__tcmi__syscallhooks__other__class.html#ga832a46b9cefbc52fc454fd643e00bfe8" title="&lt;&lt;public&gt;&gt; Unregisters all syscalls hooks." alt="" coords="219,70,357,111"/><area shape="rect" id="node4" href="../../d7/da0/group__tcmi__syscallhooks__pidman__class.html#ga2e8a5f90575bcb32773dca34ad7709ec" title="&lt;&lt;public&gt;&gt; Unregisters all PID manipulation syscalls hooks." alt="" coords="219,135,357,177"/><area shape="rect" id="node5" href="../../d8/dfc/group__tcmi__syscallhooks__signal__class.html#gacde8fdfd4c794b92f4707c9bb69d3879" title="&lt;&lt;public&gt;&gt; Unregisters all syscalls hooks." alt="" coords="219,201,357,242"/><area shape="rect" id="node6" href="../../d1/db6/group__tcmi__syscallhooks__userident__class.html#ga1c2f4380293f9be89fdb28119e2b62ea" title="&lt;&lt;public&gt;&gt; Unregisters all user identifikation syscalls hooks." alt="" coords="219,266,357,307"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga8d308e4bffe9dabddb5b9ac3176d930b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static long tcmi_syscall_hooks_in_fork </td>
          <td>(</td>
          <td class="paramtype">struct task_struct *&#160;</td>
          <td class="paramname"><em>child</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; in-fork... </p>
<p>performs attachement of guest/shadow task to TCMI </p>

<p>Definition at line <a class="el" href="../../db/d35/tcmi__syscallhooks__other_8c_source.html#l00112">112</a> of file <a class="el" href="../../db/d35/tcmi__syscallhooks__other_8c_source.html">tcmi_syscallhooks_other.c</a>.</p>

<p>References <a class="el" href="../../df/db0/tcmi__man_8h_source.html#l00151">TCMI_MAN</a>, and <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00542">tcmi_man_fork()</a>.</p>

<p>Referenced by <a class="el" href="../../db/d35/tcmi__syscallhooks__other_8c_source.html#l00056">tcmi_syscall_hooks_other_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                                                  {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">if</span> ( current-&gt;tcmi.task_type == guest ) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="comment">// Parent task is guest =&gt; child will be guest</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keyword">struct </span>tcmi_penman* pen_man = tcmi_penman_get_instance();</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d6/de0/group__tcmi__man__class.html#ga34c83e593357e4cf14838d2fca19b9d2" title="&lt;&lt;public&gt;&gt; Method that performs task fork">tcmi_man_fork</a>(<a class="code" href="../../d6/de0/group__tcmi__man__class.html#gaa817e26a29c1f89a28677a955a0e66d0" title="Casts to the TCMI manager.">TCMI_MAN</a>(pen_man), current, child);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( current-&gt;tcmi.task_type == shadow ) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="comment">// Parent task is shadow =&gt; child should be shadow </span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keyword">struct </span>tcmi_ccnman* ccn_man = tcmi_ccnman_get_instance();</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d6/de0/group__tcmi__man__class.html#ga34c83e593357e4cf14838d2fca19b9d2" title="&lt;&lt;public&gt;&gt; Method that performs task fork">tcmi_man_fork</a>(<a class="code" href="../../d6/de0/group__tcmi__man__class.html#gaa817e26a29c1f89a28677a955a0e66d0" title="Casts to the TCMI manager.">TCMI_MAN</a>(ccn_man), current, child);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">return</span> 0;   </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../db/d6c/group__tcmi__syscallhooks__class_ga8d308e4bffe9dabddb5b9ac3176d930b_cgraph.png" border="0" usemap="#db/d6c/group__tcmi__syscallhooks__class_ga8d308e4bffe9dabddb5b9ac3176d930b_cgraph" alt=""/></div>
<map name="db/d6c/group__tcmi__syscallhooks__class_ga8d308e4bffe9dabddb5b9ac3176d930b_cgraph" id="db/d6c/group__tcmi__syscallhooks__class_ga8d308e4bffe9dabddb5b9ac3176d930b_cgraph">
<area shape="rect" id="node2" href="../../d6/de0/group__tcmi__man__class.html#ga34c83e593357e4cf14838d2fca19b9d2" title="&lt;&lt;public&gt;&gt; Method that performs task fork" alt="" coords="192,376,299,403"/><area shape="rect" id="node3" href="../../d6/da2/group__tcmi__migman__class.html#gacd13117046ccc1fa12ac743b893fcfca" title="&lt;&lt;public&gt;&gt; Instance accessor, increments the reference counter." alt="" coords="364,208,489,235"/><area shape="rect" id="node4" href="../../d6/da2/group__tcmi__migman__class.html#gab536c262c24d8fc76cdbdfa8d6d65b81" title="&lt;&lt;public&gt;&gt; The manager is shutdown exactly in this order:" alt="" coords="364,259,489,285"/><area shape="rect" id="node30" href="../../da/d0c/group__tcmi__slot__class.html#ga821f6b686443bfc7fff52dd3b155de37" title="&lt;&lt;public&gt;&gt; Slot index accessor." alt="" coords="810,376,923,403"/><area shape="rect" id="node31" href="../../d0/db7/group__tcmi__slotvec__class.html#ga876670f605631a5deb930412dae02b28" title="&lt;&lt;public&gt;&gt; Accesses a slot at a given index." alt="" coords="371,427,483,453"/><area shape="rect" id="node32" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="364,477,489,504"/><area shape="rect" id="node33" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="357,528,496,555"/><area shape="rect" id="node34" href="../../de/d2f/group__tcmi__task__class.html#ga90412716287ffdaf54ba3f6f1e374a38" title="&lt;&lt;public&gt;&gt; Accessor of vector slot index of the migration manager associated with this task..." alt="" coords="347,310,507,351"/><area shape="rect" id="node5" href="../../d6/da2/group__tcmi__migman__class.html#ga94df994d6d2ad3dd9aa6543ee67bf934" title="&lt;&lt;private&gt;&gt; Free method is has two purposes:when the last reference is released, it will free all ins..." alt="" coords="575,183,703,209"/><area shape="rect" id="node6" href="../../d9/dfc/group__tcmi__comm__class.html#ga89dc5a63295a65407cc93606c79ca314" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="809,157,924,184"/><area shape="rect" id="node13" href="../../d6/da2/group__tcmi__migman__class.html#ga39c491f49b4e5b3cc533c816d27135a3" title="&lt;&lt;private&gt;&gt; Destroys all TCMI ctlfs directories" alt="" coords="771,259,962,285"/><area shape="rect" id="node16" href="../../d6/da2/group__tcmi__migman__class.html#ga5b56a5213e9dbcba9973b9530692fd27" title="&lt;&lt;private&gt;&gt; Unregisters and releases all control files." alt="" coords="785,310,948,351"/><area shape="rect" id="node23" href="../../d6/da2/group__tcmi__migman__class.html#gae4ad418d705edeca23e38eb383343978" title="&lt;&lt;private&gt;&gt; The TCMI manager listening thread is to be terminated by forcing a signal and waiting for..." alt="" coords="779,5,954,32"/><area shape="rect" id="node24" href="../../d6/da2/group__tcmi__migman__class.html#ga71f49cd0661e81a859daab82ae7676de" title="Removes migman from a list of migration managers of the associated manager." alt="" coords="792,56,941,83"/><area shape="rect" id="node27" href="../../d0/db7/group__tcmi__slotvec__class.html#ga2376bcc84e5bbd48a8f92400f5ad5f25" title="&lt;&lt;public&gt;&gt; Decrements the reference counter, when the count reaches 0, the instance is destroyed..." alt="" coords="807,107,926,133"/><area shape="rect" id="node29" href="../../d3/d7e/group__tcmi__sock__class.html#gaa64951d80cedfaf76bb82ee811255d69" title="&lt;&lt;public&gt;&gt; Decrements the reference counter and if it reaches 0, the instance." alt="" coords="813,208,920,235"/><area shape="rect" id="node7" href="../../d6/d8e/group__kkc__sock__class.html#ga9f980056fbf3436596c4cfdf3913e85c" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined..." alt="" coords="1046,157,1149,184"/><area shape="rect" id="node8" href="../../d5/ddf/group__kkc__arch__class.html#ga06049c969ae0324d0607f10db99af65c" title="&lt;&lt;public&gt;&gt; Decrements the reference counter on the module owning the architecture." alt="" coords="1267,107,1367,133"/><area shape="rect" id="node9" href="../../d6/d8e/group__kkc__sock__class.html#ga00d8b033d3e1118303e7b4c54c6aafe6" title="&lt;&lt;public&gt;&gt; Socket name accessor." alt="" coords="1234,157,1401,184"/><area shape="rect" id="node11" href="../../d6/d8e/group__kkc__sock__class.html#gac8e64f52015e75cb76a34c4b7e9ef176" title="&lt;&lt;public&gt;&gt; Socket name accessor." alt="" coords="1232,208,1403,235"/><area shape="rect" id="node10" href="../../d6/d8e/group__kkc__sock__class.html#gadf1b231c727891d5ac2d32646d574931" title="&lt;&lt;public&gt;&gt; Peer socket name accessor." alt="" coords="1460,157,1620,184"/><area shape="rect" id="node12" href="../../d6/d8e/group__kkc__sock__class.html#ga3cae649f56c8f5fa18f755f6c7d53597" title="&lt;&lt;public&gt;&gt; Local socket name accessor." alt="" coords="1459,208,1621,235"/><area shape="rect" id="node14" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d..." alt="" coords="1028,259,1167,285"/><area shape="rect" id="node15" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga986b629882729daaf2c9607bfca57c3c" title="&lt;&lt;public&gt;&gt; Entry name accessor." alt="" coords="1241,259,1394,285"/><area shape="rect" id="node17" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga665210941a04fda118949874767ced93" title="&lt;&lt;public&gt;&gt; This method unregisters the file uses the semaphore lock as protection from races..." alt="" coords="1235,309,1400,336"/><area shape="rect" id="node22" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gaead344003750e43cb4a0326876a191bc" title="&lt;&lt;public&gt;&gt; This method unregisters the file and allows the user to specify the preferred way of unreg..." alt="" coords="1011,360,1183,387"/><area shape="rect" id="node18" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga5323f5b0f103dd3c42defc6c4494e641" title="&lt;&lt;public&gt;&gt; Locks this file instance." alt="" coords="1474,309,1606,336"/><area shape="rect" id="node19" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gaddf76bb53a90657e6773b485e0a89248" title="This method is used when object associated with the file wants to unregister with the file..." alt="" coords="1451,360,1629,387"/><area shape="rect" id="node21" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gad49b6ab401eeac4dab0ecd314796d569" title="&lt;&lt;public&gt;&gt; Unlocks this file instance." alt="" coords="1467,259,1613,285"/><area shape="rect" id="node20" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga8c97fc25ab3bd060017a3539edf7d6f0" title="&lt;&lt;public&gt;&gt; Sets the unregistered flag of the file." alt="" coords="1677,353,1843,394"/><area shape="rect" id="node25" href="../../da/d0c/group__tcmi__slot__class.html#ga109d6d783ebf06046f364f970f84da1f" title="&lt;&lt;public&gt;&gt; Locks the slot data." alt="" coords="1044,56,1151,83"/><area shape="rect" id="node26" href="../../da/d0c/group__tcmi__slot__class.html#ga5447231fec5f42040c40307eb2e6a13c" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="1037,5,1157,32"/><area shape="rect" id="node28" href="../../da/d0c/group__tcmi__slot__class.html#ga6dd63ff2854a9939a5aa094f6543a5d1" title="&lt;&lt;public&gt;&gt; Checks if the slot is empty." alt="" coords="1038,107,1157,133"/><area shape="rect" id="node35" href="../../d6/da2/group__tcmi__migman__class.html#gafca6221a82ff480ee067fcfa39745719" title="&lt;&lt;public&gt;&gt; Migration manager slot index getter" alt="" coords="555,321,722,348"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga6da59bf397b6392287a3afe9a0305def"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tcmi_syscall_hooks_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Registers all syscalls hooks with the kernel. </p>
<p>&lt;&lt;public&gt;&gt; Registers all hooks with the kernel.</p>
<dl class="section return"><dt>Returns</dt><dd>0 upon success</dd></dl>

<p>Definition at line <a class="el" href="../../df/d7c/tcmi__syscallhooks_8c_source.html#l00051">51</a> of file <a class="el" href="../../df/d7c/tcmi__syscallhooks_8c_source.html">tcmi_syscallhooks.c</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00221">minfo</a>, <a class="el" href="../../dc/dd0/tcmi__syscallhooks__groupident_8c_source.html#l00048">tcmi_syscall_hooks_groupident_init()</a>, <a class="el" href="../../db/d35/tcmi__syscallhooks__other_8c_source.html#l00056">tcmi_syscall_hooks_other_init()</a>, <a class="el" href="../../d7/dc5/tcmi__syscallhooks__pidman_8c_source.html#l00047">tcmi_syscall_hooks_pidman_init()</a>, <a class="el" href="../../d0/d64/tcmi__syscallhooks__signal_8c_source.html#l00046">tcmi_syscall_hooks_signal_init()</a>, and <a class="el" href="../../d9/df7/tcmi__syscallhooks__userident_8c_source.html#l00047">tcmi_syscall_hooks_userident_init()</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d0f/tcmi__module_8c_source.html#l00122">tcmi_module_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;{</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="../../d6/d01/dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(INFO1, <span class="stringliteral">&quot;Registering TCMI syscalls hooks&quot;</span>);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="../../d8/dfc/group__tcmi__syscallhooks__signal__class.html#gab24b3283e431bd286411ce5c853fa0c6" title="&lt;&lt;public&gt;&gt; Registers all syscalls hooks with the kernel.">tcmi_syscall_hooks_signal_init</a>();</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="../../d7/da0/group__tcmi__syscallhooks__pidman__class.html#ga5cbadfbb7e7dac81984455f546fbe5e7" title="&lt;&lt;public&gt;&gt; Registers all PID manipulaton syscalls hooks with the kernel.">tcmi_syscall_hooks_pidman_init</a>();</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="../../d1/db6/group__tcmi__syscallhooks__userident__class.html#gafaf892dffa8d0b9e2beb25cfdb27490e" title="&lt;&lt;public&gt;&gt; Registers all user identification syscalls hooks with the kernel.">tcmi_syscall_hooks_userident_init</a>();</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="../../de/da7/group__tcmi__syscallhooks__groupident__class.html#gaea4c485c41be932d875d4dbce866b4b3" title="&lt;&lt;public&gt;&gt; Registers all user identification syscalls hooks with the kernel.">tcmi_syscall_hooks_groupident_init</a>();</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="../../db/d5e/group__tcmi__syscallhooks__other__class.html#ga09d996449766bcb9bc012537ff0c1835" title="&lt;&lt;public&gt;&gt; Registers all syscalls hooks with the kernel.">tcmi_syscall_hooks_other_init</a>();</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../db/d6c/group__tcmi__syscallhooks__class_ga6da59bf397b6392287a3afe9a0305def_cgraph.png" border="0" usemap="#db/d6c/group__tcmi__syscallhooks__class_ga6da59bf397b6392287a3afe9a0305def_cgraph" alt=""/></div>
<map name="db/d6c/group__tcmi__syscallhooks__class_ga6da59bf397b6392287a3afe9a0305def_cgraph" id="db/d6c/group__tcmi__syscallhooks__class_ga6da59bf397b6392287a3afe9a0305def_cgraph">
<area shape="rect" id="node2" href="../../de/da7/group__tcmi__syscallhooks__groupident__class.html#gaea4c485c41be932d875d4dbce866b4b3" title="&lt;&lt;public&gt;&gt; Registers all user identification syscalls hooks with the kernel." alt="" coords="217,693,354,734"/><area shape="rect" id="node16" href="../../db/d5e/group__tcmi__syscallhooks__other__class.html#ga09d996449766bcb9bc012537ff0c1835" title="&lt;&lt;public&gt;&gt; Registers all syscalls hooks with the kernel." alt="" coords="217,1607,354,1649"/><area shape="rect" id="node32" href="../../d7/da0/group__tcmi__syscallhooks__pidman__class.html#ga5cbadfbb7e7dac81984455f546fbe5e7" title="&lt;&lt;public&gt;&gt; Registers all PID manipulaton syscalls hooks with the kernel." alt="" coords="217,203,354,245"/><area shape="rect" id="node40" href="../../d8/dfc/group__tcmi__syscallhooks__signal__class.html#gab24b3283e431bd286411ce5c853fa0c6" title="&lt;&lt;public&gt;&gt; Registers all syscalls hooks with the kernel." alt="" coords="217,1378,354,1419"/><area shape="rect" id="node44" href="../../d1/db6/group__tcmi__syscallhooks__userident__class.html#gafaf892dffa8d0b9e2beb25cfdb27490e" title="&lt;&lt;public&gt;&gt; Registers all user identification syscalls hooks with the kernel." alt="" coords="217,1118,354,1159"/><area shape="rect" id="node3" href="../../dc/dd0/tcmi__syscallhooks__groupident_8c.html#a97f9b0b6702ca083e02afbc1872f4111" title="&lt;&lt;private&gt;&gt; Getegid system call hook" alt="" coords="406,497,543,538"/><area shape="rect" id="node6" href="../../dc/dd0/tcmi__syscallhooks__groupident_8c.html#a69750f9e52d7913a00f91a33ee5b008e" title="&lt;&lt;private&gt;&gt; Getgid system call hook" alt="" coords="406,562,543,603"/><area shape="rect" id="node7" href="../../dc/dd0/tcmi__syscallhooks__groupident_8c.html#af71efa93162cc74b38f5f8a6443d4a4c" title="&lt;&lt;private&gt;&gt; Setgid system call hook" alt="" coords="406,431,543,473"/><area shape="rect" id="node9" href="../../dc/dd0/tcmi__syscallhooks__groupident_8c.html#ab4ade59ff539ab8e9d6d8546cdd91ff5" title="&lt;&lt;private&gt;&gt; Setregid system call hook" alt="" coords="406,693,543,734"/><area shape="rect" id="node11" href="../../dc/dd0/tcmi__syscallhooks__groupident_8c.html#af86ef10171297df47d57aed902e22624" title="&lt;&lt;private&gt;&gt; Setresgid system call hook" alt="" coords="406,823,543,865"/><area shape="rect" id="node13" href="../../dc/dd0/tcmi__syscallhooks__groupident_8c.html#a30eb603b1dfb12ddb260b947ef042a5e" title="&lt;&lt;private&gt;&gt; Getresgid system call hook" alt="" coords="406,889,543,930"/><area shape="rect" id="node14" href="../../dc/dd0/tcmi__syscallhooks__groupident_8c.html#aea5aeec1c830aa115a5ebee69fa9b092" title="&lt;&lt;private&gt;&gt; Getgroups system call hook" alt="" coords="406,758,543,799"/><area shape="rect" id="node15" href="../../dc/dd0/tcmi__syscallhooks__groupident_8c.html#adfdfba3da60f2b2b8f9a44a8b4d5f3c9" title="&lt;&lt;private&gt;&gt; Setgroups system call hook" alt="" coords="406,627,543,669"/><area shape="rect" id="node4" href="../../d2/d43/group__tcmi__rpc__class.html#gaf1b703296ddb9266e763838bdf1f3cd8" title="&lt;&lt;public&gt;&gt; Do a rpc without parameters." alt="" coords="627,536,733,563"/><area shape="rect" id="node5" href="../../d2/d43/group__tcmi__rpc__class.html#ga3b19dd529d8c1bc18d24bca70107003f" title="&lt;&lt;public&gt;&gt; Universal procedure to do RPC" alt="" coords="843,995,936,1021"/><area shape="rect" id="node8" href="../../d2/d43/group__tcmi__rpc__class.html#ga5b9038dad443fde049925ac3be004ff0" title="&lt;&lt;public&gt;&gt; Do a rpc with 1 parameter." alt="" coords="627,439,733,465"/><area shape="rect" id="node10" href="../../d2/d43/group__tcmi__rpc__class.html#gac256a36ecc415dfbf0427af0d3e7e902" title="&lt;&lt;public&gt;&gt; Do a rpc with 2 parameters." alt="" coords="627,765,733,792"/><area shape="rect" id="node12" href="../../d2/d43/group__tcmi__rpc__class.html#ga2c40c9a03386d2f72490604ae5d938d4" title="&lt;&lt;public&gt;&gt; Do a rpc with 3 parameters." alt="" coords="627,1223,733,1249"/><area shape="rect" id="node17" href="../../db/d6c/group__tcmi__syscallhooks__class.html#ga919389ad6939b72a6e42950cb0472f3d" title="&lt;&lt;private&gt;&gt; sys_wait4 system call hook." alt="" coords="406,1607,543,1649"/><area shape="rect" id="node19" href="../../db/d6c/group__tcmi__syscallhooks__class.html#ga83a1e4217a65e4291ba10b3238b632b8" title="&lt;&lt;private&gt;&gt; pre&#45;fork" alt="" coords="406,1542,543,1583"/><area shape="rect" id="node21" href="../../db/d6c/group__tcmi__syscallhooks__class.html#ga8d308e4bffe9dabddb5b9ac3176d930b" title="&lt;&lt;private&gt;&gt; in&#45;fork..." alt="" coords="406,1738,543,1779"/><area shape="rect" id="node27" href="../../db/d6c/group__tcmi__syscallhooks__class.html#ga818119b8855fe4b6eea69b3b28d1648b" title="&lt;&lt;private&gt;&gt; post&#45;fork" alt="" coords="406,1673,543,1714"/><area shape="rect" id="node18" href="../../d2/d43/group__tcmi__rpc__class.html#ga32359a1145238628bc41373f5e5d513f" title="&lt;&lt;public&gt;&gt; Do a rpc with 4 parameters." alt="" coords="627,1472,733,1499"/><area shape="rect" id="node20" href="../../d2/d43/group__tcmi__rpc__class.html#ga847778f7c0cb8f2163f43fada7323c91" title="&lt;&lt;public&gt;&gt; Do a rpc with 4 parameters." alt="" coords="627,1367,733,1393"/><area shape="rect" id="node22" href="../../d6/de0/group__tcmi__man__class.html#ga34c83e593357e4cf14838d2fca19b9d2" title="&lt;&lt;public&gt;&gt; Method that performs task fork" alt="" coords="627,1745,733,1772"/><area shape="rect" id="node23" href="../../d6/da2/group__tcmi__migman__class.html#gacd13117046ccc1fa12ac743b893fcfca" title="&lt;&lt;public&gt;&gt; Instance accessor, increments the reference counter." alt="" coords="827,1669,952,1696"/><area shape="rect" id="node24" href="../../d6/da2/group__tcmi__migman__class.html#gab536c262c24d8fc76cdbdfa8d6d65b81" title="&lt;&lt;public&gt;&gt; The manager is shutdown exactly in this order:" alt="" coords="827,1720,952,1747"/><area shape="rect" id="node25" href="../../da/d0c/group__tcmi__slot__class.html#ga821f6b686443bfc7fff52dd3b155de37" title="&lt;&lt;public&gt;&gt; Slot index accessor." alt="" coords="833,1771,946,1797"/><area shape="rect" id="node26" href="../../d0/db7/group__tcmi__slotvec__class.html#ga876670f605631a5deb930412dae02b28" title="&lt;&lt;public&gt;&gt; Accesses a slot at a given index." alt="" coords="833,1821,945,1848"/><area shape="rect" id="node28" href="../../d5/d85/group__tcmi__guesttask__class.html#gaa439390162db6c39e89ece50c0119d61" title="&lt;&lt;public&gt;&gt; Called on post&#45;fork hook on guest task that was forked (parent)" alt="" coords="595,1687,765,1713"/><area shape="rect" id="node30" href="../../db/d78/group__proxyfs__server__class.html#gaeb977fa48d903588bc74d4dff9bc7de8" title="&lt;&lt;public&gt;&gt; &lt;&lt;exported&gt;&gt; Duplicates all file that were overtaken by a &quot;parent&quot; process and makes child..." alt="" coords="598,1570,762,1611"/><area shape="rect" id="node31" href="../../d8/d87/director_8c.html#a7bf207dc5e02c76577e38bae4ebadca8" title="Called, when a task forks." alt="" coords="617,1636,743,1663"/><area shape="rect" id="node29" href="../../de/d2f/group__tcmi__task__class.html#ga2f054ae4772c0921004eebdb48d39dcf" title="&lt;&lt;public&gt;&gt; Remote PID accessor." alt="" coords="814,1217,965,1244"/><area shape="rect" id="node33" href="../../d7/dc5/tcmi__syscallhooks__pidman_8c.html#a23b9ffb5a6059deca3ad667f433c921d" title="&lt;&lt;private&gt;&gt; Getppid system call hook" alt="" coords="406,170,543,211"/><area shape="rect" id="node34" href="../../d7/dc5/tcmi__syscallhooks__pidman_8c.html#ae372fc28e1c7211c51acb46bf93dcce4" title="&lt;&lt;private&gt;&gt; Getpid system call hook" alt="" coords="611,177,749,218"/><area shape="rect" id="node35" href="../../d7/dc5/tcmi__syscallhooks__pidman_8c.html#a703a698f18321aceaf4a24f124fa4bf9" title="&lt;&lt;private&gt;&gt; Getpgid system call hook" alt="" coords="406,105,543,146"/><area shape="rect" id="node36" href="../../d7/dc5/tcmi__syscallhooks__pidman_8c.html#a12c63764ccd0784964afc7f1e2152a82" title="&lt;&lt;private&gt;&gt; Setpgid system call hook" alt="" coords="406,366,543,407"/><area shape="rect" id="node37" href="../../d7/dc5/tcmi__syscallhooks__pidman_8c.html#a4606111985a9010556efd71a0b3a41ae" title="&lt;&lt;private&gt;&gt; Getsid system call hook" alt="" coords="406,39,543,81"/><area shape="rect" id="node38" href="../../d7/dc5/tcmi__syscallhooks__pidman_8c.html#a5b8408a45c68ae0af6fd0649cc912737" title="&lt;&lt;private&gt;&gt; Setsid system call hook" alt="" coords="406,235,543,277"/><area shape="rect" id="node39" href="../../d7/dc5/tcmi__syscallhooks__pidman_8c.html#a71bb94a9bce3b8b2bcd4794bc0fae342" title="&lt;&lt;private&gt;&gt; Getpgrp system call hook" alt="" coords="406,301,543,342"/><area shape="rect" id="node41" href="../../db/d6c/group__tcmi__syscallhooks__class.html#gabc5f26f1fc92e45829f3c23dc30439ac" title="&lt;&lt;private&gt;&gt; Kill system call hook." alt="" coords="406,1346,543,1387"/><area shape="rect" id="node42" href="../../db/d6c/group__tcmi__syscallhooks__class.html#ga0fd086d7662832ba7479a17248b548cd" title="&lt;&lt;private&gt;&gt; do_tkill hook." alt="" coords="406,1411,543,1453"/><area shape="rect" id="node43" href="../../db/d6c/group__tcmi__syscallhooks__class.html#gaf6e8e9ed1a9dbd61984fe4c82e6c4c97" title="&lt;&lt;private&gt;&gt; sys_rt_sigqueueinfo hook." alt="" coords="403,1477,547,1518"/><area shape="rect" id="node45" href="../../d9/df7/tcmi__syscallhooks__userident_8c.html#a29a4711c017be116de2c1aaa2ebbf019" title="&lt;&lt;private&gt;&gt; Getuid system call hook" alt="" coords="406,1085,543,1126"/><area shape="rect" id="node46" href="../../d9/df7/tcmi__syscallhooks__userident_8c.html#a9178af40befffea6c5b8d6137effefa4" title="&lt;&lt;private&gt;&gt; Setuid system call hook" alt="" coords="406,954,543,995"/><area shape="rect" id="node47" href="../../d9/df7/tcmi__syscallhooks__userident_8c.html#acb23940f503ac7eb3251bcf6e6b7f4da" title="&lt;&lt;private&gt;&gt; Getresuid system call hook (all pointers points to userspace)" alt="" coords="406,1215,543,1257"/><area shape="rect" id="node48" href="../../d9/df7/tcmi__syscallhooks__userident_8c.html#accefddcdb4b27be664994ea456006495" title="&lt;&lt;private&gt;&gt; Setresuid system call hook" alt="" coords="406,1281,543,1322"/><area shape="rect" id="node49" href="../../d9/df7/tcmi__syscallhooks__userident_8c.html#aec68de9f167da42c5764ef7e68d9bbf9" title="&lt;&lt;private&gt;&gt; Setreuid system call hook" alt="" coords="406,1150,543,1191"/><area shape="rect" id="node50" href="../../d9/df7/tcmi__syscallhooks__userident_8c.html#af04c69b2c8f941292e46eef854d1f696" title="&lt;&lt;private&gt;&gt; Geteuid system call hook" alt="" coords="406,1019,543,1061"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga818119b8855fe4b6eea69b3b28d1648b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static long tcmi_syscall_hooks_post_fork </td>
          <td>(</td>
          <td class="paramtype">struct task_struct *&#160;</td>
          <td class="paramname"><em>child</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pid_t&#160;</td>
          <td class="paramname"><em>remote_pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int __user *&#160;</td>
          <td class="paramname"><em>parent_tidptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int __user *&#160;</td>
          <td class="paramname"><em>child_tidptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; post-fork </p>

<p>Definition at line <a class="el" href="../../db/d35/tcmi__syscallhooks__other_8c_source.html#l00131">131</a> of file <a class="el" href="../../db/d35/tcmi__syscallhooks__other_8c_source.html">tcmi_syscallhooks_other.c</a>.</p>

<p>References <a class="el" href="../../d8/d87/director_8c_source.html#l00102">director_task_fork()</a>, <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d0/dc1/proxyfs__server_8c_source.html#l00472">proxyfs_server_duplicate_all_parent()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00146">tcmi_task::remote_pid</a>, <a class="el" href="../../da/d61/tcmi__guesttask_8c_source.html#l00358">tcmi_guesttask_post_fork()</a>, and <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00261">TCMI_TASK</a>.</p>

<p>Referenced by <a class="el" href="../../db/d35/tcmi__syscallhooks__other_8c_source.html#l00056">tcmi_syscall_hooks_other_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;{</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">if</span> ( current-&gt;tcmi.task_type == guest ) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="comment">// Guest task hook</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task" title="Compound structure that gathers necessary process information.">tcmi_task</a>* child_task = NULL;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordflow">if</span> ( IS_ERR((<span class="keywordtype">void</span>*)res) ) {         </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Resetting fork return values due to error&quot;</span>);   </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="keywordflow">if</span> ( parent_tidptr != NULL )</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                <span class="comment">//put_user((int)-1, parent_tidptr);</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="keywordflow">if</span> ( child_tidptr != NULL ) {               </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                <span class="comment">//put_user((int)-1, child_tidptr);</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            child_task = <a class="code" href="../../de/d2f/group__tcmi__task__class.html#gaf05e0c401db433deef4d95a64ce9117b" title="Casts to the task instance.">TCMI_TASK</a>(child-&gt;tcmi.tcmi_task);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <a class="code" href="../../d5/d85/group__tcmi__guesttask__class.html#gaa439390162db6c39e89ece50c0119d61" title="&lt;&lt;public&gt;&gt; Called on post-fork hook on guest task that was forked (parent)">tcmi_guesttask_post_fork</a>(<a class="code" href="../../de/d2f/group__tcmi__task__class.html#gaf05e0c401db433deef4d95a64ce9117b" title="Casts to the task instance.">TCMI_TASK</a>(current-&gt;tcmi.tcmi_task), child_task, res, <a class="code" href="../../de/d2f/group__tcmi__task__class.html#a071b7d4b1e2f24e055b643810a97570c" title="remote PID on PEN, CCN resp.">remote_pid</a>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../de/d2f/group__tcmi__task__class.html#a071b7d4b1e2f24e055b643810a97570c" title="remote PID on PEN, CCN resp.">remote_pid</a>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( current-&gt;tcmi.task_type == shadow ) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="comment">// Shadow task hook</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="comment">// We have to duplicate all proxyfs file references for child.. this way we are in a same situation as</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="comment">// if the fork happend on CCN before the migration</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordflow">if</span> (!IS_ERR((<span class="keywordtype">void</span>*)res) ) {         </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <a class="code" href="../../db/d78/group__proxyfs__server__class.html#gaeb977fa48d903588bc74d4dff9bc7de8" title="&lt;&lt;public&gt;&gt; &lt;&lt;exported&gt;&gt; Duplicates all file that were overtaken by a &quot;parent&quot; process and makes child...">proxyfs_server_duplicate_all_parent</a>(current, child);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="../../d8/d87/director_8c.html#a7bf207dc5e02c76577e38bae4ebadca8" title="Called, when a task forks.">director_task_fork</a>(res, current-&gt;pid);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;};</div>
</div><!-- fragment -->
<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../db/d6c/group__tcmi__syscallhooks__class_ga818119b8855fe4b6eea69b3b28d1648b_cgraph.png" border="0" usemap="#db/d6c/group__tcmi__syscallhooks__class_ga818119b8855fe4b6eea69b3b28d1648b_cgraph" alt=""/></div>
<map name="db/d6c/group__tcmi__syscallhooks__class_ga818119b8855fe4b6eea69b3b28d1648b_cgraph" id="db/d6c/group__tcmi__syscallhooks__class_ga818119b8855fe4b6eea69b3b28d1648b_cgraph">
<area shape="rect" id="node2" href="../../d8/d87/director_8c.html#a7bf207dc5e02c76577e38bae4ebadca8" title="Called, when a task forks." alt="" coords="215,227,340,253"/><area shape="rect" id="node13" href="../../db/d78/group__proxyfs__server__class.html#gaeb977fa48d903588bc74d4dff9bc7de8" title="&lt;&lt;public&gt;&gt; &lt;&lt;exported&gt;&gt; Duplicates all file that were overtaken by a &quot;parent&quot; process and makes child..." alt="" coords="195,411,359,453"/><area shape="rect" id="node24" href="../../d5/d85/group__tcmi__guesttask__class.html#gaa439390162db6c39e89ece50c0119d61" title="&lt;&lt;public&gt;&gt; Called on post&#45;fork hook on guest task that was forked (parent)" alt="" coords="192,736,363,763"/><area shape="rect" id="node3" href="../../d9/df4/comm_8c.html#a2f2d20d22eb367dbc69ecdbc8ac7576b" title="Returns 1 if, ppid is equal to userspace director pid." alt="" coords="468,176,575,203"/><area shape="rect" id="node4" href="../../d9/da5/task__forked__msg_8c.html#a4b02feb96711e70c189a1f14d7f90f90" title="Called, when a task forks." alt="" coords="477,227,566,253"/><area shape="rect" id="node5" href="../../d9/df4/comm_8c.html#af68cf85dec3fb86013cb79568bb30026" title="Performs a netlink transaction." alt="" coords="705,157,844,184"/><area shape="rect" id="node6" href="../../d9/df4/comm_8c.html#ab708cd00ae28bb68e7a53b6784f6f937" title="Helper method to create&amp;send request." alt="" coords="923,157,1091,184"/><area shape="rect" id="node10" href="../../d9/df4/comm_8c.html#a66ea56ce29053fb1d9ab6d337429652d" title="msg_transaction_response" alt="" coords="917,56,1096,83"/><area shape="rect" id="node7" href="../../d8/d7c/genl__ext_8c.html#ac461d0210fcfe8dde0588f23aebf9aab" title="genlmsg_unicast_tx &#45; wrapper around generic netlink unicast." alt="" coords="1180,107,1319,133"/><area shape="rect" id="node8" href="../../d9/df4/comm_8c.html#a4559dadd35469f8de48ab278303e40a0" title="Returns unique sequence number for transaction." alt="" coords="1193,157,1306,184"/><area shape="rect" id="node9" href="../../d9/df4/comm_8c.html#a5f190e32af9d5c630100bee151c00717" title="Returns pid of director process if there is user&#45;space director connected, 0 otherwise." alt="" coords="1175,208,1324,235"/><area shape="rect" id="node11" href="../../d9/df4/comm_8c.html#ae2479089f7107aec24a9c89a13101d0d" title="Checks, if the transaction returned an error." alt="" coords="1194,56,1305,83"/><area shape="rect" id="node12" href="../../d8/d7c/genl__ext_8c.html#a98fc505709c73b6933abbacd5a656cb9" title="Blocking read call that will read netlink response for the specified transaction." alt="" coords="1168,5,1331,32"/><area shape="rect" id="node14" href="../../d5/d89/proxyfs__real__file_8c.html#af4f58f4becfcea40b44a7b3ddbaca4e3" title="&lt;&lt;public&gt;&gt; Checks, whether shadow task is in list of shadow tasks of this file" alt="" coords="450,346,593,387"/><area shape="rect" id="node15" href="../../d1/d14/group__proxyfs__file__class.html#ga98106c38478a4df7b861052d341a0578" title="&lt;&lt;public&gt;&gt; Get file identifier" alt="" coords="1182,418,1317,459"/><area shape="rect" id="node16" href="../../d0/dc1/proxyfs__server_8c.html#ad2f261ff44b5b81d9dcd8e6a3ff317bf" title="proxyfs_server_duplicate\l_overtaken_file" alt="" coords="439,411,603,453"/><area shape="rect" id="node17" href="../../d5/d89/proxyfs__real__file_8c.html#aa8bee110603ba3a6715496c0d4387874" title="&lt;&lt;public&gt;&gt; Adds shadow task into a shadow list of the file" alt="" coords="703,411,846,453"/><area shape="rect" id="node18" href="../../da/d41/group__proxyfs__real__file__class.html#gad4ca43cdfe83775498c3c52ac5f7df18" title="&lt;&lt;public&gt;&gt; Deinitialize real_file" alt="" coords="692,309,857,336"/><area shape="rect" id="node22" href="../../d0/dc1/proxyfs__server_8c.html#ad4aa6f1a2c9ee37939e3cfc52f6c6cd8" title="proxyfs_server_register\l_poll_callback" alt="" coords="697,477,852,518"/><area shape="rect" id="node19" href="../../d1/d14/group__proxyfs__file__class.html#ga5bbed7e844f5afab2fbd943457de4bf6" title="&lt;&lt;public&gt;&gt; Deinitialize proxyfs_file struct" alt="" coords="938,259,1075,285"/><area shape="rect" id="node20" href="../../d4/d27/group__circ__buf__clas.html#ga36c9967179adece95b711ac84023b2a4" title="&lt;&lt;public&gt;&gt; Opossite function to circ_buf_init" alt="" coords="1191,259,1308,285"/><area shape="rect" id="node21" href="../../d3/d52/group__proxyfs__peer__class.html#ga0dc1598ce5116c8fe21c66b8b977ab4b" title="&lt;&lt;public&gt;&gt; Puts proxyfs_peer instance reference and on reaching zero destroys the instance..." alt="" coords="1189,309,1310,336"/><area shape="rect" id="node23" href="../../d0/dc1/proxyfs__server_8c.html#ab50c180af3b49b9044929be991b6e74d" title="&lt;&lt;private&gt;&gt; Method used for waiting on files, callback for poll structure" alt="" coords="941,447,1073,489"/><area shape="rect" id="node25" href="../../d4/d5a/group__tcmi__exit__procmsg__class.html#ga4d0e9afc9e69c4260b898e672262aa04" title="&lt;&gt;&gt; Exit message tx constructor." alt="" coords="431,812,611,839"/><area shape="rect" id="node31" href="../../de/d2f/group__tcmi__task__class.html#ga60a2a872664867b7a86ec278b570fef2" title="&lt;&lt;public&gt;&gt; Remote PID setter." alt="" coords="434,609,609,636"/><area shape="rect" id="node37" href="../../d1/dc2/group__tcmi__guest__started__procmsg__class.html#ga68c13e4eb03cdbc808140006bcb5a2f7" title="&lt;&lt;public&gt;&gt; Guest started process message tx constructor." alt="" coords="455,863,588,905"/><area shape="rect" id="node38" href="../../de/d2f/group__tcmi__task__class.html#ga2f054ae4772c0921004eebdb48d39dcf" title="&lt;&lt;public&gt;&gt; Remote PID accessor." alt="" coords="446,660,597,687"/><area shape="rect" id="node36" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="938,677,1075,704"/><area shape="rect" id="node39" href="../../de/d2f/group__tcmi__task__class.html#ga4e660ea948542a5a057e25640a762efc" title="&lt;&lt;public&gt;&gt; Sends a specified message." alt="" coords="411,761,631,788"/><area shape="rect" id="node46" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined..." alt="" coords="469,943,573,969"/><area shape="rect" id="node26" href="../../d7/dc8/group__tcmi__procmsg__class.html#gaa22b26ec117d20a804758f501e9d3e59" title="&lt;&lt;public&gt;&gt; Initializes the message for transferring." alt="" coords="701,855,848,881"/><area shape="rect" id="node27" href="../../d6/dc2/group__tcmi__msg__class.html#gace79df438ec4f7c8f7cee3bfe42f6d93" title="&lt;&lt;public&gt;&gt; Initializes the message for transferring." alt="" coords="946,855,1067,881"/><area shape="rect" id="node28" href="../../db/dc8/tcmi__msg_8c.html#a5c394462e393c496f11d949b265b8a9e" title="Shared initialization fuction of both rx and tx messages." alt="" coords="1175,956,1324,983"/><area shape="rect" id="node29" href="../../d4/d8c/group__tcmi__transaction__class.html#gada9d9436def8919a10997233cd6b5ea1" title="&lt;&lt;public&gt;&gt; Creates a new transaction." alt="" coords="1175,855,1323,881"/><area shape="rect" id="node30" href="../../d4/d8c/group__tcmi__transaction__class.html#gaac666feaaab1fe5c341237a3e0283501" title="&lt;&lt;public&gt;&gt; Transaction ID accessor." alt="" coords="1403,905,1538,932"/><area shape="rect" id="node32" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gac720ca77312808db7cbbc645be8e3541" title="&lt;&lt;public&gt;&gt; Creates a new instance of a file." alt="" coords="702,593,847,620"/><area shape="rect" id="node35" href="../../de/d2f/group__tcmi__task__class.html#ga401654abdc812f0a923d05c95b412fb1" title="tcmi_task_show_remote\l_pid_rev" alt="" coords="693,645,856,686"/><area shape="rect" id="node33" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gafcb50575d3f6cc783130766295300741" title="&lt;&lt;private&gt;&gt; This is a generic method, that creates a new instance of a file as follows:" alt="" coords="920,593,1093,620"/><area shape="rect" id="node34" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga532181c3f7224fe5aa7651a69e6ad6b4" title="&lt;&lt;public&gt;&gt; This method is used when initializing a new entry." alt="" coords="1180,593,1319,620"/><area shape="rect" id="node40" href="../../d6/dc2/group__tcmi__msg__class.html#ga7a8fe8cbfd4b25c15589c8599f66e574" title="&lt;&lt;public&gt;&gt; Sends a message via a specified connection." alt="" coords="681,761,869,788"/><area shape="rect" id="node41" href="../../d6/dc2/group__tcmi__msg__class.html#ga1c21eeafb9a0d56dabb025d5fbdc0bc3" title="&lt;&lt;private&gt;&gt; Sends a message via a specified connection." alt="" coords="949,753,1064,780"/><area shape="rect" id="node42" href="../../d6/d8e/group__kkc__sock__class.html#gad734b131e2ab00e8d7fa30737fc2f5ad" title="&lt;&lt;public&gt;&gt; Sends out specified data." alt="" coords="1193,703,1306,729"/><area shape="rect" id="node43" href="../../d6/d8e/group__kkc__sock__class.html#ga141590d302ece9990e5c8cdd82a3c3d8" title="&lt;&lt;public&gt;&gt; Locks this socket instance for sending, interruptible version, the process can be woken up..." alt="" coords="1144,753,1355,780"/><area shape="rect" id="node44" href="../../d6/d8e/group__kkc__sock__class.html#ga841d6dff84842f19540eae27c37fcb4c" title="&lt;&lt;public&gt;&gt; Unlocks this socket instance for sending." alt="" coords="1174,804,1325,831"/><area shape="rect" id="node45" href="../../d4/d8c/group__tcmi__transaction__class.html#ga653b1761a1b6e9fef415196c54e00768" title="&lt;&lt;public&gt;&gt; Starts a transaction." alt="" coords="1174,652,1325,679"/><area shape="rect" id="node47" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2748d267a8fddd1ced86e73ba8efd079" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="703,956,846,983"/><area shape="rect" id="node48" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="944,1007,1069,1033"/><area shape="rect" id="node49" href="../../da/d0c/group__tcmi__slot__class.html#ga1d6232adcf00094597a66d9f5740d5f8" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="945,905,1068,932"/><area shape="rect" id="node50" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="937,956,1076,983"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga83a1e4217a65e4291ba10b3238b632b8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static long tcmi_syscall_hooks_pre_fork </td>
          <td>(</td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>clone_flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>stack_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct pt_regs *&#160;</td>
          <td class="paramname"><em>regs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>stack_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int __user *&#160;</td>
          <td class="paramname"><em>parent_tidptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int __user *&#160;</td>
          <td class="paramname"><em>child_tidptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; pre-fork </p>

<p>Definition at line <a class="el" href="../../db/d35/tcmi__syscallhooks__other_8c_source.html#l00097">97</a> of file <a class="el" href="../../db/d35/tcmi__syscallhooks__other_8c_source.html">tcmi_syscallhooks_other.c</a>.</p>

<p>References <a class="el" href="../../dd/dda/tcmi__guest__rpc_8c_source.html#l00036">tcmi_guest_rpc</a>, <a class="el" href="../../d2/d3e/tcmi__rpc_8h_source.html#l00148">tcmi_rpc_call6()</a>, and <a class="el" href="../../da/db2/tcmi__rpc__numbers_8h_source.html#l00041">TCMI_RPC_SYS_FORK</a>.</p>

<p>Referenced by <a class="el" href="../../db/d35/tcmi__syscallhooks__other_8c_source.html#l00056">tcmi_syscall_hooks_other_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">// Pre-fork is hooked only on DN, on CN we fork normally</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">if</span> ( current-&gt;tcmi.task_type == guest ) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/group__tcmi__rpc__class.html#ga847778f7c0cb8f2163f43fada7323c91" title="&lt;&lt;public&gt;&gt; Do a rpc with 4 parameters.">tcmi_rpc_call6</a>(<a class="code" href="../../d0/d35/group__tcmi__guest__rpc__class.html#ga7ce4b3abbe1bd16852396a951c25a9ad" title="tcmi_guest_rpc class declaration">tcmi_guest_rpc</a>, <a class="code" href="../../da/db2/tcmi__rpc__numbers_8h.html#adfb05aefd829f98e67361d64d3a92b07">TCMI_RPC_SYS_FORK</a>, clone_flags, stack_start, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)regs, stack_size, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)parent_tidptr, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)child_tidptr);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;};</div>
</div><!-- fragment -->
<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../db/d6c/group__tcmi__syscallhooks__class_ga83a1e4217a65e4291ba10b3238b632b8_cgraph.png" border="0" usemap="#db/d6c/group__tcmi__syscallhooks__class_ga83a1e4217a65e4291ba10b3238b632b8_cgraph" alt=""/></div>
<map name="db/d6c/group__tcmi__syscallhooks__class_ga83a1e4217a65e4291ba10b3238b632b8_cgraph" id="db/d6c/group__tcmi__syscallhooks__class_ga83a1e4217a65e4291ba10b3238b632b8_cgraph">
<area shape="rect" id="node2" href="../../d2/d43/group__tcmi__rpc__class.html#ga847778f7c0cb8f2163f43fada7323c91" title="&lt;&lt;public&gt;&gt; Do a rpc with 4 parameters." alt="" coords="192,12,299,39"/><area shape="rect" id="node3" href="../../d2/d43/group__tcmi__rpc__class.html#ga3b19dd529d8c1bc18d24bca70107003f" title="&lt;&lt;public&gt;&gt; Universal procedure to do RPC" alt="" coords="347,12,440,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gabc5f26f1fc92e45829f3c23dc30439ac"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static long tcmi_syscall_hooks_sys_kill </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Kill system call hook. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pid</td><td>- PID of signal target </td></tr>
    <tr><td class="paramname">sig</td><td>- what signal</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- zero on sucess. </dd></dl>

<p>Definition at line <a class="el" href="../../d0/d64/tcmi__syscallhooks__signal_8c_source.html#l00080">80</a> of file <a class="el" href="../../d0/d64/tcmi__syscallhooks__signal_8c_source.html">tcmi_syscallhooks_signal.c</a>.</p>

<p>References <a class="el" href="../../dd/dda/tcmi__guest__rpc_8c_source.html#l00036">tcmi_guest_rpc</a>, <a class="el" href="../../d2/d3e/tcmi__rpc_8h_source.html#l00091">tcmi_rpc_call2()</a>, and <a class="el" href="../../da/db2/tcmi__rpc__numbers_8h_source.html#l00005">TCMI_RPC_SYS_KILL</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d64/tcmi__syscallhooks__signal_8c_source.html#l00046">tcmi_syscall_hooks_signal_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;{</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/group__tcmi__rpc__class.html#gac256a36ecc415dfbf0427af0d3e7e902" title="&lt;&lt;public&gt;&gt; Do a rpc with 2 parameters.">tcmi_rpc_call2</a>(<a class="code" href="../../d0/d35/group__tcmi__guest__rpc__class.html#ga7ce4b3abbe1bd16852396a951c25a9ad" title="tcmi_guest_rpc class declaration">tcmi_guest_rpc</a>, <a class="code" href="../../da/db2/tcmi__rpc__numbers_8h.html#a1db336d1629b9226d95399dedb873c00">TCMI_RPC_SYS_KILL</a>, <a class="code" href="../../d6/d23/tcmi__signal__msg_8h.html#ae0d46a978d5cd6707411f276ad869b9c" title="Target PID.">pid</a>, sig);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../db/d6c/group__tcmi__syscallhooks__class_gabc5f26f1fc92e45829f3c23dc30439ac_cgraph.png" border="0" usemap="#db/d6c/group__tcmi__syscallhooks__class_gabc5f26f1fc92e45829f3c23dc30439ac_cgraph" alt=""/></div>
<map name="db/d6c/group__tcmi__syscallhooks__class_gabc5f26f1fc92e45829f3c23dc30439ac_cgraph" id="db/d6c/group__tcmi__syscallhooks__class_gabc5f26f1fc92e45829f3c23dc30439ac_cgraph">
<area shape="rect" id="node2" href="../../d2/d43/group__tcmi__rpc__class.html#gac256a36ecc415dfbf0427af0d3e7e902" title="&lt;&lt;public&gt;&gt; Do a rpc with 2 parameters." alt="" coords="192,12,299,39"/><area shape="rect" id="node3" href="../../d2/d43/group__tcmi__rpc__class.html#ga3b19dd529d8c1bc18d24bca70107003f" title="&lt;&lt;public&gt;&gt; Universal procedure to do RPC" alt="" coords="347,12,440,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gaf6e8e9ed1a9dbd61984fe4c82e6c4c97"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static long tcmi_syscall_hooks_sys_rt_sigqueueinfo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">siginfo_t *&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; sys_rt_sigqueueinfo hook. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pid</td><td>- the PID of the thread </td></tr>
    <tr><td class="paramname">sig</td><td>- signal to be sent </td></tr>
    <tr><td class="paramname">*info</td><td>- pointer siginfo struct in kernel space</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- zero on sucess. </dd></dl>

<p>Definition at line <a class="el" href="../../d0/d64/tcmi__syscallhooks__signal_8c_source.html#l00109">109</a> of file <a class="el" href="../../d0/d64/tcmi__syscallhooks__signal_8c_source.html">tcmi_syscallhooks_signal.c</a>.</p>

<p>References <a class="el" href="../../dd/dda/tcmi__guest__rpc_8c_source.html#l00036">tcmi_guest_rpc</a>, <a class="el" href="../../d2/d3e/tcmi__rpc_8h_source.html#l00108">tcmi_rpc_call3()</a>, and <a class="el" href="../../da/db2/tcmi__rpc__numbers_8h_source.html#l00006">TCMI_RPC_SYS_SIGQUEUE</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d64/tcmi__syscallhooks__signal_8c_source.html#l00046">tcmi_syscall_hooks_signal_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;{</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/group__tcmi__rpc__class.html#ga2c40c9a03386d2f72490604ae5d938d4" title="&lt;&lt;public&gt;&gt; Do a rpc with 3 parameters.">tcmi_rpc_call3</a>(<a class="code" href="../../d0/d35/group__tcmi__guest__rpc__class.html#ga7ce4b3abbe1bd16852396a951c25a9ad" title="tcmi_guest_rpc class declaration">tcmi_guest_rpc</a>, <a class="code" href="../../da/db2/tcmi__rpc__numbers_8h.html#a751d2cae3a67fb2a218e0e01989d11a0">TCMI_RPC_SYS_SIGQUEUE</a>, <a class="code" href="../../d6/d23/tcmi__signal__msg_8h.html#ae0d46a978d5cd6707411f276ad869b9c" title="Target PID.">pid</a>, sig, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)<a class="code" href="../../d6/d23/tcmi__signal__msg_8h.html#a7d5c5f5b173fb960963b2c44980dc940" title="Siginfo structure (we can use directly this structure as it is padded to be exactly 128 bytes)...">info</a>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../db/d6c/group__tcmi__syscallhooks__class_gaf6e8e9ed1a9dbd61984fe4c82e6c4c97_cgraph.png" border="0" usemap="#db/d6c/group__tcmi__syscallhooks__class_gaf6e8e9ed1a9dbd61984fe4c82e6c4c97_cgraph" alt=""/></div>
<map name="db/d6c/group__tcmi__syscallhooks__class_gaf6e8e9ed1a9dbd61984fe4c82e6c4c97_cgraph" id="db/d6c/group__tcmi__syscallhooks__class_gaf6e8e9ed1a9dbd61984fe4c82e6c4c97_cgraph">
<area shape="rect" id="node2" href="../../d2/d43/group__tcmi__rpc__class.html#ga2c40c9a03386d2f72490604ae5d938d4" title="&lt;&lt;public&gt;&gt; Do a rpc with 3 parameters." alt="" coords="197,12,304,39"/><area shape="rect" id="node3" href="../../d2/d43/group__tcmi__rpc__class.html#ga3b19dd529d8c1bc18d24bca70107003f" title="&lt;&lt;public&gt;&gt; Universal procedure to do RPC" alt="" coords="352,12,445,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga919389ad6939b72a6e42950cb0472f3d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static long tcmi_syscall_hooks_sys_wait4 </td>
          <td>(</td>
          <td class="paramtype">pid_t&#160;</td>
          <td class="paramname"><em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int __user *&#160;</td>
          <td class="paramname"><em>stat_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct rusage __user *&#160;</td>
          <td class="paramname"><em>ru</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; sys_wait4 system call hook. </p>

<p>Definition at line <a class="el" href="../../db/d35/tcmi__syscallhooks__other_8c_source.html#l00089">89</a> of file <a class="el" href="../../db/d35/tcmi__syscallhooks__other_8c_source.html">tcmi_syscallhooks_other.c</a>.</p>

<p>References <a class="el" href="../../dd/dda/tcmi__guest__rpc_8c_source.html#l00036">tcmi_guest_rpc</a>, <a class="el" href="../../d2/d3e/tcmi__rpc_8h_source.html#l00127">tcmi_rpc_call4()</a>, and <a class="el" href="../../da/db2/tcmi__rpc__numbers_8h_source.html#l00038">TCMI_RPC_SYS_WAIT4</a>.</p>

<p>Referenced by <a class="el" href="../../db/d35/tcmi__syscallhooks__other_8c_source.html#l00056">tcmi_syscall_hooks_other_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                                                                                                                  {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d2/d43/group__tcmi__rpc__class.html#ga32359a1145238628bc41373f5e5d513f" title="&lt;&lt;public&gt;&gt; Do a rpc with 4 parameters.">tcmi_rpc_call4</a>(<a class="code" href="../../d0/d35/group__tcmi__guest__rpc__class.html#ga7ce4b3abbe1bd16852396a951c25a9ad" title="tcmi_guest_rpc class declaration">tcmi_guest_rpc</a>, <a class="code" href="../../da/db2/tcmi__rpc__numbers_8h.html#a8b00f0ae74ae046574f23b03b4ef54cd">TCMI_RPC_SYS_WAIT4</a>, <a class="code" href="../../d6/d23/tcmi__signal__msg_8h.html#ae0d46a978d5cd6707411f276ad869b9c" title="Target PID.">pid</a>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)stat_addr, options, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)ru);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;};</div>
</div><!-- fragment -->
<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../db/d6c/group__tcmi__syscallhooks__class_ga919389ad6939b72a6e42950cb0472f3d_cgraph.png" border="0" usemap="#db/d6c/group__tcmi__syscallhooks__class_ga919389ad6939b72a6e42950cb0472f3d_cgraph" alt=""/></div>
<map name="db/d6c/group__tcmi__syscallhooks__class_ga919389ad6939b72a6e42950cb0472f3d_cgraph" id="db/d6c/group__tcmi__syscallhooks__class_ga919389ad6939b72a6e42950cb0472f3d_cgraph">
<area shape="rect" id="node2" href="../../d2/d43/group__tcmi__rpc__class.html#ga32359a1145238628bc41373f5e5d513f" title="&lt;&lt;public&gt;&gt; Do a rpc with 4 parameters." alt="" coords="192,12,299,39"/><area shape="rect" id="node3" href="../../d2/d43/group__tcmi__rpc__class.html#ga3b19dd529d8c1bc18d24bca70107003f" title="&lt;&lt;public&gt;&gt; Universal procedure to do RPC" alt="" coords="347,12,440,39"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun May 12 2013 18:46:59 for Clondike by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
