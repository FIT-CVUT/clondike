<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Clondike: tcmi_taskhelper class</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Clondike
   </div>
   <div id="projectbrief">Supported Linux kernel 2.6.33.1</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d2/daf/group__tcmi__taskhelper__class.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">tcmi_taskhelper class<div class="ingroups"><a class="el" href="../../d3/d1d/group__tcmi__task__group.html">task component</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>This &lt;&lt;singleton&gt;&gt; class implements platform specific methods that make handling TCMI tasks easier.  
<a href="#details">More...</a></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for tcmi_taskhelper class:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<center><table><tr><td><img src="../../d2/daf/group__tcmi__taskhelper__class.png" border="0" alt="" usemap="#d2_2daf_2group____tcmi____taskhelper____class"/>
<map name="d2_2daf_2group____tcmi____taskhelper____class" id="d2_2daf_2group____tcmi____taskhelper____class">
<area shape="rect" id="node1" href="../../d3/d1d/group__tcmi__task__group.html" title="Classes in this group represent migrating processes in the system and related objects." alt="" coords="5,5,120,32"/></map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga41526f4b1eb09e8b8c00ca114d16bed9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga41526f4b1eb09e8b8c00ca114d16bed9">tcmi_taskhelper_run_mig_mode_handler</a> (void)</td></tr>
<tr class="memdesc:ga41526f4b1eb09e8b8c00ca114d16bed9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs migration mode handler of the current process.  <a href="#ga41526f4b1eb09e8b8c00ca114d16bed9">More...</a><br/></td></tr>
<tr class="separator:ga41526f4b1eb09e8b8c00ca114d16bed9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9dbb48f23b9ec6a00498db53f026ef4b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga9dbb48f23b9ec6a00498db53f026ef4b">tcmi_taskhelper_enter_mig_mode</a> (struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *t_task)</td></tr>
<tr class="memdesc:ga9dbb48f23b9ec6a00498db53f026ef4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Switches the task into migration mode.  <a href="#ga9dbb48f23b9ec6a00498db53f026ef4b">More...</a><br/></td></tr>
<tr class="separator:ga9dbb48f23b9ec6a00498db53f026ef4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7e75703a07c8cf6db170d2a5f06e464d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga7e75703a07c8cf6db170d2a5f06e464d">tcmi_taskhelper_enter_mig_mode_exclusive</a> (struct task_struct *l_task, struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *t_task)</td></tr>
<tr class="memdesc:ga7e75703a07c8cf6db170d2a5f06e464d"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Same as standard enter_mig_mode, but in this case we have already a reference to current task, so we do not perform any locking  <a href="#ga7e75703a07c8cf6db170d2a5f06e464d">More...</a><br/></td></tr>
<tr class="separator:ga7e75703a07c8cf6db170d2a5f06e464d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab89ca5c0deb987d20cf94fe2d000c58f"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daf/group__tcmi__taskhelper__class.html#gab89ca5c0deb987d20cf94fe2d000c58f">tcmi_taskhelper_find_by_pid</a> (pid_t <a class="el" href="../../d6/d23/tcmi__signal__msg_8h.html#ae0d46a978d5cd6707411f276ad869b9c">pid</a>)</td></tr>
<tr class="memdesc:gab89ca5c0deb987d20cf94fe2d000c58f"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Finds a TCMI task based on PID, in addition checks whether the task has a valid migration mode handler assigned.  <a href="#gab89ca5c0deb987d20cf94fe2d000c58f">More...</a><br/></td></tr>
<tr class="separator:gab89ca5c0deb987d20cf94fe2d000c58f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae8f5d2b311ca92e60b598076b578327d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daf/group__tcmi__taskhelper__class.html#gae8f5d2b311ca92e60b598076b578327d">tcmi_taskhelper_notify_by_pid</a> (pid_t <a class="el" href="../../d6/d23/tcmi__signal__msg_8h.html#ae0d46a978d5cd6707411f276ad869b9c">pid</a>, <a class="el" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#ga51adea36dbef7cb03ffb89f5821ef2e0">tcmi_method_t</a> *method, void *<a class="el" href="../../d9/d10/tcmi__npm__params_8h.html#ab9090ca30e7609aecaf540276e3c5084">data</a>, int <a class="el" href="../../d8/d08/tcmi__ppm__p__emigrate__msg_8h.html#af8fd9ce16b371c8a3bf5e0b37a69419f">size</a>, int priority)</td></tr>
<tr class="memdesc:gae8f5d2b311ca92e60b598076b578327d"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Submits a specified method to a TCMI task identified by PID.  <a href="#gae8f5d2b311ca92e60b598076b578327d">More...</a><br/></td></tr>
<tr class="separator:gae8f5d2b311ca92e60b598076b578327d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga80ea6618ba426419c51193f8fd24822d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga80ea6618ba426419c51193f8fd24822d">tcmi_taskhelper_wait_for_pick_up_timeout</a> (struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *t_task, unsigned long timeout)</td></tr>
<tr class="memdesc:ga80ea6618ba426419c51193f8fd24822d"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Synchronizes with a task entering the migration mode for the first time.  <a href="#ga80ea6618ba426419c51193f8fd24822d">More...</a><br/></td></tr>
<tr class="separator:ga80ea6618ba426419c51193f8fd24822d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga06e7d78c524d9f07c54eb78a41bad530"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga06e7d78c524d9f07c54eb78a41bad530">tcmi_taskhelper_do_signals</a> (struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *t_task)</td></tr>
<tr class="memdesc:ga06e7d78c524d9f07c54eb78a41bad530"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Checks if there are any pending signals and handles them.  <a href="#ga06e7d78c524d9f07c54eb78a41bad530">More...</a><br/></td></tr>
<tr class="separator:ga06e7d78c524d9f07c54eb78a41bad530"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0efd8c04f1e9c2bcd8ad0f2b8ff97c36"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga0efd8c04f1e9c2bcd8ad0f2b8ff97c36">tcmi_taskhelper_flush_signals</a> (struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *t_task)</td></tr>
<tr class="memdesc:ga0efd8c04f1e9c2bcd8ad0f2b8ff97c36"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Flushes all pending signals of the task.  <a href="#ga0efd8c04f1e9c2bcd8ad0f2b8ff97c36">More...</a><br/></td></tr>
<tr class="separator:ga0efd8c04f1e9c2bcd8ad0f2b8ff97c36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2791a4f05cb7d6c3aefd1dbc2b9c7cdb"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga2791a4f05cb7d6c3aefd1dbc2b9c7cdb">tcmi_taskhelper_attach</a> (struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *t_task, mig_mode_handler_t *mig_mode_handler)</td></tr>
<tr class="memdesc:ga2791a4f05cb7d6c3aefd1dbc2b9c7cdb"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Attaches the TCMI task to its kernel task.  <a href="#ga2791a4f05cb7d6c3aefd1dbc2b9c7cdb">More...</a><br/></td></tr>
<tr class="separator:ga2791a4f05cb7d6c3aefd1dbc2b9c7cdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga144340a93b3809129810c81bd308c637"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga144340a93b3809129810c81bd308c637">tcmi_taskhelper_attach_exclusive</a> (struct task_struct *l_task, struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *t_task, mig_mode_handler_t *mig_mode_handler)</td></tr>
<tr class="memdesc:ga144340a93b3809129810c81bd308c637"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Same as standard attach, but here we have a reference to a real task and we are exclusive owner of this reference and the task is not yet running =&gt; no locking required.  <a href="#ga144340a93b3809129810c81bd308c637">More...</a><br/></td></tr>
<tr class="separator:ga144340a93b3809129810c81bd308c637"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa2fb4cca9aa2b4bbcf606e149151b991"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daf/group__tcmi__taskhelper__class.html#gaa2fb4cca9aa2b4bbcf606e149151b991">__tcmi_taskhelper_detach</a> (struct task_struct *l_task)</td></tr>
<tr class="memdesc:gaa2fb4cca9aa2b4bbcf606e149151b991"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Dettaches the TCMI task from a specified process - lock free version.  <a href="#gaa2fb4cca9aa2b4bbcf606e149151b991">More...</a><br/></td></tr>
<tr class="separator:gaa2fb4cca9aa2b4bbcf606e149151b991"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3cc343e5d33a25284eca845d4d0abb9b"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga3cc343e5d33a25284eca845d4d0abb9b">tcmi_taskhelper_detach</a> (void)</td></tr>
<tr class="memdesc:ga3cc343e5d33a25284eca845d4d0abb9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Dettaches the TCMI task from its process The user specifies only kernel task, that is to be handled.  <a href="#ga3cc343e5d33a25284eca845d4d0abb9b">More...</a><br/></td></tr>
<tr class="separator:ga3cc343e5d33a25284eca845d4d0abb9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0ad756b4a70a9b058fdd020cf6f303c4"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga0ad756b4a70a9b058fdd020cf6f303c4">tcmi_taskhelper_detach_by_pid</a> (pid_t <a class="el" href="../../d6/d23/tcmi__signal__msg_8h.html#ae0d46a978d5cd6707411f276ad869b9c">pid</a>)</td></tr>
<tr class="memdesc:ga0ad756b4a70a9b058fdd020cf6f303c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Dettaches the TCMI task from its process.  <a href="#ga0ad756b4a70a9b058fdd020cf6f303c4">More...</a><br/></td></tr>
<tr class="separator:ga0ad756b4a70a9b058fdd020cf6f303c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae9732c6fadc0ba89ff2f6d04096438ea"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daf/group__tcmi__taskhelper__class.html#gae9732c6fadc0ba89ff2f6d04096438ea">tcmi_taskhelper_sanity_check</a> (void)</td></tr>
<tr class="memdesc:gae9732c6fadc0ba89ff2f6d04096438ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; This method is intended for migration mode handler, it should be the very first check it performs.  <a href="#gae9732c6fadc0ba89ff2f6d04096438ea">More...</a><br/></td></tr>
<tr class="separator:gae9732c6fadc0ba89ff2f6d04096438ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2420f9c7c246746d3bbc87578357338f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga2420f9c7c246746d3bbc87578357338f">tcmi_taskhelper_do_mig_mode</a> (struct pt_regs *regs)</td></tr>
<tr class="memdesc:ga2420f9c7c246746d3bbc87578357338f"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; This method is registered by CCN or PEN component as the SIGUNUSED signal handler.  <a href="#ga2420f9c7c246746d3bbc87578357338f">More...</a><br/></td></tr>
<tr class="separator:ga2420f9c7c246746d3bbc87578357338f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7421f53cc8c717b52a92daaac326f81d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga7421f53cc8c717b52a92daaac326f81d">tcmi_taskhelper_notify_current</a> (<a class="el" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#ga51adea36dbef7cb03ffb89f5821ef2e0">tcmi_method_t</a> *method, void *<a class="el" href="../../d9/d10/tcmi__npm__params_8h.html#ab9090ca30e7609aecaf540276e3c5084">data</a>, int <a class="el" href="../../d8/d08/tcmi__ppm__p__emigrate__msg_8h.html#af8fd9ce16b371c8a3bf5e0b37a69419f">size</a>, int priority)</td></tr>
<tr class="memdesc:ga7421f53cc8c717b52a92daaac326f81d"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; current process notification - submission of a method.  <a href="#ga7421f53cc8c717b52a92daaac326f81d">More...</a><br/></td></tr>
<tr class="separator:ga7421f53cc8c717b52a92daaac326f81d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6c7491a9027159fd5a293bae24689a3c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga6c7491a9027159fd5a293bae24689a3c">tcmi_taskhelper_checkpoint</a> (struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *t_task, struct <a class="el" href="../../d9/d10/tcmi__npm__params_8h.html#db/d53/structtcmi__npm__params">tcmi_npm_params</a> *npm_params)</td></tr>
<tr class="memdesc:ga6c7491a9027159fd5a293bae24689a3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Creates a new checkpoint of the process.  <a href="#ga6c7491a9027159fd5a293bae24689a3c">More...</a><br/></td></tr>
<tr class="separator:ga6c7491a9027159fd5a293bae24689a3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1ff741911c123bcd7eb94d193f3bdc59"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga1ff741911c123bcd7eb94d193f3bdc59">tcmi_taskhelper_restart</a> (struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *t_task, char *ckpt_name)</td></tr>
<tr class="memdesc:ga1ff741911c123bcd7eb94d193f3bdc59"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Schedules a task restart from a given checkpoint image.  <a href="#ga1ff741911c123bcd7eb94d193f3bdc59">More...</a><br/></td></tr>
<tr class="separator:ga1ff741911c123bcd7eb94d193f3bdc59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga403923e3422bd06870e36c8951def7fb"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga403923e3422bd06870e36c8951def7fb">tcmi_taskhelper_flushfiles</a> (void)</td></tr>
<tr class="memdesc:ga403923e3422bd06870e36c8951def7fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Flushing files is required prior to issuing a migrate request.  <a href="#ga403923e3422bd06870e36c8951def7fb">More...</a><br/></td></tr>
<tr class="separator:ga403923e3422bd06870e36c8951def7fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac1c217309f2f0c54aa2ee7802f31eab2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/daf/group__tcmi__taskhelper__class.html#gac1c217309f2f0c54aa2ee7802f31eab2">tcmi_taskhelper_catch_all_signals</a> (struct k_sigaction *<a class="el" href="../../d6/d15/tcmi__ckpt__sig_8h.html#a4cd2f0edc447fc0db91d4849cc334479">action</a>)</td></tr>
<tr class="memdesc:gac1c217309f2f0c54aa2ee7802f31eab2"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Set action for all signals accept SIGKILL and SIGSTOP  <a href="#gac1c217309f2f0c54aa2ee7802f31eab2">More...</a><br/></td></tr>
<tr class="separator:gac1c217309f2f0c54aa2ee7802f31eab2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>This &lt;&lt;singleton&gt;&gt; class implements platform specific methods that make handling TCMI tasks easier. </p>
<p>The functionality includes:</p>
<ul>
<li>method to switch a task into migration mode</li>
<li>method to submit a specific method to a TCMI task and have it process the method</li>
<li>synchronization with a task entering the migration mode for the</li>
<li>OS specific basic signal handling </li>
</ul>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gaa2fb4cca9aa2b4bbcf606e149151b991"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a>* __tcmi_taskhelper_detach </td>
          <td>(</td>
          <td class="paramtype">struct task_struct *&#160;</td>
          <td class="paramname"><em>l_task</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Dettaches the TCMI task from a specified process - lock free version. </p>
<p>This method is intended for internal use only. It resets all TCMI related data in the specified process and returns the TCMI task pointer. It is user responsibility to ensure proper locking.</p>
<dl class="section return"><dt>Returns</dt><dd>TCMI task that has been detached. </dd></dl>

<p>Definition at line <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00426">426</a> of file <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html">tcmi_taskhelper.h</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00451">tcmi_taskhelper_detach()</a>, and <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00475">tcmi_taskhelper_detach_by_pid()</a>.</p>
<div class="fragment"><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;{</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task" title="Compound structure that gathers necessary process information.">tcmi_task</a> *tmp;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    tmp = l_task-&gt;tcmi.tcmi_task;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    l_task-&gt;tcmi.tcmi_task = NULL;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    l_task-&gt;tcmi.mig_mode_handler = NULL;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">if</span> ( l_task-&gt;tcmi.task_type == shadow ) </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        l_task-&gt;tcmi.task_type = shadow_detached;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">return</span> tmp;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga2791a4f05cb7d6c3aefd1dbc2b9c7cdb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_taskhelper_attach </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td>
          <td class="paramname"><em>t_task</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mig_mode_handler_t *&#160;</td>
          <td class="paramname"><em>mig_mode_handler</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Attaches the TCMI task to its kernel task. </p>
<p>This requires:</p>
<ul>
<li>looking up the target thread (denoted by task's local PID)</li>
<li>checking if there has been assigned no handler/task assigned yet</li>
<li>storing the specified handler+task inside the kernel task(process)</li>
</ul>
<p>The target kernel task will have an extra reference to the task.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*t_task</td><td>- pointer to the TCMI task that is to be attached </td></tr>
    <tr><td class="paramname">*mig_mode_handler</td><td>- migration mode handler specific to the task. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon success. </dd></dl>

<p>Definition at line <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00339">339</a> of file <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html">tcmi_taskhelper.h</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d8/d3c/util_8h_source.html#l00007">task_find_by_pid()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00275">tcmi_task_get()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00624">tcmi_task_get_type()</a>, and <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00411">tcmi_task_local_pid()</a>.</p>

<p>Referenced by <a class="el" href="../../dc/d44/tcmi__migcom_8c_source.html#l00202">tcmi_migcom_emigrate_ccn_npm()</a>, <a class="el" href="../../dc/d44/tcmi__migcom_8c_source.html#l00151">tcmi_migcom_emigrate_ccn_ppm_p()</a>, and <a class="el" href="../../dc/d44/tcmi__migcom_8c_source.html#l00293">tcmi_migcom_immigrate()</a>.</p>
<div class="fragment"><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;{</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordtype">int</span> err = -EINVAL;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keyword">struct </span>task_struct *l_task;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">/* try finding the target process for our TCMI task by PID */</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    read_lock_irq(&amp;tasklist_lock);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">if</span> (!(l_task = <a class="code" href="../../d8/d3c/util_8h.html#a5f449355b8f54aaed664de85f89092ea">task_find_by_pid</a>(<a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor.">tcmi_task_local_pid</a>(t_task)))) {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;No such process %d&quot;</span>, <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor.">tcmi_task_local_pid</a>(t_task));</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        err = -ESRCH;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">/* synchronize with the migration mode handler that might run in paralle */</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    task_lock(l_task);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">if</span> (l_task-&gt;tcmi.mig_mode_handler || l_task-&gt;tcmi.tcmi_task) {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Kernel task %d already has a mig. mode handler - %p &quot;</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;             <span class="stringliteral">&quot;or TCMI task - %p assigned, bailing out&quot;</span>,</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;              <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor.">tcmi_task_local_pid</a>(t_task), l_task-&gt;tcmi.mig_mode_handler,</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;             l_task-&gt;tcmi.tcmi_task);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        task_unlock(l_task);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    l_task-&gt;tcmi.mig_mode_handler = mig_mode_handler;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">/* extra reference on TCMI task for the target process/its</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">     * migration component resp. */</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    l_task-&gt;tcmi.tcmi_task = <a class="code" href="../../de/d2f/group__tcmi__task__class.html#gafb7d2e6227e173c0bdc6fb99ff12bcbc" title="&lt;&lt;public&gt;&gt; Instance accessor, increments the reference counter.">tcmi_task_get</a>(t_task); </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    l_task-&gt;tcmi.task_type = <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga68c818baf665eed96e9e0b277c599d36" title="&lt;&lt;public&gt;&gt; Get task type">tcmi_task_get_type</a>(t_task);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    task_unlock(l_task);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    read_unlock_irq(&amp;tasklist_lock);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; exit0:</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    read_unlock_irq(&amp;tasklist_lock);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d2/daf/group__tcmi__taskhelper__class_ga2791a4f05cb7d6c3aefd1dbc2b9c7cdb_cgraph.png" border="0" usemap="#d2/daf/group__tcmi__taskhelper__class_ga2791a4f05cb7d6c3aefd1dbc2b9c7cdb_cgraph" alt=""/></div>
<map name="d2/daf/group__tcmi__taskhelper__class_ga2791a4f05cb7d6c3aefd1dbc2b9c7cdb_cgraph" id="d2/daf/group__tcmi__taskhelper__class_ga2791a4f05cb7d6c3aefd1dbc2b9c7cdb_cgraph">
<area shape="rect" id="node2" href="../../d8/d3c/util_8h.html#a5f449355b8f54aaed664de85f89092ea" title="task_find_by_pid" alt="" coords="221,5,339,32"/><area shape="rect" id="node3" href="../../de/d2f/group__tcmi__task__class.html#gafb7d2e6227e173c0bdc6fb99ff12bcbc" title="&lt;&lt;public&gt;&gt; Instance accessor, increments the reference counter." alt="" coords="228,56,332,83"/><area shape="rect" id="node4" href="../../de/d2f/group__tcmi__task__class.html#ga68c818baf665eed96e9e0b277c599d36" title="&lt;&lt;public&gt;&gt; Get task type" alt="" coords="212,107,348,133"/><area shape="rect" id="node5" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="211,157,349,184"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga144340a93b3809129810c81bd308c637"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_taskhelper_attach_exclusive </td>
          <td>(</td>
          <td class="paramtype">struct task_struct *&#160;</td>
          <td class="paramname"><em>l_task</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td>
          <td class="paramname"><em>t_task</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mig_mode_handler_t *&#160;</td>
          <td class="paramname"><em>mig_mode_handler</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Same as standard attach, but here we have a reference to a real task and we are exclusive owner of this reference and the task is not yet running =&gt; no locking required. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*l_task</td><td>- pointer to a kernel task struct, to which we are attaching </td></tr>
    <tr><td class="paramname">*t_task</td><td>- pointer to the TCMI task that is to be attached </td></tr>
    <tr><td class="paramname">*mig_mode_handler</td><td>- migration mode handler specific to the task. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon success. </dd></dl>

<p>Definition at line <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00391">391</a> of file <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html">tcmi_taskhelper.h</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00275">tcmi_task_get()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00624">tcmi_task_get_type()</a>, and <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00411">tcmi_task_local_pid()</a>.</p>

<p>Referenced by <a class="el" href="../../dc/d44/tcmi__migcom_8c_source.html#l00528">tcmi_migcom_guest_fork()</a>, and <a class="el" href="../../dc/d44/tcmi__migcom_8c_source.html#l00568">tcmi_migcom_shadow_fork()</a>.</p>
<div class="fragment"><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;{</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordtype">int</span> err = -EINVAL;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordflow">if</span> (l_task-&gt;tcmi.mig_mode_handler || l_task-&gt;tcmi.tcmi_task) {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Kernel task %d already has a mig. mode handler - %p &quot;</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;             <span class="stringliteral">&quot;or TCMI task - %p assigned, bailing out&quot;</span>,</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;              <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor.">tcmi_task_local_pid</a>(t_task), l_task-&gt;tcmi.mig_mode_handler,</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;             l_task-&gt;tcmi.tcmi_task);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    }</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    l_task-&gt;tcmi.mig_mode_handler = mig_mode_handler;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="comment">/* extra reference on TCMI task for the target process/its</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">     * migration component resp. */</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    l_task-&gt;tcmi.tcmi_task = <a class="code" href="../../de/d2f/group__tcmi__task__class.html#gafb7d2e6227e173c0bdc6fb99ff12bcbc" title="&lt;&lt;public&gt;&gt; Instance accessor, increments the reference counter.">tcmi_task_get</a>(t_task); </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    l_task-&gt;tcmi.task_type = <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga68c818baf665eed96e9e0b277c599d36" title="&lt;&lt;public&gt;&gt; Get task type">tcmi_task_get_type</a>(t_task);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; exit0:</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d2/daf/group__tcmi__taskhelper__class_ga144340a93b3809129810c81bd308c637_cgraph.png" border="0" usemap="#d2/daf/group__tcmi__taskhelper__class_ga144340a93b3809129810c81bd308c637_cgraph" alt=""/></div>
<map name="d2/daf/group__tcmi__taskhelper__class_ga144340a93b3809129810c81bd308c637_cgraph" id="d2/daf/group__tcmi__taskhelper__class_ga144340a93b3809129810c81bd308c637_cgraph">
<area shape="rect" id="node2" href="../../de/d2f/group__tcmi__task__class.html#gafb7d2e6227e173c0bdc6fb99ff12bcbc" title="&lt;&lt;public&gt;&gt; Instance accessor, increments the reference counter." alt="" coords="228,5,332,32"/><area shape="rect" id="node3" href="../../de/d2f/group__tcmi__task__class.html#ga68c818baf665eed96e9e0b277c599d36" title="&lt;&lt;public&gt;&gt; Get task type" alt="" coords="212,56,348,83"/><area shape="rect" id="node4" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="211,107,349,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gac1c217309f2f0c54aa2ee7802f31eab2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_taskhelper_catch_all_signals </td>
          <td>(</td>
          <td class="paramtype">struct k_sigaction *&#160;</td>
          <td class="paramname"><em>action</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Set action for all signals accept SIGKILL and SIGSTOP </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*action</td><td>- struct k_sigaction, which will be set to all signals </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00756">756</a> of file <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html">tcmi_taskhelper.h</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00205">tcmi_shadowtask_emigrate_p()</a>.</p>
<div class="fragment"><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;{</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="keywordflow">for</span>( i = 1; i &lt; _NSIG; i++ ){</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="keywordflow">if</span>( i != SIGKILL &amp;&amp; i != SIGSTOP )</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            do_sigaction( i, <a class="code" href="../../d6/d15/tcmi__ckpt__sig_8h.html#a4cd2f0edc447fc0db91d4849cc334479" title="Signal actions.">action</a>, NULL );</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    }</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga6c7491a9027159fd5a293bae24689a3c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_taskhelper_checkpoint </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td>
          <td class="paramname"><em>t_task</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d9/d10/tcmi__npm__params_8h.html#db/d53/structtcmi__npm__params">tcmi_npm_params</a> *&#160;</td>
          <td class="paramname"><em>npm_params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Creates a new checkpoint of the process. </p>
<p>It might be a good idea to delete the old checkpoint too. This method has to be called from the context of the process that is to be checkpointed.</p>
<ul>
<li>The checkpoint name is composed of the process name stored in current-&gt;comm pid and current value of jiffies. Once the checkpoint name is complete, it is stored in the task instance(so that it can be accessed later on).</li>
</ul>
<ul>
<li>a new checkpoint file is open(created)</li>
</ul>
<ul>
<li>file object along with task context is passed onto the checkpointing component.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*t_task</td><td>- pointer to the TCMI task that is to be checkpointed.  *npm_params - Pointer to non-preemtive migration params (or null in case of preemptive migration) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon success </dd></dl>

<p>Definition at line <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00620">620</a> of file <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html">tcmi_taskhelper.h</a>.</p>

<p>References <a class="el" href="../../d9/d10/tcmi__npm__params_8h_source.html#l00052">envp</a>, <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../db/d70/tcmi__ckptcom_8c_source.html#l00168">tcmi_ckptcom_checkpoint_npm()</a>, <a class="el" href="../../db/d70/tcmi__ckptcom_8c_source.html#l00163">tcmi_ckptcom_checkpoint_ppm()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00378">tcmi_task_context()</a>, and <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00755">tcmi_task_prepare_execve()</a>.</p>

<p>Referenced by <a class="el" href="../../da/d61/tcmi__guesttask_8c_source.html#l00149">tcmi_guesttask_migrateback_p()</a>, and <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00205">tcmi_shadowtask_emigrate_p()</a>.</p>
<div class="fragment"><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;{</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="comment">/* page for the filepathname */</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> page;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keywordtype">char</span> *pathname = NULL;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="keyword">struct </span>file *file;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordtype">char</span> *argv[] = { NULL };</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="../../d9/d10/tcmi__npm__params_8h.html#aeebc47a01a74a156c1843bcc37b2bd02">envp</a>[] = { NULL };</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="comment">/* resolve the path name. */</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordflow">if</span> (!(page = __get_free_page(GFP_ATOMIC))) {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Can&#39;t allocate page for file pathname!&quot;</span>);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    }</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    pathname = (<span class="keywordtype">char</span>*) page;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    snprintf(pathname, PAGE_SIZE, <span class="stringliteral">&quot;/home/clondike/%s.%d.%lu&quot;</span>, current-&gt;comm, </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;         current-&gt;pid, jiffies);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Composed checkpoint name: &#39;%s&#39; Npm params: %p&quot;</span>, pathname, npm_params);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="comment">/* setup execve arguments - this is just to store checkpoint name in the instance */</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga24a9d8c612da1a4484b1b3a28a181c15" title="&lt;&lt;public&gt;&gt; Prepares execution of a file given the arrays of arguments and environment.">tcmi_task_prepare_execve</a>(t_task, pathname, argv, envp) &lt; 0) {</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Failed preparing execve of the checkpoint &#39;%s&#39;&quot;</span>, pathname);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="keywordflow">goto</span> exit1;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    }</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="comment">/* Ask the checkpointing component for a checkpoint */</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    file = filp_open(pathname, </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;             O_CREAT | O_RDWR  | O_NOFOLLOW | O_LARGEFILE | O_TRUNC, 0700);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keywordflow">if</span> (IS_ERR(file)) {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Failed to create a checkpoint file for pid %d. Ckptname = &#39;%s&#39;. Error: %ld&quot;</span>, current-&gt;pid,</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;             pathname, PTR_ERR(file));</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <span class="keywordflow">goto</span> exit1;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    }</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="comment">/* create the checkpoint, task context contains pointer to process registers */</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keywordflow">if</span> ( npm_params ) {</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="comment">// Non-preemptive checkpoint</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/dcf/group__tcmi__ckptcom__class.html#gaf223b90f9bab6b4b553448917adbbd08" title="&lt;&lt;public&gt;&gt; Creates a non-preemptive process checkpoint.">tcmi_ckptcom_checkpoint_npm</a>(file, <a class="code" href="../../de/d2f/group__tcmi__task__class.html#gade1e8f7b12614ca0fecbc40aaae9a6c5" title="&lt;&lt;public&gt;&gt; Process context accessor.">tcmi_task_context</a>(t_task), npm_params) &lt; 0) {</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Failed npm checkpointing process PID %d ckptname = &#39;%s&#39;&quot;</span>, current-&gt;pid,</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            pathname);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            <span class="keywordflow">goto</span> exit2;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="comment">// Preemptive checkpoint</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/dcf/group__tcmi__ckptcom__class.html#ga87d900819b5cc6bbe1144e22d4e03836" title="&lt;&lt;public&gt;&gt; Creates a preemptive process checkpoint.">tcmi_ckptcom_checkpoint_ppm</a>(file, <a class="code" href="../../de/d2f/group__tcmi__task__class.html#gade1e8f7b12614ca0fecbc40aaae9a6c5" title="&lt;&lt;public&gt;&gt; Process context accessor.">tcmi_task_context</a>(t_task), 1) &lt; 0) {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Failed ppm checkpointing process PID %d ckptname = &#39;%s&#39;&quot;</span>, current-&gt;pid,</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            pathname);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            <span class="keywordflow">goto</span> exit2;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        }</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    filp_close(file, NULL); </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    free_page(page);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; exit2:</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    filp_close(file, NULL); </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; exit1:</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    free_page(page);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; exit0:</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d2/daf/group__tcmi__taskhelper__class_ga6c7491a9027159fd5a293bae24689a3c_cgraph.png" border="0" usemap="#d2/daf/group__tcmi__taskhelper__class_ga6c7491a9027159fd5a293bae24689a3c_cgraph" alt=""/></div>
<map name="d2/daf/group__tcmi__taskhelper__class_ga6c7491a9027159fd5a293bae24689a3c_cgraph" id="d2/daf/group__tcmi__taskhelper__class_ga6c7491a9027159fd5a293bae24689a3c_cgraph">
<area shape="rect" id="node2" href="../../d4/dcf/group__tcmi__ckptcom__class.html#gaf223b90f9bab6b4b553448917adbbd08" title="&lt;&lt;public&gt;&gt; Creates a non&#45;preemptive process checkpoint." alt="" coords="238,377,445,404"/><area shape="rect" id="node45" href="../../d4/dcf/group__tcmi__ckptcom__class.html#ga87d900819b5cc6bbe1144e22d4e03836" title="&lt;&lt;public&gt;&gt; Creates a preemptive process checkpoint." alt="" coords="238,428,445,455"/><area shape="rect" id="node46" href="../../de/d2f/group__tcmi__task__class.html#gade1e8f7b12614ca0fecbc40aaae9a6c5" title="&lt;&lt;public&gt;&gt; Process context accessor." alt="" coords="277,479,406,505"/><area shape="rect" id="node47" href="../../de/d2f/group__tcmi__task__class.html#ga24a9d8c612da1a4484b1b3a28a181c15" title="&lt;&lt;public&gt;&gt; Prepares execution of a file given the arrays of arguments and environment." alt="" coords="253,660,429,687"/><area shape="rect" id="node3" href="../../db/d70/tcmi__ckptcom_8c.html#ac319abd397f2a8d28b1e248939019385" title="&lt;&lt;private&gt;&gt; Helper method that handles both PPM and NPM checkpoint creation" alt="" coords="494,377,669,404"/><area shape="rect" id="node4" href="../../db/d06/tcmi__ckpt__fsstruct_8h.html#ad65f0acd5657cfc139569bd3a8a01bd4" title="Currently only current &quot;pwd&quot; of the process is migrated." alt="" coords="937,421,1066,462"/><area shape="rect" id="node7" href="../../d9/d57/group__tcmi__ckpt__mm__class.html#ga5cc088b9c94de359d62e62be57b79636" title="Writes a current process memory descriptor into the checkpoint file." alt="" coords="1154,483,1297,509"/><area shape="rect" id="node8" href="../../df/d54/group__tcmi__ckpt__class.html#gaa428792c45bff6d4c204a1888bc45bb2" title="&lt;&lt;public&gt;&gt; Checkpoint constructor." alt="" coords="739,5,848,32"/><area shape="rect" id="node10" href="../../dd/d4a/tcmi__ckpt__npm__params_8h.html#a0ae460251927e9177b1b60734cdaf5ed" title="Writes non&#45;preemptive process startup params to the checkpoint." alt="" coords="921,50,1082,91"/><area shape="rect" id="node11" href="../../df/d54/group__tcmi__ckpt__class.html#ga28018eb420ebe27ee907314d4c232241" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="741,244,845,271"/><area shape="rect" id="node13" href="../../de/d5f/tcmi__ckpt__regs_8h.html#afb361994d078435388619ea117d71ac0" title="Writes a current process registers into the checkpoint file." alt="" coords="721,323,866,349"/><area shape="rect" id="node16" href="../../d9/d57/group__tcmi__ckpt__mm__class.html#ga1ec03aa6289cb466c125b813455d9452" title="Writes a current process memory descriptor into the checkpoint file." alt="" coords="725,428,862,455"/><area shape="rect" id="node17" href="../../df/d07/tcmi__ckpt__thread_8h.html#a20e379cecfe566fc7fbf8cad15092e01" title="tcmi_ckpt_tls_write" alt="" coords="1158,217,1293,244"/><area shape="rect" id="node18" href="../../df/d54/group__tcmi__ckpt__class.html#ga8eb79d798591739f7234bae67265e097" title="&lt;&lt;public&gt;&gt; Writes open files into the checkpoint." alt="" coords="722,639,865,665"/><area shape="rect" id="node34" href="../../df/d54/group__tcmi__ckpt__class.html#gaecf1343fc1988bd210f6fc1ef349e256" title="&lt;&lt;public&gt;&gt; Writes a checkpoint header." alt="" coords="724,588,863,615"/><area shape="rect" id="node39" href="../../da/dab/tcmi__ckpt__resources_8h.html#a774918866032e6c1d6cccf240b145d9a" title="Writes a current process rlimits into the file." alt="" coords="719,537,867,564"/><area shape="rect" id="node40" href="../../df/d54/group__tcmi__ckpt__class.html#ga9d1cb4bfd021a3a845689a7262fe8190" title="&lt;&lt;public&gt;&gt; Writes all process memory regions into the checkpoint." alt="" coords="718,116,869,143"/><area shape="rect" id="node5" href="../../df/d54/group__tcmi__ckpt__class.html#gab3d478dd860126047413a05828c02360" title="&lt;&lt;public&gt;&gt; Writes a specified number of bytes into a checkpoint file." alt="" coords="1401,428,1514,455"/><area shape="rect" id="node6" href="../../df/d54/group__tcmi__ckpt__class.html#ga6b8d00619b038e49b552f87cea4a8129" title="&lt;&lt;private&gt;&gt; Executes a specified VFS method on the checkpoint file." alt="" coords="1613,428,1758,455"/><area shape="rect" id="node9" href="../../df/d54/group__tcmi__ckpt__class.html#ga6128870e21ea3aef1bf88d8e34e4cd48" title="&lt;&lt;public&gt;&gt; Seeks in the checkpoint file based on specified offset." alt="" coords="1400,7,1515,33"/><area shape="rect" id="node12" href="../../dd/d41/group__tcmi__fdcache__class.html#gad776fac5f8cecca0aabdad2bf31fc126" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="939,217,1063,244"/><area shape="rect" id="node14" href="../../d9/dc7/common_2regs_8h.html#ad2a5c3156d56f8aa440bd552d4bfec52" title="Dumps debug information about current platform registers." alt="" coords="944,369,1059,396"/><area shape="rect" id="node15" href="../../d9/dc7/common_2regs_8h.html#a79e9bcae0391a65adab144409a081a4c" title="Loads value of pt_regs into the current architecture type specific regs." alt="" coords="953,319,1050,345"/><area shape="rect" id="node19" href="../../d6/d9c/group__tcmi__ckpt__openfile__class.html#ga1ea75bd539338fdc841bcf97c1a32bef" title="&lt;&lt;public&gt;&gt; Writes an open file information into the checkpoint file." alt="" coords="936,790,1067,831"/><area shape="rect" id="node20" href="../../df/d54/group__tcmi__ckpt__class.html#ga5847c258ee160509359de5f5c27a2c33" title="&lt;&lt;public&gt;&gt; Searches the file descriptor cache for a file." alt="" coords="1137,923,1313,949"/><area shape="rect" id="node22" href="../../d6/d9c/group__tcmi__ckpt__openfile__class.html#gafe70b47b94f4f0cccf013f758d89f046" title="&lt;&lt;private&gt;&gt; Writes a duplicate file descriptor chunk into the checkpoint file." alt="" coords="1160,757,1291,798"/><area shape="rect" id="node23" href="../../d6/d9c/group__tcmi__ckpt__openfile__class.html#gabe85fffb1a72d2cf11ccde5f557ec3b6" title="&lt;&lt;private&gt;&gt; Writes a new file chunk into the checkpoint file." alt="" coords="1160,822,1291,863"/><area shape="rect" id="node21" href="../../dd/d41/group__tcmi__fdcache__class.html#ga09e6e85f776f3e0a1dc672b1f5c7979c" title="&lt;&lt;public&gt;&gt; Searches the file descriptor cache for a file." alt="" coords="1385,956,1529,983"/><area shape="rect" id="node24" href="../../d5/d77/proxyfs__helper_8h.html#ae73c5991f03548d8f100d7200d80113e" title="Creates a name of a proxy file." alt="" coords="1384,855,1531,881"/><area shape="rect" id="node25" href="../../d5/d77/proxyfs__helper_8h.html#a25be89ac94beb85ee51564c78d4031d7" title="Returns true, if the path points to a dev null file." alt="" coords="1415,905,1500,932"/><area shape="rect" id="node26" href="../../d5/d77/proxyfs__helper_8h.html#a074be037b0aae4d248a61c90c2c68737" title="Checks, whether the file is proxyfs file." alt="" coords="1405,703,1509,729"/><area shape="rect" id="node27" href="../../db/d78/group__proxyfs__server__class.html#ga0cf24b2ce6d39d211a219c3e0f53ff41" title="&lt;&lt;public&gt;&gt; &lt;&lt;exported&gt;&gt; Make file available trought proxyfs" alt="" coords="1366,753,1549,780"/><area shape="rect" id="node33" href="../../df/d54/group__tcmi__ckpt__class.html#ga59be6dd10ef81e4812417bfe0dd5f4c5" title="&lt;&lt;public&gt;&gt; Adds a file descriptor &#45; file object pair into the fd cache." alt="" coords="1378,804,1537,831"/><area shape="rect" id="node28" href="../../de/d0d/group__proxyfs__tty__real__file__class.html#gaa072b8ffc0485563a02cd199ea44202d" title="&lt;&lt;public&gt;&gt; tty_real_file constructor" alt="" coords="1602,703,1769,729"/><area shape="rect" id="node29" href="../../d2/dc8/group__proxyfs__pipe__real__file__class.html#gab01c9a2a21e46a82db7716411b088cae" title="&lt;&lt;public&gt;&gt; pipe_real_file construktor" alt="" coords="1597,753,1773,780"/><area shape="rect" id="node31" href="../../d5/d89/proxyfs__real__file_8c.html#aa8bee110603ba3a6715496c0d4387874" title="&lt;&lt;public&gt;&gt; Adds shadow task into a shadow list of the file" alt="" coords="1614,805,1757,846"/><area shape="rect" id="node32" href="../../d0/dc1/proxyfs__server_8c.html#ad4aa6f1a2c9ee37939e3cfc52f6c6cd8" title="proxyfs_server_register\l_poll_callback" alt="" coords="1608,870,1763,911"/><area shape="rect" id="node30" href="../../da/d41/group__proxyfs__real__file__class.html#gad4ca43cdfe83775498c3c52ac5f7df18" title="&lt;&lt;public&gt;&gt; Deinitialize real_file" alt="" coords="1821,703,1987,729"/><area shape="rect" id="node35" href="../../df/d54/group__tcmi__ckpt__class.html#gacea45b22c76a0bff6422d8d4e3731925" title="&lt;&lt;private&gt;&gt; Calculates the number of memory regions of the current process." alt="" coords="926,701,1077,728"/><area shape="rect" id="node37" href="../../df/d54/group__tcmi__ckpt__class.html#gac1c519443be61f5923b9f6cc8fe92d1e" title="&lt;&lt;private&gt;&gt; Calculates the number of open files of the current process." alt="" coords="931,647,1072,673"/><area shape="rect" id="node36" href="../../d4/d2b/tcmi__npm__params_8c.html#acc026454809c9e854f4ce3e7aec89377" title="count" alt="" coords="1198,705,1253,732"/><area shape="rect" id="node38" href="../../d6/d9c/group__tcmi__ckpt__openfile__class.html#ga733163f46fde5d5e4502bf35fe4f8a4d" title="&lt;&lt;public&gt;&gt; Class method &#45; checks if the specified file(represented by its inode) is supported by chec..." alt="" coords="1160,639,1291,681"/><area shape="rect" id="node41" href="../../d3/dad/group__tcmi__ckpt__vm__area__class.html#ga2da52b7d6a4fc42437ad12d18b7806e5" title="&lt;&lt;public&gt;&gt; Writes a specified memory area into the checkpoint file." alt="" coords="917,116,1085,143"/><area shape="rect" id="node42" href="../../d3/dad/group__tcmi__ckpt__vm__area__class.html#ga1bf3e24cdf83c3d7506e8eb8c2cea4d5" title="&lt;&lt;private&gt;&gt; Writes a specified memory area into the checkpoint file &#45; light version." alt="" coords="1136,167,1315,193"/><area shape="rect" id="node43" href="../../d3/dad/group__tcmi__ckpt__vm__area__class.html#gadb0972a6f0e422425746f27d4411c3f6" title="&lt;&lt;private&gt;&gt; Writes a specified memory area into the checkpoint file &#45; heavy version." alt="" coords="1134,65,1317,92"/><area shape="rect" id="node44" href="../../df/d54/group__tcmi__ckpt__class.html#gac5d7b45cd57fdd09ac83ce079260ec7e" title="&lt;&lt;public&gt;&gt; Aligns the position in the checkpoint file to page boundary." alt="" coords="1383,65,1531,92"/><area shape="rect" id="node48" href="../../de/d2f/group__tcmi__task__class.html#gad41453e0aefb9dd79c2d3b65d8b9b16c" title="&lt;&lt;private&gt;&gt; Releases the execve context (execve file, argv, envp) Since the argv/envp have alloca..." alt="" coords="494,682,669,723"/><area shape="rect" id="node50" href="../../de/d84/tcmi__task_8c.html#ab73603e4adaf2a1bb6b7cf6a01a1c2f3" title="&lt;&lt;private&gt;&gt; Class method &#45; copies an array of strings terminated by NULL string (standard argv/envp f..." alt="" coords="501,748,661,775"/><area shape="rect" id="node49" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="725,689,862,716"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga3cc343e5d33a25284eca845d4d0abb9b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a>* tcmi_taskhelper_detach </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Dettaches the TCMI task from its process The user specifies only kernel task, that is to be handled. </p>
<p>This method is typically used from migration mode handler -</p>
<p>Dettaching the task includes also resetting the migration mode handler to NULL. This work is delegated to <a class="el" href="../../d2/daf/group__tcmi__taskhelper__class.html#gaa2fb4cca9aa2b4bbcf606e149151b991" title="&lt;&lt;private&gt;&gt; Dettaches the TCMI task from a specified process - lock free version.">__tcmi_taskhelper_detach()</a>.</p>
<dl class="section return"><dt>Returns</dt><dd>TCMI task that has been detached. </dd></dl>

<p>Definition at line <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00451">451</a> of file <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html">tcmi_taskhelper.h</a>.</p>

<p>References <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00426">__tcmi_taskhelper_detach()</a>.</p>

<p>Referenced by <a class="el" href="../../dc/d44/tcmi__migcom_8c_source.html#l00620">tcmi_migcom_mig_mode_handler()</a>.</p>
<div class="fragment"><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;{</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task" title="Compound structure that gathers necessary process information.">tcmi_task</a> *tmp;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    read_lock_irq(&amp;tasklist_lock);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    task_lock(current);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    tmp = <a class="code" href="../../d2/daf/group__tcmi__taskhelper__class.html#gaa2fb4cca9aa2b4bbcf606e149151b991" title="&lt;&lt;private&gt;&gt; Dettaches the TCMI task from a specified process - lock free version.">__tcmi_taskhelper_detach</a>(current);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    task_unlock(current);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    read_unlock_irq(&amp;tasklist_lock);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">return</span> tmp;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d2/daf/group__tcmi__taskhelper__class_ga3cc343e5d33a25284eca845d4d0abb9b_cgraph.png" border="0" usemap="#d2/daf/group__tcmi__taskhelper__class_ga3cc343e5d33a25284eca845d4d0abb9b_cgraph" alt=""/></div>
<map name="d2/daf/group__tcmi__taskhelper__class_ga3cc343e5d33a25284eca845d4d0abb9b_cgraph" id="d2/daf/group__tcmi__taskhelper__class_ga3cc343e5d33a25284eca845d4d0abb9b_cgraph">
<area shape="rect" id="node2" href="../../d2/daf/group__tcmi__taskhelper__class.html#gaa2fb4cca9aa2b4bbcf606e149151b991" title="&lt;&lt;private&gt;&gt; Dettaches the TCMI task from a specified process &#45; lock free version." alt="" coords="214,5,389,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga0ad756b4a70a9b058fdd020cf6f303c4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a>* tcmi_taskhelper_detach_by_pid </td>
          <td>(</td>
          <td class="paramtype">pid_t&#160;</td>
          <td class="paramname"><em>pid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Dettaches the TCMI task from its process. </p>
<p>The process is looked up based on PID and the task is removed from the task_struct.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pid</td><td>- PID of the process whose TCMI task is to be detached </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TCMI task that has been detached. </dd></dl>

<p>Definition at line <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00475">475</a> of file <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html">tcmi_taskhelper.h</a>.</p>

<p>References <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00426">__tcmi_taskhelper_detach()</a>, <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, and <a class="el" href="../../d8/d3c/util_8h_source.html#l00007">task_find_by_pid()</a>.</p>
<div class="fragment"><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;{</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keyword">struct </span>task_struct *l_task;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task" title="Compound structure that gathers necessary process information.">tcmi_task</a> *t_task;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="comment">/* try finding the process by PID */</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    read_lock_irq(&amp;tasklist_lock);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">if</span> (!(l_task = <a class="code" href="../../d8/d3c/util_8h.html#a5f449355b8f54aaed664de85f89092ea">task_find_by_pid</a>(<a class="code" href="../../d6/d23/tcmi__signal__msg_8h.html#ae0d46a978d5cd6707411f276ad869b9c" title="Target PID.">pid</a>))) {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Can&#39;t notify, no such process %d&quot;</span>, <a class="code" href="../../d6/d23/tcmi__signal__msg_8h.html#ae0d46a978d5cd6707411f276ad869b9c" title="Target PID.">pid</a>);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    }</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    task_lock(l_task);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    t_task = <a class="code" href="../../d2/daf/group__tcmi__taskhelper__class.html#gaa2fb4cca9aa2b4bbcf606e149151b991" title="&lt;&lt;private&gt;&gt; Dettaches the TCMI task from a specified process - lock free version.">__tcmi_taskhelper_detach</a>(l_task);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    task_unlock(l_task);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    read_unlock_irq(&amp;tasklist_lock);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">return</span> t_task;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; exit0:</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    read_unlock_irq(&amp;tasklist_lock);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d2/daf/group__tcmi__taskhelper__class_ga0ad756b4a70a9b058fdd020cf6f303c4_cgraph.png" border="0" usemap="#d2/daf/group__tcmi__taskhelper__class_ga0ad756b4a70a9b058fdd020cf6f303c4_cgraph" alt=""/></div>
<map name="d2/daf/group__tcmi__taskhelper__class_ga0ad756b4a70a9b058fdd020cf6f303c4_cgraph" id="d2/daf/group__tcmi__taskhelper__class_ga0ad756b4a70a9b058fdd020cf6f303c4_cgraph">
<area shape="rect" id="node2" href="../../d2/daf/group__tcmi__taskhelper__class.html#gaa2fb4cca9aa2b4bbcf606e149151b991" title="&lt;&lt;private&gt;&gt; Dettaches the TCMI task from a specified process &#45; lock free version." alt="" coords="214,5,389,32"/><area shape="rect" id="node3" href="../../d8/d3c/util_8h.html#a5f449355b8f54aaed664de85f89092ea" title="task_find_by_pid" alt="" coords="242,56,361,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga2420f9c7c246746d3bbc87578357338f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_taskhelper_do_mig_mode </td>
          <td>(</td>
          <td class="paramtype">struct pt_regs *&#160;</td>
          <td class="paramname"><em>regs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; This method is registered by CCN or PEN component as the SIGUNUSED signal handler. </p>
<p>It is responsible for storing the current process user mode context into the shadow/guest task resp.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*regs</td><td>- the current process context (registers) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00547">547</a> of file <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html">tcmi_taskhelper.h</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, and <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00389">tcmi_task_set_context()</a>.</p>

<p>Referenced by <a class="el" href="../../dc/d44/tcmi__migcom_8c_source.html#l00202">tcmi_migcom_emigrate_ccn_npm()</a>, <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html#l00171">tcmi_mighooks_mig_mode()</a>, <a class="el" href="../../d9/d86/tcmi__penman_8c_source.html#l00253">tcmi_penman_migrateback_npm()</a>, and <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00574">tcmi_taskhelper_notify_current()</a>.</p>
<div class="fragment"><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;{</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keywordflow">if</span> (current-&gt;tcmi.mig_mode_handler &amp;&amp; current-&gt;tcmi.tcmi_task) {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Migration mode active for %p &#39;%s&#39;&quot;</span>, current, current-&gt;comm);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <a class="code" href="../../de/d2f/group__tcmi__task__class.html#gabc853647b7b732333c5909e617030f44" title="&lt;&lt;public&gt;&gt; Process context setter.">tcmi_task_set_context</a>(current-&gt;tcmi.tcmi_task, regs);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        current-&gt;tcmi.mig_mode_handler();</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    }</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d2/daf/group__tcmi__taskhelper__class_ga2420f9c7c246746d3bbc87578357338f_cgraph.png" border="0" usemap="#d2/daf/group__tcmi__taskhelper__class_ga2420f9c7c246746d3bbc87578357338f_cgraph" alt=""/></div>
<map name="d2/daf/group__tcmi__taskhelper__class_ga2420f9c7c246746d3bbc87578357338f_cgraph" id="d2/daf/group__tcmi__taskhelper__class_ga2420f9c7c246746d3bbc87578357338f_cgraph">
<area shape="rect" id="node2" href="../../de/d2f/group__tcmi__task__class.html#gabc853647b7b732333c5909e617030f44" title="&lt;&lt;public&gt;&gt; Process context setter." alt="" coords="189,12,344,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga06e7d78c524d9f07c54eb78a41bad530"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_taskhelper_do_signals </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td>
          <td class="paramname"><em>t_task</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Checks if there are any pending signals and handles them. </p>
<p>For each pending signal, the task is requested to process it as long as the signal is not SIGUNUSED - which indicates an attempt to switch to migration mode, eventhough we are already in migration mode. This signal is ignored.</p>
<p>We keep processing the signals as long as there are any pending left and the task method returns TCMI_TASK_KEEP_PUMPING.</p>
<p>The result of the last call of the task method is communicated back.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*t_task</td><td>- pointer to this task instance </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>result of the task specific signal handling method or TCMI_TASK_KEEP_PUMPING </dd></dl>

<p>Definition at line <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00282">282</a> of file <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html">tcmi_taskhelper.h</a>.</p>

<p>References <a class="el" href="../../d6/d23/tcmi__signal__msg_8h_source.html#l00071">info</a>, <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00599">tcmi_task_do_signal()</a>, and <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00252">TCMI_TASK_KEEP_PUMPING</a>.</p>

<p>Referenced by <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00346">tcmi_task_process_methods()</a>.</p>
<div class="fragment"><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;{</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordtype">int</span> res = <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ggaa81f1a7178bfcf01d74e57d6bbcb869bafa7c813a4364ccccdc1edfd29839c675">TCMI_TASK_KEEP_PUMPING</a>;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    siginfo_t <a class="code" href="../../d6/d23/tcmi__signal__msg_8h.html#a7d5c5f5b173fb960963b2c44980dc940" title="Siginfo structure (we can use directly this structure as it is padded to be exactly 128 bytes)...">info</a>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> signr = 0;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    sigset_t *mask = &amp;current-&gt;blocked;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO2, <span class="stringliteral">&quot;Do signals being processed.&quot;</span>);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">/* check pending signal */</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">if</span> (signal_pending(current)) {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO2, <span class="stringliteral">&quot;Has signal pending&quot;</span>);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="comment">/* for all signals */</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">while</span> (res == <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ggaa81f1a7178bfcf01d74e57d6bbcb869bafa7c813a4364ccccdc1edfd29839c675">TCMI_TASK_KEEP_PUMPING</a>) {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <span class="comment">/* dequeue signal */</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            spin_lock_irq(&amp;current-&gt;sighand-&gt;siglock);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            signr = dequeue_signal(current, mask, &amp;info);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            spin_unlock_irq(&amp;current-&gt;sighand-&gt;siglock);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="comment">/* no more signals in queue */</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="keywordflow">if</span> (!signr)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO2, <span class="stringliteral">&quot;Dequeued signal number: %lu..&quot;</span>, signr);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="keywordflow">if</span> (signr != SIGUNUSED)</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                res = <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga1d63cea88da4ef266e6c191720c2f2fb" title="&lt;&lt;public&gt;&gt; Processes a specified signal.">tcmi_task_do_signal</a>(t_task, signr, &amp;info);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO2, <span class="stringliteral">&quot;Signal handling finished. Result: %d&quot;</span>, res);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d2/daf/group__tcmi__taskhelper__class_ga06e7d78c524d9f07c54eb78a41bad530_cgraph.png" border="0" usemap="#d2/daf/group__tcmi__taskhelper__class_ga06e7d78c524d9f07c54eb78a41bad530_cgraph" alt=""/></div>
<map name="d2/daf/group__tcmi__taskhelper__class_ga06e7d78c524d9f07c54eb78a41bad530_cgraph" id="d2/daf/group__tcmi__taskhelper__class_ga06e7d78c524d9f07c54eb78a41bad530_cgraph">
<area shape="rect" id="node2" href="../../de/d2f/group__tcmi__task__class.html#ga1d63cea88da4ef266e6c191720c2f2fb" title="&lt;&lt;public&gt;&gt; Processes a specified signal." alt="" coords="189,12,331,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga9dbb48f23b9ec6a00498db53f026ef4b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_taskhelper_enter_mig_mode </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td>
          <td class="paramname"><em>t_task</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Switches the task into migration mode. </p>
<p>It is necessary to lookup the regular kernel process that the TCMI task is attached to and enforce its migration mode. Essentially, it sends SIG_UNUSED signal to the process. The signal handler hook(see <a class="el" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga2420f9c7c246746d3bbc87578357338f" title="&lt;&lt;public&gt;&gt; This method is registered by CCN or PEN component as the SIGUNUSED signal handler...">tcmi_taskhelper_do_mig_mode()</a>) takes care of running the migration mode handler.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*t_task</td><td>- pointer to the TCMI task that is to be preempted into migration mode </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00092">92</a> of file <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html">tcmi_taskhelper.h</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00221">minfo</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00411">tcmi_task_local_pid()</a>, and <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00542">tcmi_task_to_task_struct()</a>.</p>

<p>Referenced by <a class="el" href="../../dc/d44/tcmi__migcom_8c_source.html#l00151">tcmi_migcom_emigrate_ccn_ppm_p()</a>, <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00365">tcmi_shadowtask_execve()</a>, <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00904">tcmi_task_deliver_msg()</a>, and <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00181">tcmi_taskhelper_notify_by_pid()</a>.</p>
<div class="fragment"><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;{</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keyword">struct </span>task_struct* l_task = <a class="code" href="../../de/d2f/group__tcmi__task__class.html#gac263213bf219960dea9c7d4b4e6f3b34" title="Returns a task_struct associated with the tcmi_task.">tcmi_task_to_task_struct</a>(t_task);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">if</span> ( !l_task ) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(ERR3, <span class="stringliteral">&quot;Can&#39;t enter to mig_mode. Cannot find corresponding task_struct for PID: %d&quot;</span>, </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;             <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor.">tcmi_task_local_pid</a>(t_task));      </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">/* switch the task to migration mode */</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    force_sig(SIGUNUSED, l_task);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d2/daf/group__tcmi__taskhelper__class_ga9dbb48f23b9ec6a00498db53f026ef4b_cgraph.png" border="0" usemap="#d2/daf/group__tcmi__taskhelper__class_ga9dbb48f23b9ec6a00498db53f026ef4b_cgraph" alt=""/></div>
<map name="d2/daf/group__tcmi__taskhelper__class_ga9dbb48f23b9ec6a00498db53f026ef4b_cgraph" id="d2/daf/group__tcmi__taskhelper__class_ga9dbb48f23b9ec6a00498db53f026ef4b_cgraph">
<area shape="rect" id="node2" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="425,5,562,32"/><area shape="rect" id="node3" href="../../de/d2f/group__tcmi__task__class.html#gac263213bf219960dea9c7d4b4e6f3b34" title="Returns a task_struct associated with the tcmi_task." alt="" coords="206,56,375,83"/><area shape="rect" id="node4" href="../../d8/d3c/util_8h.html#a5f449355b8f54aaed664de85f89092ea" title="task_find_by_pid" alt="" coords="434,56,553,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga7e75703a07c8cf6db170d2a5f06e464d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_taskhelper_enter_mig_mode_exclusive </td>
          <td>(</td>
          <td class="paramtype">struct task_struct *&#160;</td>
          <td class="paramname"><em>l_task</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td>
          <td class="paramname"><em>t_task</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Same as standard enter_mig_mode, but in this case we have already a reference to current task, so we do not perform any locking </p>

<p>Definition at line <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00111">111</a> of file <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html">tcmi_taskhelper.h</a>.</p>

<p>Referenced by <a class="el" href="../../dc/d44/tcmi__migcom_8c_source.html#l00528">tcmi_migcom_guest_fork()</a>, and <a class="el" href="../../dc/d44/tcmi__migcom_8c_source.html#l00568">tcmi_migcom_shadow_fork()</a>.</p>
<div class="fragment"><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;{</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">/* switch the task to migration mode */</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    force_sig(SIGUNUSED, l_task);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gab89ca5c0deb987d20cf94fe2d000c58f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a>* tcmi_taskhelper_find_by_pid </td>
          <td>(</td>
          <td class="paramtype">pid_t&#160;</td>
          <td class="paramname"><em>pid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Finds a TCMI task based on PID, in addition checks whether the task has a valid migration mode handler assigned. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pid</td><td>- PID of a taks to be looked up </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TCMI task or NULL </dd></dl>

<p>Definition at line <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00128">128</a> of file <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html">tcmi_taskhelper.h</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d8/d3c/util_8h_source.html#l00007">task_find_by_pid()</a>, and <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00275">tcmi_task_get()</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d82/tcmi__migman_8c_source.html#l00604">tcmi_migman_deliver_msg()</a>, and <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00181">tcmi_taskhelper_notify_by_pid()</a>.</p>
<div class="fragment"><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;{</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keyword">struct </span>task_struct *l_task;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task" title="Compound structure that gathers necessary process information.">tcmi_task</a> *t_task = NULL;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">/* try finding the process by PID */</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    read_lock_irq(&amp;tasklist_lock);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">if</span> (!(l_task = <a class="code" href="../../d8/d3c/util_8h.html#a5f449355b8f54aaed664de85f89092ea">task_find_by_pid</a>(<a class="code" href="../../d6/d23/tcmi__signal__msg_8h.html#ae0d46a978d5cd6707411f276ad869b9c" title="Target PID.">pid</a>))) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Can&#39;t find, no such process %d&quot;</span>, <a class="code" href="../../d6/d23/tcmi__signal__msg_8h.html#ae0d46a978d5cd6707411f276ad869b9c" title="Target PID.">pid</a>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    task_lock(l_task);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">/* check whether the process has a TCMI task and a valid handler */</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">if</span> (!(l_task-&gt;tcmi.mig_mode_handler &amp;&amp; l_task-&gt;tcmi.tcmi_task)) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Process %d has no a mig. mode handler&quot;</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;             <span class="stringliteral">&quot;or TCMI task&quot;</span>, <a class="code" href="../../d6/d23/tcmi__signal__msg_8h.html#ae0d46a978d5cd6707411f276ad869b9c" title="Target PID.">pid</a>);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        task_unlock(l_task);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">/* get the extra task reference */</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    t_task = <a class="code" href="../../de/d2f/group__tcmi__task__class.html#gafb7d2e6227e173c0bdc6fb99ff12bcbc" title="&lt;&lt;public&gt;&gt; Instance accessor, increments the reference counter.">tcmi_task_get</a>(l_task-&gt;tcmi.tcmi_task);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    task_unlock(l_task);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    read_unlock_irq(&amp;tasklist_lock);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">return</span> t_task;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; exit0:</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    read_unlock_irq(&amp;tasklist_lock);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d2/daf/group__tcmi__taskhelper__class_gab89ca5c0deb987d20cf94fe2d000c58f_cgraph.png" border="0" usemap="#d2/daf/group__tcmi__taskhelper__class_gab89ca5c0deb987d20cf94fe2d000c58f_cgraph" alt=""/></div>
<map name="d2/daf/group__tcmi__taskhelper__class_gab89ca5c0deb987d20cf94fe2d000c58f_cgraph" id="d2/daf/group__tcmi__taskhelper__class_gab89ca5c0deb987d20cf94fe2d000c58f_cgraph">
<area shape="rect" id="node2" href="../../d8/d3c/util_8h.html#a5f449355b8f54aaed664de85f89092ea" title="task_find_by_pid" alt="" coords="195,5,314,32"/><area shape="rect" id="node3" href="../../de/d2f/group__tcmi__task__class.html#gafb7d2e6227e173c0bdc6fb99ff12bcbc" title="&lt;&lt;public&gt;&gt; Instance accessor, increments the reference counter." alt="" coords="203,56,307,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga0efd8c04f1e9c2bcd8ad0f2b8ff97c36"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_taskhelper_flush_signals </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td>
          <td class="paramname"><em>t_task</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Flushes all pending signals of the task. </p>
<p>Usually needed right after establishing a new shadow process.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*t_task</td><td>- pointer to this task instance </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00320">320</a> of file <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html">tcmi_taskhelper.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;{</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    flush_signals(current);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga403923e3422bd06870e36c8951def7fb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_taskhelper_flushfiles </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Flushing files is required prior to issuing a migrate request. </p>
<p>It is necessary to close all regular files that the process has open as those files will be accessed again by the restarted checkpoint. This prevents write conflicts. </p>

<p>Definition at line <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00728">728</a> of file <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html">tcmi_taskhelper.h</a>.</p>

<p>References <a class="el" href="../../d4/d83/tcmi__ckpt__openfile_8h_source.html#l00123">fd</a>, <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, and <a class="el" href="../../d6/db7/tcmi__ckpt_8h_source.html#l00334">tcmi_ckpt_foreach_openfile</a>.</p>

<p>Referenced by <a class="el" href="../../da/d61/tcmi__guesttask_8c_source.html#l00149">tcmi_guesttask_migrateback_p()</a>, and <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00205">tcmi_shadowtask_emigrate_p()</a>.</p>
<div class="fragment"><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;{</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d4/d83/tcmi__ckpt__openfile_8h.html#a4a05f54831975728fbdcadcb6fc4d40e" title="file descriptor">fd</a>;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keyword">struct </span>file *file;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="keyword">struct </span>inode *inode;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> old_flags = current-&gt;flags &amp; PF_EXITING;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="comment">/* We do a special trick here. In order to preserve proxy files during the migration, we need to tell the other end not to close the files.</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">       It does not close the files in case the clsoe was called in context of exit, as this file is going to be closed on process exit.</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment">       So we pretend we are exitting here so that the server things it should not close the file */</span> </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    current-&gt;flags |= PF_EXITING;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="comment">/* Check each open file */</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <a class="code" href="../../df/d54/group__tcmi__ckpt__class.html#gab07e0068ff7b0d4b9b577cb3d5fcf715" title="&lt;&lt;public&gt;&gt; Iterates through all open files">tcmi_ckpt_foreach_openfile</a>(file, fd) {</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        inode = file-&gt;f_dentry-&gt;d_inode;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <span class="keywordflow">if</span> (S_ISREG(inode-&gt;i_mode) || S_ISDIR(inode-&gt;i_mode) || S_ISCHR(inode-&gt;i_mode) || S_ISFIFO(inode-&gt;i_mode) ) {</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO4, <span class="stringliteral">&quot;Closing file fd=%d, type=%0o &#39;%s&#39;&quot;</span>, fd, file-&gt;f_flags, </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                 file-&gt;f_dentry-&gt;d_name.name);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            sys_close(fd);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    }</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    current-&gt;flags = old_flags;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gae8f5d2b311ca92e60b598076b578327d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_taskhelper_notify_by_pid </td>
          <td>(</td>
          <td class="paramtype">pid_t&#160;</td>
          <td class="paramname"><em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#ga51adea36dbef7cb03ffb89f5821ef2e0">tcmi_method_t</a> *&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>priority</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Submits a specified method to a TCMI task identified by PID. </p>
<p>To accomplish the job in SMP safe manner we need to:</p>
<ul>
<li>get a valid reference to a TCMI task associated with particular PID</li>
<li>submit the method - based on priority we can also choose to flush the method queue</li>
<li>switch the process to migration mode - again, to be safe, we use the <a class="el" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga9dbb48f23b9ec6a00498db53f026ef4b" title="&lt;&lt;public&gt;&gt; Switches the task into migration mode.">tcmi_taskhelper_enter_mig_mode()</a></li>
<li>drop the task reference</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pid</td><td>- process that is to be notified </td></tr>
    <tr><td class="paramname">*method</td><td>- task method that is to be submitted </td></tr>
    <tr><td class="paramname">*data</td><td>- argument for the submitted method </td></tr>
    <tr><td class="paramname">size</td><td>- size of the argument in bytes </td></tr>
    <tr><td class="paramname">priority</td><td>- when &gt; 0, the method queue is also flushed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon success</dd></dl>
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000007">Todo:</a></b></dt><dd>Simplify the way the task is forced into migration mode, so that a full lookup doesn't need to be performed again via <a class="el" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga9dbb48f23b9ec6a00498db53f026ef4b" title="&lt;&lt;public&gt;&gt; Switches the task into migration mode.">tcmi_taskhelper_enter_mig_mode()</a> </dd></dl>

<p>Definition at line <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00181">181</a> of file <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html">tcmi_taskhelper.h</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00295">tcmi_task_flush_and_submit_method()</a>, <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00209">tcmi_task_put()</a>, <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00270">tcmi_task_submit_method()</a>, <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00092">tcmi_taskhelper_enter_mig_mode()</a>, and <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00128">tcmi_taskhelper_find_by_pid()</a>.</p>

<p>Referenced by <a class="el" href="../../dc/d44/tcmi__migcom_8c_source.html#l00409">tcmi_migcom_migrate_home_ppm_p()</a>.</p>
<div class="fragment"><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;{</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task" title="Compound structure that gathers necessary process information.">tcmi_task</a> *t_task = NULL;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span> (!(t_task = <a class="code" href="../../d2/daf/group__tcmi__taskhelper__class.html#gab89ca5c0deb987d20cf94fe2d000c58f" title="&lt;&lt;public&gt;&gt; Finds a TCMI task based on PID, in addition checks whether the task has a valid migration ...">tcmi_taskhelper_find_by_pid</a>(<a class="code" href="../../d6/d23/tcmi__signal__msg_8h.html#ae0d46a978d5cd6707411f276ad869b9c" title="Target PID.">pid</a>))) {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Can&#39;t find TCMI task PID %d&quot;</span>, <a class="code" href="../../d6/d23/tcmi__signal__msg_8h.html#ae0d46a978d5cd6707411f276ad869b9c" title="Target PID.">pid</a>);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">/* now we can safely operate on the task as we own 1 reference */</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">if</span> (priority &gt; 0)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga2bf62635c09738ef0c1385ea258bec2f" title="&lt;&lt;public&gt;&gt; Flushes all pending methods in the queue submits a method for execution.">tcmi_task_flush_and_submit_method</a>(t_task, method, <a class="code" href="../../d9/d10/tcmi__npm__params_8h.html#ab9090ca30e7609aecaf540276e3c5084" title="Helper field that stores content of args/envp for the serialization.">data</a>, <a class="code" href="../../d5/d20/tcmi__p__emigrate__msg_8h.html#af8fd9ce16b371c8a3bf5e0b37a69419f" title="size of the checkpoint name in bytes (including trailing zero)">size</a>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0409e631915b37fbcfe096dfc498bbbb" title="&lt;&lt;public&gt;&gt; Submits a method for execution.">tcmi_task_submit_method</a>(t_task, method, <a class="code" href="../../d9/d10/tcmi__npm__params_8h.html#ab9090ca30e7609aecaf540276e3c5084" title="Helper field that stores content of args/envp for the serialization.">data</a>, <a class="code" href="../../d5/d20/tcmi__p__emigrate__msg_8h.html#af8fd9ce16b371c8a3bf5e0b37a69419f" title="size of the checkpoint name in bytes (including trailing zero)">size</a>);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">/* using method is safe as we have no reference l_task */</span> </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga9dbb48f23b9ec6a00498db53f026ef4b" title="&lt;&lt;public&gt;&gt; Switches the task into migration mode.">tcmi_taskhelper_enter_mig_mode</a>(t_task);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga9317afe43a9b9343c70eaf42409864b7" title="&lt;&lt;public&gt;&gt; Releases the instance.">tcmi_task_put</a>(t_task);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; exit0:</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d2/daf/group__tcmi__taskhelper__class_gae8f5d2b311ca92e60b598076b578327d_cgraph.png" border="0" usemap="#d2/daf/group__tcmi__taskhelper__class_gae8f5d2b311ca92e60b598076b578327d_cgraph" alt=""/></div>
<map name="d2/daf/group__tcmi__taskhelper__class_gae8f5d2b311ca92e60b598076b578327d_cgraph" id="d2/daf/group__tcmi__taskhelper__class_gae8f5d2b311ca92e60b598076b578327d_cgraph">
<area shape="rect" id="node2" href="../../de/d2f/group__tcmi__task__class.html#ga2bf62635c09738ef0c1385ea258bec2f" title="&lt;&lt;public&gt;&gt; Flushes all pending methods in the queue submits a method for execution." alt="" coords="223,150,364,191"/><area shape="rect" id="node9" href="../../de/d2f/group__tcmi__task__class.html#ga9317afe43a9b9343c70eaf42409864b7" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="241,512,345,539"/><area shape="rect" id="node45" href="../../de/d2f/group__tcmi__task__class.html#ga0409e631915b37fbcfe096dfc498bbbb" title="&lt;&lt;public&gt;&gt; Submits a method for execution." alt="" coords="206,52,381,79"/><area shape="rect" id="node46" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga9dbb48f23b9ec6a00498db53f026ef4b" title="&lt;&lt;public&gt;&gt; Switches the task into migration mode." alt="" coords="218,875,369,917"/><area shape="rect" id="node49" href="../../d2/daf/group__tcmi__taskhelper__class.html#gab89ca5c0deb987d20cf94fe2d000c58f" title="&lt;&lt;public&gt;&gt; Finds a TCMI task based on PID, in addition checks whether the task has a valid migration ..." alt="" coords="223,977,364,1018"/><area shape="rect" id="node3" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#ga57cd57a64f1ec847f1b71452daf4b3b1" title="&lt;&lt;public&gt;&gt; Creates a new wrapper for the specified method." alt="" coords="431,5,609,32"/><area shape="rect" id="node4" href="../../dc/d0c/group__tcmi__queue__class.html#ga3ae4d7e0a4d5d21ec8b9fff138f5b0d4" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="460,56,580,83"/><area shape="rect" id="node5" href="../../dc/d0c/group__tcmi__queue__class.html#ga2b0f1376bcd561196e77599cbc23090f" title="tcmi_queue_empty" alt="" coords="454,208,586,235"/><area shape="rect" id="node6" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#gad93018cc0894a434a94703eed0f869f9" title="&lt;&lt;public&gt;&gt; Decrements the reference counter, when the count reaches 0, the instance is destroyed..." alt="" coords="433,259,607,285"/><area shape="rect" id="node7" href="../../dc/d0c/group__tcmi__queue__class.html#ga40921ea3b077d55d70fb7b94ac666292" title="&lt;&lt;public&gt;&gt; Adds an element to the queue &#45; lock free version, assumes the lock is already held..." alt="" coords="455,107,585,133"/><area shape="rect" id="node8" href="../../dc/d0c/group__tcmi__queue__class.html#ga2e0e25eec1d5e4ea6e89dfde81ed43f4" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="453,157,587,184"/><area shape="rect" id="node10" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="679,723,817,749"/><area shape="rect" id="node11" href="../../d6/d8e/group__kkc__sock__class.html#ga9f980056fbf3436596c4cfdf3913e85c" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined..." alt="" coords="1117,807,1219,833"/><area shape="rect" id="node17" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga665210941a04fda118949874767ced93" title="&lt;&lt;public&gt;&gt; This method unregisters the file uses the semaphore lock as protection from races..." alt="" coords="437,309,603,336"/><area shape="rect" id="node22" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d..." alt="" coords="451,360,589,387"/><area shape="rect" id="node24" href="../../d0/db7/group__tcmi__slotvec__class.html#ga03946dfe98a88a916f30eaf3f2eed1be" title="&lt;&lt;public&gt;&gt; Tester method for slotvec emptyness" alt="" coords="451,461,589,488"/><area shape="rect" id="node25" href="../../d0/db7/group__tcmi__slotvec__class.html#ga2376bcc84e5bbd48a8f92400f5ad5f25" title="&lt;&lt;public&gt;&gt; Decrements the reference counter, when the count reaches 0, the instance is destroyed..." alt="" coords="909,563,1027,589"/><area shape="rect" id="node27" href="../../d6/dc2/group__tcmi__msg__class.html#ga73489766817f528da25369a3f4c713a1" title="&lt;&lt;public&gt;&gt; Message ID accessor." alt="" coords="472,563,568,589"/><area shape="rect" id="node28" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined..." alt="" coords="468,411,572,437"/><area shape="rect" id="node37" href="../../de/d2f/group__tcmi__task__class.html#gad41453e0aefb9dd79c2d3b65d8b9b16c" title="&lt;&lt;private&gt;&gt; Releases the execve context (execve file, argv, envp) Since the argv/envp have alloca..." alt="" coords="433,715,607,757"/><area shape="rect" id="node38" href="../../d6/da2/group__tcmi__migman__class.html#ga73763ae6fc849730aa1346f16208908f" title="&lt;&lt;public&gt;&gt; Removes tcmi task from the migration manager tasks slotvec" alt="" coords="430,613,610,640"/><area shape="rect" id="node42" href="../../d6/da2/group__tcmi__migman__class.html#gab536c262c24d8fc76cdbdfa8d6d65b81" title="&lt;&lt;public&gt;&gt; The manager is shutdown exactly in this order:" alt="" coords="457,781,583,808"/><area shape="rect" id="node12" href="../../d5/ddf/group__kkc__arch__class.html#ga06049c969ae0324d0607f10db99af65c" title="&lt;&lt;public&gt;&gt; Decrements the reference counter on the module owning the architecture." alt="" coords="1321,756,1421,783"/><area shape="rect" id="node13" href="../../d6/d8e/group__kkc__sock__class.html#ga00d8b033d3e1118303e7b4c54c6aafe6" title="&lt;&lt;public&gt;&gt; Socket name accessor." alt="" coords="1287,807,1454,833"/><area shape="rect" id="node15" href="../../d6/d8e/group__kkc__sock__class.html#gac8e64f52015e75cb76a34c4b7e9ef176" title="&lt;&lt;public&gt;&gt; Socket name accessor." alt="" coords="1285,857,1456,884"/><area shape="rect" id="node14" href="../../d6/d8e/group__kkc__sock__class.html#gadf1b231c727891d5ac2d32646d574931" title="&lt;&lt;public&gt;&gt; Peer socket name accessor." alt="" coords="1505,807,1665,833"/><area shape="rect" id="node16" href="../../d6/d8e/group__kkc__sock__class.html#ga3cae649f56c8f5fa18f755f6c7d53597" title="&lt;&lt;public&gt;&gt; Local socket name accessor." alt="" coords="1504,857,1667,884"/><area shape="rect" id="node18" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga5323f5b0f103dd3c42defc6c4494e641" title="&lt;&lt;public&gt;&gt; Locks this file instance." alt="" coords="682,309,814,336"/><area shape="rect" id="node19" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gaddf76bb53a90657e6773b485e0a89248" title="This method is used when object associated with the file wants to unregister with the file..." alt="" coords="659,208,837,235"/><area shape="rect" id="node21" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gad49b6ab401eeac4dab0ecd314796d569" title="&lt;&lt;public&gt;&gt; Unlocks this file instance." alt="" coords="675,259,821,285"/><area shape="rect" id="node20" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga8c97fc25ab3bd060017a3539edf7d6f0" title="&lt;&lt;public&gt;&gt; Sets the unregistered flag of the file." alt="" coords="885,201,1051,242"/><area shape="rect" id="node23" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga986b629882729daaf2c9607bfca57c3c" title="&lt;&lt;public&gt;&gt; Entry name accessor." alt="" coords="671,360,825,387"/><area shape="rect" id="node26" href="../../da/d0c/group__tcmi__slot__class.html#ga6dd63ff2854a9939a5aa094f6543a5d1" title="&lt;&lt;public&gt;&gt; Checks if the slot is empty." alt="" coords="1311,537,1430,564"/><area shape="rect" id="node29" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2748d267a8fddd1ced86e73ba8efd079" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="677,411,819,437"/><area shape="rect" id="node30" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="905,411,1031,437"/><area shape="rect" id="node31" href="../../d4/d8c/group__tcmi__transaction__class.html#gaac666feaaab1fe5c341237a3e0283501" title="&lt;&lt;public&gt;&gt; Transaction ID accessor." alt="" coords="901,309,1035,336"/><area shape="rect" id="node32" href="../../da/d0c/group__tcmi__slot__class.html#ga1d6232adcf00094597a66d9f5740d5f8" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="907,461,1029,488"/><area shape="rect" id="node36" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="899,360,1037,387"/><area shape="rect" id="node33" href="../../da/d0c/group__tcmi__slot__class.html#ga29d8101c5815a6519567c548da4a3c7e" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="1099,512,1237,539"/><area shape="rect" id="node34" href="../../da/d0c/group__tcmi__slot__class.html#ga109d6d783ebf06046f364f970f84da1f" title="&lt;&lt;public&gt;&gt; Locks the slot data." alt="" coords="1115,411,1221,437"/><area shape="rect" id="node35" href="../../da/d0c/group__tcmi__slot__class.html#ga5447231fec5f42040c40307eb2e6a13c" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="1108,461,1228,488"/><area shape="rect" id="node39" href="../../d0/db7/group__tcmi__slotvec__class.html#ga876670f605631a5deb930412dae02b28" title="&lt;&lt;public&gt;&gt; Accesses a slot at a given index." alt="" coords="692,563,804,589"/><area shape="rect" id="node40" href="../../d0/db7/group__tcmi__slotvec__class.html#ga463d8dd03bd30b24c3ebfed5a0239d8a" title="&lt;&lt;public&gt;&gt; Hashmask accessor." alt="" coords="667,613,829,640"/><area shape="rect" id="node41" href="../../de/d2f/group__tcmi__task__class.html#ga00ff41ed284360c257ed41138ad58d99" title="&lt;&lt;public&gt;&gt; Computes the hash value of the task (to be used in tasks slotvec of migman)" alt="" coords="691,664,805,691"/><area shape="rect" id="node43" href="../../d6/da2/group__tcmi__migman__class.html#ga94df994d6d2ad3dd9aa6543ee67bf934" title="&lt;&lt;private&gt;&gt; Free method is has two purposes:when the last reference is released, it will free all ins..." alt="" coords="684,781,812,808"/><area shape="rect" id="node44" href="../../d9/dfc/group__tcmi__comm__class.html#ga89dc5a63295a65407cc93606c79ca314" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="911,781,1025,808"/><area shape="rect" id="node47" href="../../de/d2f/group__tcmi__task__class.html#gac263213bf219960dea9c7d4b4e6f3b34" title="Returns a task_struct associated with the tcmi_task." alt="" coords="435,933,605,960"/><area shape="rect" id="node48" href="../../d8/d3c/util_8h.html#a5f449355b8f54aaed664de85f89092ea" title="task_find_by_pid" alt="" coords="689,984,807,1011"/><area shape="rect" id="node50" href="../../de/d2f/group__tcmi__task__class.html#gafb7d2e6227e173c0bdc6fb99ff12bcbc" title="&lt;&lt;public&gt;&gt; Instance accessor, increments the reference counter." alt="" coords="468,984,572,1011"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga7421f53cc8c717b52a92daaac326f81d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_taskhelper_notify_current </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#ga51adea36dbef7cb03ffb89f5821ef2e0">tcmi_method_t</a> *&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>priority</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; current process notification - submission of a method. </p>
<p>The notification requires:</p>
<ul>
<li>checks for a valid TCMI task in current process</li>
<li>submits the method based on priority</li>
<li>launches the migration mode handler - we need to reassign the process context as this notification is typically used from system call hooks.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*method</td><td>- task method that is to be submitted </td></tr>
    <tr><td class="paramname">*data</td><td>- argument for the submitted method </td></tr>
    <tr><td class="paramname">size</td><td>- size of the argument in bytes </td></tr>
    <tr><td class="paramname">priority</td><td>- when &gt; 0, the method queue is also flushed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon success </dd></dl>

<p>Definition at line <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00574">574</a> of file <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html">tcmi_taskhelper.h</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00378">tcmi_task_context()</a>, <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00295">tcmi_task_flush_and_submit_method()</a>, <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00270">tcmi_task_submit_method()</a>, and <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00547">tcmi_taskhelper_do_mig_mode()</a>.</p>

<p>Referenced by <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html#l00135">tcmi_mighooks_do_exit()</a>.</p>
<div class="fragment"><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;{</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task" title="Compound structure that gathers necessary process information.">tcmi_task</a> *t_task;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Notify current %p&quot;</span>, current);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordflow">if</span> (!(t_task = current-&gt;tcmi.tcmi_task)) {</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="comment">/* now we can safely operate on the task as we own 1 reference */</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordflow">if</span> (priority &gt; 0)</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga2bf62635c09738ef0c1385ea258bec2f" title="&lt;&lt;public&gt;&gt; Flushes all pending methods in the queue submits a method for execution.">tcmi_task_flush_and_submit_method</a>(t_task, method, <a class="code" href="../../d9/d10/tcmi__npm__params_8h.html#ab9090ca30e7609aecaf540276e3c5084" title="Helper field that stores content of args/envp for the serialization.">data</a>, <a class="code" href="../../d5/d20/tcmi__p__emigrate__msg_8h.html#af8fd9ce16b371c8a3bf5e0b37a69419f" title="size of the checkpoint name in bytes (including trailing zero)">size</a>);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0409e631915b37fbcfe096dfc498bbbb" title="&lt;&lt;public&gt;&gt; Submits a method for execution.">tcmi_task_submit_method</a>(t_task, method, <a class="code" href="../../d9/d10/tcmi__npm__params_8h.html#ab9090ca30e7609aecaf540276e3c5084" title="Helper field that stores content of args/envp for the serialization.">data</a>, <a class="code" href="../../d5/d20/tcmi__p__emigrate__msg_8h.html#af8fd9ce16b371c8a3bf5e0b37a69419f" title="size of the checkpoint name in bytes (including trailing zero)">size</a>);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <a class="code" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga2420f9c7c246746d3bbc87578357338f" title="&lt;&lt;public&gt;&gt; This method is registered by CCN or PEN component as the SIGUNUSED signal handler...">tcmi_taskhelper_do_mig_mode</a>(<a class="code" href="../../de/d2f/group__tcmi__task__class.html#gade1e8f7b12614ca0fecbc40aaae9a6c5" title="&lt;&lt;public&gt;&gt; Process context accessor.">tcmi_task_context</a>(t_task));</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; exit0:</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d2/daf/group__tcmi__taskhelper__class_ga7421f53cc8c717b52a92daaac326f81d_cgraph.png" border="0" usemap="#d2/daf/group__tcmi__taskhelper__class_ga7421f53cc8c717b52a92daaac326f81d_cgraph" alt=""/></div>
<map name="d2/daf/group__tcmi__taskhelper__class_ga7421f53cc8c717b52a92daaac326f81d_cgraph" id="d2/daf/group__tcmi__taskhelper__class_ga7421f53cc8c717b52a92daaac326f81d_cgraph">
<area shape="rect" id="node2" href="../../de/d2f/group__tcmi__task__class.html#gade1e8f7b12614ca0fecbc40aaae9a6c5" title="&lt;&lt;public&gt;&gt; Process context accessor." alt="" coords="229,23,358,49"/><area shape="rect" id="node3" href="../../de/d2f/group__tcmi__task__class.html#ga2bf62635c09738ef0c1385ea258bec2f" title="&lt;&lt;public&gt;&gt; Flushes all pending methods in the queue submits a method for execution." alt="" coords="223,125,364,166"/><area shape="rect" id="node10" href="../../de/d2f/group__tcmi__task__class.html#ga0409e631915b37fbcfe096dfc498bbbb" title="&lt;&lt;public&gt;&gt; Submits a method for execution." alt="" coords="206,73,381,100"/><area shape="rect" id="node11" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga2420f9c7c246746d3bbc87578357338f" title="&lt;&lt;public&gt;&gt; This method is registered by CCN or PEN component as the SIGUNUSED signal handler..." alt="" coords="226,233,361,274"/><area shape="rect" id="node4" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#ga57cd57a64f1ec847f1b71452daf4b3b1" title="&lt;&lt;public&gt;&gt; Creates a new wrapper for the specified method." alt="" coords="429,5,608,32"/><area shape="rect" id="node5" href="../../dc/d0c/group__tcmi__queue__class.html#ga3ae4d7e0a4d5d21ec8b9fff138f5b0d4" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="459,56,579,83"/><area shape="rect" id="node6" href="../../dc/d0c/group__tcmi__queue__class.html#ga2b0f1376bcd561196e77599cbc23090f" title="tcmi_queue_empty" alt="" coords="453,107,585,133"/><area shape="rect" id="node7" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#gad93018cc0894a434a94703eed0f869f9" title="&lt;&lt;public&gt;&gt; Decrements the reference counter, when the count reaches 0, the instance is destroyed..." alt="" coords="431,157,606,184"/><area shape="rect" id="node8" href="../../dc/d0c/group__tcmi__queue__class.html#ga40921ea3b077d55d70fb7b94ac666292" title="&lt;&lt;public&gt;&gt; Adds an element to the queue &#45; lock free version, assumes the lock is already held..." alt="" coords="453,208,584,235"/><area shape="rect" id="node9" href="../../dc/d0c/group__tcmi__queue__class.html#ga2e0e25eec1d5e4ea6e89dfde81ed43f4" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="451,259,586,285"/><area shape="rect" id="node12" href="../../de/d2f/group__tcmi__task__class.html#gabc853647b7b732333c5909e617030f44" title="&lt;&lt;public&gt;&gt; Process context setter." alt="" coords="441,309,596,336"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga1ff741911c123bcd7eb94d193f3bdc59"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_taskhelper_restart </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td>
          <td class="paramname"><em>t_task</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>ckpt_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Schedules a task restart from a given checkpoint image. </p>
<p>This requires:</p>
<ul>
<li>preparing execve of the checkpoint (the task stores internally the execve name string, so that it can be released upon task destruction)</li>
<li>submitting execve method - it will be picked up by the method pump in its next iteration. We WANT to flush all methods from the queue as execve we is of high importance and want to make sure it runs next.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*t_task</td><td>- pointer to the TCMI task whose image will be overlayed with the checkpoint image </td></tr>
    <tr><td class="paramname">ckpt_name</td><td>- checkpoint image name. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon success </dd></dl>

<p>Definition at line <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00700">700</a> of file <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html">tcmi_taskhelper.h</a>.</p>

<p>References <a class="el" href="../../d9/d10/tcmi__npm__params_8h_source.html#l00052">envp</a>, <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00802">tcmi_task_execve()</a>, <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00295">tcmi_task_flush_and_submit_method()</a>, and <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00755">tcmi_task_prepare_execve()</a>.</p>

<p>Referenced by <a class="el" href="../../da/d61/tcmi__guesttask_8c_source.html#l00307">tcmi_guesttask_process_p_emigrate_msg()</a>, and <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00467">tcmi_shadowtask_process_ppm_p_migr_back_guestreq_procmsg()</a>.</p>
<div class="fragment"><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;{</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="../../de/d2f/group__tcmi__task__class.html#a00d2cb20c8d850399c7d22aeb55bca60" title="command line arguments for the checkpoint file (NULL terminated array of strings)">argv</a>[] = { NULL };</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="../../d9/d10/tcmi__npm__params_8h.html#aeebc47a01a74a156c1843bcc37b2bd02">envp</a>[] = { NULL };</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="comment">/* setup execve arguments*/</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga24a9d8c612da1a4484b1b3a28a181c15" title="&lt;&lt;public&gt;&gt; Prepares execution of a file given the arrays of arguments and environment.">tcmi_task_prepare_execve</a>(t_task, ckpt_name, argv, envp) &lt; 0) { </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Failed preparing execve of the checkpoint &#39;%s&#39;&quot;</span>, ckpt_name);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    }</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="comment">/* schedule task execve as the next method - requires flushing</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">     * all methods in the queue */</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Submitting execve&quot;</span>);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga2bf62635c09738ef0c1385ea258bec2f" title="&lt;&lt;public&gt;&gt; Flushes all pending methods in the queue submits a method for execution.">tcmi_task_flush_and_submit_method</a>(t_task, <a class="code" href="../../de/d2f/group__tcmi__task__class.html#gab1a418ac9d8b708dcee524671db07518" title="&lt;&lt;public&gt;&gt; Executes the file that has been previously setup for execution.">tcmi_task_execve</a>, NULL, 0);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; exit0:</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d2/daf/group__tcmi__taskhelper__class_ga1ff741911c123bcd7eb94d193f3bdc59_cgraph.png" border="0" usemap="#d2/daf/group__tcmi__taskhelper__class_ga1ff741911c123bcd7eb94d193f3bdc59_cgraph" alt=""/></div>
<map name="d2/daf/group__tcmi__taskhelper__class_ga1ff741911c123bcd7eb94d193f3bdc59_cgraph" id="d2/daf/group__tcmi__taskhelper__class_ga1ff741911c123bcd7eb94d193f3bdc59_cgraph">
<area shape="rect" id="node2" href="../../de/d2f/group__tcmi__task__class.html#gab1a418ac9d8b708dcee524671db07518" title="&lt;&lt;public&gt;&gt; Executes the file that has been previously setup for execution." alt="" coords="238,56,365,83"/><area shape="rect" id="node5" href="../../de/d2f/group__tcmi__task__class.html#ga2bf62635c09738ef0c1385ea258bec2f" title="&lt;&lt;public&gt;&gt; Flushes all pending methods in the queue submits a method for execution." alt="" coords="231,175,372,217"/><area shape="rect" id="node11" href="../../de/d2f/group__tcmi__task__class.html#ga24a9d8c612da1a4484b1b3a28a181c15" title="&lt;&lt;public&gt;&gt; Prepares execution of a file given the arrays of arguments and environment." alt="" coords="213,397,389,424"/><area shape="rect" id="node3" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#gad93018cc0894a434a94703eed0f869f9" title="&lt;&lt;public&gt;&gt; Decrements the reference counter, when the count reaches 0, the instance is destroyed..." alt="" coords="439,56,614,83"/><area shape="rect" id="node4" href="../../da/d7c/i386_2make__syscall_8h.html#a042af8adc43a2caa376c6a5dfddfeb6c" title="TODO: Export the original kernel_execve in kernel and use that instead." alt="" coords="452,5,601,32"/><area shape="rect" id="node6" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#ga57cd57a64f1ec847f1b71452daf4b3b1" title="&lt;&lt;public&gt;&gt; Creates a new wrapper for the specified method." alt="" coords="437,107,616,133"/><area shape="rect" id="node7" href="../../dc/d0c/group__tcmi__queue__class.html#ga3ae4d7e0a4d5d21ec8b9fff138f5b0d4" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="467,157,587,184"/><area shape="rect" id="node8" href="../../dc/d0c/group__tcmi__queue__class.html#ga2b0f1376bcd561196e77599cbc23090f" title="tcmi_queue_empty" alt="" coords="461,208,593,235"/><area shape="rect" id="node9" href="../../dc/d0c/group__tcmi__queue__class.html#ga40921ea3b077d55d70fb7b94ac666292" title="&lt;&lt;public&gt;&gt; Adds an element to the queue &#45; lock free version, assumes the lock is already held..." alt="" coords="461,259,592,285"/><area shape="rect" id="node10" href="../../dc/d0c/group__tcmi__queue__class.html#ga2e0e25eec1d5e4ea6e89dfde81ed43f4" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="459,309,594,336"/><area shape="rect" id="node12" href="../../de/d2f/group__tcmi__task__class.html#gad41453e0aefb9dd79c2d3b65d8b9b16c" title="&lt;&lt;private&gt;&gt; Releases the execve context (execve file, argv, envp) Since the argv/envp have alloca..." alt="" coords="439,361,614,402"/><area shape="rect" id="node14" href="../../de/d84/tcmi__task_8c.html#ab73603e4adaf2a1bb6b7cf6a01a1c2f3" title="&lt;&lt;private&gt;&gt; Class method &#45; copies an array of strings terminated by NULL string (standard argv/envp f..." alt="" coords="447,427,607,453"/><area shape="rect" id="node13" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="665,423,802,449"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga41526f4b1eb09e8b8c00ca114d16bed9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_taskhelper_run_mig_mode_handler </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Runs migration mode handler of the current process. </p>
<dl class="section return"><dt>Returns</dt><dd>0 upon success </dd></dl>

<p>Definition at line <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00067">67</a> of file <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html">tcmi_taskhelper.h</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>.</p>

<p>Referenced by <a class="el" href="../../dc/d44/tcmi__migcom_8c_source.html#l00439">tcmi_migcom_migrated_task()</a>.</p>
<div class="fragment"><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;{</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">if</span> (!current-&gt;tcmi.mig_mode_handler) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Missing migration mode handler for current process!!&quot;</span>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    current-&gt;tcmi.mig_mode_handler();</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; exit0:</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gae9732c6fadc0ba89ff2f6d04096438ea"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a>* tcmi_taskhelper_sanity_check </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; This method is intended for migration mode handler, it should be the very first check it performs. </p>
<p>We verify that the current process has a valid TCMI task assigned. Also, if this is the first time entering the migration mode, the task has to be 'picked up'. This is a synchronization mechanism that is available for the TCMI task instantiator (usually the migration component).</p>
<dl class="section return"><dt>Returns</dt><dd>a valid TCMI task that is attached to the current kernel process or NULL; </dd></dl>

<p>Definition at line <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00512">512</a> of file <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html">tcmi_taskhelper.h</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00411">tcmi_task_local_pid()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00496">tcmi_task_pick_up()</a>, and <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00509">tcmi_task_picked_up()</a>.</p>

<p>Referenced by <a class="el" href="../../dc/d44/tcmi__migcom_8c_source.html#l00620">tcmi_migcom_mig_mode_handler()</a>.</p>
<div class="fragment"><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;{</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task" title="Compound structure that gathers necessary process information.">tcmi_task</a> *t_task;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    task_lock(current);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="comment">/* safes a few dereferences */</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    t_task = current-&gt;tcmi.tcmi_task;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="comment">/* check that the TCMI task exists */</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">if</span> (!t_task) {</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Kernel task &#39;%s&#39; PID=%d has no TCMI task assigned&quot;</span>, </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;             current-&gt;comm, current-&gt;pid);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment">/* pickup the task when entering the migration mode for the first time */</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../de/d2f/group__tcmi__task__class.html#gaccbe464cf89735f8da8ff88fc1a202a8" title="&lt;&lt;public&gt;&gt; Checks whether the task has been picked up.">tcmi_task_picked_up</a>(t_task)) {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO2, <span class="stringliteral">&quot;TCMI task %p PID=%d first time in mig. mode, picking up&quot;</span>, </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;             t_task, <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor.">tcmi_task_local_pid</a>(t_task));</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <a class="code" href="../../de/d2f/group__tcmi__task__class.html#gad1f29bebb7bb9f2174559555d97d8f29" title="&lt;&lt;public&gt;&gt; Signals, the tcmi task has been pickedup by the associated process.n">tcmi_task_pick_up</a>(t_task);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    task_unlock(current);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keywordflow">return</span> t_task;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; exit0:</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    task_unlock(current);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d2/daf/group__tcmi__taskhelper__class_gae9732c6fadc0ba89ff2f6d04096438ea_cgraph.png" border="0" usemap="#d2/daf/group__tcmi__taskhelper__class_gae9732c6fadc0ba89ff2f6d04096438ea_cgraph" alt=""/></div>
<map name="d2/daf/group__tcmi__taskhelper__class_gae9732c6fadc0ba89ff2f6d04096438ea_cgraph" id="d2/daf/group__tcmi__taskhelper__class_gae9732c6fadc0ba89ff2f6d04096438ea_cgraph">
<area shape="rect" id="node2" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="215,5,353,32"/><area shape="rect" id="node3" href="../../de/d2f/group__tcmi__task__class.html#gad1f29bebb7bb9f2174559555d97d8f29" title="&lt;&lt;public&gt;&gt; Signals, the tcmi task has been pickedup by the associated process.n" alt="" coords="219,56,349,83"/><area shape="rect" id="node4" href="../../de/d2f/group__tcmi__task__class.html#gaccbe464cf89735f8da8ff88fc1a202a8" title="&lt;&lt;public&gt;&gt; Checks whether the task has been picked up." alt="" coords="211,107,357,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga80ea6618ba426419c51193f8fd24822d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_taskhelper_wait_for_pick_up_timeout </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td>
          <td class="paramname"><em>t_task</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>timeout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Synchronizes with a task entering the migration mode for the first time. </p>
<p>The thread associated with the task already has an extra reference. If the task doesn't get picked up on time, it will be safely removed from under the thread.</p>
<p>We don't need an extra reference to the kernel task struct as we are holding task_list_lock -&gt; the task struct can't be removed from under us.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*t_task</td><td>- pointer to the task instance that we are syncing with </td></tr>
    <tr><td class="paramname">timeout</td><td>- in ticks </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if the task has successfully entered the migration mode </dd></dl>

<p>Definition at line <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00224">224</a> of file <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html">tcmi_taskhelper.h</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d6/d01/dbg_8h_source.html#l00221">minfo</a>, <a class="el" href="../../d8/d3c/util_8h_source.html#l00007">task_find_by_pid()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00411">tcmi_task_local_pid()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00509">tcmi_task_picked_up()</a>, <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00209">tcmi_task_put()</a>, and <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00483">tcmi_task_wait_for_pick_up_timeout()</a>.</p>

<p>Referenced by <a class="el" href="../../dc/d44/tcmi__migcom_8c_source.html#l00151">tcmi_migcom_emigrate_ccn_ppm_p()</a>, and <a class="el" href="../../dc/d44/tcmi__migcom_8c_source.html#l00293">tcmi_migcom_immigrate()</a>.</p>
<div class="fragment"><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;{</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordtype">int</span> err = 0;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">/* temporary storage for the task. */</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task" title="Compound structure that gathers necessary process information.">tcmi_task</a> *tmp = NULL;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">/* regular linux task used for lookup*/</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keyword">struct </span>task_struct *l_task;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">/* Wait for pickup first */</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../de/d2f/group__tcmi__task__class.html#gaddcd1c0b8ba2bfee9a3602dbabea04e1" title="&lt;&lt;public&gt;&gt; Waits until the task is picked up, by the associated process.">tcmi_task_wait_for_pick_up_timeout</a>(t_task, timeout)) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="comment">/* try finding thread associated with the task by PID */</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        read_lock_irq(&amp;tasklist_lock);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">if</span> (!(l_task = <a class="code" href="../../d8/d3c/util_8h.html#a5f449355b8f54aaed664de85f89092ea">task_find_by_pid</a>(<a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor.">tcmi_task_local_pid</a>(t_task)))) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Failed to wait - no such process %d&quot;</span>, </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                 <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor.">tcmi_task_local_pid</a>(t_task));</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            err = -ESRCH;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            read_unlock_irq(&amp;tasklist_lock);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="comment">/* A bad inconsistency if tasks don&#39;t match - bug */</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        BUG_ON(t_task != l_task-&gt;tcmi.tcmi_task);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="comment">/* the task might still have been picked up in the</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">         * meantime, we have to check again */</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        task_lock(l_task);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../de/d2f/group__tcmi__task__class.html#gaccbe464cf89735f8da8ff88fc1a202a8" title="&lt;&lt;public&gt;&gt; Checks whether the task has been picked up.">tcmi_task_picked_up</a>(l_task-&gt;tcmi.tcmi_task)) {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <a class="code" href="../../d6/d01/dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(INFO1, <span class="stringliteral">&quot;Task local PID = %d still not picked up destroying..&quot;</span>,</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                  <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor.">tcmi_task_local_pid</a>(t_task));</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            tmp = l_task-&gt;tcmi.tcmi_task;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            l_task-&gt;tcmi.mig_mode_handler = NULL;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            l_task-&gt;tcmi.tcmi_task = NULL;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            err = -EINVAL;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        task_unlock(l_task);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        read_unlock_irq(&amp;tasklist_lock);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="comment">/* Release the task instance - safe if still NULL. We must release 1 reference as the thread that owned the task no longer owns it. */</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga9317afe43a9b9343c70eaf42409864b7" title="&lt;&lt;public&gt;&gt; Releases the instance.">tcmi_task_put</a>(tmp);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; exit0:</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d2/daf/group__tcmi__taskhelper__class_ga80ea6618ba426419c51193f8fd24822d_cgraph.png" border="0" usemap="#d2/daf/group__tcmi__taskhelper__class_ga80ea6618ba426419c51193f8fd24822d_cgraph" alt=""/></div>
<map name="d2/daf/group__tcmi__taskhelper__class_ga80ea6618ba426419c51193f8fd24822d_cgraph" id="d2/daf/group__tcmi__taskhelper__class_ga80ea6618ba426419c51193f8fd24822d_cgraph">
<area shape="rect" id="node2" href="../../d8/d3c/util_8h.html#a5f449355b8f54aaed664de85f89092ea" title="task_find_by_pid" alt="" coords="214,5,333,32"/><area shape="rect" id="node3" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="637,161,774,188"/><area shape="rect" id="node4" href="../../de/d2f/group__tcmi__task__class.html#gaccbe464cf89735f8da8ff88fc1a202a8" title="&lt;&lt;public&gt;&gt; Checks whether the task has been picked up." alt="" coords="201,435,346,461"/><area shape="rect" id="node5" href="../../de/d2f/group__tcmi__task__class.html#ga9317afe43a9b9343c70eaf42409864b7" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="221,384,325,411"/><area shape="rect" id="node50" href="../../de/d2f/group__tcmi__task__class.html#gaddcd1c0b8ba2bfee9a3602dbabea04e1" title="&lt;&lt;public&gt;&gt; Waits until the task is picked up, by the associated process." alt="" coords="208,486,339,527"/><area shape="rect" id="node6" href="../../d6/d8e/group__kkc__sock__class.html#ga9f980056fbf3436596c4cfdf3913e85c" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined..." alt="" coords="1110,291,1213,317"/><area shape="rect" id="node12" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga665210941a04fda118949874767ced93" title="&lt;&lt;public&gt;&gt; This method unregisters the file uses the semaphore lock as protection from races..." alt="" coords="1299,476,1464,503"/><area shape="rect" id="node17" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d..." alt="" coords="1092,375,1231,401"/><area shape="rect" id="node19" href="../../d0/db7/group__tcmi__slotvec__class.html#ga03946dfe98a88a916f30eaf3f2eed1be" title="&lt;&lt;public&gt;&gt; Tester method for slotvec emptyness" alt="" coords="417,725,554,752"/><area shape="rect" id="node20" href="../../d0/db7/group__tcmi__slotvec__class.html#ga2376bcc84e5bbd48a8f92400f5ad5f25" title="&lt;&lt;public&gt;&gt; Decrements the reference counter, when the count reaches 0, the instance is destroyed..." alt="" coords="871,628,990,655"/><area shape="rect" id="node22" href="../../dc/d0c/group__tcmi__queue__class.html#ga2b0f1376bcd561196e77599cbc23090f" title="tcmi_queue_empty" alt="" coords="419,776,551,803"/><area shape="rect" id="node23" href="../../d6/dc2/group__tcmi__msg__class.html#ga73489766817f528da25369a3f4c713a1" title="&lt;&lt;public&gt;&gt; Message ID accessor." alt="" coords="437,827,533,853"/><area shape="rect" id="node24" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined..." alt="" coords="433,675,537,701"/><area shape="rect" id="node35" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#gad93018cc0894a434a94703eed0f869f9" title="&lt;&lt;public&gt;&gt; Decrements the reference counter, when the count reaches 0, the instance is destroyed..." alt="" coords="398,157,573,184"/><area shape="rect" id="node36" href="../../de/d2f/group__tcmi__task__class.html#gad41453e0aefb9dd79c2d3b65d8b9b16c" title="&lt;&lt;private&gt;&gt; Releases the execve context (execve file, argv, envp) Since the argv/envp have alloca..." alt="" coords="398,209,573,250"/><area shape="rect" id="node37" href="../../d6/da2/group__tcmi__migman__class.html#ga73763ae6fc849730aa1346f16208908f" title="&lt;&lt;public&gt;&gt; Removes tcmi task from the migration manager tasks slotvec" alt="" coords="395,511,575,537"/><area shape="rect" id="node41" href="../../d6/da2/group__tcmi__migman__class.html#gab536c262c24d8fc76cdbdfa8d6d65b81" title="&lt;&lt;public&gt;&gt; The manager is shutdown exactly in this order:" alt="" coords="423,384,548,411"/><area shape="rect" id="node7" href="../../d5/ddf/group__kkc__arch__class.html#ga06049c969ae0324d0607f10db99af65c" title="&lt;&lt;public&gt;&gt; Decrements the reference counter on the module owning the architecture." alt="" coords="1331,333,1431,360"/><area shape="rect" id="node8" href="../../d6/d8e/group__kkc__sock__class.html#ga00d8b033d3e1118303e7b4c54c6aafe6" title="&lt;&lt;public&gt;&gt; Socket name accessor." alt="" coords="1298,232,1465,259"/><area shape="rect" id="node10" href="../../d6/d8e/group__kkc__sock__class.html#gac8e64f52015e75cb76a34c4b7e9ef176" title="&lt;&lt;public&gt;&gt; Socket name accessor." alt="" coords="1296,283,1467,309"/><area shape="rect" id="node9" href="../../d6/d8e/group__kkc__sock__class.html#gadf1b231c727891d5ac2d32646d574931" title="&lt;&lt;public&gt;&gt; Peer socket name accessor." alt="" coords="1524,232,1684,259"/><area shape="rect" id="node11" href="../../d6/d8e/group__kkc__sock__class.html#ga3cae649f56c8f5fa18f755f6c7d53597" title="&lt;&lt;public&gt;&gt; Local socket name accessor." alt="" coords="1523,283,1685,309"/><area shape="rect" id="node13" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga5323f5b0f103dd3c42defc6c4494e641" title="&lt;&lt;public&gt;&gt; Locks this file instance." alt="" coords="1538,425,1670,452"/><area shape="rect" id="node14" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gaddf76bb53a90657e6773b485e0a89248" title="This method is used when object associated with the file wants to unregister with the file..." alt="" coords="1515,527,1693,553"/><area shape="rect" id="node16" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gad49b6ab401eeac4dab0ecd314796d569" title="&lt;&lt;public&gt;&gt; Unlocks this file instance." alt="" coords="1531,476,1677,503"/><area shape="rect" id="node15" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga8c97fc25ab3bd060017a3539edf7d6f0" title="&lt;&lt;public&gt;&gt; Sets the unregistered flag of the file." alt="" coords="1741,519,1907,561"/><area shape="rect" id="node18" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga986b629882729daaf2c9607bfca57c3c" title="&lt;&lt;public&gt;&gt; Entry name accessor." alt="" coords="1305,384,1458,411"/><area shape="rect" id="node21" href="../../da/d0c/group__tcmi__slot__class.html#ga6dd63ff2854a9939a5aa094f6543a5d1" title="&lt;&lt;public&gt;&gt; Checks if the slot is empty." alt="" coords="1322,679,1441,705"/><area shape="rect" id="node25" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2748d267a8fddd1ced86e73ba8efd079" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="634,780,777,807"/><area shape="rect" id="node26" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="868,881,993,908"/><area shape="rect" id="node27" href="../../d4/d8c/group__tcmi__transaction__class.html#gaac666feaaab1fe5c341237a3e0283501" title="&lt;&lt;public&gt;&gt; Transaction ID accessor." alt="" coords="863,780,998,807"/><area shape="rect" id="node28" href="../../da/d0c/group__tcmi__slot__class.html#ga1d6232adcf00094597a66d9f5740d5f8" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="869,729,992,756"/><area shape="rect" id="node34" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="861,831,1000,857"/><area shape="rect" id="node29" href="../../da/d0c/group__tcmi__slot__class.html#ga29d8101c5815a6519567c548da4a3c7e" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="1093,780,1230,807"/><area shape="rect" id="node32" href="../../da/d0c/group__tcmi__slot__class.html#ga109d6d783ebf06046f364f970f84da1f" title="&lt;&lt;public&gt;&gt; Locks the slot data." alt="" coords="1108,729,1215,756"/><area shape="rect" id="node33" href="../../da/d0c/group__tcmi__slot__class.html#ga5447231fec5f42040c40307eb2e6a13c" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="1101,679,1221,705"/><area shape="rect" id="node30" href="../../da/d0c/group__tcmi__slot__class.html#ga2550a3e6624b54e323c73cb1d06e6cd0" title="&lt;&lt;public&gt;&gt; Moves a slot among unused_slots." alt="" coords="1301,780,1462,807"/><area shape="rect" id="node31" href="../../da/d0c/group__tcmi__slot__class.html#ga8d6885be2677819158e0d956f0cca5b2" title="&lt;&lt;private&gt;&gt; Moves a slot into the specified list." alt="" coords="1548,780,1660,807"/><area shape="rect" id="node38" href="../../d0/db7/group__tcmi__slotvec__class.html#ga876670f605631a5deb930412dae02b28" title="&lt;&lt;public&gt;&gt; Accesses a slot at a given index." alt="" coords="649,485,761,512"/><area shape="rect" id="node39" href="../../d0/db7/group__tcmi__slotvec__class.html#ga463d8dd03bd30b24c3ebfed5a0239d8a" title="&lt;&lt;public&gt;&gt; Hashmask accessor." alt="" coords="625,536,786,563"/><area shape="rect" id="node40" href="../../de/d2f/group__tcmi__task__class.html#ga00ff41ed284360c257ed41138ad58d99" title="&lt;&lt;public&gt;&gt; Computes the hash value of the task (to be used in tasks slotvec of migman)" alt="" coords="648,587,763,613"/><area shape="rect" id="node42" href="../../d6/da2/group__tcmi__migman__class.html#ga94df994d6d2ad3dd9aa6543ee67bf934" title="&lt;&lt;private&gt;&gt; Free method is has two purposes:when the last reference is released, it will free all ins..." alt="" coords="641,384,769,411"/><area shape="rect" id="node43" href="../../d9/dfc/group__tcmi__comm__class.html#ga89dc5a63295a65407cc93606c79ca314" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="873,308,988,335"/><area shape="rect" id="node44" href="../../d6/da2/group__tcmi__migman__class.html#ga39c491f49b4e5b3cc533c816d27135a3" title="&lt;&lt;private&gt;&gt; Destroys all TCMI ctlfs directories" alt="" coords="835,460,1026,487"/><area shape="rect" id="node45" href="../../d6/da2/group__tcmi__migman__class.html#ga5b56a5213e9dbcba9973b9530692fd27" title="&lt;&lt;private&gt;&gt; Unregisters and releases all control files." alt="" coords="849,511,1012,553"/><area shape="rect" id="node47" href="../../d6/da2/group__tcmi__migman__class.html#gae4ad418d705edeca23e38eb383343978" title="&lt;&lt;private&gt;&gt; The TCMI manager listening thread is to be terminated by forcing a signal and waiting for..." alt="" coords="843,359,1018,385"/><area shape="rect" id="node48" href="../../d6/da2/group__tcmi__migman__class.html#ga71f49cd0661e81a859daab82ae7676de" title="Removes migman from a list of migration managers of the associated manager." alt="" coords="856,679,1005,705"/><area shape="rect" id="node49" href="../../d3/d7e/group__tcmi__sock__class.html#gaa64951d80cedfaf76bb82ee811255d69" title="&lt;&lt;public&gt;&gt; Decrements the reference counter and if it reaches 0, the instance." alt="" coords="877,409,984,436"/><area shape="rect" id="node46" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gaead344003750e43cb4a0326876a191bc" title="&lt;&lt;public&gt;&gt; This method unregisters the file and allows the user to specify the preferred way of unreg..." alt="" coords="1075,527,1247,553"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun May 12 2013 18:47:01 for Clondike by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
