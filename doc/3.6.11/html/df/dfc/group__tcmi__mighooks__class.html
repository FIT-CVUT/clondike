<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Clondike: tcmi_mighooks class</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Clondike
   </div>
   <div id="projectbrief">Supported to Linux kernel 3.6.11</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('df/dfc/group__tcmi__mighooks__class.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">tcmi_mighooks class<div class="ingroups"><a class="el" href="../../d4/d99/group__tcmi__migration__group.html">migration</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>A &lt;&lt;singleton&gt;&gt; class that installs migration hooks into the kernel.  
<a href="#details">More...</a></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for tcmi_mighooks class:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<center><table><tr><td><img src="../../df/dfc/group__tcmi__mighooks__class.png" border="0" alt="" usemap="#df_2dfc_2group____tcmi____mighooks____class"/>
<map name="df_2dfc_2group____tcmi____mighooks____class" id="df_2dfc_2group____tcmi____mighooks____class">
<area shape="rect" id="node1" href="../../d4/d99/group__tcmi__migration__group.html" title="Classes in this group are responsible migration control in the infrastructure." alt="" coords="5,5,80,32"/></map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaa0601a7d19329d21b4257278c16357e0"><td class="memItemLeft" align="right" valign="top">static long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dfc/group__tcmi__mighooks__class.html#gaa0601a7d19329d21b4257278c16357e0">tcmi_mighooks_do_exit</a> (long code)</td></tr>
<tr class="memdesc:gaa0601a7d19329d21b4257278c16357e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Exit system call hook.  <a href="#gaa0601a7d19329d21b4257278c16357e0">More...</a><br/></td></tr>
<tr class="separator:gaa0601a7d19329d21b4257278c16357e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf99c6402f3cf1ac0b25d9c396cd33e48"><td class="memItemLeft" align="right" valign="top">static long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dfc/group__tcmi__mighooks__class.html#gaf99c6402f3cf1ac0b25d9c396cd33e48">tcmi_mighooks_mig_mode</a> (struct pt_regs *regs)</td></tr>
<tr class="memdesc:gaf99c6402f3cf1ac0b25d9c396cd33e48"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; This hook is called upon SIGUNUSED delivery to a particular process.  <a href="#gaf99c6402f3cf1ac0b25d9c396cd33e48">More...</a><br/></td></tr>
<tr class="separator:gaf99c6402f3cf1ac0b25d9c396cd33e48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad2ecd15466a7569be6030ee4a59ac3dc"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dfc/group__tcmi__mighooks__class.html#gad2ecd15466a7569be6030ee4a59ac3dc">tcmi_try_npm_on_exec</a> (const char *filename, const char __user *const __user *argv, const char __user *const __user *<a class="el" href="../../d9/d10/tcmi__npm__params_8h.html#aeebc47a01a74a156c1843bcc37b2bd02">envp</a>, struct pt_regs *regs, struct <a class="el" href="../../d6/de0/group__tcmi__man__class.html#da/d15/structtcmi__man">tcmi_man</a> *man, int is_guest)</td></tr>
<tr class="separator:gad2ecd15466a7569be6030ee4a59ac3dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga976d4842862f35103b7a2844f8a73e7c"><td class="memItemLeft" align="right" valign="top">static long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dfc/group__tcmi__mighooks__class.html#ga976d4842862f35103b7a2844f8a73e7c">tcmi_mighooks_execve</a> (const char *filename, const char __user *const __user *argv, const char __user *const __user *<a class="el" href="../../d9/d10/tcmi__npm__params_8h.html#aeebc47a01a74a156c1843bcc37b2bd02">envp</a>, struct pt_regs *regs)</td></tr>
<tr class="separator:ga976d4842862f35103b7a2844f8a73e7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacba0b88eda0371f2be5be630a8ac24a0"><td class="memItemLeft" align="right" valign="top">static long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dfc/group__tcmi__mighooks__class.html#gacba0b88eda0371f2be5be630a8ac24a0">tcmi_mighooks_replace_proc_self_file</a> (const char *filename, const char **result)</td></tr>
<tr class="separator:gacba0b88eda0371f2be5be630a8ac24a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga705196ddd4c33752e6b4950899d17d84"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dfc/group__tcmi__mighooks__class.html#ga705196ddd4c33752e6b4950899d17d84">tcmi_mighooks_init</a> (void)</td></tr>
<tr class="memdesc:ga705196ddd4c33752e6b4950899d17d84"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Registers all hooks with the kernel.  <a href="#ga705196ddd4c33752e6b4950899d17d84">More...</a><br/></td></tr>
<tr class="separator:ga705196ddd4c33752e6b4950899d17d84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga98946c2d33eafff9d4a992eae05a3ad4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dfc/group__tcmi__mighooks__class.html#ga98946c2d33eafff9d4a992eae05a3ad4">tcmi_mighooks_exit</a> (void)</td></tr>
<tr class="memdesc:ga98946c2d33eafff9d4a992eae05a3ad4"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Unregisters all hooks.  <a href="#ga98946c2d33eafff9d4a992eae05a3ad4">More...</a><br/></td></tr>
<tr class="separator:ga98946c2d33eafff9d4a992eae05a3ad4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>A &lt;&lt;singleton&gt;&gt; class that installs migration hooks into the kernel. </p>
<p>Currently the hooks cover:</p>
<ul>
<li><a class="el" href="../../df/dfc/group__tcmi__mighooks__class.html#gaf99c6402f3cf1ac0b25d9c396cd33e48">migration mode callback </a></li>
<li><a class="el" href="../../df/dfc/group__tcmi__mighooks__class.html#gaa0601a7d19329d21b4257278c16357e0">exit system call hook </a> </li>
</ul>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gaa0601a7d19329d21b4257278c16357e0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static long tcmi_mighooks_do_exit </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>code</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Exit system call hook. </p>
<p>Delegates work to the task helper that notifies current process by submitting a task_exit method and supplying the exit code. The task handles the rest on its own.</p>
<p>The priority notification is used, so that the exit follows immediately.</p>
<p>This hook is called for every process in the system, but does something only for TCMI tasks.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">code</td><td>- process exit code </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- status of how the notification went. </dd></dl>

<p>Definition at line <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html#l00135">135</a> of file <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html">tcmi_mighooks.c</a>.</p>

<p>References <a class="el" href="../../d8/d87/director_8c_source.html#l00096">director_task_exit()</a>, <a class="el" href="../../d0/dc1/proxyfs__server_8c_source.html#l00325">proxyfs_server_release_all()</a>, <a class="el" href="../../d5/d77/proxyfs__helper_8h_source.html#l00209">proxyfs_sync_files_on_exit()</a>, <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00637">tcmi_task_exit()</a>, and <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00574">tcmi_taskhelper_notify_current()</a>.</p>

<p>Referenced by <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html#l00058">tcmi_mighooks_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;{</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordtype">int</span> prio = 1, is_shadow;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keyword">struct </span>rusage rusage;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    mm_segment_t old_fs;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordtype">long</span> res;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    is_shadow = (current-&gt;tcmi.task_type == shadow || current-&gt;tcmi.task_type == shadow_detached);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    old_fs = get_fs();</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    set_fs(get_ds());</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    res = getrusage(current, RUSAGE_SELF, &amp;rusage);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    set_fs(old_fs);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="../../d8/d87/director_8c.html#afc6e7c293f7c2ac0d34c2937058fe734" title="Called, when a task exits.">director_task_exit</a>(current-&gt;pid, code, &amp;rusage);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    res = <a class="code" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga7421f53cc8c717b52a92daaac326f81d" title="&lt;&lt;public&gt;&gt; current process notification - submission of a method.">tcmi_taskhelper_notify_current</a>(<a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga724d575729c5a3f2be09db7ee6833999" title="&lt;&lt;public&gt;&gt; Called from method queue - Exits a task.">tcmi_task_exit</a>, &amp;code, </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                          <span class="keyword">sizeof</span>(code), prio);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">if</span> ( is_shadow ) { <span class="comment">// If the exitting task is a shadow task, we release all its proxy files as they won&#39;t be needed</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <a class="code" href="../../d5/d77/proxyfs__helper_8h.html#a9c20f5bd7542a43136e9ac435aa9dee5" title="Synchronizes all files open by &quot;current&quot; process.">proxyfs_sync_files_on_exit</a>(); <span class="comment">// We have to synchronize all files first so that no new writes occur after server release</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <a class="code" href="../../db/d78/group__proxyfs__server__class.html#ga77d912a797d8b74f05bda041fa8c489a" title="&lt;&lt;public&gt;&gt; &lt;&lt;exported&gt;&gt; Release all files taken from current proccess">proxyfs_server_release_all</a>();</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../df/dfc/group__tcmi__mighooks__class_gaa0601a7d19329d21b4257278c16357e0_cgraph.png" border="0" usemap="#df/dfc/group__tcmi__mighooks__class_gaa0601a7d19329d21b4257278c16357e0_cgraph" alt=""/></div>
<map name="df/dfc/group__tcmi__mighooks__class_gaa0601a7d19329d21b4257278c16357e0_cgraph" id="df/dfc/group__tcmi__mighooks__class_gaa0601a7d19329d21b4257278c16357e0_cgraph">
<area shape="rect" id="node2" href="../../d8/d87/director_8c.html#afc6e7c293f7c2ac0d34c2937058fe734" title="Called, when a task exits." alt="" coords="239,115,364,141"/><area shape="rect" id="node15" href="../../db/d78/group__proxyfs__server__class.html#ga77d912a797d8b74f05bda041fa8c489a" title="&lt;&lt;public&gt;&gt; &lt;&lt;exported&gt;&gt; Release all files taken from current proccess" alt="" coords="214,199,389,225"/><area shape="rect" id="node19" href="../../d5/d77/proxyfs__helper_8h.html#a9c20f5bd7542a43136e9ac435aa9dee5" title="Synchronizes all files open by &quot;current&quot; process." alt="" coords="237,250,366,291"/><area shape="rect" id="node20" href="../../de/d2f/group__tcmi__task__class.html#ga724d575729c5a3f2be09db7ee6833999" title="&lt;&lt;public&gt;&gt; Called from method queue &#45; Exits a task." alt="" coords="248,316,355,343"/><area shape="rect" id="node22" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga7421f53cc8c717b52a92daaac326f81d" title="&lt;&lt;public&gt;&gt; current process notification &#45; submission of a method." alt="" coords="225,426,377,467"/><area shape="rect" id="node3" href="../../d7/d92/task__exitted__msg_8c.html#aef5439b226c48e8ca2e8c4a1b90dd9fc" title="Called, when a task exits." alt="" coords="481,81,575,108"/><area shape="rect" id="node4" href="../../d9/df4/comm_8c.html#af68cf85dec3fb86013cb79568bb30026" title="Performs a netlink transaction." alt="" coords="687,81,825,108"/><area shape="rect" id="node5" href="../../d9/df4/comm_8c.html#ab708cd00ae28bb68e7a53b6784f6f937" title="Helper method to create&amp;send request." alt="" coords="899,132,1067,159"/><area shape="rect" id="node11" href="../../d9/df4/comm_8c.html#a66ea56ce29053fb1d9ab6d337429652d" title="msg_transaction_response" alt="" coords="893,56,1072,83"/><area shape="rect" id="node6" href="../../d8/d7c/genl__ext_8c.html#ac461d0210fcfe8dde0588f23aebf9aab" title="genlmsg_unicast_tx &#45; wrapper around generic netlink unicast." alt="" coords="1132,107,1271,133"/><area shape="rect" id="node9" href="../../d9/df4/comm_8c.html#a4559dadd35469f8de48ab278303e40a0" title="Returns unique sequence number for transaction." alt="" coords="1145,157,1258,184"/><area shape="rect" id="node10" href="../../d9/df4/comm_8c.html#a5f190e32af9d5c630100bee151c00717" title="Returns pid of director process if there is user&#45;space director connected, 0 otherwise." alt="" coords="1127,208,1276,235"/><area shape="rect" id="node7" href="../../d8/d7c/genl__ext_8c.html#ad7afbee4ce89bce50e383aa7b2cce80c" title="genl_ext_lock" alt="" coords="1338,107,1441,133"/><area shape="rect" id="node8" href="../../d8/d7c/genl__ext_8c.html#a9ea9dfe0b2ad73e1306c736e66755b1d" title="genl_ext_unlock" alt="" coords="1331,56,1447,83"/><area shape="rect" id="node12" href="../../d9/df4/comm_8c.html#ae2479089f7107aec24a9c89a13101d0d" title="Checks, if the transaction returned an error." alt="" coords="1146,5,1257,32"/><area shape="rect" id="node13" href="../../d8/d7c/genl__ext_8c.html#a98fc505709c73b6933abbacd5a656cb9" title="Blocking read call that will read netlink response for the specified transaction." alt="" coords="1120,56,1283,83"/><area shape="rect" id="node14" href="../../d8/d7c/genl__ext_8c.html#a96c79abdde8010527de40d4806b4942c" title="__find_itx" alt="" coords="1351,5,1428,32"/><area shape="rect" id="node16" href="../../d5/d89/proxyfs__real__file_8c.html#a563d038976ae96214d0f9fcbafb94d8b" title="&lt;&lt;public&gt;&gt; Removes shadow task from a shadow list of the file" alt="" coords="447,133,609,174"/><area shape="rect" id="node17" href="../../d1/d14/group__proxyfs__file__class.html#ga09bf2c02a87032c44fd9872fa157bf8e" title="&lt;&lt;public&gt;&gt; Set file status" alt="" coords="451,199,605,225"/><area shape="rect" id="node18" href="../../d1/d14/group__proxyfs__file__class.html#ga98106c38478a4df7b861052d341a0578" title="&lt;&lt;public&gt;&gt; Get file identifier" alt="" coords="461,250,595,291"/><area shape="rect" id="node21" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#gaaf4d02eac4338a675bd5ed2df9943c97" title="&lt;&lt;public&gt;&gt; Accessor for the data stored in the method wrapper." alt="" coords="437,316,619,343"/><area shape="rect" id="node23" href="../../de/d2f/group__tcmi__task__class.html#ga2bf62635c09738ef0c1385ea258bec2f" title="&lt;&lt;public&gt;&gt; Flushes all pending methods in the queue submits a method for execution." alt="" coords="457,367,599,409"/><area shape="rect" id="node30" href="../../de/d2f/group__tcmi__task__class.html#ga0409e631915b37fbcfe096dfc498bbbb" title="&lt;&lt;public&gt;&gt; Submits a method for execution." alt="" coords="441,433,615,460"/><area shape="rect" id="node31" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga2420f9c7c246746d3bbc87578357338f" title="&lt;&lt;public&gt;&gt; This method is registered by CCN or PEN component as the SIGUNUSED signal handler..." alt="" coords="461,535,595,577"/><area shape="rect" id="node33" href="../../de/d2f/group__tcmi__task__class.html#gade1e8f7b12614ca0fecbc40aaae9a6c5" title="&lt;&lt;public&gt;&gt; Process context accessor." alt="" coords="463,484,593,511"/><area shape="rect" id="node24" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#ga57cd57a64f1ec847f1b71452daf4b3b1" title="&lt;&lt;public&gt;&gt; Creates a new wrapper for the specified method." alt="" coords="667,476,845,503"/><area shape="rect" id="node25" href="../../dc/d0c/group__tcmi__queue__class.html#ga3ae4d7e0a4d5d21ec8b9fff138f5b0d4" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="696,375,816,401"/><area shape="rect" id="node26" href="../../dc/d0c/group__tcmi__queue__class.html#ga2b0f1376bcd561196e77599cbc23090f" title="tcmi_queue_empty" alt="" coords="690,425,822,452"/><area shape="rect" id="node27" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#gad93018cc0894a434a94703eed0f869f9" title="&lt;&lt;public&gt;&gt; Decrements the reference counter, when the count reaches 0, the instance is destroyed..." alt="" coords="669,223,843,249"/><area shape="rect" id="node28" href="../../dc/d0c/group__tcmi__queue__class.html#ga40921ea3b077d55d70fb7b94ac666292" title="&lt;&lt;public&gt;&gt; Adds an element to the queue &#45; lock free version, assumes the lock is already held..." alt="" coords="691,273,821,300"/><area shape="rect" id="node29" href="../../dc/d0c/group__tcmi__queue__class.html#ga2e0e25eec1d5e4ea6e89dfde81ed43f4" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="689,324,823,351"/><area shape="rect" id="node32" href="../../de/d2f/group__tcmi__task__class.html#gabc853647b7b732333c5909e617030f44" title="&lt;&lt;public&gt;&gt; Process context setter." alt="" coords="679,543,833,569"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga976d4842862f35103b7a2844f8a73e7c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static long tcmi_mighooks_execve </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char __user *const __user *&#160;</td>
          <td class="paramname"><em>argv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char __user *const __user *&#160;</td>
          <td class="paramname"><em>envp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct pt_regs *&#160;</td>
          <td class="paramname"><em>regs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html#l00215">215</a> of file <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html">tcmi_mighooks.c</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00210">mdbg</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00146">tcmi_task::remote_pid</a>, <a class="el" href="../../df/db0/tcmi__man_8h_source.html#l00151">TCMI_MAN</a>, <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00212">tcmi_msg_put()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00529">tcmi_task_get_execve_count()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00624">tcmi_task_get_type()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00535">tcmi_task_inc_execve_count()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00524">tcmi_task_send_anonymous_msg()</a>, <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html#l00177">tcmi_try_npm_on_exec()</a>, and <a class="el" href="../../d2/d89/tcmi__vfork__done__procmsg_8c_source.html#l00064">tcmi_vfork_done_procmsg_new_tx()</a>.</p>

<p>Referenced by <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html#l00058">tcmi_mighooks_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                                                                                                                                                               {    </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">if</span> ( !current-&gt;tcmi.tcmi_task ) {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="comment">/* The task is not controlled by clondike =&gt; we can non-preemptively migrate it ONLY if there is CCN registered on current node */</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keyword">struct </span>tcmi_ccnman* ccn_man = tcmi_ccnman_get_instance();</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO4, <span class="stringliteral">&quot;DEBUG TCMI_TASK NOT SET&quot;</span>);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">if</span> ( ccn_man != NULL )</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <a class="code" href="../../df/dfc/group__tcmi__mighooks__class.html#gad2ecd15466a7569be6030ee4a59ac3dc">tcmi_try_npm_on_exec</a>(filename, argv, <a class="code" href="../../d9/d10/tcmi__npm__params_8h.html#aeebc47a01a74a156c1843bcc37b2bd02">envp</a>, regs, <a class="code" href="../../d6/de0/group__tcmi__man__class.html#gaa817e26a29c1f89a28677a955a0e66d0" title="Casts to the TCMI manager.">TCMI_MAN</a>(ccn_man), 0);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga68c818baf665eed96e9e0b277c599d36" title="&lt;&lt;public&gt;&gt; Get task type">tcmi_task_get_type</a>(current-&gt;tcmi.tcmi_task) == guest ) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO4, <span class="stringliteral">&quot;DEBUG TCMI_TASK == QUEST&quot;</span>);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="comment">// We allow npm only after we get initial execve executed.. not during the initial image load!</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga01d55ac246026189ab497ec974bc75f8">tcmi_task_get_execve_count</a>(current-&gt;tcmi.tcmi_task) &gt; 1 ) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="comment">// Task is guest, so DN has to take care of its possible NPM</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <span class="keyword">struct </span>tcmi_penman* pen_man = tcmi_penman_get_instance();</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Guest exec hook called. File %s&quot;</span>, filename);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <a class="code" href="../../df/dfc/group__tcmi__mighooks__class.html#gad2ecd15466a7569be6030ee4a59ac3dc">tcmi_try_npm_on_exec</a>(filename, argv, <a class="code" href="../../d9/d10/tcmi__npm__params_8h.html#aeebc47a01a74a156c1843bcc37b2bd02">envp</a>, regs, <a class="code" href="../../d6/de0/group__tcmi__man__class.html#gaa817e26a29c1f89a28677a955a0e66d0" title="Casts to the TCMI manager.">TCMI_MAN</a>(pen_man), 1);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="comment">/* On first exceve, we notify about possible vfork done</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">             TODO: We may optimize this, and notify only in case it is required.. this would require some flag in tcmi_task, that would be caried here during emigration */</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="keyword">struct </span><a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg" title="A coumpound structure that carries a generic TCMI message.">tcmi_msg</a> *m;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <span class="comment">/* We do not aquire reference to t_task as it cannot be release at this moment*/</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            <span class="keyword">struct </span><a class="code" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task" title="Compound structure that gathers necessary process information.">tcmi_task</a>* t_task = current-&gt;tcmi.tcmi_task;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="keywordflow">if</span> ( !t_task) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;No tcmi task associated!&quot;</span>);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">if</span> (!(m = <a class="code" href="../../d3/d4b/group__tcmi__vfork__done__procmsg__class.html#ga502b49c01d4849914e5c30411b601426" title="&lt;&gt;&gt; vfork_done message tx constructor.">tcmi_vfork_done_procmsg_new_tx</a>(t_task-&gt;<a class="code" href="../../de/d2f/group__tcmi__task__class.html#a071b7d4b1e2f24e055b643810a97570c" title="remote PID on PEN, CCN resp.">remote_pid</a>))) {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Can&#39;t create vfork done message&quot;</span>);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                <span class="comment">// TODO: What to do in this case? ;) For now we just ignore it.</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga4e660ea948542a5a057e25640a762efc" title="&lt;&lt;public&gt;&gt; Sends a specified message.">tcmi_task_send_anonymous_msg</a>(t_task, m);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined...">tcmi_msg_put</a>(m);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            exit0:</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            ;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga1483e4662ef7df7f603ea607b3291de3">tcmi_task_inc_execve_count</a>(current-&gt;tcmi.tcmi_task);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO4, <span class="stringliteral">&quot;DEBUG TASK OTHER&quot;</span>);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="comment">// We are shadow task =&gt; ignore this hook, shadow execves only when restarting process that was migrated back</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga1483e4662ef7df7f603ea607b3291de3">tcmi_task_inc_execve_count</a>(current-&gt;tcmi.tcmi_task);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;};</div>
</div><!-- fragment -->
<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../df/dfc/group__tcmi__mighooks__class_ga976d4842862f35103b7a2844f8a73e7c_cgraph.png" border="0" usemap="#df/dfc/group__tcmi__mighooks__class_ga976d4842862f35103b7a2844f8a73e7c_cgraph" alt=""/></div>
<map name="df/dfc/group__tcmi__mighooks__class_ga976d4842862f35103b7a2844f8a73e7c_cgraph" id="df/dfc/group__tcmi__mighooks__class_ga976d4842862f35103b7a2844f8a73e7c_cgraph">
<area shape="rect" id="node2" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined..." alt="" coords="269,767,373,793"/><area shape="rect" id="node11" href="../../de/d2f/group__tcmi__task__class.html#ga01d55ac246026189ab497ec974bc75f8" title="tcmi_task_get_execve\l_count" alt="" coords="246,885,397,926"/><area shape="rect" id="node12" href="../../de/d2f/group__tcmi__task__class.html#ga68c818baf665eed96e9e0b277c599d36" title="&lt;&lt;public&gt;&gt; Get task type" alt="" coords="253,951,389,977"/><area shape="rect" id="node13" href="../../de/d2f/group__tcmi__task__class.html#ga1483e4662ef7df7f603ea607b3291de3" title="tcmi_task_inc_execve\l_count" alt="" coords="246,1002,397,1043"/><area shape="rect" id="node14" href="../../de/d2f/group__tcmi__task__class.html#ga4e660ea948542a5a057e25640a762efc" title="&lt;&lt;public&gt;&gt; Sends a specified message." alt="" coords="211,1069,431,1096"/><area shape="rect" id="node21" href="../../df/dfc/group__tcmi__mighooks__class.html#gad2ecd15466a7569be6030ee4a59ac3dc" title="tcmi_try_npm_on_exec" alt="" coords="243,361,400,388"/><area shape="rect" id="node46" href="../../d3/d4b/group__tcmi__vfork__done__procmsg__class.html#ga502b49c01d4849914e5c30411b601426" title="&lt;&gt;&gt; vfork_done message tx constructor." alt="" coords="235,819,407,861"/><area shape="rect" id="node3" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2748d267a8fddd1ced86e73ba8efd079" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="514,767,657,793"/><area shape="rect" id="node4" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="771,716,896,743"/><area shape="rect" id="node5" href="../../d4/d8c/group__tcmi__transaction__class.html#gaac666feaaab1fe5c341237a3e0283501" title="&lt;&lt;public&gt;&gt; Transaction ID accessor." alt="" coords="1235,868,1370,895"/><area shape="rect" id="node6" href="../../da/d0c/group__tcmi__slot__class.html#ga1d6232adcf00094597a66d9f5740d5f8" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="772,767,895,793"/><area shape="rect" id="node10" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="764,665,903,692"/><area shape="rect" id="node7" href="../../da/d0c/group__tcmi__slot__class.html#ga29d8101c5815a6519567c548da4a3c7e" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="1013,716,1150,743"/><area shape="rect" id="node8" href="../../da/d0c/group__tcmi__slot__class.html#ga109d6d783ebf06046f364f970f84da1f" title="&lt;&lt;public&gt;&gt; Locks the slot data." alt="" coords="1028,767,1135,793"/><area shape="rect" id="node9" href="../../da/d0c/group__tcmi__slot__class.html#ga5447231fec5f42040c40307eb2e6a13c" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="1021,665,1141,692"/><area shape="rect" id="node15" href="../../d6/dc2/group__tcmi__msg__class.html#ga7a8fe8cbfd4b25c15589c8599f66e574" title="&lt;&lt;public&gt;&gt; Sends a message via a specified connection." alt="" coords="491,1071,679,1097"/><area shape="rect" id="node16" href="../../d6/dc2/group__tcmi__msg__class.html#ga1c21eeafb9a0d56dabb025d5fbdc0bc3" title="&lt;&lt;private&gt;&gt; Sends a message via a specified connection." alt="" coords="776,1071,891,1097"/><area shape="rect" id="node17" href="../../d6/d8e/group__kkc__sock__class.html#gad734b131e2ab00e8d7fa30737fc2f5ad" title="&lt;&lt;public&gt;&gt; Sends out specified data." alt="" coords="1025,1020,1138,1047"/><area shape="rect" id="node18" href="../../d6/d8e/group__kkc__sock__class.html#ga141590d302ece9990e5c8cdd82a3c3d8" title="&lt;&lt;public&gt;&gt; Locks this socket instance for sending, interruptible version, the process can be woken up..." alt="" coords="976,1071,1187,1097"/><area shape="rect" id="node19" href="../../d6/d8e/group__kkc__sock__class.html#ga841d6dff84842f19540eae27c37fcb4c" title="&lt;&lt;public&gt;&gt; Unlocks this socket instance for sending." alt="" coords="1006,1121,1157,1148"/><area shape="rect" id="node20" href="../../d4/d8c/group__tcmi__transaction__class.html#ga653b1761a1b6e9fef415196c54e00768" title="&lt;&lt;public&gt;&gt; Starts a transaction." alt="" coords="1006,1172,1157,1199"/><area shape="rect" id="node22" href="../../d8/d87/director_8c.html#a3b8becf6124d1c7caac6852db26fd35a" title="This is the main entry point that can be used by TCMI when it needs to consult user space director..." alt="" coords="516,260,655,287"/><area shape="rect" id="node26" href="../../d4/d2b/tcmi__npm__params_8c.html#ab1d544d6e06fd85777cebc9ae696c232" title="Extracts npm params from user space passed params to a tcmi structure." alt="" coords="497,361,673,388"/><area shape="rect" id="node31" href="../../db/d61/group__tcmi__penman__class.html#gaaa68e5e6c390896f63d1734204b6e191" title="Performs non&#45;preemtive migration back from PEN." alt="" coords="480,117,691,144"/><area shape="rect" id="node40" href="../../d6/de0/group__tcmi__man__class.html#gaddba35e06a4eda99450d72288234ad14" title="&lt;&lt;public&gt;&gt; Method that performs non&#45;preemtive migration" alt="" coords="512,564,659,591"/><area shape="rect" id="node23" href="../../d3/de8/npm__msg_8c.html#a1d1a4b7c77f49fcc1abe3a9af5634a75" title="Checks, whether the process should be non&#45;preemptively migrated to some other node." alt="" coords="789,260,878,287"/><area shape="rect" id="node25" href="../../d3/de8/npm__msg_8c.html#aefde13528ad7f58da2120234e1634ba4" title="Checks, whether the process should be non&#45;preemptively migrated to some other node." alt="" coords="777,209,889,236"/><area shape="rect" id="node24" href="../../d9/df4/comm_8c.html#af68cf85dec3fb86013cb79568bb30026" title="Performs a netlink transaction." alt="" coords="1012,260,1151,287"/><area shape="rect" id="node27" href="../../d4/d2b/tcmi__npm__params_8c.html#ac7528a4145b8d2ff990416773558d082" title="copy_strings" alt="" coords="785,361,881,388"/><area shape="rect" id="node29" href="../../d4/d2b/tcmi__npm__params_8c.html#af64f4ee0104b701e4f843c457b77e14c" title="count" alt="" coords="806,412,861,439"/><area shape="rect" id="node30" href="../../d9/d10/tcmi__npm__params_8h.html#a091259df2d963061baac4e12b9bf0e6d" title="Given a npm params structure, this method will fixup args and envp pointers to point to correct place..." alt="" coords="741,311,925,337"/><area shape="rect" id="node28" href="../../d9/d10/tcmi__npm__params_8h.html#a666e66daab3a643c4271a70428b25390" title="UGLY UGLY! Following 2 funcs would ideally not be in a header." alt="" coords="1011,336,1152,363"/><area shape="rect" id="node32" href="../../de/d2f/group__tcmi__task__class.html#ga0409e631915b37fbcfe096dfc498bbbb" title="&lt;&lt;public&gt;&gt; Submits a method for execution." alt="" coords="746,81,921,108"/><area shape="rect" id="node34" href="../../de/d2f/group__tcmi__task__class.html#gad0cec9fea3d6f19f8d9c903a97fba347" title="&lt;&lt;public&gt;&gt; Called from method queue &#45; Migrates a task back to CCN &#45; NPM." alt="" coords="739,153,928,180"/><area shape="rect" id="node38" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga2420f9c7c246746d3bbc87578357338f" title="&lt;&lt;public&gt;&gt; This method is registered by CCN or PEN component as the SIGUNUSED signal handler..." alt="" coords="766,5,901,46"/><area shape="rect" id="node33" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#ga57cd57a64f1ec847f1b71452daf4b3b1" title="&lt;&lt;public&gt;&gt; Creates a new wrapper for the specified method." alt="" coords="992,57,1171,84"/><area shape="rect" id="node35" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#gaaf4d02eac4338a675bd5ed2df9943c97" title="&lt;&lt;public&gt;&gt; Accessor for the data stored in the method wrapper." alt="" coords="991,209,1172,236"/><area shape="rect" id="node36" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="1013,108,1150,135"/><area shape="rect" id="node37" href="../../de/d2f/group__tcmi__task__class.html#ga2f054ae4772c0921004eebdb48d39dcf" title="&lt;&lt;public&gt;&gt; Remote PID accessor." alt="" coords="1006,159,1157,185"/><area shape="rect" id="node39" href="../../de/d2f/group__tcmi__task__class.html#gabc853647b7b732333c5909e617030f44" title="&lt;&lt;public&gt;&gt; Process context setter." alt="" coords="1004,7,1159,33"/><area shape="rect" id="node41" href="../../d6/da2/group__tcmi__migman__class.html#gacd13117046ccc1fa12ac743b893fcfca" title="&lt;&lt;public&gt;&gt; Instance accessor, increments the reference counter." alt="" coords="771,564,896,591"/><area shape="rect" id="node42" href="../../d6/da2/group__tcmi__migman__class.html#gab536c262c24d8fc76cdbdfa8d6d65b81" title="&lt;&lt;public&gt;&gt; The manager is shutdown exactly in this order:" alt="" coords="771,463,896,489"/><area shape="rect" id="node44" href="../../da/d0c/group__tcmi__slot__class.html#ga821f6b686443bfc7fff52dd3b155de37" title="&lt;&lt;public&gt;&gt; Slot index accessor." alt="" coords="777,615,890,641"/><area shape="rect" id="node45" href="../../d0/db7/group__tcmi__slotvec__class.html#ga876670f605631a5deb930412dae02b28" title="&lt;&lt;public&gt;&gt; Accesses a slot at a given index." alt="" coords="777,513,889,540"/><area shape="rect" id="node43" href="../../d6/da2/group__tcmi__migman__class.html#ga94df994d6d2ad3dd9aa6543ee67bf934" title="&lt;&lt;private&gt;&gt; Free method is has two purposes:when the last reference is released, it will free all ins..." alt="" coords="1017,463,1145,489"/><area shape="rect" id="node47" href="../../d7/dc8/group__tcmi__procmsg__class.html#gaa22b26ec117d20a804758f501e9d3e59" title="&lt;&lt;public&gt;&gt; Initializes the message for transferring." alt="" coords="512,851,659,877"/><area shape="rect" id="node48" href="../../d6/dc2/group__tcmi__msg__class.html#gace79df438ec4f7c8f7cee3bfe42f6d93" title="&lt;&lt;public&gt;&gt; Initializes the message for transferring." alt="" coords="773,896,894,923"/><area shape="rect" id="node49" href="../../db/dc8/tcmi__msg_8c.html#a5c394462e393c496f11d949b265b8a9e" title="Shared initialization fuction of both rx and tx messages." alt="" coords="1007,969,1156,996"/><area shape="rect" id="node50" href="../../d4/d8c/group__tcmi__transaction__class.html#gada9d9436def8919a10997233cd6b5ea1" title="&lt;&lt;public&gt;&gt; Creates a new transaction." alt="" coords="1007,919,1155,945"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga98946c2d33eafff9d4a992eae05a3ad4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tcmi_mighooks_exit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Unregisters all hooks. </p>

<p>Definition at line <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html#l00071">71</a> of file <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html">tcmi_mighooks.c</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00211">minfo</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d0f/tcmi__module_8c_source.html#l00168">tcmi_module_exit()</a>.</p>
<div class="fragment"><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;{</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="../../d6/d01/dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(INFO1, <span class="stringliteral">&quot;Unregistering TCMI migration hooks&quot;</span>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    tcmi_hooks_unregister_exit();</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    tcmi_hooks_unregister_sig_unused();</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    tcmi_hooks_unregister_execve();</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    tcmi_hooks_unregister_replace_proc_self_file();</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga705196ddd4c33752e6b4950899d17d84"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tcmi_mighooks_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Registers all hooks with the kernel. </p>
<dl class="section return"><dt>Returns</dt><dd>0 upon success </dd></dl>

<p>Definition at line <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html#l00058">58</a> of file <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html">tcmi_mighooks.c</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00211">minfo</a>, <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html#l00135">tcmi_mighooks_do_exit()</a>, <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html#l00215">tcmi_mighooks_execve()</a>, <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html#l00171">tcmi_mighooks_mig_mode()</a>, and <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html#l00269">tcmi_mighooks_replace_proc_self_file()</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d0f/tcmi__module_8c_source.html#l00122">tcmi_module_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;{</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="../../d6/d01/dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(INFO1, <span class="stringliteral">&quot;Registering TCMI migration hooks&quot;</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    tcmi_hooks_register_exit(<a class="code" href="../../df/dfc/group__tcmi__mighooks__class.html#gaa0601a7d19329d21b4257278c16357e0" title="&lt;&lt;private&gt;&gt; Exit system call hook.">tcmi_mighooks_do_exit</a>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    tcmi_hooks_register_sig_unused(<a class="code" href="../../df/dfc/group__tcmi__mighooks__class.html#gaf99c6402f3cf1ac0b25d9c396cd33e48" title="&lt;&lt;private&gt;&gt; This hook is called upon SIGUNUSED delivery to a particular process.">tcmi_mighooks_mig_mode</a>);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    tcmi_hooks_register_execve(<a class="code" href="../../df/dfc/group__tcmi__mighooks__class.html#ga976d4842862f35103b7a2844f8a73e7c">tcmi_mighooks_execve</a>);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    tcmi_hooks_register_replace_proc_self_file(<a class="code" href="../../df/dfc/group__tcmi__mighooks__class.html#gacba0b88eda0371f2be5be630a8ac24a0">tcmi_mighooks_replace_proc_self_file</a>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../df/dfc/group__tcmi__mighooks__class_ga705196ddd4c33752e6b4950899d17d84_cgraph.png" border="0" usemap="#df/dfc/group__tcmi__mighooks__class_ga705196ddd4c33752e6b4950899d17d84_cgraph" alt=""/></div>
<map name="df/dfc/group__tcmi__mighooks__class_ga705196ddd4c33752e6b4950899d17d84_cgraph" id="df/dfc/group__tcmi__mighooks__class_ga705196ddd4c33752e6b4950899d17d84_cgraph">
<area shape="rect" id="node2" href="../../df/dfc/group__tcmi__mighooks__class.html#gaa0601a7d19329d21b4257278c16357e0" title="&lt;&lt;private&gt;&gt; Exit system call hook." alt="" coords="447,243,606,269"/><area shape="rect" id="node25" href="../../df/dfc/group__tcmi__mighooks__class.html#ga976d4842862f35103b7a2844f8a73e7c" title="tcmi_mighooks_execve" alt="" coords="200,696,357,723"/><area shape="rect" id="node49" href="../../df/dfc/group__tcmi__mighooks__class.html#gaf99c6402f3cf1ac0b25d9c396cd33e48" title="&lt;&lt;private&gt;&gt; This hook is called upon SIGUNUSED delivery to a particular process." alt="" coords="190,583,367,609"/><area shape="rect" id="node50" href="../../df/dfc/group__tcmi__mighooks__class.html#gacba0b88eda0371f2be5be630a8ac24a0" title="tcmi_mighooks_replace\l_proc_self_file" alt="" coords="199,747,358,789"/><area shape="rect" id="node3" href="../../d8/d87/director_8c.html#afc6e7c293f7c2ac0d34c2937058fe734" title="Called, when a task exits." alt="" coords="728,468,853,495"/><area shape="rect" id="node6" href="../../db/d78/group__proxyfs__server__class.html#ga77d912a797d8b74f05bda041fa8c489a" title="&lt;&lt;public&gt;&gt; &lt;&lt;exported&gt;&gt; Release all files taken from current proccess" alt="" coords="703,180,878,207"/><area shape="rect" id="node10" href="../../d5/d77/proxyfs__helper_8h.html#a9c20f5bd7542a43136e9ac435aa9dee5" title="Synchronizes all files open by &quot;current&quot; process." alt="" coords="726,63,855,105"/><area shape="rect" id="node11" href="../../de/d2f/group__tcmi__task__class.html#ga724d575729c5a3f2be09db7ee6833999" title="&lt;&lt;public&gt;&gt; Called from method queue &#45; Exits a task." alt="" coords="737,129,844,156"/><area shape="rect" id="node13" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga7421f53cc8c717b52a92daaac326f81d" title="&lt;&lt;public&gt;&gt; current process notification &#45; submission of a method." alt="" coords="715,297,867,338"/><area shape="rect" id="node4" href="../../d7/d92/task__exitted__msg_8c.html#aef5439b226c48e8ca2e8c4a1b90dd9fc" title="Called, when a task exits." alt="" coords="988,472,1081,499"/><area shape="rect" id="node5" href="../../d9/df4/comm_8c.html#af68cf85dec3fb86013cb79568bb30026" title="Performs a netlink transaction." alt="" coords="1193,624,1332,651"/><area shape="rect" id="node7" href="../../d5/d89/proxyfs__real__file_8c.html#a563d038976ae96214d0f9fcbafb94d8b" title="&lt;&lt;public&gt;&gt; Removes shadow task from a shadow list of the file" alt="" coords="953,173,1116,214"/><area shape="rect" id="node8" href="../../d1/d14/group__proxyfs__file__class.html#ga09bf2c02a87032c44fd9872fa157bf8e" title="&lt;&lt;public&gt;&gt; Set file status" alt="" coords="957,56,1112,83"/><area shape="rect" id="node9" href="../../d1/d14/group__proxyfs__file__class.html#ga98106c38478a4df7b861052d341a0578" title="&lt;&lt;public&gt;&gt; Get file identifier" alt="" coords="967,107,1102,149"/><area shape="rect" id="node12" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#gaaf4d02eac4338a675bd5ed2df9943c97" title="&lt;&lt;public&gt;&gt; Accessor for the data stored in the method wrapper." alt="" coords="944,5,1125,32"/><area shape="rect" id="node14" href="../../de/d2f/group__tcmi__task__class.html#ga2bf62635c09738ef0c1385ea258bec2f" title="&lt;&lt;public&gt;&gt; Flushes all pending methods in the queue submits a method for execution." alt="" coords="964,238,1105,279"/><area shape="rect" id="node21" href="../../de/d2f/group__tcmi__task__class.html#ga0409e631915b37fbcfe096dfc498bbbb" title="&lt;&lt;public&gt;&gt; Submits a method for execution." alt="" coords="947,355,1122,381"/><area shape="rect" id="node22" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga2420f9c7c246746d3bbc87578357338f" title="&lt;&lt;public&gt;&gt; This method is registered by CCN or PEN component as the SIGUNUSED signal handler..." alt="" coords="967,406,1102,447"/><area shape="rect" id="node24" href="../../de/d2f/group__tcmi__task__class.html#gade1e8f7b12614ca0fecbc40aaae9a6c5" title="&lt;&lt;public&gt;&gt; Process context accessor." alt="" coords="970,304,1099,331"/><area shape="rect" id="node15" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#ga57cd57a64f1ec847f1b71452daf4b3b1" title="&lt;&lt;public&gt;&gt; Creates a new wrapper for the specified method." alt="" coords="1173,355,1352,381"/><area shape="rect" id="node16" href="../../dc/d0c/group__tcmi__queue__class.html#ga3ae4d7e0a4d5d21ec8b9fff138f5b0d4" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="1203,253,1323,280"/><area shape="rect" id="node17" href="../../dc/d0c/group__tcmi__queue__class.html#ga2b0f1376bcd561196e77599cbc23090f" title="tcmi_queue_empty" alt="" coords="1197,304,1329,331"/><area shape="rect" id="node18" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#gad93018cc0894a434a94703eed0f869f9" title="&lt;&lt;public&gt;&gt; Decrements the reference counter, when the count reaches 0, the instance is destroyed..." alt="" coords="1175,101,1350,128"/><area shape="rect" id="node19" href="../../dc/d0c/group__tcmi__queue__class.html#ga40921ea3b077d55d70fb7b94ac666292" title="&lt;&lt;public&gt;&gt; Adds an element to the queue &#45; lock free version, assumes the lock is already held..." alt="" coords="1197,152,1328,179"/><area shape="rect" id="node20" href="../../dc/d0c/group__tcmi__queue__class.html#ga2e0e25eec1d5e4ea6e89dfde81ed43f4" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="1195,203,1330,229"/><area shape="rect" id="node23" href="../../de/d2f/group__tcmi__task__class.html#gabc853647b7b732333c5909e617030f44" title="&lt;&lt;public&gt;&gt; Process context setter." alt="" coords="1185,413,1340,440"/><area shape="rect" id="node26" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined..." alt="" coords="475,872,579,899"/><area shape="rect" id="node32" href="../../de/d2f/group__tcmi__task__class.html#ga01d55ac246026189ab497ec974bc75f8" title="tcmi_task_get_execve\l_count" alt="" coords="451,689,602,730"/><area shape="rect" id="node33" href="../../de/d2f/group__tcmi__task__class.html#ga68c818baf665eed96e9e0b277c599d36" title="&lt;&lt;public&gt;&gt; Get task type" alt="" coords="459,755,595,781"/><area shape="rect" id="node34" href="../../de/d2f/group__tcmi__task__class.html#ga1483e4662ef7df7f603ea607b3291de3" title="tcmi_task_inc_execve\l_count" alt="" coords="451,806,602,847"/><area shape="rect" id="node35" href="../../de/d2f/group__tcmi__task__class.html#ga4e660ea948542a5a057e25640a762efc" title="&lt;&lt;public&gt;&gt; Sends a specified message." alt="" coords="417,925,637,952"/><area shape="rect" id="node38" href="../../df/dfc/group__tcmi__mighooks__class.html#gad2ecd15466a7569be6030ee4a59ac3dc" title="tcmi_try_npm_on_exec" alt="" coords="448,572,605,599"/><area shape="rect" id="node47" href="../../d3/d4b/group__tcmi__vfork__done__procmsg__class.html#ga502b49c01d4849914e5c30411b601426" title="&lt;&gt;&gt; vfork_done message tx constructor." alt="" coords="441,623,613,665"/><area shape="rect" id="node27" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2748d267a8fddd1ced86e73ba8efd079" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="719,827,862,853"/><area shape="rect" id="node28" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="972,776,1097,803"/><area shape="rect" id="node29" href="../../d4/d8c/group__tcmi__transaction__class.html#gaac666feaaab1fe5c341237a3e0283501" title="&lt;&lt;public&gt;&gt; Transaction ID accessor." alt="" coords="967,827,1102,853"/><area shape="rect" id="node30" href="../../da/d0c/group__tcmi__slot__class.html#ga1d6232adcf00094597a66d9f5740d5f8" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="973,877,1096,904"/><area shape="rect" id="node31" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="965,725,1104,752"/><area shape="rect" id="node36" href="../../d6/dc2/group__tcmi__msg__class.html#ga7a8fe8cbfd4b25c15589c8599f66e574" title="&lt;&lt;public&gt;&gt; Sends a message via a specified connection." alt="" coords="697,927,885,953"/><area shape="rect" id="node37" href="../../d6/dc2/group__tcmi__msg__class.html#ga1c21eeafb9a0d56dabb025d5fbdc0bc3" title="&lt;&lt;private&gt;&gt; Sends a message via a specified connection." alt="" coords="977,928,1092,955"/><area shape="rect" id="node39" href="../../d8/d87/director_8c.html#a3b8becf6124d1c7caac6852db26fd35a" title="This is the main entry point that can be used by TCMI when it needs to consult user space director..." alt="" coords="721,624,860,651"/><area shape="rect" id="node42" href="../../d4/d2b/tcmi__npm__params_8c.html#ab1d544d6e06fd85777cebc9ae696c232" title="Extracts npm params from user space passed params to a tcmi structure." alt="" coords="703,572,879,599"/><area shape="rect" id="node45" href="../../db/d61/group__tcmi__penman__class.html#gaaa68e5e6c390896f63d1734204b6e191" title="Performs non&#45;preemtive migration back from PEN." alt="" coords="685,413,896,440"/><area shape="rect" id="node46" href="../../d6/de0/group__tcmi__man__class.html#gaddba35e06a4eda99450d72288234ad14" title="&lt;&lt;public&gt;&gt; Method that performs non&#45;preemtive migration" alt="" coords="717,700,864,727"/><area shape="rect" id="node40" href="../../d3/de8/npm__msg_8c.html#a1d1a4b7c77f49fcc1abe3a9af5634a75" title="Checks, whether the process should be non&#45;preemptively migrated to some other node." alt="" coords="990,675,1079,701"/><area shape="rect" id="node41" href="../../d3/de8/npm__msg_8c.html#aefde13528ad7f58da2120234e1634ba4" title="Checks, whether the process should be non&#45;preemptively migrated to some other node." alt="" coords="979,624,1091,651"/><area shape="rect" id="node43" href="../../d4/d2b/tcmi__npm__params_8c.html#ac7528a4145b8d2ff990416773558d082" title="copy_strings" alt="" coords="987,523,1083,549"/><area shape="rect" id="node44" href="../../d4/d2b/tcmi__npm__params_8c.html#af64f4ee0104b701e4f843c457b77e14c" title="count" alt="" coords="1007,573,1062,600"/><area shape="rect" id="node48" href="../../d7/dc8/group__tcmi__procmsg__class.html#gaa22b26ec117d20a804758f501e9d3e59" title="&lt;&lt;public&gt;&gt; Initializes the message for transferring." alt="" coords="717,751,864,777"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gaf99c6402f3cf1ac0b25d9c396cd33e48"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static long tcmi_mighooks_mig_mode </td>
          <td>(</td>
          <td class="paramtype">struct pt_regs *&#160;</td>
          <td class="paramname"><em>regs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; This hook is called upon SIGUNUSED delivery to a particular process. </p>
<p>All work is delegated to the task helper. The context passed onto the task helper is used for updating the TCMI task. Any potential migration request thus operates on the latest process context.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*regs</td><td>- process context right before entering kernel mode. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html#l00171">171</a> of file <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html">tcmi_mighooks.c</a>.</p>

<p>References <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00547">tcmi_taskhelper_do_mig_mode()</a>.</p>

<p>Referenced by <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html#l00058">tcmi_mighooks_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;{</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga2420f9c7c246746d3bbc87578357338f" title="&lt;&lt;public&gt;&gt; This method is registered by CCN or PEN component as the SIGUNUSED signal handler...">tcmi_taskhelper_do_mig_mode</a>(regs);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../df/dfc/group__tcmi__mighooks__class_gaf99c6402f3cf1ac0b25d9c396cd33e48_cgraph.png" border="0" usemap="#df/dfc/group__tcmi__mighooks__class_gaf99c6402f3cf1ac0b25d9c396cd33e48_cgraph" alt=""/></div>
<map name="df/dfc/group__tcmi__mighooks__class_gaf99c6402f3cf1ac0b25d9c396cd33e48_cgraph" id="df/dfc/group__tcmi__mighooks__class_gaf99c6402f3cf1ac0b25d9c396cd33e48_cgraph">
<area shape="rect" id="node2" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga2420f9c7c246746d3bbc87578357338f" title="&lt;&lt;public&gt;&gt; This method is registered by CCN or PEN component as the SIGUNUSED signal handler..." alt="" coords="233,5,367,46"/><area shape="rect" id="node3" href="../../de/d2f/group__tcmi__task__class.html#gabc853647b7b732333c5909e617030f44" title="&lt;&lt;public&gt;&gt; Process context setter." alt="" coords="416,12,571,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gacba0b88eda0371f2be5be630a8ac24a0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static long tcmi_mighooks_replace_proc_self_file </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html#l00269">269</a> of file <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html">tcmi_mighooks.c</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00210">mdbg</a>.</p>

<p>Referenced by <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html#l00058">tcmi_mighooks_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                                                                            {   </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">if</span> ( strncmp(<span class="stringliteral">&quot;/proc/self&quot;</span>,filename,10) == 0 ) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordtype">int</span> len;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordtype">char</span> * tmp_result = __getname();</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">if</span> ( !(tmp_result) )</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="comment">//len = sprintf((tmp_result), &quot;/proc/%d%s&quot;, tcmi_task_remote_pid(current-&gt;tcmi.tcmi_task), filename+10);</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        len = sprintf((tmp_result), <span class="stringliteral">&quot;/mnt/local/proc/self%s&quot;</span>, filename+10);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Replaced open filename from %s to %s (len: %d)&quot;</span>, filename, (tmp_result), len);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        *result = tmp_result;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    }   </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gad2ecd15466a7569be6030ee4a59ac3dc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_try_npm_on_exec </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char __user *const __user *&#160;</td>
          <td class="paramname"><em>argv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char __user *const __user *&#160;</td>
          <td class="paramname"><em>envp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct pt_regs *&#160;</td>
          <td class="paramname"><em>regs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/de0/group__tcmi__man__class.html#da/d15/structtcmi__man">tcmi_man</a> *&#160;</td>
          <td class="paramname"><em>man</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is_guest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html#l00177">177</a> of file <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html">tcmi_mighooks.c</a>.</p>

<p>References <a class="el" href="../../d9/d10/tcmi__npm__params_8h_source.html#l00036">tcmi_npm_params::argsc</a>, <a class="el" href="../../d8/d87/director_8c_source.html#l00020">director_npm_check()</a>, <a class="el" href="../../d9/d10/tcmi__npm__params_8h_source.html#l00036">tcmi_npm_params::envpc</a>, <a class="el" href="../../d4/d2b/tcmi__npm__params_8c_source.html#l00072">extract_tcmi_npm_params()</a>, <a class="el" href="../../d9/d10/tcmi__npm__params_8h_source.html#l00034">tcmi_npm_params::file_name</a>, <a class="el" href="../../d6/d01/dbg_8h_source.html#l00210">mdbg</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00504">tcmi_man_emig_npm()</a>, and <a class="el" href="../../d9/d86/tcmi__penman_8c_source.html#l00253">tcmi_penman_migrateback_npm()</a>.</p>

<p>Referenced by <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html#l00215">tcmi_mighooks_execve()</a>.</p>
<div class="fragment"><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;{</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keyword">struct </span>rusage rusage;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    mm_segment_t old_fs;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordtype">int</span> migman_to_use = -1;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordtype">int</span> migrate_home = 0;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    old_fs = get_fs();</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    set_fs(get_ds());</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    getrusage(current, RUSAGE_SELF, &amp;rusage);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    set_fs(old_fs);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/d87/director_8c.html#a3b8becf6124d1c7caac6852db26fd35a" title="This is the main entry point that can be used by TCMI when it needs to consult user space director...">director_npm_check</a>(current-&gt;pid, current_euid(), is_guest, filename, argv, <a class="code" href="../../d9/d10/tcmi__npm__params_8h.html#aeebc47a01a74a156c1843bcc37b2bd02">envp</a>, &amp;migman_to_use, &amp;migrate_home, &amp;rusage) != 1 )</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    migrate_home = is_guest ? migrate_home : 0;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">// Check if we should emigrate and if so where</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">if</span> ( migman_to_use != -1 || migrate_home ) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d9/d10/tcmi__npm__params_8h.html#db/d53/structtcmi__npm__params" title="Structure containing data required for performing of non-preemtive restart.">tcmi_npm_params</a>* npm_params = vmalloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../d9/d10/tcmi__npm__params_8h.html#db/d53/structtcmi__npm__params" title="Structure containing data required for performing of non-preemtive restart.">tcmi_npm_params</a>));</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordtype">int</span> err = <a class="code" href="../../d4/d2b/tcmi__npm__params_8c.html#ab1d544d6e06fd85777cebc9ae696c232" title="Extracts npm params from user space passed params to a tcmi structure.">extract_tcmi_npm_params</a>(npm_params, filename, argv, <a class="code" href="../../d9/d10/tcmi__npm__params_8h.html#aeebc47a01a74a156c1843bcc37b2bd02">envp</a>);    </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO4, <span class="stringliteral">&quot;AFTER EXTRACT Filename: %s, Argc: %d, Evnpc: %d.&quot;</span>, npm_params-&gt;<a class="code" href="../../d9/d10/tcmi__npm__params_8h.html#a7ec2cdb6a770a06a1a7d055b633b738d" title="Name of the file that is being &quot;execve-ed&quot;.">file_name</a>, npm_params-&gt;<a class="code" href="../../d9/d10/tcmi__npm__params_8h.html#ae8d73ddbce5ff4bd31eccbd68a6e3f6d" title="Count of args/envp params.">argsc</a>, npm_params-&gt;<a class="code" href="../../d9/d10/tcmi__npm__params_8h.html#a4f381f14dd5c55e52db7b6c64d177a1b">envpc</a>);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keywordflow">if</span> ( err ) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Error extracting npm params: %d. Skipping npm emigration attempt.&quot;</span>, err);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            vfree(npm_params);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            <span class="keywordflow">if</span> ( migrate_home )</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                <a class="code" href="../../db/d61/group__tcmi__penman__class.html#gaaa68e5e6c390896f63d1734204b6e191" title="Performs non-preemtive migration back from PEN.">tcmi_penman_migrateback_npm</a>(man, regs, npm_params);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                <a class="code" href="../../d6/de0/group__tcmi__man__class.html#gaddba35e06a4eda99450d72288234ad14" title="&lt;&lt;public&gt;&gt; Method that performs non-preemtive migration">tcmi_man_emig_npm</a>(man, current-&gt;pid, migman_to_use, regs, npm_params);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="comment">// If we got here, the migration was not performed =&gt; free npm params</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Freeing npm_params after unsuccessful npm migration attempt.&quot;</span>);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            vfree(npm_params);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../df/dfc/group__tcmi__mighooks__class_gad2ecd15466a7569be6030ee4a59ac3dc_cgraph.png" border="0" usemap="#df/dfc/group__tcmi__mighooks__class_gad2ecd15466a7569be6030ee4a59ac3dc_cgraph" alt=""/></div>
<map name="df/dfc/group__tcmi__mighooks__class_gad2ecd15466a7569be6030ee4a59ac3dc_cgraph" id="df/dfc/group__tcmi__mighooks__class_gad2ecd15466a7569be6030ee4a59ac3dc_cgraph">
<area shape="rect" id="node2" href="../../d8/d87/director_8c.html#a3b8becf6124d1c7caac6852db26fd35a" title="This is the main entry point that can be used by TCMI when it needs to consult user space director..." alt="" coords="247,107,385,133"/><area shape="rect" id="node15" href="../../d4/d2b/tcmi__npm__params_8c.html#ab1d544d6e06fd85777cebc9ae696c232" title="Extracts npm params from user space passed params to a tcmi structure." alt="" coords="228,233,404,260"/><area shape="rect" id="node20" href="../../d6/de0/group__tcmi__man__class.html#gaddba35e06a4eda99450d72288234ad14" title="&lt;&lt;public&gt;&gt; Method that performs non&#45;preemtive migration" alt="" coords="243,411,389,437"/><area shape="rect" id="node42" href="../../db/d61/group__tcmi__penman__class.html#gaaa68e5e6c390896f63d1734204b6e191" title="Performs non&#45;preemtive migration back from PEN." alt="" coords="211,651,421,677"/><area shape="rect" id="node3" href="../../d3/de8/npm__msg_8c.html#a1d1a4b7c77f49fcc1abe3a9af5634a75" title="Checks, whether the process should be non&#45;preemptively migrated to some other node." alt="" coords="519,56,609,83"/><area shape="rect" id="node14" href="../../d3/de8/npm__msg_8c.html#aefde13528ad7f58da2120234e1634ba4" title="Checks, whether the process should be non&#45;preemptively migrated to some other node." alt="" coords="508,107,620,133"/><area shape="rect" id="node4" href="../../d9/df4/comm_8c.html#af68cf85dec3fb86013cb79568bb30026" title="Performs a netlink transaction." alt="" coords="728,81,867,108"/><area shape="rect" id="node5" href="../../d9/df4/comm_8c.html#ab708cd00ae28bb68e7a53b6784f6f937" title="Helper method to create&amp;send request." alt="" coords="948,132,1116,159"/><area shape="rect" id="node11" href="../../d9/df4/comm_8c.html#a66ea56ce29053fb1d9ab6d337429652d" title="msg_transaction_response" alt="" coords="943,56,1121,83"/><area shape="rect" id="node6" href="../../d8/d7c/genl__ext_8c.html#ac461d0210fcfe8dde0588f23aebf9aab" title="genlmsg_unicast_tx &#45; wrapper around generic netlink unicast." alt="" coords="1193,107,1332,133"/><area shape="rect" id="node9" href="../../d9/df4/comm_8c.html#a4559dadd35469f8de48ab278303e40a0" title="Returns unique sequence number for transaction." alt="" coords="1206,157,1319,184"/><area shape="rect" id="node10" href="../../d9/df4/comm_8c.html#a5f190e32af9d5c630100bee151c00717" title="Returns pid of director process if there is user&#45;space director connected, 0 otherwise." alt="" coords="1188,208,1337,235"/><area shape="rect" id="node7" href="../../d8/d7c/genl__ext_8c.html#ad7afbee4ce89bce50e383aa7b2cce80c" title="genl_ext_lock" alt="" coords="1429,107,1531,133"/><area shape="rect" id="node8" href="../../d8/d7c/genl__ext_8c.html#a9ea9dfe0b2ad73e1306c736e66755b1d" title="genl_ext_unlock" alt="" coords="1422,56,1538,83"/><area shape="rect" id="node12" href="../../d9/df4/comm_8c.html#ae2479089f7107aec24a9c89a13101d0d" title="Checks, if the transaction returned an error." alt="" coords="1207,5,1318,32"/><area shape="rect" id="node13" href="../../d8/d7c/genl__ext_8c.html#a98fc505709c73b6933abbacd5a656cb9" title="Blocking read call that will read netlink response for the specified transaction." alt="" coords="1181,56,1344,83"/><area shape="rect" id="node16" href="../../d4/d2b/tcmi__npm__params_8c.html#ac7528a4145b8d2ff990416773558d082" title="copy_strings" alt="" coords="516,208,612,235"/><area shape="rect" id="node18" href="../../d4/d2b/tcmi__npm__params_8c.html#af64f4ee0104b701e4f843c457b77e14c" title="count" alt="" coords="537,157,591,184"/><area shape="rect" id="node19" href="../../d9/d10/tcmi__npm__params_8h.html#a091259df2d963061baac4e12b9bf0e6d" title="Given a npm params structure, this method will fixup args and envp pointers to point to correct place..." alt="" coords="472,259,656,285"/><area shape="rect" id="node17" href="../../d9/d10/tcmi__npm__params_8h.html#a666e66daab3a643c4271a70428b25390" title="UGLY UGLY! Following 2 funcs would ideally not be in a header." alt="" coords="727,233,868,260"/><area shape="rect" id="node21" href="../../d6/da2/group__tcmi__migman__class.html#gacd13117046ccc1fa12ac743b893fcfca" title="&lt;&lt;public&gt;&gt; Instance accessor, increments the reference counter." alt="" coords="501,512,627,539"/><area shape="rect" id="node22" href="../../d6/da2/group__tcmi__migman__class.html#gab536c262c24d8fc76cdbdfa8d6d65b81" title="&lt;&lt;public&gt;&gt; The manager is shutdown exactly in this order:" alt="" coords="501,563,627,589"/><area shape="rect" id="node38" href="../../da/d0c/group__tcmi__slot__class.html#ga821f6b686443bfc7fff52dd3b155de37" title="&lt;&lt;public&gt;&gt; Slot index accessor." alt="" coords="507,309,621,336"/><area shape="rect" id="node39" href="../../d0/db7/group__tcmi__slotvec__class.html#ga876670f605631a5deb930412dae02b28" title="&lt;&lt;public&gt;&gt; Accesses a slot at a given index." alt="" coords="508,360,620,387"/><area shape="rect" id="node40" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="501,411,627,437"/><area shape="rect" id="node41" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="495,461,633,488"/><area shape="rect" id="node23" href="../../d6/da2/group__tcmi__migman__class.html#ga94df994d6d2ad3dd9aa6543ee67bf934" title="&lt;&lt;private&gt;&gt; Free method is has two purposes:when the last reference is released, it will free all ins..." alt="" coords="733,563,861,589"/><area shape="rect" id="node24" href="../../d9/dfc/group__tcmi__comm__class.html#ga89dc5a63295a65407cc93606c79ca314" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="975,563,1089,589"/><area shape="rect" id="node26" href="../../d6/da2/group__tcmi__migman__class.html#ga39c491f49b4e5b3cc533c816d27135a3" title="&lt;&lt;private&gt;&gt; Destroys all TCMI ctlfs directories" alt="" coords="937,664,1127,691"/><area shape="rect" id="node28" href="../../d6/da2/group__tcmi__migman__class.html#ga5b56a5213e9dbcba9973b9530692fd27" title="&lt;&lt;private&gt;&gt; Unregisters and releases all control files." alt="" coords="951,715,1113,757"/><area shape="rect" id="node31" href="../../d6/da2/group__tcmi__migman__class.html#gae4ad418d705edeca23e38eb383343978" title="&lt;&lt;private&gt;&gt; The TCMI manager listening thread is to be terminated by forcing a signal and waiting for..." alt="" coords="945,461,1119,488"/><area shape="rect" id="node32" href="../../d6/da2/group__tcmi__migman__class.html#ga71f49cd0661e81a859daab82ae7676de" title="Removes migman from a list of migration managers of the associated manager." alt="" coords="957,411,1107,437"/><area shape="rect" id="node35" href="../../d0/db7/group__tcmi__slotvec__class.html#ga2376bcc84e5bbd48a8f92400f5ad5f25" title="&lt;&lt;public&gt;&gt; Decrements the reference counter, when the count reaches 0, the instance is destroyed..." alt="" coords="973,512,1091,539"/><area shape="rect" id="node37" href="../../d3/d7e/group__tcmi__sock__class.html#gaa64951d80cedfaf76bb82ee811255d69" title="&lt;&lt;public&gt;&gt; Decrements the reference counter and if it reaches 0, the instance." alt="" coords="979,613,1085,640"/><area shape="rect" id="node25" href="../../d6/d8e/group__kkc__sock__class.html#ga9f980056fbf3436596c4cfdf3913e85c" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined..." alt="" coords="1211,563,1314,589"/><area shape="rect" id="node27" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d..." alt="" coords="1193,664,1332,691"/><area shape="rect" id="node29" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga665210941a04fda118949874767ced93" title="&lt;&lt;public&gt;&gt; This method unregisters the file uses the semaphore lock as protection from races..." alt="" coords="1397,715,1563,741"/><area shape="rect" id="node30" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gaead344003750e43cb4a0326876a191bc" title="&lt;&lt;public&gt;&gt; This method unregisters the file and allows the user to specify the preferred way of unreg..." alt="" coords="1177,765,1349,792"/><area shape="rect" id="node33" href="../../da/d0c/group__tcmi__slot__class.html#ga109d6d783ebf06046f364f970f84da1f" title="&lt;&lt;public&gt;&gt; Locks the slot data." alt="" coords="1209,385,1316,412"/><area shape="rect" id="node34" href="../../da/d0c/group__tcmi__slot__class.html#ga5447231fec5f42040c40307eb2e6a13c" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="1203,436,1323,463"/><area shape="rect" id="node36" href="../../da/d0c/group__tcmi__slot__class.html#ga6dd63ff2854a9939a5aa094f6543a5d1" title="&lt;&lt;public&gt;&gt; Checks if the slot is empty." alt="" coords="1203,512,1322,539"/><area shape="rect" id="node43" href="../../de/d2f/group__tcmi__task__class.html#ga0409e631915b37fbcfe096dfc498bbbb" title="&lt;&lt;public&gt;&gt; Submits a method for execution." alt="" coords="477,680,651,707"/><area shape="rect" id="node45" href="../../de/d2f/group__tcmi__task__class.html#gad0cec9fea3d6f19f8d9c903a97fba347" title="&lt;&lt;public&gt;&gt; Called from method queue &#45; Migrates a task back to CCN &#45; NPM." alt="" coords="469,755,659,781"/><area shape="rect" id="node49" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga2420f9c7c246746d3bbc87578357338f" title="&lt;&lt;public&gt;&gt; This method is registered by CCN or PEN component as the SIGUNUSED signal handler..." alt="" coords="497,614,631,655"/><area shape="rect" id="node44" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#ga57cd57a64f1ec847f1b71452daf4b3b1" title="&lt;&lt;public&gt;&gt; Creates a new wrapper for the specified method." alt="" coords="708,676,887,703"/><area shape="rect" id="node46" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#gaaf4d02eac4338a675bd5ed2df9943c97" title="&lt;&lt;public&gt;&gt; Accessor for the data stored in the method wrapper." alt="" coords="707,828,888,855"/><area shape="rect" id="node47" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="729,727,866,753"/><area shape="rect" id="node48" href="../../de/d2f/group__tcmi__task__class.html#ga2f054ae4772c0921004eebdb48d39dcf" title="&lt;&lt;public&gt;&gt; Remote PID accessor." alt="" coords="722,777,873,804"/><area shape="rect" id="node50" href="../../de/d2f/group__tcmi__task__class.html#gabc853647b7b732333c5909e617030f44" title="&lt;&lt;public&gt;&gt; Process context setter." alt="" coords="720,621,875,648"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun May 12 2013 19:06:09 for Clondike by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
