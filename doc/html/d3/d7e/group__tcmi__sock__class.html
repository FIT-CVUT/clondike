<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Clondike: tcmi_sock class</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Clondike
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d3/d7e/group__tcmi__sock__class.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">tcmi_sock class<div class="ingroups"><a class="el" href="../../dc/d84/group__tcmi__lib__group.html">lib</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>This class is a wrapper for KKC socket.  
<a href="#details">More...</a></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for tcmi_sock class:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<center><table><tr><td><img src="../../d3/d7e/group__tcmi__sock__class.png" border="0" alt="" usemap="#d3_2d7e_2group____tcmi____sock____class"/>
<map name="d3_2d7e_2group____tcmi____sock____class" id="d3_2d7e_2group____tcmi____sock____class">
<area shape="rect" id="node1" href="../../dc/d84/group__tcmi__lib__group.html" title="Classes in this group provide basic objects used commonly throughout the whole framework." alt="" coords="6,5,45,32"/></map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:da/dba/structtcmi__sock"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock">tcmi_sock</a></td></tr>
<tr class="memdesc:da/dba/structtcmi__sock"><td class="mdescLeft">&#160;</td><td class="mdescRight">A compound structure that holds the actual KKC listening.  <a href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock">More...</a><br/></td></tr>
<tr class="separator:da/dba/structtcmi__sock"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gaf8039b60ba9bdd64e8acc2e46f796f81"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#gaf8039b60ba9bdd64e8acc2e46f796f81">TCMI_SOCK</a>(l)&#160;&#160;&#160;((struct <a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock">tcmi_sock</a> *)l)</td></tr>
<tr class="memdesc:gaf8039b60ba9bdd64e8acc2e46f796f81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Casts to a <a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock" title="A compound structure that holds the actual KKC listening.">tcmi_sock</a> instance.  <a href="#gaf8039b60ba9bdd64e8acc2e46f796f81">More...</a><br/></td></tr>
<tr class="separator:gaf8039b60ba9bdd64e8acc2e46f796f81"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gad1f976e6e2c20c9f97fa0977cf7c00a8"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#gad1f976e6e2c20c9f97fa0977cf7c00a8">tcmi_sock_getsockname</a> (void *object, void *<a class="el" href="../../d9/d10/tcmi__npm__params_8h.html#ab9090ca30e7609aecaf540276e3c5084">data</a>)</td></tr>
<tr class="memdesc:gad1f976e6e2c20c9f97fa0977cf7c00a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Asks the KKC socket to supply its localname.  <a href="#gad1f976e6e2c20c9f97fa0977cf7c00a8">More...</a><br/></td></tr>
<tr class="separator:gad1f976e6e2c20c9f97fa0977cf7c00a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2febb49f11f25c34307c57b735c6307b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#ga2febb49f11f25c34307c57b735c6307b">tcmi_sock_getpeername</a> (void *object, void *<a class="el" href="../../d9/d10/tcmi__npm__params_8h.html#ab9090ca30e7609aecaf540276e3c5084">data</a>)</td></tr>
<tr class="memdesc:ga2febb49f11f25c34307c57b735c6307b"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Asks the KKC socket to supply its peername.  <a href="#ga2febb49f11f25c34307c57b735c6307b">More...</a><br/></td></tr>
<tr class="separator:ga2febb49f11f25c34307c57b735c6307b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4772df777dec4418da664b5428b6039a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#ga4772df777dec4418da664b5428b6039a">tcmi_sock_getarchname</a> (void *object, void *<a class="el" href="../../d9/d10/tcmi__npm__params_8h.html#ab9090ca30e7609aecaf540276e3c5084">data</a>)</td></tr>
<tr class="memdesc:ga4772df777dec4418da664b5428b6039a"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Asks the KKC socket to supply its peername.  <a href="#ga4772df777dec4418da664b5428b6039a">More...</a><br/></td></tr>
<tr class="separator:ga4772df777dec4418da664b5428b6039a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga68990d4c8a8379fe81d5714cef0cf3f1"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock">tcmi_sock</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#ga68990d4c8a8379fe81d5714cef0cf3f1">tcmi_sock_new</a> (struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *root, struct <a class="el" href="../../d6/d8e/group__kkc__sock__class.html#da/d0d/structkkc__sock">kkc_sock</a> *sock, const char namefmt[],...)</td></tr>
<tr class="memdesc:ga68990d4c8a8379fe81d5714cef0cf3f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; TCMI socket constructor.  <a href="#ga68990d4c8a8379fe81d5714cef0cf3f1">More...</a><br/></td></tr>
<tr class="separator:ga68990d4c8a8379fe81d5714cef0cf3f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8573cfac9adbb5996cd90395d8a78502"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d6/d8e/group__kkc__sock__class.html#da/d0d/structkkc__sock">kkc_sock</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#ga8573cfac9adbb5996cd90395d8a78502">tcmi_sock_kkc_sock_get</a> (struct <a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock">tcmi_sock</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:ga8573cfac9adbb5996cd90395d8a78502"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; KKC socket accessor.  <a href="#ga8573cfac9adbb5996cd90395d8a78502">More...</a><br/></td></tr>
<tr class="separator:ga8573cfac9adbb5996cd90395d8a78502"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga876afb36eb57904291d799899b7e01f2"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock">tcmi_sock</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#ga876afb36eb57904291d799899b7e01f2">tcmi_sock_get</a> (struct <a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock">tcmi_sock</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:ga876afb36eb57904291d799899b7e01f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Instance accessor.  <a href="#ga876afb36eb57904291d799899b7e01f2">More...</a><br/></td></tr>
<tr class="separator:ga876afb36eb57904291d799899b7e01f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf237e9aa6b0c62e2b152df0951226972"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../da/d0c/group__tcmi__slot__class.html#ga97f49e924fec185311972baf87d31897">tcmi_slot_node_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#gaf237e9aa6b0c62e2b152df0951226972">tcmi_sock_node</a> (struct <a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock">tcmi_sock</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:gaf237e9aa6b0c62e2b152df0951226972"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Sock node accessor.  <a href="#gaf237e9aa6b0c62e2b152df0951226972">More...</a><br/></td></tr>
<tr class="separator:gaf237e9aa6b0c62e2b152df0951226972"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa64951d80cedfaf76bb82ee811255d69"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#gaa64951d80cedfaf76bb82ee811255d69">tcmi_sock_put</a> (struct <a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock">tcmi_sock</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:gaa64951d80cedfaf76bb82ee811255d69"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Releases the instance.  <a href="#gaa64951d80cedfaf76bb82ee811255d69">More...</a><br/></td></tr>
<tr class="separator:gaa64951d80cedfaf76bb82ee811255d69"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>This class is a wrapper for KKC socket. </p>
<p>It provides a TCMI ctlfs user interface, that allows the user to read information about the socket - local name, peername and architecture.</p>
<p>Sockets are meant to be stored in <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html">a slot vector </a>. For that reason they provide a slot node, so that they can be linked into the slotvector.</p>
<p>There is no need for additional lock since access to the data structures from user space is serialized via the TCMI ctlfs files. Other kernel threads accessing the socket don't manipulate its internal datastructures, except for the last thread that destroys it. This protection is implemented by standard reference counting. </p>
<hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="da/dba/structtcmi__sock" id="da/dba/structtcmi__sock"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct tcmi_sock</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>A compound structure that holds the actual KKC listening. </p>

<p>Definition at line <a class="el" href="../../d9/d2c/tcmi__sock_8h_source.html#l00067">67</a> of file <a class="el" href="../../d9/d2c/tcmi__sock_8h_source.html">tcmi_sock.h</a>.</p>
</div><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for tcmi_sock:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d8/d16/structtcmi__sock__coll__graph.png" border="0" usemap="#tcmi__sock_coll__map" alt="Collaboration graph"/></div>
<map name="tcmi__sock_coll__map" id="tcmi__sock_coll__map">
<area shape="rect" id="node2" href="../../d6/d8e/group__kkc__sock__class.html#da/d0d/structkkc__sock" title="A coumpound structure that contains generic information about a KKC socket." alt="" coords="155,451,284,602"/><area shape="rect" id="node3" href="../../d5/ddf/group__kkc__arch__class.html#db/d0a/structkkc__arch" title="Compound structure, describes one particular architecture." alt="" coords="39,213,113,320"/><area shape="rect" id="node4" href="../../d5/ddf/group__kkc__arch__class.html#d0/d60/structkkc__arch__ops" title="Architecture specific operations." alt="" coords="5,5,147,83"/><area shape="rect" id="node5" href="../../d6/d8e/group__kkc__sock__class.html#d9/db1/structkkc__sock__ops" title="Socket operations that support polymorphism." alt="" coords="138,147,301,386"/><area shape="rect" id="node6" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry" title="An entry compound structure." alt="" coords="317,481,432,573"/><area shape="rect" id="node7" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#df/d10/structtcmi__ctlfs__ops" title="entry operations that support polymorphism" alt="" coords="327,228,439,305"/></map>
</div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a63b56f4af05952a1446d24002fb3e04e"></a>struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *</td>
<td class="fieldname">
d_id</td>
<td class="fielddoc">
TCMI ctlfs directory where there are the control files of the listening. <p>The name is based on slot index </p>
</td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a577a92e31ab800dc56309401249535f4"></a>struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *</td>
<td class="fieldname">
f_archname</td>
<td class="fielddoc">
TCMI ctlfs - shows the architecture name. </td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a4c2c82e7ba326b2aed1e1c821ad188de"></a>struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *</td>
<td class="fieldname">
f_peername</td>
<td class="fielddoc">
TCMI ctlfs - shows the remote socketa addres - meaningful for connected sockets only. </td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="add614dc866c09d444f4f95b6ba5aa127"></a>struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *</td>
<td class="fieldname">
f_sockname</td>
<td class="fielddoc">
TCMI ctlfs - shows the local socket address. </td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a97a16420fd085452062d38e6aeed9d42"></a><a class="el" href="../../da/d0c/group__tcmi__slot__class.html#ga97f49e924fec185311972baf87d31897">tcmi_slot_node_t</a></td>
<td class="fieldname">
node</td>
<td class="fielddoc">
A slot node, used for insertion the listening into a slot. </td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ab4dd171a39dffd446e77e12e1f7ea434"></a>atomic_t</td>
<td class="fieldname">
ref_count</td>
<td class="fielddoc">
Instance reference counter. </td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a2b9ba27d237ea2b934e7dfd8cf85d054"></a>struct <a class="el" href="../../d6/d8e/group__kkc__sock__class.html#da/d0d/structkkc__sock">kkc_sock</a> *</td>
<td class="fieldname">
sock</td>
<td class="fielddoc">
KKC socket contained in the instance. </td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="gaf8039b60ba9bdd64e8acc2e46f796f81"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCMI_SOCK</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">l</td><td>)</td>
          <td>&#160;&#160;&#160;((struct <a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock">tcmi_sock</a> *)l)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Casts to a <a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock" title="A compound structure that holds the actual KKC listening.">tcmi_sock</a> instance. </p>

<p>Definition at line <a class="el" href="../../d9/d2c/tcmi__sock_8h_source.html#l00150">150</a> of file <a class="el" href="../../d9/d2c/tcmi__sock_8h_source.html">tcmi_sock.h</a>.</p>

<p>Referenced by <a class="el" href="../../da/d37/tcmi__sock_8c_source.html#l00190">tcmi_sock_getarchname()</a>, <a class="el" href="../../da/d37/tcmi__sock_8c_source.html#l00175">tcmi_sock_getpeername()</a>, and <a class="el" href="../../da/d37/tcmi__sock_8c_source.html#l00160">tcmi_sock_getsockname()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga876afb36eb57904291d799899b7e01f2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock">tcmi_sock</a>* tcmi_sock_get </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock">tcmi_sock</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Instance accessor. </p>
<p>increments the reference counter. The user is now guaranteed, that the instance stays in memory while he is using it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this instance </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock" title="A compound structure that holds the actual KKC listening.">tcmi_sock</a> instance </dd></dl>

<p>Definition at line <a class="el" href="../../d9/d2c/tcmi__sock_8h_source.html#l00119">119</a> of file <a class="el" href="../../d9/d2c/tcmi__sock_8h_source.html">tcmi_sock.h</a>.</p>

<p>References <a class="el" href="../../d0/dc1/proxyfs__server_8c_source.html#l00059">self</a>.</p>

<p>Referenced by <a class="el" href="../../d2/de0/tcmi__ccnman_8c_source.html#l00552">tcmi_ccnman_thread()</a>.</p>
<div class="fragment"><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;{</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">self</span>) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">/*      mdbg(CRIT4, &quot;Incrementing ref. count(%d) of local:&#39;%s&#39;, remote:&#39;%s&#39; (%p)&quot;, </span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">             atomic_read(&amp;self-&gt;ref_count), </span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">             kkc_sock_getsockname2(tcmi_sock_kkc_sock_get(self)), </span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">             kkc_sock_getpeername2(tcmi_sock_kkc_sock_get(self)), self);</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        atomic_inc(&amp;self-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#ab4dd171a39dffd446e77e12e1f7ea434" title="Instance reference counter.">ref_count</a>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">self</span>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga4772df777dec4418da664b5428b6039a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_sock_getarchname </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Asks the KKC socket to supply its peername. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*object</td><td>- pointer to this tcmi socket instance </td></tr>
    <tr><td class="paramname">*data</td><td>- storage for the architecture string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon success </dd></dl>

<p>Definition at line <a class="el" href="../../da/d37/tcmi__sock_8c_source.html#l00190">190</a> of file <a class="el" href="../../da/d37/tcmi__sock_8c_source.html">tcmi_sock.c</a>.</p>

<p>References <a class="el" href="../../d0/d6e/kkc__arch_8h_source.html#l00059">KKC_MAX_ARCH_LENGTH</a>, <a class="el" href="../../df/dfa/kkc__sock_8h_source.html#l00210">kkc_sock_getarchname()</a>, <a class="el" href="../../d0/dc1/proxyfs__server_8c_source.html#l00059">self</a>, and <a class="el" href="../../d9/d2c/tcmi__sock_8h_source.html#l00150">TCMI_SOCK</a>.</p>

<p>Referenced by <a class="el" href="../../da/d37/tcmi__sock_8c_source.html#l00058">tcmi_sock_new()</a>.</p>
<div class="fragment"><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;{</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock" title="A compound structure that holds the actual KKC listening.">tcmi_sock</a> *<span class="keyword">self</span> = <a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#gaf8039b60ba9bdd64e8acc2e46f796f81" title="Casts to a tcmi_sock instance.">TCMI_SOCK</a>(<span class="keywordtype">object</span>);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="../../d6/d8e/group__kkc__sock__class.html#ga705b6d499116fcd74f3d5bdfcbf7564d" title="&lt;&lt;public&gt;&gt; Architecture name accessor.">kkc_sock_getarchname</a>(<a class="code" href="../../d0/dc1/proxyfs__server_8c.html#acffc38573c809dad4512ce637724ab7e">self</a>-&gt;sock, <a class="code" href="../../d9/d10/tcmi__npm__params_8h.html#ab9090ca30e7609aecaf540276e3c5084" title="Helper field that stores content of args/envp for the serialization.">data</a>, <a class="code" href="../../d5/ddf/group__kkc__arch__class.html#gac6347cfcb8b88bd94b71265d7d27bd98" title="Maximum architecture string length.">KKC_MAX_ARCH_LENGTH</a>);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d3/d7e/group__tcmi__sock__class_ga4772df777dec4418da664b5428b6039a_cgraph.png" border="0" usemap="#d3/d7e/group__tcmi__sock__class_ga4772df777dec4418da664b5428b6039a_cgraph" alt=""/></div>
<map name="d3/d7e/group__tcmi__sock__class_ga4772df777dec4418da664b5428b6039a_cgraph" id="d3/d7e/group__tcmi__sock__class_ga4772df777dec4418da664b5428b6039a_cgraph">
<area shape="rect" id="node2" href="../../d6/d8e/group__kkc__sock__class.html#ga705b6d499116fcd74f3d5bdfcbf7564d" title="&lt;&lt;public&gt;&gt; Architecture name accessor." alt="" coords="219,5,379,32"/><area shape="rect" id="node3" href="../../d5/ddf/group__kkc__arch__class.html#ga84a8539c1971651af4a8ad753c7853e5" title="&lt;&lt;public&gt;&gt; Architecture name accessor." alt="" coords="427,5,541,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga2febb49f11f25c34307c57b735c6307b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_sock_getpeername </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Asks the KKC socket to supply its peername. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*object</td><td>- pointer to this tcmi socket instance </td></tr>
    <tr><td class="paramname">*data</td><td>- storage for the peername string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon success </dd></dl>

<p>Definition at line <a class="el" href="../../da/d37/tcmi__sock_8c_source.html#l00175">175</a> of file <a class="el" href="../../da/d37/tcmi__sock_8c_source.html">tcmi_sock.c</a>.</p>

<p>References <a class="el" href="../../df/dfa/kkc__sock_8h_source.html#l00194">kkc_sock_getpeername()</a>, <a class="el" href="../../df/dfa/kkc__sock_8h_source.html#l00058">KKC_SOCK_MAX_ADDR_LENGTH</a>, <a class="el" href="../../d0/dc1/proxyfs__server_8c_source.html#l00059">self</a>, and <a class="el" href="../../d9/d2c/tcmi__sock_8h_source.html#l00150">TCMI_SOCK</a>.</p>

<p>Referenced by <a class="el" href="../../da/d37/tcmi__sock_8c_source.html#l00058">tcmi_sock_new()</a>.</p>
<div class="fragment"><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;{</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock" title="A compound structure that holds the actual KKC listening.">tcmi_sock</a> *<span class="keyword">self</span> = <a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#gaf8039b60ba9bdd64e8acc2e46f796f81" title="Casts to a tcmi_sock instance.">TCMI_SOCK</a>(<span class="keywordtype">object</span>);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="../../d6/d8e/group__kkc__sock__class.html#gadf1b231c727891d5ac2d32646d574931" title="&lt;&lt;public&gt;&gt; Peer socket name accessor.">kkc_sock_getpeername</a>(<a class="code" href="../../d0/dc1/proxyfs__server_8c.html#acffc38573c809dad4512ce637724ab7e">self</a>-&gt;sock, <a class="code" href="../../d9/d10/tcmi__npm__params_8h.html#ab9090ca30e7609aecaf540276e3c5084" title="Helper field that stores content of args/envp for the serialization.">data</a>, <a class="code" href="../../d6/d8e/group__kkc__sock__class.html#ga22cf4745e4dd8b649e6b3fb4eb96ed66" title="Maximum address length.">KKC_SOCK_MAX_ADDR_LENGTH</a>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d3/d7e/group__tcmi__sock__class_ga2febb49f11f25c34307c57b735c6307b_cgraph.png" border="0" usemap="#d3/d7e/group__tcmi__sock__class_ga2febb49f11f25c34307c57b735c6307b_cgraph" alt=""/></div>
<map name="d3/d7e/group__tcmi__sock__class_ga2febb49f11f25c34307c57b735c6307b_cgraph" id="d3/d7e/group__tcmi__sock__class_ga2febb49f11f25c34307c57b735c6307b_cgraph">
<area shape="rect" id="node2" href="../../d6/d8e/group__kkc__sock__class.html#gadf1b231c727891d5ac2d32646d574931" title="&lt;&lt;public&gt;&gt; Peer socket name accessor." alt="" coords="219,5,379,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gad1f976e6e2c20c9f97fa0977cf7c00a8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_sock_getsockname </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Asks the KKC socket to supply its localname. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*object</td><td>- pointer to this tcmi socket instance </td></tr>
    <tr><td class="paramname">*data</td><td>- storage for the localname string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon success </dd></dl>

<p>Definition at line <a class="el" href="../../da/d37/tcmi__sock_8c_source.html#l00160">160</a> of file <a class="el" href="../../da/d37/tcmi__sock_8c_source.html">tcmi_sock.c</a>.</p>

<p>References <a class="el" href="../../df/dfa/kkc__sock_8h_source.html#l00176">kkc_sock_getsockname()</a>, <a class="el" href="../../df/dfa/kkc__sock_8h_source.html#l00058">KKC_SOCK_MAX_ADDR_LENGTH</a>, <a class="el" href="../../d0/dc1/proxyfs__server_8c_source.html#l00059">self</a>, and <a class="el" href="../../d9/d2c/tcmi__sock_8h_source.html#l00150">TCMI_SOCK</a>.</p>

<p>Referenced by <a class="el" href="../../da/d37/tcmi__sock_8c_source.html#l00058">tcmi_sock_new()</a>.</p>
<div class="fragment"><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;{</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock" title="A compound structure that holds the actual KKC listening.">tcmi_sock</a> *<span class="keyword">self</span> = <a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#gaf8039b60ba9bdd64e8acc2e46f796f81" title="Casts to a tcmi_sock instance.">TCMI_SOCK</a>(<span class="keywordtype">object</span>);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="../../d6/d8e/group__kkc__sock__class.html#ga3cae649f56c8f5fa18f755f6c7d53597" title="&lt;&lt;public&gt;&gt; Local socket name accessor.">kkc_sock_getsockname</a>(<a class="code" href="../../d0/dc1/proxyfs__server_8c.html#acffc38573c809dad4512ce637724ab7e">self</a>-&gt;sock, <a class="code" href="../../d9/d10/tcmi__npm__params_8h.html#ab9090ca30e7609aecaf540276e3c5084" title="Helper field that stores content of args/envp for the serialization.">data</a>, <a class="code" href="../../d6/d8e/group__kkc__sock__class.html#ga22cf4745e4dd8b649e6b3fb4eb96ed66" title="Maximum address length.">KKC_SOCK_MAX_ADDR_LENGTH</a>);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d3/d7e/group__tcmi__sock__class_gad1f976e6e2c20c9f97fa0977cf7c00a8_cgraph.png" border="0" usemap="#d3/d7e/group__tcmi__sock__class_gad1f976e6e2c20c9f97fa0977cf7c00a8_cgraph" alt=""/></div>
<map name="d3/d7e/group__tcmi__sock__class_gad1f976e6e2c20c9f97fa0977cf7c00a8_cgraph" id="d3/d7e/group__tcmi__sock__class_gad1f976e6e2c20c9f97fa0977cf7c00a8_cgraph">
<area shape="rect" id="node2" href="../../d6/d8e/group__kkc__sock__class.html#ga3cae649f56c8f5fa18f755f6c7d53597" title="&lt;&lt;public&gt;&gt; Local socket name accessor." alt="" coords="221,5,384,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga8573cfac9adbb5996cd90395d8a78502"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d6/d8e/group__kkc__sock__class.html#da/d0d/structkkc__sock">kkc_sock</a>* tcmi_sock_kkc_sock_get </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock">tcmi_sock</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; KKC socket accessor. </p>
<p>Reference counter of the KKC socket is not adjusted as the socket is part of the <a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock" title="A compound structure that holds the actual KKC listening.">tcmi_sock</a> instance. The caller is expected to have a valid reference to the <a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock" title="A compound structure that holds the actual KKC listening.">tcmi_sock</a> instance.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this instance </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock" title="A compound structure that holds the actual KKC listening.">tcmi_sock</a> instance </dd></dl>

<p>Definition at line <a class="el" href="../../d9/d2c/tcmi__sock_8h_source.html#l00104">104</a> of file <a class="el" href="../../d9/d2c/tcmi__sock_8h_source.html">tcmi_sock.h</a>.</p>

<p>Referenced by <a class="el" href="../../d2/de0/tcmi__ccnman_8c_source.html#l00229">tcmi_ccnman_remove_sleepers()</a>, <a class="el" href="../../d2/de0/tcmi__ccnman_8c_source.html#l00552">tcmi_ccnman_thread()</a>, and <a class="el" href="../../d8/d88/tcmi__migman_8h_source.html#l00307">tcmi_migman_sock()</a>.</p>
<div class="fragment"><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;{</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">if</span> (!<span class="keyword">self</span>)</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">self</span>-&gt;sock;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga68990d4c8a8379fe81d5714cef0cf3f1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock">tcmi_sock</a>* tcmi_sock_new </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *&#160;</td>
          <td class="paramname"><em>root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d8e/group__kkc__sock__class.html#da/d0d/structkkc__sock">kkc_sock</a> *&#160;</td>
          <td class="paramname"><em>k_sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>namefmt</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; TCMI socket constructor. </p>
<p>A listening is constructed as follows:</p>
<ul>
<li>a new instance is allocated</li>
<li>a new socket directory is created in the root directory. The name of the directory is specified by the method caller.</li>
<li>localname, peername and archname control files are crated</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*root</td><td>- directory which all listening control files and its main directory will reside in. </td></tr>
    <tr><td class="paramname">*k_sock</td><td>- KKC socket, that this instance is to present in ctlfs </td></tr>
    <tr><td class="paramname">namefmt</td><td>- nameformat string (printf style) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- a new <a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock" title="A compound structure that holds the actual KKC listening.">tcmi_sock</a> instance or NULL </dd></dl>

<p>Definition at line <a class="el" href="../../da/d37/tcmi__sock_8c_source.html#l00058">58</a> of file <a class="el" href="../../da/d37/tcmi__sock_8c_source.html">tcmi_sock.c</a>.</p>

<p>References <a class="el" href="../../d9/d10/tcmi__npm__params_8h_source.html#l00052">args</a>, <a class="el" href="../../d9/d2c/tcmi__sock_8h_source.html#l00076">tcmi_sock::d_id</a>, <a class="el" href="../../d9/d2c/tcmi__sock_8h_source.html#l00083">tcmi_sock::f_archname</a>, <a class="el" href="../../d9/d2c/tcmi__sock_8h_source.html#l00081">tcmi_sock::f_peername</a>, <a class="el" href="../../d9/d2c/tcmi__sock_8h_source.html#l00078">tcmi_sock::f_sockname</a>, <a class="el" href="../../d0/d6e/kkc__arch_8h_source.html#l00059">KKC_MAX_ARCH_LENGTH</a>, <a class="el" href="../../df/dfa/kkc__sock_8h_source.html#l00251">kkc_sock_get()</a>, <a class="el" href="../../df/dfa/kkc__sock_8h_source.html#l00224">kkc_sock_getsockname2()</a>, <a class="el" href="../../df/dfa/kkc__sock_8h_source.html#l00058">KKC_SOCK_MAX_ADDR_LENGTH</a>, <a class="el" href="../../df/dfa/kkc__sock_8h_source.html#l00269">kkc_sock_put()</a>, <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d9/d2c/tcmi__sock_8h_source.html#l00072">tcmi_sock::ref_count</a>, <a class="el" href="../../d9/d2c/tcmi__sock_8h_source.html#l00086">tcmi_sock::sock</a>, <a class="el" href="../../d1/ddf/tcmi__ctlfs__dir_8c_source.html#l00072">tcmi_ctlfs_dir_vnew()</a>, <a class="el" href="../../df/d2f/tcmi__ctlfs__entry_8h_source.html#l00214">tcmi_ctlfs_entry_put()</a>, <a class="el" href="../../d2/d0f/tcmi__ctlfs__file_8c_source.html#l00154">tcmi_ctlfs_file_unregister()</a>, <a class="el" href="../../d2/d0f/tcmi__ctlfs__file_8c_source.html#l00099">tcmi_ctlfs_strfile_new()</a>, <a class="el" href="../../d0/d49/tcmi__ctlfs_8h_source.html#l00087">TCMI_PERMS_DIR</a>, <a class="el" href="../../d0/d49/tcmi__ctlfs_8h_source.html#l00091">TCMI_PERMS_FILE_R</a>, <a class="el" href="../../da/d37/tcmi__sock_8c_source.html#l00190">tcmi_sock_getarchname()</a>, <a class="el" href="../../da/d37/tcmi__sock_8c_source.html#l00175">tcmi_sock_getpeername()</a>, and <a class="el" href="../../da/d37/tcmi__sock_8c_source.html#l00160">tcmi_sock_getsockname()</a>.</p>

<p>Referenced by <a class="el" href="../../d2/de0/tcmi__ccnman_8c_source.html#l00302">tcmi_ccnman_listen()</a>, and <a class="el" href="../../d6/d82/tcmi__migman_8c_source.html#l00081">tcmi_migman_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;{</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock" title="A compound structure that holds the actual KKC listening.">tcmi_sock</a> *t_sock;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    va_list <a class="code" href="../../d9/d10/tcmi__npm__params_8h.html#aa24f72e6a4d6a997528142211b375496" title="Arrays of args and envps.">args</a>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    va_start(args, namefmt);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Creating new TCMI socket&quot;</span>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">if</span> (!(t_sock = kmalloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock" title="A compound structure that holds the actual KKC listening.">tcmi_sock</a>), GFP_KERNEL))) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Failed to allocate memory for tcmi socket &#39;%s&#39;&quot;</span>,</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;             <a class="code" href="../../d6/d8e/group__kkc__sock__class.html#gac8e64f52015e75cb76a34c4b7e9ef176" title="&lt;&lt;public&gt;&gt; Socket name accessor.">kkc_sock_getsockname2</a>(k_sock));</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">/* create KKC t_sock */</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    atomic_set(&amp;t_sock-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#ab4dd171a39dffd446e77e12e1f7ea434" title="Instance reference counter.">ref_count</a>, 1);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    t_sock-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#a2b9ba27d237ea2b934e7dfd8cf85d054" title="KKC socket contained in the instance.">sock</a> = <a class="code" href="../../d6/d8e/group__kkc__sock__class.html#gabada9f8c5976a6aff07529239acdf727" title="&lt;&lt;public&gt;&gt; Instance accessor, increments the reference count.">kkc_sock_get</a>(k_sock);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">/* main t_sock directory named after the index of its slot */</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">if</span> (!(t_sock-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#a63b56f4af05952a1446d24002fb3e04e" title="TCMI ctlfs directory where there are the control files of the listening.">d_id</a> = </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;          <a class="code" href="../../dc/def/group__tcmi__ctlfs__dir__class.html#ga571b8ac681691e3ceca2e833b89b6a21" title="&lt;&lt;public&gt;&gt; Creates a new directory entry in the tcmi_ctlfs tree.">tcmi_ctlfs_dir_vnew</a>(root, <a class="code" href="../../d9/d0a/group__tcmi__ctlfs__class.html#gaf838aee6d2933dc427bf9d47ac09c610" title="Preferred directory rights.">TCMI_PERMS_DIR</a>, namefmt, args)))</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordflow">goto</span> exit1;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">if</span> (!(t_sock-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#add614dc866c09d444f4f95b6ba5aa127" title="TCMI ctlfs - shows the local socket address.">f_sockname</a> = </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;          <a class="code" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gaeaa21c9f35d22ab9ea81f97a39ef3e95" title="&lt;&lt;public&gt;&gt; Creates a new instance of a file.">tcmi_ctlfs_strfile_new</a>(t_sock-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#a63b56f4af05952a1446d24002fb3e04e" title="TCMI ctlfs directory where there are the control files of the listening.">d_id</a>, <a class="code" href="../../d9/d0a/group__tcmi__ctlfs__class.html#ga84907a0ffd1393cf8b462e14c9b4140a" title="Preferred read file rights.">TCMI_PERMS_FILE_R</a>,</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                     t_sock, <a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#gad1f976e6e2c20c9f97fa0977cf7c00a8" title="&lt;&lt;private&gt;&gt; Asks the KKC socket to supply its localname.">tcmi_sock_getsockname</a>, NULL,</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                     <a class="code" href="../../d6/d8e/group__kkc__sock__class.html#ga22cf4745e4dd8b649e6b3fb4eb96ed66" title="Maximum address length.">KKC_SOCK_MAX_ADDR_LENGTH</a>, <span class="stringliteral">&quot;sockname&quot;</span>)))</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordflow">goto</span> exit2;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">if</span> (!(t_sock-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#a4c2c82e7ba326b2aed1e1c821ad188de" title="TCMI ctlfs - shows the remote socketa addres - meaningful for connected sockets only.">f_peername</a> = </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;          <a class="code" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gaeaa21c9f35d22ab9ea81f97a39ef3e95" title="&lt;&lt;public&gt;&gt; Creates a new instance of a file.">tcmi_ctlfs_strfile_new</a>(t_sock-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#a63b56f4af05952a1446d24002fb3e04e" title="TCMI ctlfs directory where there are the control files of the listening.">d_id</a>, <a class="code" href="../../d9/d0a/group__tcmi__ctlfs__class.html#ga84907a0ffd1393cf8b462e14c9b4140a" title="Preferred read file rights.">TCMI_PERMS_FILE_R</a>,</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                     t_sock, <a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#ga2febb49f11f25c34307c57b735c6307b" title="&lt;&lt;private&gt;&gt; Asks the KKC socket to supply its peername.">tcmi_sock_getpeername</a>, NULL,</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                     <a class="code" href="../../d6/d8e/group__kkc__sock__class.html#ga22cf4745e4dd8b649e6b3fb4eb96ed66" title="Maximum address length.">KKC_SOCK_MAX_ADDR_LENGTH</a>, <span class="stringliteral">&quot;peername&quot;</span>)))</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordflow">goto</span> exit3;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">if</span> (!(t_sock-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#a577a92e31ab800dc56309401249535f4" title="TCMI ctlfs - shows the architecture name.">f_archname</a> = </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;          <a class="code" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gaeaa21c9f35d22ab9ea81f97a39ef3e95" title="&lt;&lt;public&gt;&gt; Creates a new instance of a file.">tcmi_ctlfs_strfile_new</a>(t_sock-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#a63b56f4af05952a1446d24002fb3e04e" title="TCMI ctlfs directory where there are the control files of the listening.">d_id</a>, <a class="code" href="../../d9/d0a/group__tcmi__ctlfs__class.html#ga84907a0ffd1393cf8b462e14c9b4140a" title="Preferred read file rights.">TCMI_PERMS_FILE_R</a>,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                     t_sock, <a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#ga4772df777dec4418da664b5428b6039a" title="&lt;&lt;private&gt;&gt; Asks the KKC socket to supply its peername.">tcmi_sock_getarchname</a>, NULL,</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                     <a class="code" href="../../d5/ddf/group__kkc__arch__class.html#gac6347cfcb8b88bd94b71265d7d27bd98" title="Maximum architecture string length.">KKC_MAX_ARCH_LENGTH</a>, <span class="stringliteral">&quot;archname&quot;</span>)))</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordflow">goto</span> exit4;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    va_end(args);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO4, <span class="stringliteral">&quot;Allocated new TCMI socket memory=%p&quot;</span>, t_sock);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">return</span> t_sock;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; exit4:</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga665210941a04fda118949874767ced93" title="&lt;&lt;public&gt;&gt; This method unregisters the file uses the semaphore lock as protection from races...">tcmi_ctlfs_file_unregister</a>(t_sock-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#a4c2c82e7ba326b2aed1e1c821ad188de" title="TCMI ctlfs - shows the remote socketa addres - meaningful for connected sockets only.">f_peername</a>);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d...">tcmi_ctlfs_entry_put</a>(t_sock-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#a4c2c82e7ba326b2aed1e1c821ad188de" title="TCMI ctlfs - shows the remote socketa addres - meaningful for connected sockets only.">f_peername</a>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; exit3:</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga665210941a04fda118949874767ced93" title="&lt;&lt;public&gt;&gt; This method unregisters the file uses the semaphore lock as protection from races...">tcmi_ctlfs_file_unregister</a>(t_sock-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#add614dc866c09d444f4f95b6ba5aa127" title="TCMI ctlfs - shows the local socket address.">f_sockname</a>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d...">tcmi_ctlfs_entry_put</a>(t_sock-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#add614dc866c09d444f4f95b6ba5aa127" title="TCMI ctlfs - shows the local socket address.">f_sockname</a>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; exit2:</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d...">tcmi_ctlfs_entry_put</a>(t_sock-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#a63b56f4af05952a1446d24002fb3e04e" title="TCMI ctlfs directory where there are the control files of the listening.">d_id</a>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; exit1:</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="../../d6/d8e/group__kkc__sock__class.html#ga9f980056fbf3436596c4cfdf3913e85c" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined...">kkc_sock_put</a>(t_sock-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#a2b9ba27d237ea2b934e7dfd8cf85d054" title="KKC socket contained in the instance.">sock</a>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    kfree(t_sock);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    va_end(args);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; exit0:</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d3/d7e/group__tcmi__sock__class_ga68990d4c8a8379fe81d5714cef0cf3f1_cgraph.png" border="0" usemap="#d3/d7e/group__tcmi__sock__class_ga68990d4c8a8379fe81d5714cef0cf3f1_cgraph" alt=""/></div>
<map name="d3/d7e/group__tcmi__sock__class_ga68990d4c8a8379fe81d5714cef0cf3f1_cgraph" id="d3/d7e/group__tcmi__sock__class_ga68990d4c8a8379fe81d5714cef0cf3f1_cgraph">
<area shape="rect" id="node2" href="../../d6/d8e/group__kkc__sock__class.html#gabada9f8c5976a6aff07529239acdf727" title="&lt;&lt;public&gt;&gt; Instance accessor, increments the reference count." alt="" coords="198,5,301,32"/><area shape="rect" id="node3" href="../../d6/d8e/group__kkc__sock__class.html#gac8e64f52015e75cb76a34c4b7e9ef176" title="&lt;&lt;public&gt;&gt; Socket name accessor." alt="" coords="385,56,556,83"/><area shape="rect" id="node5" href="../../d6/d8e/group__kkc__sock__class.html#ga9f980056fbf3436596c4cfdf3913e85c" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined..." alt="" coords="198,157,301,184"/><area shape="rect" id="node9" href="../../dc/def/group__tcmi__ctlfs__dir__class.html#ga571b8ac681691e3ceca2e833b89b6a21" title="&lt;&lt;public&gt;&gt; Creates a new directory entry in the tcmi_ctlfs tree." alt="" coords="182,267,317,293"/><area shape="rect" id="node16" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d..." alt="" coords="621,427,760,453"/><area shape="rect" id="node17" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga665210941a04fda118949874767ced93" title="&lt;&lt;public&gt;&gt; This method unregisters the file uses the semaphore lock as protection from races..." alt="" coords="167,503,332,529"/><area shape="rect" id="node22" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gaeaa21c9f35d22ab9ea81f97a39ef3e95" title="&lt;&lt;public&gt;&gt; Creates a new instance of a file." alt="" coords="176,347,323,373"/><area shape="rect" id="node24" href="../../d3/d7e/group__tcmi__sock__class.html#ga4772df777dec4418da664b5428b6039a" title="&lt;&lt;private&gt;&gt; Asks the KKC socket to supply its peername." alt="" coords="167,592,331,619"/><area shape="rect" id="node27" href="../../d3/d7e/group__tcmi__sock__class.html#ga2febb49f11f25c34307c57b735c6307b" title="&lt;&lt;private&gt;&gt; Asks the KKC socket to supply its peername." alt="" coords="167,212,331,239"/><area shape="rect" id="node28" href="../../d3/d7e/group__tcmi__sock__class.html#gad1f976e6e2c20c9f97fa0977cf7c00a8" title="&lt;&lt;private&gt;&gt; Asks the KKC socket to supply its localname." alt="" coords="166,56,333,83"/><area shape="rect" id="node4" href="../../d6/d8e/group__kkc__sock__class.html#ga3cae649f56c8f5fa18f755f6c7d53597" title="&lt;&lt;public&gt;&gt; Local socket name accessor." alt="" coords="609,31,772,57"/><area shape="rect" id="node6" href="../../d5/ddf/group__kkc__arch__class.html#ga06049c969ae0324d0607f10db99af65c" title="&lt;&lt;public&gt;&gt; Decrements the reference counter on the module owning the architecture." alt="" coords="421,157,521,184"/><area shape="rect" id="node7" href="../../d6/d8e/group__kkc__sock__class.html#ga00d8b033d3e1118303e7b4c54c6aafe6" title="&lt;&lt;public&gt;&gt; Socket name accessor." alt="" coords="387,107,554,133"/><area shape="rect" id="node8" href="../../d6/d8e/group__kkc__sock__class.html#gadf1b231c727891d5ac2d32646d574931" title="&lt;&lt;public&gt;&gt; Peer socket name accessor." alt="" coords="611,157,771,184"/><area shape="rect" id="node10" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga532181c3f7224fe5aa7651a69e6ad6b4" title="&lt;&lt;public&gt;&gt; This method is used when initializing a new entry." alt="" coords="621,351,760,377"/><area shape="rect" id="node15" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga71558bf14c4a13eed4e4b9ca240fd016" title="&lt;&lt;public&gt;&gt; Increments the number of links referencing this entry&#39;s inode." alt="" coords="401,259,540,301"/><area shape="rect" id="node11" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga986b629882729daaf2c9607bfca57c3c" title="&lt;&lt;public&gt;&gt; Entry name accessor." alt="" coords="823,427,977,453"/><area shape="rect" id="node12" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga4fbd3f1c3789bd79d4e2c684fc08d1a2" title="&lt;&lt;private&gt;&gt; Checks whether a directory entry contains entry of the specified name" alt="" coords="822,325,978,352"/><area shape="rect" id="node13" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga256f5088d3434bfadcdb0cb59bf25cb7" title="&lt;&lt;private&gt;&gt; A method for inode allocation." alt="" coords="829,376,971,403"/><area shape="rect" id="node14" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#gaeeb7fba5f385c90d93878a60a4dcf1dc" title="&lt;&lt;private&gt;&gt; The new dentry is allocated based on the parent&#39;s dentry and the current name of the ..." alt="" coords="826,259,974,301"/><area shape="rect" id="node18" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga5323f5b0f103dd3c42defc6c4494e641" title="&lt;&lt;public&gt;&gt; Locks this file instance." alt="" coords="405,528,537,555"/><area shape="rect" id="node19" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gaddf76bb53a90657e6773b485e0a89248" title="This method is used when object associated with the file wants to unregister with the file..." alt="" coords="381,579,560,605"/><area shape="rect" id="node21" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gad49b6ab401eeac4dab0ecd314796d569" title="&lt;&lt;public&gt;&gt; Unlocks this file instance." alt="" coords="397,477,544,504"/><area shape="rect" id="node20" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga8c97fc25ab3bd060017a3539edf7d6f0" title="&lt;&lt;public&gt;&gt; Sets the unregistered flag of the file." alt="" coords="608,569,773,610"/><area shape="rect" id="node23" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gafcb50575d3f6cc783130766295300741" title="&lt;&lt;private&gt;&gt; This is a generic method, that creates a new instance of a file as follows:" alt="" coords="384,376,557,403"/><area shape="rect" id="node25" href="../../d6/d8e/group__kkc__sock__class.html#ga705b6d499116fcd74f3d5bdfcbf7564d" title="&lt;&lt;public&gt;&gt; Architecture name accessor." alt="" coords="391,631,551,657"/><area shape="rect" id="node26" href="../../d5/ddf/group__kkc__arch__class.html#ga84a8539c1971651af4a8ad753c7853e5" title="&lt;&lt;public&gt;&gt; Architecture name accessor." alt="" coords="633,635,748,661"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gaf237e9aa6b0c62e2b152df0951226972"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../da/d0c/group__tcmi__slot__class.html#ga97f49e924fec185311972baf87d31897">tcmi_slot_node_t</a>* tcmi_sock_node </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock">tcmi_sock</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Sock node accessor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this instance </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>tcmi_slot_node </dd></dl>

<p>Definition at line <a class="el" href="../../d9/d2c/tcmi__sock_8h_source.html#l00139">139</a> of file <a class="el" href="../../d9/d2c/tcmi__sock_8h_source.html">tcmi_sock.h</a>.</p>

<p>Referenced by <a class="el" href="../../d2/de0/tcmi__ccnman_8c_source.html#l00302">tcmi_ccnman_listen()</a>, and <a class="el" href="../../d2/de0/tcmi__ccnman_8c_source.html#l00552">tcmi_ccnman_thread()</a>.</p>
<div class="fragment"><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;{</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">if</span> (!<span class="keyword">self</span>)</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">return</span> &amp;<span class="keyword">self</span>-&gt;node;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaa64951d80cedfaf76bb82ee811255d69"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tcmi_sock_put </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock">tcmi_sock</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Releases the instance. </p>
<p>&lt;&lt;public&gt;&gt; Releases the instance.</p>
<p>Unregistering the file is safe as the access is internally serialized by TCMI ctlfs - the instance is removed from the file and drop its reference counter.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this listening instance </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../da/d37/tcmi__sock_8c_source.html#l00128">128</a> of file <a class="el" href="../../da/d37/tcmi__sock_8c_source.html">tcmi_sock.c</a>.</p>

<p>References <a class="el" href="../../df/dfa/kkc__sock_8h_source.html#l00269">kkc_sock_put()</a>, <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d0/dc1/proxyfs__server_8c_source.html#l00059">self</a>, <a class="el" href="../../df/d2f/tcmi__ctlfs__entry_8h_source.html#l00214">tcmi_ctlfs_entry_put()</a>, and <a class="el" href="../../d2/d0f/tcmi__ctlfs__file_8c_source.html#l00154">tcmi_ctlfs_file_unregister()</a>.</p>

<p>Referenced by <a class="el" href="../../d2/de0/tcmi__ccnman_8c_source.html#l00366">tcmi_ccnman_stop_listen_all()</a>, <a class="el" href="../../d2/de0/tcmi__ccnman_8c_source.html#l00402">tcmi_ccnman_stop_listen_one()</a>, <a class="el" href="../../d2/de0/tcmi__ccnman_8c_source.html#l00552">tcmi_ccnman_thread()</a>, <a class="el" href="../../d6/d82/tcmi__migman_8c_source.html#l00228">tcmi_migman_free()</a>, and <a class="el" href="../../d6/d82/tcmi__migman_8c_source.html#l00081">tcmi_migman_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;{</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">self</span> &amp;&amp; atomic_dec_and_test(&amp;self-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#ab4dd171a39dffd446e77e12e1f7ea434" title="Instance reference counter.">ref_count</a>)) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO4, <span class="stringliteral">&quot;Destroying TCMI socket memory=%p&quot;</span>, <span class="keyword">self</span>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <a class="code" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga665210941a04fda118949874767ced93" title="&lt;&lt;public&gt;&gt; This method unregisters the file uses the semaphore lock as protection from races...">tcmi_ctlfs_file_unregister</a>(self-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#a577a92e31ab800dc56309401249535f4" title="TCMI ctlfs - shows the architecture name.">f_archname</a>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d...">tcmi_ctlfs_entry_put</a>(self-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#a577a92e31ab800dc56309401249535f4" title="TCMI ctlfs - shows the architecture name.">f_archname</a>);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <a class="code" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga665210941a04fda118949874767ced93" title="&lt;&lt;public&gt;&gt; This method unregisters the file uses the semaphore lock as protection from races...">tcmi_ctlfs_file_unregister</a>(self-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#a4c2c82e7ba326b2aed1e1c821ad188de" title="TCMI ctlfs - shows the remote socketa addres - meaningful for connected sockets only.">f_peername</a>);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d...">tcmi_ctlfs_entry_put</a>(self-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#a4c2c82e7ba326b2aed1e1c821ad188de" title="TCMI ctlfs - shows the remote socketa addres - meaningful for connected sockets only.">f_peername</a>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <a class="code" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga665210941a04fda118949874767ced93" title="&lt;&lt;public&gt;&gt; This method unregisters the file uses the semaphore lock as protection from races...">tcmi_ctlfs_file_unregister</a>(self-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#add614dc866c09d444f4f95b6ba5aa127" title="TCMI ctlfs - shows the local socket address.">f_sockname</a>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d...">tcmi_ctlfs_entry_put</a>(self-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#add614dc866c09d444f4f95b6ba5aa127" title="TCMI ctlfs - shows the local socket address.">f_sockname</a>);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d...">tcmi_ctlfs_entry_put</a>(self-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#a63b56f4af05952a1446d24002fb3e04e" title="TCMI ctlfs directory where there are the control files of the listening.">d_id</a>);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <a class="code" href="../../d6/d8e/group__kkc__sock__class.html#ga9f980056fbf3436596c4cfdf3913e85c" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined...">kkc_sock_put</a>(self-&gt;<a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#a2b9ba27d237ea2b934e7dfd8cf85d054" title="KKC socket contained in the instance.">sock</a>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        kfree(<span class="keyword">self</span>);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d3/d7e/group__tcmi__sock__class_gaa64951d80cedfaf76bb82ee811255d69_cgraph.png" border="0" usemap="#d3/d7e/group__tcmi__sock__class_gaa64951d80cedfaf76bb82ee811255d69_cgraph" alt=""/></div>
<map name="d3/d7e/group__tcmi__sock__class_gaa64951d80cedfaf76bb82ee811255d69_cgraph" id="d3/d7e/group__tcmi__sock__class_gaa64951d80cedfaf76bb82ee811255d69_cgraph">
<area shape="rect" id="node2" href="../../d6/d8e/group__kkc__sock__class.html#ga9f980056fbf3436596c4cfdf3913e85c" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined..." alt="" coords="191,81,294,108"/><area shape="rect" id="node8" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d..." alt="" coords="173,157,312,184"/><area shape="rect" id="node10" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga665210941a04fda118949874767ced93" title="&lt;&lt;public&gt;&gt; This method unregisters the file uses the semaphore lock as protection from races..." alt="" coords="160,233,325,260"/><area shape="rect" id="node3" href="../../d5/ddf/group__kkc__arch__class.html#ga06049c969ae0324d0607f10db99af65c" title="&lt;&lt;public&gt;&gt; Decrements the reference counter on the module owning the architecture." alt="" coords="413,5,513,32"/><area shape="rect" id="node4" href="../../d6/d8e/group__kkc__sock__class.html#ga00d8b033d3e1118303e7b4c54c6aafe6" title="&lt;&lt;public&gt;&gt; Socket name accessor." alt="" coords="379,56,546,83"/><area shape="rect" id="node6" href="../../d6/d8e/group__kkc__sock__class.html#gac8e64f52015e75cb76a34c4b7e9ef176" title="&lt;&lt;public&gt;&gt; Socket name accessor." alt="" coords="377,107,548,133"/><area shape="rect" id="node5" href="../../d6/d8e/group__kkc__sock__class.html#gadf1b231c727891d5ac2d32646d574931" title="&lt;&lt;public&gt;&gt; Peer socket name accessor." alt="" coords="603,56,763,83"/><area shape="rect" id="node7" href="../../d6/d8e/group__kkc__sock__class.html#ga3cae649f56c8f5fa18f755f6c7d53597" title="&lt;&lt;public&gt;&gt; Local socket name accessor." alt="" coords="601,107,764,133"/><area shape="rect" id="node9" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga986b629882729daaf2c9607bfca57c3c" title="&lt;&lt;public&gt;&gt; Entry name accessor." alt="" coords="386,157,539,184"/><area shape="rect" id="node11" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga5323f5b0f103dd3c42defc6c4494e641" title="&lt;&lt;public&gt;&gt; Locks this file instance." alt="" coords="397,208,529,235"/><area shape="rect" id="node12" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gaddf76bb53a90657e6773b485e0a89248" title="This method is used when object associated with the file wants to unregister with the file..." alt="" coords="373,259,552,285"/><area shape="rect" id="node14" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gad49b6ab401eeac4dab0ecd314796d569" title="&lt;&lt;public&gt;&gt; Unlocks this file instance." alt="" coords="389,309,536,336"/><area shape="rect" id="node13" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga8c97fc25ab3bd060017a3539edf7d6f0" title="&lt;&lt;public&gt;&gt; Sets the unregistered flag of the file." alt="" coords="600,251,765,293"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun Apr 7 2013 23:20:18 for Clondike by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
