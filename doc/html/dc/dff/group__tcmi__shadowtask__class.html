<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Clondike: tcmi_shadowtask class</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Clondike
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dc/dff/group__tcmi__shadowtask__class.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">tcmi_shadowtask class<div class="ingroups"><a class="el" href="../../de/d2f/group__tcmi__task__class.html">tcmi_task class</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>This class is an abstraction for a migrated process on CCN.  
<a href="#details">More...</a></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for tcmi_shadowtask class:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<center><table><tr><td><img src="../../dc/dff/group__tcmi__shadowtask__class.png" border="0" alt="" usemap="#dc_2dff_2group____tcmi____shadowtask____class"/>
<map name="dc_2dff_2group____tcmi____shadowtask____class" id="dc_2dff_2group____tcmi____shadowtask____class">
<area shape="rect" id="node1" href="../../de/d2f/group__tcmi__task__class.html" title="TCMI task is an abstraction for any process in the system that participates in migration." alt="" coords="5,5,120,32"/></map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:d9/d98/structtcmi__shadowtask"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dff/group__tcmi__shadowtask__class.html#d9/d98/structtcmi__shadowtask">tcmi_shadowtask</a></td></tr>
<tr class="memdesc:d9/d98/structtcmi__shadowtask"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compound structure for the shadow task.  <a href="../../dc/dff/group__tcmi__shadowtask__class.html#d9/d98/structtcmi__shadowtask">More...</a><br/></td></tr>
<tr class="separator:d9/d98/structtcmi__shadowtask"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gaead05b1f37cf8a8741dd622d93cff516"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dff/group__tcmi__shadowtask__class.html#gaead05b1f37cf8a8741dd622d93cff516">TCMI_SHADOWTASK</a>(t)&#160;&#160;&#160;((struct <a class="el" href="../../dc/dff/group__tcmi__shadowtask__class.html#d9/d98/structtcmi__shadowtask">tcmi_shadowtask</a>*)t)</td></tr>
<tr class="memdesc:gaead05b1f37cf8a8741dd622d93cff516"><td class="mdescLeft">&#160;</td><td class="mdescRight">Casts to the task instance.  <a href="#gaead05b1f37cf8a8741dd622d93cff516">More...</a><br/></td></tr>
<tr class="separator:gaead05b1f37cf8a8741dd622d93cff516"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gafe0d1448f55b9fef0832b44a3128b2ad"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dff/group__tcmi__shadowtask__class.html#gafe0d1448f55b9fef0832b44a3128b2ad">tcmi_shadowtask_process_msg</a> (struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *m)</td></tr>
<tr class="memdesc:gafe0d1448f55b9fef0832b44a3128b2ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Processes a message specified by the caller.  <a href="#gafe0d1448f55b9fef0832b44a3128b2ad">More...</a><br/></td></tr>
<tr class="separator:gafe0d1448f55b9fef0832b44a3128b2ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga13c386f8b5320b2aa774cf5ec9010407"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dff/group__tcmi__shadowtask__class.html#ga13c386f8b5320b2aa774cf5ec9010407">tcmi_shadowtask_vfork_done</a> (struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="separator:ga13c386f8b5320b2aa774cf5ec9010407"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6c190ae8422d516d13dc517e2d89d2cd"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dff/group__tcmi__shadowtask__class.html#ga6c190ae8422d516d13dc517e2d89d2cd">tcmi_shadowtask_emigrate_p</a> (struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, struct <a class="el" href="../../d9/d10/tcmi__npm__params_8h.html#db/d53/structtcmi__npm__params">tcmi_npm_params</a> *npm_params)</td></tr>
<tr class="memdesc:ga6c190ae8422d516d13dc517e2d89d2cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal helper method that can perform both NPM and PPM physical emigration.  <a href="#ga6c190ae8422d516d13dc517e2d89d2cd">More...</a><br/></td></tr>
<tr class="separator:ga6c190ae8422d516d13dc517e2d89d2cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae54626726bfe8d29214acb323742e49e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dff/group__tcmi__shadowtask__class.html#gae54626726bfe8d29214acb323742e49e">tcmi_shadowtask_emigrate_ppm_p</a> (struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:gae54626726bfe8d29214acb323742e49e"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Emigrates a task to a PEN.  <a href="#gae54626726bfe8d29214acb323742e49e">More...</a><br/></td></tr>
<tr class="separator:gae54626726bfe8d29214acb323742e49e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae6a187e64a35dcea926a89060ce6bdae"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dff/group__tcmi__shadowtask__class.html#gae6a187e64a35dcea926a89060ce6bdae">tcmi_shadowtask_emigrate_npm</a> (struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, struct <a class="el" href="../../d9/d10/tcmi__npm__params_8h.html#db/d53/structtcmi__npm__params">tcmi_npm_params</a> *npm_params)</td></tr>
<tr class="separator:gae6a187e64a35dcea926a89060ce6bdae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacff748e4399d3c718a848f9e914e2c04"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dff/group__tcmi__shadowtask__class.html#gacff748e4399d3c718a848f9e914e2c04">tcmi_shadowtask_migrateback_ppm_p</a> (struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:gacff748e4399d3c718a848f9e914e2c04"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Migrates a task back to CCN.  <a href="#gacff748e4399d3c718a848f9e914e2c04">More...</a><br/></td></tr>
<tr class="separator:gacff748e4399d3c718a848f9e914e2c04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5aabc354e036491ef0b5466fab4808fb"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dff/group__tcmi__shadowtask__class.html#ga5aabc354e036491ef0b5466fab4808fb">tcmi_shadowtask_execve</a> (struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:ga5aabc354e036491ef0b5466fab4808fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Execve notification when merging shadow with migrating process on CCN.  <a href="#ga5aabc354e036491ef0b5466fab4808fb">More...</a><br/></td></tr>
<tr class="separator:ga5aabc354e036491ef0b5466fab4808fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad36c4dd7e78162d76c7341688a8f42b5"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dff/group__tcmi__shadowtask__class.html#gad36c4dd7e78162d76c7341688a8f42b5">tcmi_shadowtask_do_signal</a> (struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, unsigned long signr, siginfo_t *<a class="el" href="../../d6/d23/tcmi__signal__msg_8h.html#a7d5c5f5b173fb960963b2c44980dc940">info</a>)</td></tr>
<tr class="memdesc:gad36c4dd7e78162d76c7341688a8f42b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Processes a specified signal.  <a href="#gad36c4dd7e78162d76c7341688a8f42b5">More...</a><br/></td></tr>
<tr class="separator:gad36c4dd7e78162d76c7341688a8f42b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac80577a00603ae888241ced646f230e7"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dff/group__tcmi__shadowtask__class.html#gac80577a00603ae888241ced646f230e7">tcmi_shadowtask_verify_migration</a> (struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *<a class="el" href="../../d1/d6d/tcmi__msg_8h.html#adb26817b6c4a9eeb3f68c832f24d5471">resp</a>)</td></tr>
<tr class="memdesc:gac80577a00603ae888241ced646f230e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Verifies, that the task has been successfully migrated.  <a href="#gac80577a00603ae888241ced646f230e7">More...</a><br/></td></tr>
<tr class="separator:gac80577a00603ae888241ced646f230e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0329a0dc8d8d862cb40c66faebc21211"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dff/group__tcmi__shadowtask__class.html#ga0329a0dc8d8d862cb40c66faebc21211">tcmi_shadowtask_process_ppm_p_migr_back_guestreq_procmsg</a> (struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *m)</td></tr>
<tr class="memdesc:ga0329a0dc8d8d862cb40c66faebc21211"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Processes the PPM_P emigrate process message.  <a href="#ga0329a0dc8d8d862cb40c66faebc21211">More...</a><br/></td></tr>
<tr class="separator:ga0329a0dc8d8d862cb40c66faebc21211"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga881ec0021bc7db3f376bde3d04e77541"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dff/group__tcmi__shadowtask__class.html#ga881ec0021bc7db3f376bde3d04e77541">tcmi_shadowtask_free</a> (struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:ga881ec0021bc7db3f376bde3d04e77541"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Custom free method  <a href="#ga881ec0021bc7db3f376bde3d04e77541">More...</a><br/></td></tr>
<tr class="separator:ga881ec0021bc7db3f376bde3d04e77541"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3224d8fc9ab8c8765f1b803cb91c861c"><td class="memItemLeft" align="right" valign="top">enum tcmi_task_type&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dff/group__tcmi__shadowtask__class.html#ga3224d8fc9ab8c8765f1b803cb91c861c">tcmi_shadowtask_get_type</a> (void)</td></tr>
<tr class="memdesc:ga3224d8fc9ab8c8765f1b803cb91c861c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return type of task.  <a href="#ga3224d8fc9ab8c8765f1b803cb91c861c">More...</a><br/></td></tr>
<tr class="separator:ga3224d8fc9ab8c8765f1b803cb91c861c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5a1a66f6d53a0cbd079627b64d04b0ed"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dff/group__tcmi__shadowtask__class.html#ga5a1a66f6d53a0cbd079627b64d04b0ed">tcmi_shadowtask_new</a> (pid_t local_pid, struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *migman, struct <a class="el" href="../../d6/d8e/group__kkc__sock__class.html#da/d0d/structkkc__sock">kkc_sock</a> *sock, struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *d_migproc, struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *d_migman)</td></tr>
<tr class="memdesc:ga5a1a66f6d53a0cbd079627b64d04b0ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Creates a new shadow task.  <a href="#ga5a1a66f6d53a0cbd079627b64d04b0ed">More...</a><br/></td></tr>
<tr class="separator:ga5a1a66f6d53a0cbd079627b64d04b0ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga4ce31f95511b3a387b75a304c9464f3e"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d5/d04/structtcmi__task__ops">tcmi_task_ops</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dff/group__tcmi__shadowtask__class.html#ga4ce31f95511b3a387b75a304c9464f3e">shadowtask_ops</a></td></tr>
<tr class="memdesc:ga4ce31f95511b3a387b75a304c9464f3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">TCMI task operations that support polymorphism.  <a href="#ga4ce31f95511b3a387b75a304c9464f3e">More...</a><br/></td></tr>
<tr class="separator:ga4ce31f95511b3a387b75a304c9464f3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>This class is an abstraction for a migrated process on CCN. </p>
<p>It represents the residual dependency that the migrated process has towards its originating node(CCN). This class also does all the migration work including migration back to CCN (merging the shadow with the process migrating home). For this purpose, there are various methods that implement various types of migration:</p>
<ul>
<li>preemptive migration using physical checkpoint image (tcmi_shadowtask_*_ppm_p())</li>
<li>preemptive migration using virtual checkpoint image (tcmi_shadowtask_*_ppm_v())</li>
<li>non-preemptive migration via execve hook (tcmi_shadowtask_*_npm()) </li>
</ul>
<hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="d9/d98/structtcmi__shadowtask" id="d9/d98/structtcmi__shadowtask"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct tcmi_shadowtask</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Compound structure for the shadow task. </p>

<p>Definition at line <a class="el" href="../../d8/dcb/tcmi__shadowtask_8h_source.html#l00056">56</a> of file <a class="el" href="../../d8/dcb/tcmi__shadowtask_8h_source.html">tcmi_shadowtask.h</a>.</p>
</div><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for tcmi_shadowtask:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d4/d05/structtcmi__shadowtask__coll__graph.png" border="0" usemap="#tcmi__shadowtask_coll__map" alt="Collaboration graph"/></div>
<map name="tcmi__shadowtask_coll__map" id="tcmi__shadowtask_coll__map">
<area shape="rect" id="node2" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task" title="Compound structure that gathers necessary process information." alt="" coords="396,1315,519,1583"/><area shape="rect" id="node3" href="../../de/d2f/group__tcmi__task__class.html#d5/d04/structtcmi__task__ops" title="TCMI task operations that support polymorphism." alt="" coords="5,1011,155,1250"/><area shape="rect" id="node4" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec" title="A slot vector compound structure." alt="" coords="354,723,464,888"/><area shape="rect" id="node6" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman" title="A compound structure that holds all current shadow processes and other migration related data..." alt="" coords="537,1041,660,1221"/><area shape="rect" id="node5" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot" title="A slot compound structure." alt="" coords="521,451,631,616"/><area shape="rect" id="node7" href="../../d3/d7e/group__tcmi__sock__class.html#da/dba/structtcmi__sock" title="A compound structure that holds the actual KKC listening." alt="" coords="489,759,575,851"/><area shape="rect" id="node8" href="../../d6/d8e/group__kkc__sock__class.html#da/d0d/structkkc__sock" title="A coumpound structure that contains generic information about a KKC socket." alt="" coords="215,458,344,609"/><area shape="rect" id="node16" href="../../d9/dfc/group__tcmi__comm__class.html#de/d0f/structtcmi__comm" title="Compound structure that holds reference to the connection and the user method." alt="" coords="231,737,329,873"/><area shape="rect" id="node9" href="../../d5/ddf/group__kkc__arch__class.html#db/d0a/structkkc__arch" title="Compound structure, describes one particular architecture." alt="" coords="135,213,209,320"/><area shape="rect" id="node10" href="../../d5/ddf/group__kkc__arch__class.html#d0/d60/structkkc__arch__ops" title="Architecture specific operations." alt="" coords="101,5,243,83"/><area shape="rect" id="node11" href="../../d6/d8e/group__kkc__sock__class.html#d9/db1/structkkc__sock__ops" title="Socket operations that support polymorphism." alt="" coords="234,147,397,386"/><area shape="rect" id="node12" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry" title="An entry compound structure." alt="" coords="857,487,972,579"/><area shape="rect" id="node13" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#df/d10/structtcmi__ctlfs__ops" title="entry operations that support polymorphism" alt="" coords="859,228,971,305"/><area shape="rect" id="node14" href="../../d6/da2/group__tcmi__migman__class.html#d6/d88/structtcmi__migman__ops" title="Migration manager operations that support polymorphism." alt="" coords="739,723,867,888"/><area shape="rect" id="node15" href="../../dc/d0c/group__tcmi__queue__class.html#d5/d9a/structtcmi__queue" title="compound structure" alt="" coords="1013,737,1101,873"/></map>
</div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a2adc0eb0f4a61545a6ad008e5ae66e8d"></a>struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a></td>
<td class="fieldname">
super</td>
<td class="fielddoc">
parent class instance. </td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="gaead05b1f37cf8a8741dd622d93cff516"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCMI_SHADOWTASK</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t</td><td>)</td>
          <td>&#160;&#160;&#160;((struct <a class="el" href="../../dc/dff/group__tcmi__shadowtask__class.html#d9/d98/structtcmi__shadowtask">tcmi_shadowtask</a>*)t)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Casts to the task instance. </p>

<p>Definition at line <a class="el" href="../../d8/dcb/tcmi__shadowtask_8h_source.html#l00063">63</a> of file <a class="el" href="../../d8/dcb/tcmi__shadowtask_8h_source.html">tcmi_shadowtask.h</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00089">tcmi_shadowtask_new()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gad36c4dd7e78162d76c7341688a8f42b5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_shadowtask_do_signal </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>signr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">siginfo_t *&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Processes a specified signal. </p>
<p>All signals are forwared to the guest task.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this task instance </td></tr>
    <tr><td class="paramname">signr</td><td>- signal that is to be processed </td></tr>
    <tr><td class="paramname">*info</td><td>- info for signal to be processed</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TCMI_TASK_KEEP_PUMPING on any signal but second or more SIGKILL </dd></dl>

<p>Definition at line <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00384">384</a> of file <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html">tcmi_shadowtask.c</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d0/dc1/proxyfs__server_8c_source.html#l00059">self</a>, <a class="el" href="../../d8/d88/tcmi__migman_8h_source.html#l00307">tcmi_migman_sock()</a>, <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html#l00138">tcmi_msg_send_anonymous()</a>, <a class="el" href="../../d3/d5b/tcmi__signal__msg_8c_source.html#l00168">tcmi_signal_msg_new()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00648">tcmi_task_check_peer_lost()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00252">TCMI_TASK_KEEP_PUMPING</a>, and <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00422">tcmi_task_remote_pid()</a>.</p>
<div class="fragment"><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;{</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordtype">int</span> res = <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ggaa81f1a7178bfcf01d74e57d6bbcb869bafa7c813a4364ccccdc1edfd29839c675">TCMI_TASK_KEEP_PUMPING</a>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg" title="A coumpound structure that carries a generic TCMI message.">tcmi_msg</a> *msg;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO2, <span class="stringliteral">&quot;Shadow is processing signal %lu&quot;</span>, signr);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    msg = <a class="code" href="../../d8/d7b/group__tcmi__signal__msg__class.html#gaf1e2be73e14e6b57351003b2a19e72c6" title="&lt;&lt;public&gt;&gt; Construktor for sending with initialization">tcmi_signal_msg_new</a>(<a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga2f054ae4772c0921004eebdb48d39dcf" title="&lt;&lt;public&gt;&gt; Remote PID accessor.">tcmi_task_remote_pid</a>(<span class="keyword">self</span>), <a class="code" href="../../d6/d23/tcmi__signal__msg_8h.html#a7d5c5f5b173fb960963b2c44980dc940" title="Siginfo structure (we can use directly this structure as it is padded to be exactly 128 bytes)...">info</a>);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">if</span>( msg ){</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <a class="code" href="../../de/d2f/group__tcmi__task__class.html#gac04862f389dea22fbd5b8dc8f642ca9c" title="Simple error checking method to be used after communication operations to detect lost peer...">tcmi_task_check_peer_lost</a>(<span class="keyword">self</span>, <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ga7a8fe8cbfd4b25c15589c8599f66e574" title="&lt;&lt;public&gt;&gt; Sends a message via a specified connection.">tcmi_msg_send_anonymous</a>(msg, <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ga91bf5b41a1d4faa3eab11e6867ec34e4" title="&lt;&lt;public&gt;&gt; Communication socket accesor.">tcmi_migman_sock</a>(self-&gt;<a class="code" href="../../de/d2f/group__tcmi__task__class.html#a2efb62586c1f4f7e0e5438fd20ec1008" title="Reference to a migration manager to which this task belongs to.">migman</a>)));</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO2, <span class="stringliteral">&quot;Signal message send&quot;</span>);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../dc/dff/group__tcmi__shadowtask__class_gad36c4dd7e78162d76c7341688a8f42b5_cgraph.png" border="0" usemap="#dc/dff/group__tcmi__shadowtask__class_gad36c4dd7e78162d76c7341688a8f42b5_cgraph" alt=""/></div>
<map name="dc/dff/group__tcmi__shadowtask__class_gad36c4dd7e78162d76c7341688a8f42b5_cgraph" id="dc/dff/group__tcmi__shadowtask__class_gad36c4dd7e78162d76c7341688a8f42b5_cgraph">
<area shape="rect" id="node2" href="../../d6/da2/group__tcmi__migman__class.html#ga91bf5b41a1d4faa3eab11e6867ec34e4" title="&lt;&lt;public&gt;&gt; Communication socket accesor." alt="" coords="225,200,359,227"/><area shape="rect" id="node4" href="../../d6/dc2/group__tcmi__msg__class.html#ga7a8fe8cbfd4b25c15589c8599f66e574" title="&lt;&lt;public&gt;&gt; Sends a message via a specified connection." alt="" coords="198,263,386,289"/><area shape="rect" id="node15" href="../../d8/d7b/group__tcmi__signal__msg__class.html#gaf1e2be73e14e6b57351003b2a19e72c6" title="&lt;&lt;public&gt;&gt; Construktor for sending with initialization" alt="" coords="217,320,367,347"/><area shape="rect" id="node37" href="../../de/d2f/group__tcmi__task__class.html#gac04862f389dea22fbd5b8dc8f642ca9c" title="Simple error checking method to be used after communication operations to detect lost peer..." alt="" coords="201,371,383,397"/><area shape="rect" id="node42" href="../../de/d2f/group__tcmi__task__class.html#ga2f054ae4772c0921004eebdb48d39dcf" title="&lt;&lt;public&gt;&gt; Remote PID accessor." alt="" coords="217,421,367,448"/><area shape="rect" id="node3" href="../../d3/d7e/group__tcmi__sock__class.html#ga8573cfac9adbb5996cd90395d8a78502" title="&lt;&lt;public&gt;&gt; KKC socket accessor." alt="" coords="440,197,611,224"/><area shape="rect" id="node5" href="../../d6/dc2/group__tcmi__msg__class.html#ga1c21eeafb9a0d56dabb025d5fbdc0bc3" title="&lt;&lt;private&gt;&gt; Sends a message via a specified connection." alt="" coords="468,248,583,275"/><area shape="rect" id="node6" href="../../d6/d8e/group__kkc__sock__class.html#gad734b131e2ab00e8d7fa30737fc2f5ad" title="&lt;&lt;public&gt;&gt; Sends out specified data." alt="" coords="713,223,826,249"/><area shape="rect" id="node8" href="../../d6/d8e/group__kkc__sock__class.html#ga141590d302ece9990e5c8cdd82a3c3d8" title="&lt;&lt;public&gt;&gt; Locks this socket instance for sending, interruptible version, the process can be woken up..." alt="" coords="664,273,875,300"/><area shape="rect" id="node9" href="../../d6/d8e/group__kkc__sock__class.html#ga841d6dff84842f19540eae27c37fcb4c" title="&lt;&lt;public&gt;&gt; Unlocks this socket instance for sending." alt="" coords="694,96,845,123"/><area shape="rect" id="node10" href="../../d4/d8c/group__tcmi__transaction__class.html#ga653b1761a1b6e9fef415196c54e00768" title="&lt;&lt;public&gt;&gt; Starts a transaction." alt="" coords="694,147,845,173"/><area shape="rect" id="node7" href="../../d6/d8e/group__kkc__sock__class.html#gaff5e8804c93f0cb2a4b5e2e12f64e743" title="&lt;&lt;private&gt;&gt; Transfers a required number of bytes." alt="" coords="933,223,1075,249"/><area shape="rect" id="node11" href="../../d4/d8c/group__tcmi__transaction__class.html#gaba57811a17b10df187e7918d02e3679e" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="929,121,1079,148"/><area shape="rect" id="node12" href="../../d4/d8c/group__tcmi__transaction__class.html#ga176151d0f528ed8cda13e21da8551519" title="&lt;&lt;public&gt;&gt; Instance accessor." alt="" coords="933,172,1075,199"/><area shape="rect" id="node13" href="../../d4/d8c/group__tcmi__transaction__class.html#ga1dfece4fcea1c1b9ce676f560957077f" title="&lt;&lt;public&gt;&gt; Sets flags in the transaction that denote additional transaction attributes." alt="" coords="933,5,1075,46"/><area shape="rect" id="node14" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2c5c24c4b88dae68aa68c7b043d105b8" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="923,71,1085,97"/><area shape="rect" id="node16" href="../../d8/d7b/group__tcmi__signal__msg__class.html#gadec6208e448cacf50a000cc04a866381" title="&lt;&lt;public&gt;&gt; Skeleton message tx constructor." alt="" coords="441,321,609,348"/><area shape="rect" id="node17" href="../../d6/dc2/group__tcmi__msg__class.html#gace79df438ec4f7c8f7cee3bfe42f6d93" title="&lt;&lt;public&gt;&gt; Initializes the message for transferring." alt="" coords="709,324,830,351"/><area shape="rect" id="node18" href="../../db/dc8/tcmi__msg_8c.html#a5c394462e393c496f11d949b265b8a9e" title="Shared initialization fuction of both rx and tx messages." alt="" coords="929,324,1079,351"/><area shape="rect" id="node19" href="../../d4/d8c/group__tcmi__transaction__class.html#gada9d9436def8919a10997233cd6b5ea1" title="&lt;&lt;public&gt;&gt; Creates a new transaction." alt="" coords="930,375,1078,401"/><area shape="rect" id="node25" href="../../d4/d8c/group__tcmi__transaction__class.html#gaac666feaaab1fe5c341237a3e0283501" title="&lt;&lt;public&gt;&gt; Transaction ID accessor." alt="" coords="1546,375,1681,401"/><area shape="rect" id="node20" href="../../d4/d8c/group__tcmi__transaction__class.html#gad66082869d71dbe73b9a0b60cb2f437c" title="&lt;&lt;private&gt;&gt; Generates a transaction ID." alt="" coords="1133,324,1296,351"/><area shape="rect" id="node21" href="../../d0/db7/group__tcmi__slotvec__class.html#ga463d8dd03bd30b24c3ebfed5a0239d8a" title="&lt;&lt;public&gt;&gt; Hashmask accessor." alt="" coords="1134,375,1295,401"/><area shape="rect" id="node22" href="../../d4/d8c/group__tcmi__transaction__class.html#ga244e6188e1c4f9e1faba20d0892f5441" title="&lt;&lt;private&gt;&gt; Callback for the kernel timer that handles transaction timeouts." alt="" coords="1137,476,1292,503"/><area shape="rect" id="node34" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4f973395848150fbebecf3cc292c80ba" title="&lt;&lt;public&gt;&gt; The index where the insertion takes place has to be a valid slot." alt="" coords="1345,577,1495,604"/><area shape="rect" id="node23" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2748d267a8fddd1ced86e73ba8efd079" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="1349,476,1491,503"/><area shape="rect" id="node24" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="1551,476,1676,503"/><area shape="rect" id="node26" href="../../da/d0c/group__tcmi__slot__class.html#ga1d6232adcf00094597a66d9f5740d5f8" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="1552,527,1675,553"/><area shape="rect" id="node33" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="1544,425,1683,452"/><area shape="rect" id="node27" href="../../da/d0c/group__tcmi__slot__class.html#ga29d8101c5815a6519567c548da4a3c7e" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="1731,476,1869,503"/><area shape="rect" id="node31" href="../../da/d0c/group__tcmi__slot__class.html#ga109d6d783ebf06046f364f970f84da1f" title="&lt;&lt;public&gt;&gt; Locks the slot data." alt="" coords="1747,527,1853,553"/><area shape="rect" id="node32" href="../../da/d0c/group__tcmi__slot__class.html#ga5447231fec5f42040c40307eb2e6a13c" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="1740,577,1860,604"/><area shape="rect" id="node28" href="../../da/d0c/group__tcmi__slot__class.html#ga6dd63ff2854a9939a5aa094f6543a5d1" title="&lt;&lt;public&gt;&gt; Checks if the slot is empty." alt="" coords="1939,476,2058,503"/><area shape="rect" id="node29" href="../../da/d0c/group__tcmi__slot__class.html#ga2550a3e6624b54e323c73cb1d06e6cd0" title="&lt;&lt;public&gt;&gt; Moves a slot among unused_slots." alt="" coords="1918,552,2079,579"/><area shape="rect" id="node30" href="../../da/d0c/group__tcmi__slot__class.html#ga8d6885be2677819158e0d956f0cca5b2" title="&lt;&lt;private&gt;&gt; Moves a slot into the specified list." alt="" coords="2128,591,2240,617"/><area shape="rect" id="node35" href="../../d0/db7/group__tcmi__slotvec__class.html#ga876670f605631a5deb930412dae02b28" title="&lt;&lt;public&gt;&gt; Accesses a slot at a given index." alt="" coords="1557,628,1669,655"/><area shape="rect" id="node36" href="../../da/d0c/group__tcmi__slot__class.html#gaefe294678d9d6922b3af1e452a318fa1" title="&lt;&lt;public&gt;&gt; Inserts a new node into the slot." alt="" coords="1556,577,1671,604"/><area shape="rect" id="node38" href="../../de/d2f/group__tcmi__task__class.html#gad2d3dad02cf555da12cb2926cebb25f6" title="Notifies task that it peer is lost and sends a kill signal to that task." alt="" coords="435,373,615,400"/><area shape="rect" id="node39" href="../../de/d2f/group__tcmi__task__class.html#gac263213bf219960dea9c7d4b4e6f3b34" title="Returns a task_struct associated with the tcmi_task." alt="" coords="685,425,854,452"/><area shape="rect" id="node40" href="../../d8/d3c/util_8h.html#a5f449355b8f54aaed664de85f89092ea" title="task_find_by_pid" alt="" coords="945,425,1063,452"/><area shape="rect" id="node41" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="935,476,1073,503"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gae6a187e64a35dcea926a89060ce6bdae"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_shadowtask_emigrate_npm </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d9/d10/tcmi__npm__params_8h.html#db/d53/structtcmi__npm__params">tcmi_npm_params</a> *&#160;</td>
          <td class="paramname"><em>npm_params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00313">313</a> of file <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html">tcmi_shadowtask.c</a>.</p>

<p>References <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00205">tcmi_shadowtask_emigrate_p()</a>.</p>
<div class="fragment"><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;{</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/dff/group__tcmi__shadowtask__class.html#ga6c190ae8422d516d13dc517e2d89d2cd" title="Internal helper method that can perform both NPM and PPM physical emigration.">tcmi_shadowtask_emigrate_p</a>(<span class="keyword">self</span>, npm_params);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../dc/dff/group__tcmi__shadowtask__class_gae6a187e64a35dcea926a89060ce6bdae_cgraph.png" border="0" usemap="#dc/dff/group__tcmi__shadowtask__class_gae6a187e64a35dcea926a89060ce6bdae_cgraph" alt=""/></div>
<map name="dc/dff/group__tcmi__shadowtask__class_gae6a187e64a35dcea926a89060ce6bdae_cgraph" id="dc/dff/group__tcmi__shadowtask__class_gae6a187e64a35dcea926a89060ce6bdae_cgraph">
<area shape="rect" id="node2" href="../../dc/dff/group__tcmi__shadowtask__class.html#ga6c190ae8422d516d13dc517e2d89d2cd" title="Internal helper method that can perform both NPM and PPM physical emigration." alt="" coords="267,696,461,723"/><area shape="rect" id="node3" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="1227,195,1365,221"/><area shape="rect" id="node4" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga6c7491a9027159fd5a293bae24689a3c" title="&lt;&lt;public&gt;&gt; Creates a new checkpoint of the process." alt="" coords="509,427,693,453"/><area shape="rect" id="node15" href="../../df/df9/group__tcmi__p__emigrate__msg__class.html#ga93e25269556be44be9de2b73713d7081" title="&lt;&lt;public&gt;&gt; Physical emigration message tx constructor." alt="" coords="526,747,677,789"/><area shape="rect" id="node20" href="../../de/d2f/group__tcmi__task__class.html#ga86b8af90f121c51ad718c6965441972f" title="&lt;&lt;public&gt;&gt; Transactions accessor &#45; needed when tasks construct their own messages." alt="" coords="523,813,680,840"/><area shape="rect" id="node21" href="../../de/d2f/group__tcmi__task__class.html#ga44b0c0c985d4c3954c6e35d748d9638b" title="&lt;&lt;public&gt;&gt; Task checkpoint pathname accessor." alt="" coords="526,864,677,891"/><area shape="rect" id="node22" href="../../de/d2f/group__tcmi__task__class.html#gac04862f389dea22fbd5b8dc8f642ca9c" title="Simple error checking method to be used after communication operations to detect lost peer..." alt="" coords="511,5,692,32"/><area shape="rect" id="node25" href="../../de/d2f/group__tcmi__task__class.html#ga6f509d7a61c069c641e99fe32a57ef75" title="&lt;&lt;public&gt;&gt; Sends a specified message and waits for a response." alt="" coords="530,630,673,671"/><area shape="rect" id="node35" href="../../dc/dff/group__tcmi__shadowtask__class.html#gac80577a00603ae888241ced646f230e7" title="&lt;&lt;private&gt;&gt; Verifies, that the task has been successfully migrated." alt="" coords="522,217,681,258"/><area shape="rect" id="node41" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga403923e3422bd06870e36c8951def7fb" title="&lt;&lt;public&gt;&gt; Flushing files is required prior to issuing a migrate request." alt="" coords="516,915,687,941"/><area shape="rect" id="node42" href="../../d2/daf/group__tcmi__taskhelper__class.html#gac1c217309f2f0c54aa2ee7802f31eab2" title="&lt;&lt;public&gt;&gt; Set action for all signals accept SIGKILL and SIGSTOP" alt="" coords="525,966,678,1007"/><area shape="rect" id="node43" href="../../de/d2f/group__tcmi__task__class.html#ga0409e631915b37fbcfe096dfc498bbbb" title="&lt;&lt;public&gt;&gt; Submits a method for execution." alt="" coords="514,1032,689,1059"/><area shape="rect" id="node45" href="../../de/d2f/group__tcmi__task__class.html#ga491523e65c3fb2f665013a2f15899cb8" title="&lt;&lt;public&gt;&gt; Called from method queue &#45; Processes one message from the message queue." alt="" coords="519,579,683,605"/><area shape="rect" id="node49" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined..." alt="" coords="793,797,897,824"/><area shape="rect" id="node5" href="../../de/d2f/group__tcmi__task__class.html#ga24a9d8c612da1a4484b1b3a28a181c15" title="&lt;&lt;public&gt;&gt; Prepares execution of a file given the arrays of arguments and environment." alt="" coords="757,275,933,301"/><area shape="rect" id="node8" href="../../d4/dcf/group__tcmi__ckptcom__class.html#gaf223b90f9bab6b4b553448917adbbd08" title="&lt;&lt;public&gt;&gt; Creates a non&#45;preemptive process checkpoint." alt="" coords="742,325,949,352"/><area shape="rect" id="node13" href="../../de/d2f/group__tcmi__task__class.html#gade1e8f7b12614ca0fecbc40aaae9a6c5" title="&lt;&lt;public&gt;&gt; Process context accessor." alt="" coords="781,477,910,504"/><area shape="rect" id="node14" href="../../d4/dcf/group__tcmi__ckptcom__class.html#ga87d900819b5cc6bbe1144e22d4e03836" title="&lt;&lt;public&gt;&gt; Creates a preemptive process checkpoint." alt="" coords="742,427,949,453"/><area shape="rect" id="node6" href="../../de/d2f/group__tcmi__task__class.html#gad41453e0aefb9dd79c2d3b65d8b9b16c" title="&lt;&lt;private&gt;&gt; Releases the execve context (execve file, argv, envp) Since the argv/envp have alloca..." alt="" coords="998,326,1173,367"/><area shape="rect" id="node7" href="../../de/d84/tcmi__task_8c.html#ab73603e4adaf2a1bb6b7cf6a01a1c2f3" title="&lt;&lt;private&gt;&gt; Class method &#45; copies an array of strings terminated by NULL string (standard argv/envp f..." alt="" coords="1005,392,1165,419"/><area shape="rect" id="node9" href="../../db/d70/tcmi__ckptcom_8c.html#ac319abd397f2a8d28b1e248939019385" title="&lt;&lt;private&gt;&gt; Helper method that handles both PPM and NPM checkpoint creation" alt="" coords="998,443,1173,469"/><area shape="rect" id="node10" href="../../db/d06/tcmi__ckpt__fsstruct_8h.html#ad65f0acd5657cfc139569bd3a8a01bd4" title="Currently only current &quot;pwd&quot; of the process is migrated." alt="" coords="1231,494,1361,535"/><area shape="rect" id="node11" href="../../d9/d57/group__tcmi__ckpt__mm__class.html#ga5cc088b9c94de359d62e62be57b79636" title="Writes a current process memory descriptor into the checkpoint file." alt="" coords="1225,392,1367,419"/><area shape="rect" id="node12" href="../../df/d54/group__tcmi__ckpt__class.html#gaa428792c45bff6d4c204a1888bc45bb2" title="&lt;&lt;public&gt;&gt; Checkpoint constructor." alt="" coords="1241,443,1351,469"/><area shape="rect" id="node16" href="../../d6/dc2/group__tcmi__msg__class.html#gace79df438ec4f7c8f7cee3bfe42f6d93" title="&lt;&lt;public&gt;&gt; Initializes the message for transferring." alt="" coords="1025,904,1146,931"/><area shape="rect" id="node17" href="../../db/dc8/tcmi__msg_8c.html#a5c394462e393c496f11d949b265b8a9e" title="Shared initialization fuction of both rx and tx messages." alt="" coords="1221,904,1371,931"/><area shape="rect" id="node18" href="../../d4/d8c/group__tcmi__transaction__class.html#gada9d9436def8919a10997233cd6b5ea1" title="&lt;&lt;public&gt;&gt; Creates a new transaction." alt="" coords="1222,853,1370,880"/><area shape="rect" id="node19" href="../../d4/d8c/group__tcmi__transaction__class.html#gaac666feaaab1fe5c341237a3e0283501" title="&lt;&lt;public&gt;&gt; Transaction ID accessor." alt="" coords="1421,867,1555,893"/><area shape="rect" id="node23" href="../../de/d2f/group__tcmi__task__class.html#gad2d3dad02cf555da12cb2926cebb25f6" title="Notifies task that it peer is lost and sends a kill signal to that task." alt="" coords="755,5,935,32"/><area shape="rect" id="node24" href="../../de/d2f/group__tcmi__task__class.html#gac263213bf219960dea9c7d4b4e6f3b34" title="Returns a task_struct associated with the tcmi_task." alt="" coords="1001,5,1170,32"/><area shape="rect" id="node26" href="../../d6/dc2/group__tcmi__msg__class.html#gadcb05f36b8afb930d1a825ae12ff7d3c" title="&lt;&lt;public&gt;&gt; Sends a message via a specified connection and waits for the response." alt="" coords="751,747,940,773"/><area shape="rect" id="node27" href="../../d6/dc2/group__tcmi__msg__class.html#ga1c21eeafb9a0d56dabb025d5fbdc0bc3" title="&lt;&lt;private&gt;&gt; Sends a message via a specified connection." alt="" coords="1028,685,1143,712"/><area shape="rect" id="node28" href="../../d4/d8c/group__tcmi__transaction__class.html#gaadc5d69241ec4815bf37e041ec0844dc" title="&lt;&lt;public&gt;&gt; Waits on a transaction till it expires or is completed, the task can be prematurely woken ..." alt="" coords="1011,737,1159,778"/><area shape="rect" id="node29" href="../../d4/d8c/group__tcmi__transaction__class.html#ga8a1027d8451c92d105ff818b0bf09c1d" title="&lt;&lt;public&gt;&gt; Transaction context accessor." alt="" coords="1001,803,1169,829"/><area shape="rect" id="node30" href="../../d4/d8c/group__tcmi__transaction__class.html#gaec110b630e8c0935ddddfb0529a03368" title="&lt;&lt;public&gt;&gt; Aborting the transaction requires:" alt="" coords="1008,635,1163,661"/><area shape="rect" id="node31" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2748d267a8fddd1ced86e73ba8efd079" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="1225,777,1367,804"/><area shape="rect" id="node32" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="1425,765,1551,792"/><area shape="rect" id="node33" href="../../da/d0c/group__tcmi__slot__class.html#ga1d6232adcf00094597a66d9f5740d5f8" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="1427,816,1549,843"/><area shape="rect" id="node34" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="1419,715,1557,741"/><area shape="rect" id="node36" href="../../d6/dc2/group__tcmi__msg__class.html#ga73489766817f528da25369a3f4c713a1" title="&lt;&lt;public&gt;&gt; Message ID accessor." alt="" coords="797,376,893,403"/><area shape="rect" id="node37" href="../../d1/dc2/group__tcmi__guest__started__procmsg__class.html#gad1e35a7478f07eccff72ce8d47045d1a" title="&lt;&lt;public&gt;&gt; Stub PID accessor." alt="" coords="774,107,917,149"/><area shape="rect" id="node38" href="../../de/d2f/group__tcmi__task__class.html#ga60a2a872664867b7a86ec278b570fef2" title="&lt;&lt;public&gt;&gt; Remote PID setter." alt="" coords="758,173,933,200"/><area shape="rect" id="node39" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gac720ca77312808db7cbbc645be8e3541" title="&lt;&lt;public&gt;&gt; Creates a new instance of a file." alt="" coords="1013,107,1158,133"/><area shape="rect" id="node40" href="../../de/d2f/group__tcmi__task__class.html#ga401654abdc812f0a923d05c95b412fb1" title="tcmi_task_show_remote\l_pid_rev" alt="" coords="1004,158,1167,199"/><area shape="rect" id="node44" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#ga57cd57a64f1ec847f1b71452daf4b3b1" title="&lt;&lt;public&gt;&gt; Creates a new wrapper for the specified method." alt="" coords="756,1032,935,1059"/><area shape="rect" id="node46" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#gaaf4d02eac4338a675bd5ed2df9943c97" title="&lt;&lt;public&gt;&gt; Accessor for the data stored in the method wrapper." alt="" coords="755,528,936,555"/><area shape="rect" id="node47" href="../../dc/d0c/group__tcmi__queue__class.html#ga2b0f1376bcd561196e77599cbc23090f" title="tcmi_queue_empty" alt="" coords="1019,583,1151,609"/><area shape="rect" id="node48" href="../../dc/d0c/group__tcmi__queue__class.html#gae749f14f4593f9b0b48cf31fc43eaa17" title="&lt;&lt;public&gt;&gt; Puts the calling process to sleep as long as the queue is empty." alt="" coords="775,630,915,671"/><area shape="rect" id="node50" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#gaf0a8913b9f40f66641ad7076e023dd58" title="&lt;&lt;public&gt;&gt; Method wrapper accessor." alt="" coords="758,696,933,723"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga6c190ae8422d516d13dc517e2d89d2cd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_shadowtask_emigrate_p </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d9/d10/tcmi__npm__params_8h.html#db/d53/structtcmi__npm__params">tcmi_npm_params</a> *&#160;</td>
          <td class="paramname"><em>npm_params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Internal helper method that can perform both NPM and PPM physical emigration. </p>

<p>Definition at line <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00205">205</a> of file <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html">tcmi_shadowtask.c</a>.</p>

<p>References <a class="el" href="../../d9/d10/tcmi__npm__params_8h_source.html#l00034">tcmi_npm_params::file_name</a>, <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00114">req</a>, <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00116">resp</a>, <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00059">signal_action</a>, <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00212">tcmi_msg_put()</a>, <a class="el" href="../../d3/d1b/tcmi__p__emigrate__msg_8c_source.html#l00102">tcmi_p_emigrate_msg_new_tx()</a>, <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00412">tcmi_shadowtask_verify_migration()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00648">tcmi_task_check_peer_lost()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00400">tcmi_task_ckpt_name()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00252">TCMI_TASK_KEEP_PUMPING</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00411">tcmi_task_local_pid()</a>, <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00398">tcmi_task_process_msg()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00257">TCMI_TASK_REMOVE_AND_LET_ME_GO</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00567">tcmi_task_send_and_receive_msg()</a>, <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00270">tcmi_task_submit_method()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00344">tcmi_task_transactions()</a>, <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00756">tcmi_taskhelper_catch_all_signals()</a>, <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00620">tcmi_taskhelper_checkpoint()</a>, and <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00728">tcmi_taskhelper_flushfiles()</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00313">tcmi_shadowtask_emigrate_npm()</a>, and <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00308">tcmi_shadowtask_emigrate_ppm_p()</a>.</p>
<div class="fragment"><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                                                                                                  {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg" title="A coumpound structure that carries a generic TCMI message.">tcmi_msg</a> *<a class="code" href="../../d1/d6d/tcmi__msg_8h.html#a523c18bfd05e923b099719721b24db7d" title="request transaction ID">req</a>, *<a class="code" href="../../d1/d6d/tcmi__msg_8h.html#adb26817b6c4a9eeb3f68c832f24d5471" title="response transaction ID">resp</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordtype">char</span>* exec_name;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    u64 beg_time, end_time;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    beg_time = cpu_clock(smp_processor_id());</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">if</span> ( npm_params ) {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="comment">// For NPM, the exec name is name of the file being executed</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        exec_name = npm_params-&gt;<a class="code" href="../../d9/d10/tcmi__npm__params_8h.html#a7ec2cdb6a770a06a1a7d055b633b738d" title="Name of the file that is being &quot;execve-ed&quot;.">file_name</a>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="comment">// TODO: Detect this from current in case of PPM.. how? ;)  </span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        exec_name = current-&gt;comm;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO2, <span class="stringliteral">&quot;Process &#39;%s&#39; - local PID %d, emigrating&quot;</span>,</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;         current-&gt;comm, <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor.">tcmi_task_local_pid</a>(<span class="keyword">self</span>));</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga6c7491a9027159fd5a293bae24689a3c" title="&lt;&lt;public&gt;&gt; Creates a new checkpoint of the process.">tcmi_taskhelper_checkpoint</a>(<span class="keyword">self</span>, npm_params) &lt; 0) {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Failed to create a checkpoint&quot;</span>);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">if</span> (!(req = <a class="code" href="../../df/df9/group__tcmi__p__emigrate__msg__class.html#ga93e25269556be44be9de2b73713d7081" title="&lt;&lt;public&gt;&gt; Physical emigration message tx constructor.">tcmi_p_emigrate_msg_new_tx</a>(<a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga86b8af90f121c51ad718c6965441972f" title="&lt;&lt;public&gt;&gt; Transactions accessor - needed when tasks construct their own messages.">tcmi_task_transactions</a>(<span class="keyword">self</span>), </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                           <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor.">tcmi_task_local_pid</a>(<span class="keyword">self</span>), </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                           exec_name,</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                           <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga44b0c0c985d4c3954c6e35d748d9638b" title="&lt;&lt;public&gt;&gt; Task checkpoint pathname accessor.">tcmi_task_ckpt_name</a>(<span class="keyword">self</span>),</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                           current_euid(),</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                           current_egid(),</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                           current_fsuid(),</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                           current_fsgid()))) {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Error creating an emigration message&quot;</span>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="../../de/d2f/group__tcmi__task__class.html#gac04862f389dea22fbd5b8dc8f642ca9c" title="Simple error checking method to be used after communication operations to detect lost peer...">tcmi_task_check_peer_lost</a>(<span class="keyword">self</span>, <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga6f509d7a61c069c641e99fe32a57ef75" title="&lt;&lt;public&gt;&gt; Sends a specified message and waits for a response.">tcmi_task_send_and_receive_msg</a>(<span class="keyword">self</span>, req, &amp;resp)) &lt; 0) {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Failed to send message!!&quot;</span>);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">goto</span> exit1;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/dff/group__tcmi__shadowtask__class.html#gac80577a00603ae888241ced646f230e7" title="&lt;&lt;private&gt;&gt; Verifies, that the task has been successfully migrated.">tcmi_shadowtask_verify_migration</a>(<span class="keyword">self</span>, resp) &lt; 0) {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Failed to migrate the task &#39;%s&#39;&quot;</span>, current-&gt;comm);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">goto</span> exit2;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    end_time = cpu_clock(smp_processor_id());</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Emigration (npm: %d) took &#39;%llu&#39; ms.&#39;&quot;</span>, npm_params != NULL, (end_time - beg_time) / 1000000);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    printk(<span class="stringliteral">&quot;Emigration (npm: %d) took &#39;%llu&#39; ms.\n&#39;&quot;</span>, npm_params != NULL, (end_time - beg_time) / 1000000);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">/* </span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">       Files are flushed only after we have confirmation that the migration have succeeded.</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">       Otherwise we keep them open so that we can eventually continue execution of the current</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">           process.</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga403923e3422bd06870e36c8951def7fb" title="&lt;&lt;public&gt;&gt; Flushing files is required prior to issuing a migrate request.">tcmi_taskhelper_flushfiles</a>();</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <a class="code" href="../../d2/daf/group__tcmi__taskhelper__class.html#gac1c217309f2f0c54aa2ee7802f31eab2" title="&lt;&lt;public&gt;&gt; Set action for all signals accept SIGKILL and SIGSTOP">tcmi_taskhelper_catch_all_signals</a>(&amp;<a class="code" href="../../d7/d0a/tcmi__shadowtask_8c.html#a2c12247d069df548dc334deea6441e7d">signal_action</a>);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Submitting process_msg&quot;</span>);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0409e631915b37fbcfe096dfc498bbbb" title="&lt;&lt;public&gt;&gt; Submits a method for execution.">tcmi_task_submit_method</a>(<span class="keyword">self</span>, <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga491523e65c3fb2f665013a2f15899cb8" title="&lt;&lt;public&gt;&gt; Called from method queue - Processes one message from the message queue.">tcmi_task_process_msg</a>, NULL, 0);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">/* release the message */</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined...">tcmi_msg_put</a>(req);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined...">tcmi_msg_put</a>(resp);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// In case the emigration succeeded, we are responsible for freeing of npm params, as the caller won&#39;t ever get chance</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">if</span> ( npm_params )</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        vfree(npm_params);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ggaa81f1a7178bfcf01d74e57d6bbcb869bafa7c813a4364ccccdc1edfd29839c675">TCMI_TASK_KEEP_PUMPING</a>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; exit2:</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined...">tcmi_msg_put</a>(resp);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; exit1:</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined...">tcmi_msg_put</a>(req);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; exit0:</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">/* either checkpointing,communication or restart has failed. In either case we simply continue execution of the current task */</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ggaa81f1a7178bfcf01d74e57d6bbcb869bade59423de18b4fdc67a09f36b7cd71aa">TCMI_TASK_REMOVE_AND_LET_ME_GO</a>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;};</div>
</div><!-- fragment -->
<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../dc/dff/group__tcmi__shadowtask__class_ga6c190ae8422d516d13dc517e2d89d2cd_cgraph.png" border="0" usemap="#dc/dff/group__tcmi__shadowtask__class_ga6c190ae8422d516d13dc517e2d89d2cd_cgraph" alt=""/></div>
<map name="dc/dff/group__tcmi__shadowtask__class_ga6c190ae8422d516d13dc517e2d89d2cd_cgraph" id="dc/dff/group__tcmi__shadowtask__class_ga6c190ae8422d516d13dc517e2d89d2cd_cgraph">
<area shape="rect" id="node2" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined..." alt="" coords="532,224,636,251"/><area shape="rect" id="node11" href="../../df/df9/group__tcmi__p__emigrate__msg__class.html#ga93e25269556be44be9de2b73713d7081" title="&lt;&lt;public&gt;&gt; Physical emigration message tx constructor." alt="" coords="265,326,415,367"/><area shape="rect" id="node16" href="../../dc/dff/group__tcmi__shadowtask__class.html#gac80577a00603ae888241ced646f230e7" title="&lt;&lt;private&gt;&gt; Verifies, that the task has been successfully migrated." alt="" coords="261,654,419,695"/><area shape="rect" id="node23" href="../../de/d2f/group__tcmi__task__class.html#gac04862f389dea22fbd5b8dc8f642ca9c" title="Simple error checking method to be used after communication operations to detect lost peer..." alt="" coords="249,813,431,840"/><area shape="rect" id="node26" href="../../de/d2f/group__tcmi__task__class.html#ga44b0c0c985d4c3954c6e35d748d9638b" title="&lt;&lt;public&gt;&gt; Task checkpoint pathname accessor." alt="" coords="265,915,415,941"/><area shape="rect" id="node19" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="966,788,1103,815"/><area shape="rect" id="node27" href="../../de/d2f/group__tcmi__task__class.html#ga491523e65c3fb2f665013a2f15899cb8" title="&lt;&lt;public&gt;&gt; Called from method queue &#45; Processes one message from the message queue." alt="" coords="258,443,422,469"/><area shape="rect" id="node32" href="../../de/d2f/group__tcmi__task__class.html#ga6f509d7a61c069c641e99fe32a57ef75" title="&lt;&lt;public&gt;&gt; Sends a specified message and waits for a response." alt="" coords="269,146,411,187"/><area shape="rect" id="node38" href="../../de/d2f/group__tcmi__task__class.html#ga0409e631915b37fbcfe096dfc498bbbb" title="&lt;&lt;public&gt;&gt; Submits a method for execution." alt="" coords="253,965,427,992"/><area shape="rect" id="node40" href="../../de/d2f/group__tcmi__task__class.html#ga86b8af90f121c51ad718c6965441972f" title="&lt;&lt;public&gt;&gt; Transactions accessor &#45; needed when tasks construct their own messages." alt="" coords="261,1016,419,1043"/><area shape="rect" id="node41" href="../../d2/daf/group__tcmi__taskhelper__class.html#gac1c217309f2f0c54aa2ee7802f31eab2" title="&lt;&lt;public&gt;&gt; Set action for all signals accept SIGKILL and SIGSTOP" alt="" coords="263,1067,417,1109"/><area shape="rect" id="node42" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga6c7491a9027159fd5a293bae24689a3c" title="&lt;&lt;public&gt;&gt; Creates a new checkpoint of the process." alt="" coords="248,864,432,891"/><area shape="rect" id="node50" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga403923e3422bd06870e36c8951def7fb" title="&lt;&lt;public&gt;&gt; Flushing files is required prior to issuing a migrate request." alt="" coords="255,1133,425,1160"/><area shape="rect" id="node3" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2748d267a8fddd1ced86e73ba8efd079" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="963,148,1106,175"/><area shape="rect" id="node4" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="1176,72,1301,99"/><area shape="rect" id="node5" href="../../d4/d8c/group__tcmi__transaction__class.html#gaac666feaaab1fe5c341237a3e0283501" title="&lt;&lt;public&gt;&gt; Transaction ID accessor." alt="" coords="1171,224,1306,251"/><area shape="rect" id="node6" href="../../da/d0c/group__tcmi__slot__class.html#ga1d6232adcf00094597a66d9f5740d5f8" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="1177,123,1300,149"/><area shape="rect" id="node10" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="1169,173,1308,200"/><area shape="rect" id="node7" href="../../da/d0c/group__tcmi__slot__class.html#ga29d8101c5815a6519567c548da4a3c7e" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="1369,72,1506,99"/><area shape="rect" id="node8" href="../../da/d0c/group__tcmi__slot__class.html#ga109d6d783ebf06046f364f970f84da1f" title="&lt;&lt;public&gt;&gt; Locks the slot data." alt="" coords="1384,123,1491,149"/><area shape="rect" id="node9" href="../../da/d0c/group__tcmi__slot__class.html#ga5447231fec5f42040c40307eb2e6a13c" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="1377,173,1497,200"/><area shape="rect" id="node12" href="../../d6/dc2/group__tcmi__msg__class.html#gace79df438ec4f7c8f7cee3bfe42f6d93" title="&lt;&lt;public&gt;&gt; Initializes the message for transferring." alt="" coords="763,275,885,301"/><area shape="rect" id="node13" href="../../db/dc8/tcmi__msg_8c.html#a5c394462e393c496f11d949b265b8a9e" title="Shared initialization fuction of both rx and tx messages." alt="" coords="960,325,1109,352"/><area shape="rect" id="node14" href="../../d4/d8c/group__tcmi__transaction__class.html#gada9d9436def8919a10997233cd6b5ea1" title="&lt;&lt;public&gt;&gt; Creates a new transaction." alt="" coords="961,275,1109,301"/><area shape="rect" id="node15" href="../../d4/d8c/group__tcmi__transaction__class.html#gad66082869d71dbe73b9a0b60cb2f437c" title="&lt;&lt;private&gt;&gt; Generates a transaction ID." alt="" coords="1157,275,1320,301"/><area shape="rect" id="node17" href="../../d6/dc2/group__tcmi__msg__class.html#ga73489766817f528da25369a3f4c713a1" title="&lt;&lt;public&gt;&gt; Message ID accessor." alt="" coords="536,544,632,571"/><area shape="rect" id="node18" href="../../d1/dc2/group__tcmi__guest__started__procmsg__class.html#gad1e35a7478f07eccff72ce8d47045d1a" title="&lt;&lt;public&gt;&gt; Stub PID accessor." alt="" coords="513,595,655,637"/><area shape="rect" id="node20" href="../../de/d2f/group__tcmi__task__class.html#ga60a2a872664867b7a86ec278b570fef2" title="&lt;&lt;public&gt;&gt; Remote PID setter." alt="" coords="497,661,671,688"/><area shape="rect" id="node21" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gac720ca77312808db7cbbc645be8e3541" title="&lt;&lt;public&gt;&gt; Creates a new instance of a file." alt="" coords="751,595,897,621"/><area shape="rect" id="node22" href="../../de/d2f/group__tcmi__task__class.html#ga401654abdc812f0a923d05c95b412fb1" title="tcmi_task_show_remote\l_pid_rev" alt="" coords="743,646,905,687"/><area shape="rect" id="node24" href="../../de/d2f/group__tcmi__task__class.html#gad2d3dad02cf555da12cb2926cebb25f6" title="Notifies task that it peer is lost and sends a kill signal to that task." alt="" coords="494,813,674,840"/><area shape="rect" id="node25" href="../../de/d2f/group__tcmi__task__class.html#gac263213bf219960dea9c7d4b4e6f3b34" title="Returns a task_struct associated with the tcmi_task." alt="" coords="739,813,909,840"/><area shape="rect" id="node28" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#gaaf4d02eac4338a675bd5ed2df9943c97" title="&lt;&lt;public&gt;&gt; Accessor for the data stored in the method wrapper." alt="" coords="493,443,675,469"/><area shape="rect" id="node29" href="../../dc/d0c/group__tcmi__queue__class.html#ga2b0f1376bcd561196e77599cbc23090f" title="tcmi_queue_empty" alt="" coords="758,413,890,440"/><area shape="rect" id="node30" href="../../dc/d0c/group__tcmi__queue__class.html#gae749f14f4593f9b0b48cf31fc43eaa17" title="&lt;&lt;public&gt;&gt; Puts the calling process to sleep as long as the queue is empty." alt="" coords="514,326,654,367"/><area shape="rect" id="node31" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#gaf0a8913b9f40f66641ad7076e023dd58" title="&lt;&lt;public&gt;&gt; Method wrapper accessor." alt="" coords="497,392,671,419"/><area shape="rect" id="node33" href="../../d6/dc2/group__tcmi__msg__class.html#gadcb05f36b8afb930d1a825ae12ff7d3c" title="&lt;&lt;public&gt;&gt; Sends a message via a specified connection and waits for the response." alt="" coords="489,115,679,141"/><area shape="rect" id="node34" href="../../d6/dc2/group__tcmi__msg__class.html#ga1c21eeafb9a0d56dabb025d5fbdc0bc3" title="&lt;&lt;private&gt;&gt; Sends a message via a specified connection." alt="" coords="767,56,881,83"/><area shape="rect" id="node35" href="../../d4/d8c/group__tcmi__transaction__class.html#gaadc5d69241ec4815bf37e041ec0844dc" title="&lt;&lt;public&gt;&gt; Waits on a transaction till it expires or is completed, the task can be prematurely woken ..." alt="" coords="750,107,898,149"/><area shape="rect" id="node36" href="../../d4/d8c/group__tcmi__transaction__class.html#ga8a1027d8451c92d105ff818b0bf09c1d" title="&lt;&lt;public&gt;&gt; Transaction context accessor." alt="" coords="740,173,908,200"/><area shape="rect" id="node37" href="../../d4/d8c/group__tcmi__transaction__class.html#gaec110b630e8c0935ddddfb0529a03368" title="&lt;&lt;public&gt;&gt; Aborting the transaction requires:" alt="" coords="747,5,901,32"/><area shape="rect" id="node39" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#ga57cd57a64f1ec847f1b71452daf4b3b1" title="&lt;&lt;public&gt;&gt; Creates a new wrapper for the specified method." alt="" coords="495,1067,673,1093"/><area shape="rect" id="node43" href="../../de/d2f/group__tcmi__task__class.html#ga24a9d8c612da1a4484b1b3a28a181c15" title="&lt;&lt;public&gt;&gt; Prepares execution of a file given the arrays of arguments and environment." alt="" coords="496,864,672,891"/><area shape="rect" id="node46" href="../../d4/dcf/group__tcmi__ckptcom__class.html#gaf223b90f9bab6b4b553448917adbbd08" title="&lt;&lt;public&gt;&gt; Creates a non&#45;preemptive process checkpoint." alt="" coords="481,915,687,941"/><area shape="rect" id="node48" href="../../de/d2f/group__tcmi__task__class.html#gade1e8f7b12614ca0fecbc40aaae9a6c5" title="&lt;&lt;public&gt;&gt; Process context accessor." alt="" coords="519,1016,649,1043"/><area shape="rect" id="node49" href="../../d4/dcf/group__tcmi__ckptcom__class.html#ga87d900819b5cc6bbe1144e22d4e03836" title="&lt;&lt;public&gt;&gt; Creates a preemptive process checkpoint." alt="" coords="481,965,687,992"/><area shape="rect" id="node44" href="../../de/d2f/group__tcmi__task__class.html#gad41453e0aefb9dd79c2d3b65d8b9b16c" title="&lt;&lt;private&gt;&gt; Releases the execve context (execve file, argv, envp) Since the argv/envp have alloca..." alt="" coords="737,915,911,957"/><area shape="rect" id="node45" href="../../de/d84/tcmi__task_8c.html#ab73603e4adaf2a1bb6b7cf6a01a1c2f3" title="&lt;&lt;private&gt;&gt; Class method &#45; copies an array of strings terminated by NULL string (standard argv/envp f..." alt="" coords="744,981,904,1008"/><area shape="rect" id="node47" href="../../db/d70/tcmi__ckptcom_8c.html#ac319abd397f2a8d28b1e248939019385" title="&lt;&lt;private&gt;&gt; Helper method that handles both PPM and NPM checkpoint creation" alt="" coords="737,1032,911,1059"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gae54626726bfe8d29214acb323742e49e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_shadowtask_emigrate_ppm_p </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Emigrates a task to a PEN. </p>
<ul>
<li>create a new checkpoint</li>
<li>flush open files of the current process (prevents write conflicts after checkpoint restart)</li>
<li>creates a new emigration message specifying latest checkpoint name and shadow task PID</li>
<li>send the message waiting for a response</li>
<li>if the guest has been succesfully started submit process_msg method into the method queue and quit (migration verification). The submitted method will keep on processing any message that will arrive on the queue.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this task instance </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TCMI_TASK_KEEP_PUMPING, if the shadow has received a positive response and the task has been successfully migrated.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000006">Todo:</a></b></dt><dd><ul>
<li>after creating a checkpoint and preparing the emigration message there a few things that need to be done:</li>
</ul>
</dd></dl>
<ul>
<li>some component should scan all open files and close all regular files as they will be accessed from the network filesystem.</li>
<li>character, block devices, pipes, sockets should stay open so that remote operations can be forwarded locally.</li>
<li>the current execution image should be flushed as it is not needed anymore </li>
</ul>

<p>Definition at line <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00308">308</a> of file <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html">tcmi_shadowtask.c</a>.</p>

<p>References <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00205">tcmi_shadowtask_emigrate_p()</a>.</p>
<div class="fragment"><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;{</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/dff/group__tcmi__shadowtask__class.html#ga6c190ae8422d516d13dc517e2d89d2cd" title="Internal helper method that can perform both NPM and PPM physical emigration.">tcmi_shadowtask_emigrate_p</a>(<span class="keyword">self</span>, NULL);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../dc/dff/group__tcmi__shadowtask__class_gae54626726bfe8d29214acb323742e49e_cgraph.png" border="0" usemap="#dc/dff/group__tcmi__shadowtask__class_gae54626726bfe8d29214acb323742e49e_cgraph" alt=""/></div>
<map name="dc/dff/group__tcmi__shadowtask__class_gae54626726bfe8d29214acb323742e49e_cgraph" id="dc/dff/group__tcmi__shadowtask__class_gae54626726bfe8d29214acb323742e49e_cgraph">
<area shape="rect" id="node2" href="../../dc/dff/group__tcmi__shadowtask__class.html#ga6c190ae8422d516d13dc517e2d89d2cd" title="Internal helper method that can perform both NPM and PPM physical emigration." alt="" coords="235,813,429,840"/><area shape="rect" id="node3" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined..." alt="" coords="761,224,865,251"/><area shape="rect" id="node12" href="../../df/df9/group__tcmi__p__emigrate__msg__class.html#ga93e25269556be44be9de2b73713d7081" title="&lt;&lt;public&gt;&gt; Physical emigration message tx constructor." alt="" coords="494,326,645,367"/><area shape="rect" id="node16" href="../../dc/dff/group__tcmi__shadowtask__class.html#gac80577a00603ae888241ced646f230e7" title="&lt;&lt;private&gt;&gt; Verifies, that the task has been successfully migrated." alt="" coords="490,654,649,695"/><area shape="rect" id="node23" href="../../de/d2f/group__tcmi__task__class.html#gac04862f389dea22fbd5b8dc8f642ca9c" title="Simple error checking method to be used after communication operations to detect lost peer..." alt="" coords="479,813,660,840"/><area shape="rect" id="node26" href="../../de/d2f/group__tcmi__task__class.html#ga44b0c0c985d4c3954c6e35d748d9638b" title="&lt;&lt;public&gt;&gt; Task checkpoint pathname accessor." alt="" coords="494,915,645,941"/><area shape="rect" id="node19" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="1195,788,1333,815"/><area shape="rect" id="node27" href="../../de/d2f/group__tcmi__task__class.html#ga491523e65c3fb2f665013a2f15899cb8" title="&lt;&lt;public&gt;&gt; Called from method queue &#45; Processes one message from the message queue." alt="" coords="487,443,651,469"/><area shape="rect" id="node32" href="../../de/d2f/group__tcmi__task__class.html#ga6f509d7a61c069c641e99fe32a57ef75" title="&lt;&lt;public&gt;&gt; Sends a specified message and waits for a response." alt="" coords="498,146,641,187"/><area shape="rect" id="node38" href="../../de/d2f/group__tcmi__task__class.html#ga0409e631915b37fbcfe096dfc498bbbb" title="&lt;&lt;public&gt;&gt; Submits a method for execution." alt="" coords="482,965,657,992"/><area shape="rect" id="node40" href="../../de/d2f/group__tcmi__task__class.html#ga86b8af90f121c51ad718c6965441972f" title="&lt;&lt;public&gt;&gt; Transactions accessor &#45; needed when tasks construct their own messages." alt="" coords="491,1016,648,1043"/><area shape="rect" id="node41" href="../../d2/daf/group__tcmi__taskhelper__class.html#gac1c217309f2f0c54aa2ee7802f31eab2" title="&lt;&lt;public&gt;&gt; Set action for all signals accept SIGKILL and SIGSTOP" alt="" coords="493,1067,646,1109"/><area shape="rect" id="node42" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga6c7491a9027159fd5a293bae24689a3c" title="&lt;&lt;public&gt;&gt; Creates a new checkpoint of the process." alt="" coords="477,864,661,891"/><area shape="rect" id="node50" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga403923e3422bd06870e36c8951def7fb" title="&lt;&lt;public&gt;&gt; Flushing files is required prior to issuing a migrate request." alt="" coords="484,1133,655,1160"/><area shape="rect" id="node4" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2748d267a8fddd1ced86e73ba8efd079" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="1193,148,1335,175"/><area shape="rect" id="node5" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="1393,97,1519,124"/><area shape="rect" id="node6" href="../../d4/d8c/group__tcmi__transaction__class.html#gaac666feaaab1fe5c341237a3e0283501" title="&lt;&lt;public&gt;&gt; Transaction ID accessor." alt="" coords="1389,249,1523,276"/><area shape="rect" id="node7" href="../../da/d0c/group__tcmi__slot__class.html#ga1d6232adcf00094597a66d9f5740d5f8" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="1395,148,1517,175"/><area shape="rect" id="node11" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="1387,199,1525,225"/><area shape="rect" id="node8" href="../../da/d0c/group__tcmi__slot__class.html#ga29d8101c5815a6519567c548da4a3c7e" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="1574,97,1711,124"/><area shape="rect" id="node9" href="../../da/d0c/group__tcmi__slot__class.html#ga109d6d783ebf06046f364f970f84da1f" title="&lt;&lt;public&gt;&gt; Locks the slot data." alt="" coords="1589,148,1696,175"/><area shape="rect" id="node10" href="../../da/d0c/group__tcmi__slot__class.html#ga5447231fec5f42040c40307eb2e6a13c" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="1583,199,1703,225"/><area shape="rect" id="node13" href="../../d6/dc2/group__tcmi__msg__class.html#gace79df438ec4f7c8f7cee3bfe42f6d93" title="&lt;&lt;public&gt;&gt; Initializes the message for transferring." alt="" coords="993,275,1114,301"/><area shape="rect" id="node14" href="../../db/dc8/tcmi__msg_8c.html#a5c394462e393c496f11d949b265b8a9e" title="Shared initialization fuction of both rx and tx messages." alt="" coords="1189,325,1339,352"/><area shape="rect" id="node15" href="../../d4/d8c/group__tcmi__transaction__class.html#gada9d9436def8919a10997233cd6b5ea1" title="&lt;&lt;public&gt;&gt; Creates a new transaction." alt="" coords="1190,224,1338,251"/><area shape="rect" id="node17" href="../../d6/dc2/group__tcmi__msg__class.html#ga73489766817f528da25369a3f4c713a1" title="&lt;&lt;public&gt;&gt; Message ID accessor." alt="" coords="765,544,861,571"/><area shape="rect" id="node18" href="../../d1/dc2/group__tcmi__guest__started__procmsg__class.html#gad1e35a7478f07eccff72ce8d47045d1a" title="&lt;&lt;public&gt;&gt; Stub PID accessor." alt="" coords="742,595,885,637"/><area shape="rect" id="node20" href="../../de/d2f/group__tcmi__task__class.html#ga60a2a872664867b7a86ec278b570fef2" title="&lt;&lt;public&gt;&gt; Remote PID setter." alt="" coords="726,661,901,688"/><area shape="rect" id="node21" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gac720ca77312808db7cbbc645be8e3541" title="&lt;&lt;public&gt;&gt; Creates a new instance of a file." alt="" coords="981,595,1126,621"/><area shape="rect" id="node22" href="../../de/d2f/group__tcmi__task__class.html#ga401654abdc812f0a923d05c95b412fb1" title="tcmi_task_show_remote\l_pid_rev" alt="" coords="972,646,1135,687"/><area shape="rect" id="node24" href="../../de/d2f/group__tcmi__task__class.html#gad2d3dad02cf555da12cb2926cebb25f6" title="Notifies task that it peer is lost and sends a kill signal to that task." alt="" coords="723,813,903,840"/><area shape="rect" id="node25" href="../../de/d2f/group__tcmi__task__class.html#gac263213bf219960dea9c7d4b4e6f3b34" title="Returns a task_struct associated with the tcmi_task." alt="" coords="969,813,1138,840"/><area shape="rect" id="node28" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#gaaf4d02eac4338a675bd5ed2df9943c97" title="&lt;&lt;public&gt;&gt; Accessor for the data stored in the method wrapper." alt="" coords="723,443,904,469"/><area shape="rect" id="node29" href="../../dc/d0c/group__tcmi__queue__class.html#ga2b0f1376bcd561196e77599cbc23090f" title="tcmi_queue_empty" alt="" coords="987,413,1119,440"/><area shape="rect" id="node30" href="../../dc/d0c/group__tcmi__queue__class.html#gae749f14f4593f9b0b48cf31fc43eaa17" title="&lt;&lt;public&gt;&gt; Puts the calling process to sleep as long as the queue is empty." alt="" coords="743,326,883,367"/><area shape="rect" id="node31" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#gaf0a8913b9f40f66641ad7076e023dd58" title="&lt;&lt;public&gt;&gt; Method wrapper accessor." alt="" coords="726,392,901,419"/><area shape="rect" id="node33" href="../../d6/dc2/group__tcmi__msg__class.html#gadcb05f36b8afb930d1a825ae12ff7d3c" title="&lt;&lt;public&gt;&gt; Sends a message via a specified connection and waits for the response." alt="" coords="719,115,908,141"/><area shape="rect" id="node34" href="../../d6/dc2/group__tcmi__msg__class.html#ga1c21eeafb9a0d56dabb025d5fbdc0bc3" title="&lt;&lt;private&gt;&gt; Sends a message via a specified connection." alt="" coords="996,56,1111,83"/><area shape="rect" id="node35" href="../../d4/d8c/group__tcmi__transaction__class.html#gaadc5d69241ec4815bf37e041ec0844dc" title="&lt;&lt;public&gt;&gt; Waits on a transaction till it expires or is completed, the task can be prematurely woken ..." alt="" coords="979,107,1127,149"/><area shape="rect" id="node36" href="../../d4/d8c/group__tcmi__transaction__class.html#ga8a1027d8451c92d105ff818b0bf09c1d" title="&lt;&lt;public&gt;&gt; Transaction context accessor." alt="" coords="969,173,1137,200"/><area shape="rect" id="node37" href="../../d4/d8c/group__tcmi__transaction__class.html#gaec110b630e8c0935ddddfb0529a03368" title="&lt;&lt;public&gt;&gt; Aborting the transaction requires:" alt="" coords="976,5,1131,32"/><area shape="rect" id="node39" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#ga57cd57a64f1ec847f1b71452daf4b3b1" title="&lt;&lt;public&gt;&gt; Creates a new wrapper for the specified method." alt="" coords="724,1067,903,1093"/><area shape="rect" id="node43" href="../../de/d2f/group__tcmi__task__class.html#ga24a9d8c612da1a4484b1b3a28a181c15" title="&lt;&lt;public&gt;&gt; Prepares execution of a file given the arrays of arguments and environment." alt="" coords="725,864,901,891"/><area shape="rect" id="node46" href="../../d4/dcf/group__tcmi__ckptcom__class.html#gaf223b90f9bab6b4b553448917adbbd08" title="&lt;&lt;public&gt;&gt; Creates a non&#45;preemptive process checkpoint." alt="" coords="710,915,917,941"/><area shape="rect" id="node48" href="../../de/d2f/group__tcmi__task__class.html#gade1e8f7b12614ca0fecbc40aaae9a6c5" title="&lt;&lt;public&gt;&gt; Process context accessor." alt="" coords="749,1016,878,1043"/><area shape="rect" id="node49" href="../../d4/dcf/group__tcmi__ckptcom__class.html#ga87d900819b5cc6bbe1144e22d4e03836" title="&lt;&lt;public&gt;&gt; Creates a preemptive process checkpoint." alt="" coords="710,965,917,992"/><area shape="rect" id="node44" href="../../de/d2f/group__tcmi__task__class.html#gad41453e0aefb9dd79c2d3b65d8b9b16c" title="&lt;&lt;private&gt;&gt; Releases the execve context (execve file, argv, envp) Since the argv/envp have alloca..." alt="" coords="966,915,1141,957"/><area shape="rect" id="node45" href="../../de/d84/tcmi__task_8c.html#ab73603e4adaf2a1bb6b7cf6a01a1c2f3" title="&lt;&lt;private&gt;&gt; Class method &#45; copies an array of strings terminated by NULL string (standard argv/envp f..." alt="" coords="973,981,1133,1008"/><area shape="rect" id="node47" href="../../db/d70/tcmi__ckptcom_8c.html#ac319abd397f2a8d28b1e248939019385" title="&lt;&lt;private&gt;&gt; Helper method that handles both PPM and NPM checkpoint creation" alt="" coords="966,1032,1141,1059"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga5aabc354e036491ef0b5466fab4808fb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_shadowtask_execve </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Execve notification when merging shadow with migrating process on CCN. </p>
<p>This method is called right before issuing the actual execve on the checkpoint image of the migrated task. Since the task will be merged with the original process, it needs to be remove from the TCMI. All that needs to be done is scheduling a <a class="el" href="../../de/d2f/group__tcmi__task__class.html#ga724d575729c5a3f2be09db7ee6833999" title="&lt;&lt;public&gt;&gt; Called from method queue - Exits a task.">tcmi_task_exit()</a> method. The migration mode handler takes care of the rest.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this task instance </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon success </dd></dl>

<p>Definition at line <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00365">365</a> of file <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html">tcmi_shadowtask.c</a>.</p>

<p>References <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00635">tcmi_task_exit()</a>, <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00295">tcmi_task_flush_and_submit_method()</a>, and <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00092">tcmi_taskhelper_enter_mig_mode()</a>.</p>
<div class="fragment"><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;{</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga2bf62635c09738ef0c1385ea258bec2f" title="&lt;&lt;public&gt;&gt; Flushes all pending methods in the queue submits a method for execution.">tcmi_task_flush_and_submit_method</a>(<span class="keyword">self</span>, <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga724d575729c5a3f2be09db7ee6833999" title="&lt;&lt;public&gt;&gt; Called from method queue - Exits a task.">tcmi_task_exit</a>, NULL, 0);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">/* migration mode is entered when the actual execve resumes to</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">     * user mode */</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <a class="code" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga9dbb48f23b9ec6a00498db53f026ef4b" title="&lt;&lt;public&gt;&gt; Switches the task into migration mode.">tcmi_taskhelper_enter_mig_mode</a>(<span class="keyword">self</span>);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../dc/dff/group__tcmi__shadowtask__class_ga5aabc354e036491ef0b5466fab4808fb_cgraph.png" border="0" usemap="#dc/dff/group__tcmi__shadowtask__class_ga5aabc354e036491ef0b5466fab4808fb_cgraph" alt=""/></div>
<map name="dc/dff/group__tcmi__shadowtask__class_ga5aabc354e036491ef0b5466fab4808fb_cgraph" id="dc/dff/group__tcmi__shadowtask__class_ga5aabc354e036491ef0b5466fab4808fb_cgraph">
<area shape="rect" id="node2" href="../../de/d2f/group__tcmi__task__class.html#ga724d575729c5a3f2be09db7ee6833999" title="&lt;&lt;public&gt;&gt; Called from method queue &#45; Exits a task." alt="" coords="247,52,353,79"/><area shape="rect" id="node4" href="../../de/d2f/group__tcmi__task__class.html#ga2bf62635c09738ef0c1385ea258bec2f" title="&lt;&lt;public&gt;&gt; Flushes all pending methods in the queue submits a method for execution." alt="" coords="229,175,371,217"/><area shape="rect" id="node11" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga9dbb48f23b9ec6a00498db53f026ef4b" title="&lt;&lt;public&gt;&gt; Switches the task into migration mode." alt="" coords="225,353,375,394"/><area shape="rect" id="node3" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#gaaf4d02eac4338a675bd5ed2df9943c97" title="&lt;&lt;public&gt;&gt; Accessor for the data stored in the method wrapper." alt="" coords="424,5,605,32"/><area shape="rect" id="node5" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#ga57cd57a64f1ec847f1b71452daf4b3b1" title="&lt;&lt;public&gt;&gt; Creates a new wrapper for the specified method." alt="" coords="425,56,604,83"/><area shape="rect" id="node6" href="../../dc/d0c/group__tcmi__queue__class.html#ga3ae4d7e0a4d5d21ec8b9fff138f5b0d4" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="455,107,575,133"/><area shape="rect" id="node7" href="../../dc/d0c/group__tcmi__queue__class.html#ga2b0f1376bcd561196e77599cbc23090f" title="tcmi_queue_empty" alt="" coords="449,157,581,184"/><area shape="rect" id="node8" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#gad93018cc0894a434a94703eed0f869f9" title="&lt;&lt;public&gt;&gt; Decrements the reference counter, when the count reaches 0, the instance is destroyed..." alt="" coords="427,208,602,235"/><area shape="rect" id="node9" href="../../dc/d0c/group__tcmi__queue__class.html#ga40921ea3b077d55d70fb7b94ac666292" title="&lt;&lt;public&gt;&gt; Adds an element to the queue &#45; lock free version, assumes the lock is already held..." alt="" coords="449,259,580,285"/><area shape="rect" id="node10" href="../../dc/d0c/group__tcmi__queue__class.html#ga2e0e25eec1d5e4ea6e89dfde81ed43f4" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="447,309,582,336"/><area shape="rect" id="node12" href="../../de/d2f/group__tcmi__task__class.html#gac263213bf219960dea9c7d4b4e6f3b34" title="Returns a task_struct associated with the tcmi_task." alt="" coords="430,360,599,387"/><area shape="rect" id="node14" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="654,411,791,437"/><area shape="rect" id="node13" href="../../d8/d3c/util_8h.html#a5f449355b8f54aaed664de85f89092ea" title="task_find_by_pid" alt="" coords="663,360,782,387"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga881ec0021bc7db3f376bde3d04e77541"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_shadowtask_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Custom free method </p>

<p>Definition at line <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00495">495</a> of file <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html">tcmi_shadowtask.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;{</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga3224d8fc9ab8c8765f1b803cb91c861c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum tcmi_task_type tcmi_shadowtask_get_type </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return type of task. </p>
<p>Only for setting task type to kernel task_struct. Polymorphism cannot be used in kernel, bacause <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task" title="Compound structure that gathers necessary process information.">tcmi_task</a> is defined outside of kernel. </p>

<p>Definition at line <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00502">502</a> of file <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html">tcmi_shadowtask.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;{</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">return</span> shadow;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gacff748e4399d3c718a848f9e914e2c04"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_shadowtask_migrateback_ppm_p </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Migrates a task back to CCN. </p>
<p>This is done simply by sending a migrate back request to the associated ghost task, which will handle its migration home the same way as if it was requested on PEN</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this task instance </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>result of the task specific migrate back method or TCMI_TASK_KEEP_PUMPING </dd></dl>

<p>Definition at line <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00328">328</a> of file <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html">tcmi_shadowtask.c</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00212">tcmi_msg_put()</a>, <a class="el" href="../../d0/dc6/tcmi__ppm__p__migr__back__shadowreq__procmsg_8c_source.html#l00065">tcmi_ppm_p_migr_back_shadowreq_procmsg_new_tx()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00648">tcmi_task_check_peer_lost()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00252">TCMI_TASK_KEEP_PUMPING</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00411">tcmi_task_local_pid()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00422">tcmi_task_remote_pid()</a>, and <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00524">tcmi_task_send_anonymous_msg()</a>.</p>
<div class="fragment"><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;{</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordtype">int</span> res = <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ggaa81f1a7178bfcf01d74e57d6bbcb869bafa7c813a4364ccccdc1edfd29839c675">TCMI_TASK_KEEP_PUMPING</a>;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg" title="A coumpound structure that carries a generic TCMI message.">tcmi_msg</a> *msg;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">/* struct tcmi_shadowtask *self_tsk = TCMI_SHADOWTASK(self); */</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO2, <span class="stringliteral">&quot;Process &#39;%s&#39; - local PID %d, remote PID %d, migrate home requested&quot;</span>,</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;         current-&gt;comm, <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor.">tcmi_task_local_pid</a>(<span class="keyword">self</span>), <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga2f054ae4772c0921004eebdb48d39dcf" title="&lt;&lt;public&gt;&gt; Remote PID accessor.">tcmi_task_remote_pid</a>(<span class="keyword">self</span>));</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">if</span> ( !(msg = <a class="code" href="../../d9/d3f/group__tcmi__ppm__p__migr__back__shadowreq__procmsg__class.html#gafb12a19188e60dfa400e079803f17cb4" title="&lt;&lt;public&gt;&gt; Shadow request for migration back tx constructor.">tcmi_ppm_p_migr_back_shadowreq_procmsg_new_tx</a>(<a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga2f054ae4772c0921004eebdb48d39dcf" title="&lt;&lt;public&gt;&gt; Remote PID accessor.">tcmi_task_remote_pid</a>(<span class="keyword">self</span>))) ) {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Error creating a migrate back message&quot;</span>);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    }</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="../../de/d2f/group__tcmi__task__class.html#gac04862f389dea22fbd5b8dc8f642ca9c" title="Simple error checking method to be used after communication operations to detect lost peer...">tcmi_task_check_peer_lost</a>(<span class="keyword">self</span>, <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga4e660ea948542a5a057e25640a762efc" title="&lt;&lt;public&gt;&gt; Sends a specified message.">tcmi_task_send_anonymous_msg</a>(<span class="keyword">self</span>, msg)) &lt; 0) {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Failed to send message!!&quot;</span>);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">goto</span> exit1;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;exit1:</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined...">tcmi_msg_put</a>(msg);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;exit0:  </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../dc/dff/group__tcmi__shadowtask__class_gacff748e4399d3c718a848f9e914e2c04_cgraph.png" border="0" usemap="#dc/dff/group__tcmi__shadowtask__class_gacff748e4399d3c718a848f9e914e2c04_cgraph" alt=""/></div>
<map name="dc/dff/group__tcmi__shadowtask__class_gacff748e4399d3c718a848f9e914e2c04_cgraph" id="dc/dff/group__tcmi__shadowtask__class_gacff748e4399d3c718a848f9e914e2c04_cgraph">
<area shape="rect" id="node2" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined..." alt="" coords="568,35,672,61"/><area shape="rect" id="node14" href="../../d9/d3f/group__tcmi__ppm__p__migr__back__shadowreq__procmsg__class.html#gafb12a19188e60dfa400e079803f17cb4" title="&lt;&lt;public&gt;&gt; Shadow request for migration back tx constructor." alt="" coords="269,171,465,213"/><area shape="rect" id="node25" href="../../de/d2f/group__tcmi__task__class.html#gac04862f389dea22fbd5b8dc8f642ca9c" title="Simple error checking method to be used after communication operations to detect lost peer..." alt="" coords="276,259,457,285"/><area shape="rect" id="node29" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="1018,309,1155,336"/><area shape="rect" id="node30" href="../../de/d2f/group__tcmi__task__class.html#ga2f054ae4772c0921004eebdb48d39dcf" title="&lt;&lt;public&gt;&gt; Remote PID accessor." alt="" coords="291,360,442,387"/><area shape="rect" id="node31" href="../../de/d2f/group__tcmi__task__class.html#ga4e660ea948542a5a057e25640a762efc" title="&lt;&lt;public&gt;&gt; Sends a specified message." alt="" coords="257,411,477,437"/><area shape="rect" id="node3" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2748d267a8fddd1ced86e73ba8efd079" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="1455,56,1598,83"/><area shape="rect" id="node4" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="1657,5,1783,32"/><area shape="rect" id="node5" href="../../d4/d8c/group__tcmi__transaction__class.html#gaac666feaaab1fe5c341237a3e0283501" title="&lt;&lt;public&gt;&gt; Transaction ID accessor." alt="" coords="1653,157,1787,184"/><area shape="rect" id="node6" href="../../da/d0c/group__tcmi__slot__class.html#ga1d6232adcf00094597a66d9f5740d5f8" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="1659,56,1781,83"/><area shape="rect" id="node13" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="1651,107,1789,133"/><area shape="rect" id="node7" href="../../da/d0c/group__tcmi__slot__class.html#ga29d8101c5815a6519567c548da4a3c7e" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="1838,60,1975,87"/><area shape="rect" id="node11" href="../../da/d0c/group__tcmi__slot__class.html#ga109d6d783ebf06046f364f970f84da1f" title="&lt;&lt;public&gt;&gt; Locks the slot data." alt="" coords="1853,113,1960,140"/><area shape="rect" id="node12" href="../../da/d0c/group__tcmi__slot__class.html#ga5447231fec5f42040c40307eb2e6a13c" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="1847,171,1967,197"/><area shape="rect" id="node8" href="../../da/d0c/group__tcmi__slot__class.html#ga6dd63ff2854a9939a5aa094f6543a5d1" title="&lt;&lt;public&gt;&gt; Checks if the slot is empty." alt="" coords="2046,60,2165,87"/><area shape="rect" id="node9" href="../../da/d0c/group__tcmi__slot__class.html#ga2550a3e6624b54e323c73cb1d06e6cd0" title="&lt;&lt;public&gt;&gt; Moves a slot among unused_slots." alt="" coords="2025,147,2186,173"/><area shape="rect" id="node10" href="../../da/d0c/group__tcmi__slot__class.html#ga8d6885be2677819158e0d956f0cca5b2" title="&lt;&lt;private&gt;&gt; Moves a slot into the specified list." alt="" coords="2235,191,2347,217"/><area shape="rect" id="node15" href="../../d7/dc8/group__tcmi__procmsg__class.html#gaa22b26ec117d20a804758f501e9d3e59" title="&lt;&lt;public&gt;&gt; Initializes the message for transferring." alt="" coords="547,168,693,195"/><area shape="rect" id="node16" href="../../d6/dc2/group__tcmi__msg__class.html#gace79df438ec4f7c8f7cee3bfe42f6d93" title="&lt;&lt;public&gt;&gt; Initializes the message for transferring." alt="" coords="787,163,909,189"/><area shape="rect" id="node17" href="../../db/dc8/tcmi__msg_8c.html#a5c394462e393c496f11d949b265b8a9e" title="Shared initialization fuction of both rx and tx messages." alt="" coords="1012,208,1161,235"/><area shape="rect" id="node18" href="../../d4/d8c/group__tcmi__transaction__class.html#gada9d9436def8919a10997233cd6b5ea1" title="&lt;&lt;public&gt;&gt; Creates a new transaction." alt="" coords="1013,157,1161,184"/><area shape="rect" id="node19" href="../../d4/d8c/group__tcmi__transaction__class.html#gad66082869d71dbe73b9a0b60cb2f437c" title="&lt;&lt;private&gt;&gt; Generates a transaction ID." alt="" coords="1240,208,1403,235"/><area shape="rect" id="node20" href="../../d0/db7/group__tcmi__slotvec__class.html#ga463d8dd03bd30b24c3ebfed5a0239d8a" title="&lt;&lt;public&gt;&gt; Hashmask accessor." alt="" coords="1241,259,1402,285"/><area shape="rect" id="node21" href="../../d4/d8c/group__tcmi__transaction__class.html#ga244e6188e1c4f9e1faba20d0892f5441" title="&lt;&lt;private&gt;&gt; Callback for the kernel timer that handles transaction timeouts." alt="" coords="1244,56,1399,83"/><area shape="rect" id="node22" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4f973395848150fbebecf3cc292c80ba" title="&lt;&lt;public&gt;&gt; The index where the insertion takes place has to be a valid slot." alt="" coords="1451,259,1602,285"/><area shape="rect" id="node23" href="../../d0/db7/group__tcmi__slotvec__class.html#ga876670f605631a5deb930412dae02b28" title="&lt;&lt;public&gt;&gt; Accesses a slot at a given index." alt="" coords="1664,208,1776,235"/><area shape="rect" id="node24" href="../../da/d0c/group__tcmi__slot__class.html#gaefe294678d9d6922b3af1e452a318fa1" title="&lt;&lt;public&gt;&gt; Inserts a new node into the slot." alt="" coords="1663,259,1777,285"/><area shape="rect" id="node26" href="../../de/d2f/group__tcmi__task__class.html#gad2d3dad02cf555da12cb2926cebb25f6" title="Notifies task that it peer is lost and sends a kill signal to that task." alt="" coords="530,259,710,285"/><area shape="rect" id="node27" href="../../de/d2f/group__tcmi__task__class.html#gac263213bf219960dea9c7d4b4e6f3b34" title="Returns a task_struct associated with the tcmi_task." alt="" coords="763,259,933,285"/><area shape="rect" id="node28" href="../../d8/d3c/util_8h.html#a5f449355b8f54aaed664de85f89092ea" title="task_find_by_pid" alt="" coords="1027,259,1146,285"/><area shape="rect" id="node32" href="../../d6/dc2/group__tcmi__msg__class.html#ga7a8fe8cbfd4b25c15589c8599f66e574" title="&lt;&lt;public&gt;&gt; Sends a message via a specified connection." alt="" coords="526,411,714,437"/><area shape="rect" id="node33" href="../../d6/dc2/group__tcmi__msg__class.html#ga1c21eeafb9a0d56dabb025d5fbdc0bc3" title="&lt;&lt;private&gt;&gt; Sends a message via a specified connection." alt="" coords="791,411,905,437"/><area shape="rect" id="node34" href="../../d6/d8e/group__kkc__sock__class.html#gad734b131e2ab00e8d7fa30737fc2f5ad" title="&lt;&lt;public&gt;&gt; Sends out specified data." alt="" coords="1030,360,1143,387"/><area shape="rect" id="node36" href="../../d6/d8e/group__kkc__sock__class.html#ga141590d302ece9990e5c8cdd82a3c3d8" title="&lt;&lt;public&gt;&gt; Locks this socket instance for sending, interruptible version, the process can be woken up..." alt="" coords="981,411,1192,437"/><area shape="rect" id="node37" href="../../d6/d8e/group__kkc__sock__class.html#ga841d6dff84842f19540eae27c37fcb4c" title="&lt;&lt;public&gt;&gt; Unlocks this socket instance for sending." alt="" coords="1011,461,1162,488"/><area shape="rect" id="node38" href="../../d4/d8c/group__tcmi__transaction__class.html#ga653b1761a1b6e9fef415196c54e00768" title="&lt;&lt;public&gt;&gt; Starts a transaction." alt="" coords="1011,512,1162,539"/><area shape="rect" id="node35" href="../../d6/d8e/group__kkc__sock__class.html#gaff5e8804c93f0cb2a4b5e2e12f64e743" title="&lt;&lt;private&gt;&gt; Transfers a required number of bytes." alt="" coords="1250,360,1393,387"/><area shape="rect" id="node39" href="../../d4/d8c/group__tcmi__transaction__class.html#gaba57811a17b10df187e7918d02e3679e" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="1247,436,1396,463"/><area shape="rect" id="node40" href="../../d4/d8c/group__tcmi__transaction__class.html#ga176151d0f528ed8cda13e21da8551519" title="&lt;&lt;public&gt;&gt; Instance accessor." alt="" coords="1250,487,1393,513"/><area shape="rect" id="node41" href="../../d4/d8c/group__tcmi__transaction__class.html#ga1dfece4fcea1c1b9ce676f560957077f" title="&lt;&lt;public&gt;&gt; Sets flags in the transaction that denote additional transaction attributes." alt="" coords="1250,538,1393,579"/><area shape="rect" id="node42" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2c5c24c4b88dae68aa68c7b043d105b8" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="1240,604,1403,631"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga5a1a66f6d53a0cbd079627b64d04b0ed"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a>* tcmi_shadowtask_new </td>
          <td>(</td>
          <td class="paramtype">pid_t&#160;</td>
          <td class="paramname"><em>local_pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *&#160;</td>
          <td class="paramname"><em>migman</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d8e/group__kkc__sock__class.html#da/d0d/structkkc__sock">kkc_sock</a> *&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *&#160;</td>
          <td class="paramname"><em>d_migproc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *&#160;</td>
          <td class="paramname"><em>d_migman</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Creates a new shadow task. </p>
<p>&lt;&lt;public&gt;&gt; Creates a new shadow task.</p>
<ul>
<li>allocates a new instance.</li>
<li>delegates its initialization to the super class.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">local_pid</td><td>- local PID on CCN </td></tr>
    <tr><td class="paramname">migman</td><td>- The migration manager that maintains this task </td></tr>
    <tr><td class="paramname">*sock</td><td>- socket used for communication with guest task on PEN </td></tr>
    <tr><td class="paramname">*d_migproc</td><td>- directory where ctlfs entries of migrated processes reside </td></tr>
    <tr><td class="paramname">*d_migman</td><td>- TCMI ctlfs directory of the migration manager responsible for this task </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon success </dd></dl>

<p>Definition at line <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00089">89</a> of file <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html">tcmi_shadowtask.c</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00221">minfo</a>, <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00508">shadowtask_ops</a>, <a class="el" href="../../d8/dcb/tcmi__shadowtask_8h_source.html#l00063">TCMI_SHADOWTASK</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00261">TCMI_TASK</a>, and <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00112">tcmi_task_init()</a>.</p>

<p>Referenced by <a class="el" href="../../dc/d44/tcmi__migcom_8c_source.html#l00202">tcmi_migcom_emigrate_ccn_npm()</a>, <a class="el" href="../../dc/d44/tcmi__migcom_8c_source.html#l00151">tcmi_migcom_emigrate_ccn_ppm_p()</a>, and <a class="el" href="../../dc/d44/tcmi__migcom_8c_source.html#l00568">tcmi_migcom_shadow_fork()</a>.</p>
<div class="fragment"><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;{</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../dc/dff/group__tcmi__shadowtask__class.html#d9/d98/structtcmi__shadowtask" title="Compound structure for the shadow task.">tcmi_shadowtask</a> *task;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="../../d6/d01/dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(INFO2, <span class="stringliteral">&quot;Creating new shadow task for local PID=%d&quot;</span>, local_pid);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">if</span> (!(task = <a class="code" href="../../dc/dff/group__tcmi__shadowtask__class.html#gaead05b1f37cf8a8741dd622d93cff516" title="Casts to the task instance.">TCMI_SHADOWTASK</a>(kmalloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../dc/dff/group__tcmi__shadowtask__class.html#d9/d98/structtcmi__shadowtask" title="Compound structure for the shadow task.">tcmi_shadowtask</a>), </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                         GFP_ATOMIC)))) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(ERR3, <span class="stringliteral">&quot;Can&#39;t allocate memory for TCMI shadow task&quot;</span>);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga4b3a924515ad4005bc713b135d75f6b9" title="Initializes the task.">tcmi_task_init</a>(<a class="code" href="../../de/d2f/group__tcmi__task__class.html#gaf05e0c401db433deef4d95a64ce9117b" title="Casts to the task instance.">TCMI_TASK</a>(task), local_pid, migman, sock, d_migproc, </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;               d_migman, &amp;<a class="code" href="../../dc/dff/group__tcmi__shadowtask__class.html#ga4ce31f95511b3a387b75a304c9464f3e" title="TCMI task operations that support polymorphism.">shadowtask_ops</a>) &lt; 0) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(ERR3, <span class="stringliteral">&quot;TCMI shadow task initialization failed!&quot;</span>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">goto</span> exit1;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../de/d2f/group__tcmi__task__class.html#gaf05e0c401db433deef4d95a64ce9117b" title="Casts to the task instance.">TCMI_TASK</a>(task);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; exit1:</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    kfree(task);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; exit0:</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../dc/dff/group__tcmi__shadowtask__class_ga5a1a66f6d53a0cbd079627b64d04b0ed_cgraph.png" border="0" usemap="#dc/dff/group__tcmi__shadowtask__class_ga5a1a66f6d53a0cbd079627b64d04b0ed_cgraph" alt=""/></div>
<map name="dc/dff/group__tcmi__shadowtask__class_ga5a1a66f6d53a0cbd079627b64d04b0ed_cgraph" id="dc/dff/group__tcmi__shadowtask__class_ga5a1a66f6d53a0cbd079627b64d04b0ed_cgraph">
<area shape="rect" id="node2" href="../../de/d2f/group__tcmi__task__class.html#ga4b3a924515ad4005bc713b135d75f6b9" title="Initializes the task." alt="" coords="209,309,311,336"/><area shape="rect" id="node3" href="../../d6/da2/group__tcmi__migman__class.html#gacd13117046ccc1fa12ac743b893fcfca" title="&lt;&lt;public&gt;&gt; Instance accessor, increments the reference counter." alt="" coords="391,5,516,32"/><area shape="rect" id="node4" href="../../d6/d8e/group__kkc__sock__class.html#gabada9f8c5976a6aff07529239acdf727" title="&lt;&lt;public&gt;&gt; Instance accessor, increments the reference count." alt="" coords="402,56,505,83"/><area shape="rect" id="node5" href="../../dc/d0c/group__tcmi__queue__class.html#ga10c0b527cad2d814db860b28847ca543" title="&lt;&lt;public&gt;&gt; Queue initializer &#45; for static allocation." alt="" coords="397,107,510,133"/><area shape="rect" id="node6" href="../../d0/db7/group__tcmi__slotvec__class.html#ga25d6b55df23662a9fc2c613762134a85" title="&lt;&lt;public&gt;&gt; This method creates a slot vector of the size $2^{order}$." alt="" coords="388,157,519,184"/><area shape="rect" id="node9" href="../../dc/def/group__tcmi__ctlfs__dir__class.html#ga1f51ad6279415ce522a3a932178702d6" title="&lt;&lt;public&gt;&gt; Creates a new directory entry in the tcmi_ctlfs tree." alt="" coords="389,208,518,235"/><area shape="rect" id="node17" href="../../dd/d30/group__tcmi__ctlfs__symlink__class.html#ga952244eff8b5630626b305e1b6c68b97" title="&lt;&lt;public&gt;&gt; Symbolic link is created as a regular ctlfs entry." alt="" coords="601,309,761,336"/><area shape="rect" id="node19" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gac720ca77312808db7cbbc645be8e3541" title="&lt;&lt;public&gt;&gt; Creates a new instance of a file." alt="" coords="381,259,526,285"/><area shape="rect" id="node21" href="../../de/d2f/group__tcmi__task__class.html#ga17c54fbcb86f7f3158426742c3ff04ba" title="&lt;&lt;private&gt;&gt; Read method for the TCMI ctlfs &#45; reports remote PID." alt="" coords="360,959,547,985"/><area shape="rect" id="node23" href="../../d6/da2/group__tcmi__migman__class.html#ga936802da41af02ca6c660e18ade52dbb" title="&lt;&lt;public&gt;&gt; Registers tcmi task into the migration manager tasks slotvec" alt="" coords="373,857,533,884"/><area shape="rect" id="node33" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d..." alt="" coords="1069,419,1208,445"/><area shape="rect" id="node34" href="../../d0/db7/group__tcmi__slotvec__class.html#ga2376bcc84e5bbd48a8f92400f5ad5f25" title="&lt;&lt;public&gt;&gt; Decrements the reference counter, when the count reaches 0, the instance is destroyed..." alt="" coords="853,731,971,757"/><area shape="rect" id="node36" href="../../d6/d8e/group__kkc__sock__class.html#ga9f980056fbf3436596c4cfdf3913e85c" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined..." alt="" coords="1087,629,1190,656"/><area shape="rect" id="node42" href="../../d6/da2/group__tcmi__migman__class.html#gab536c262c24d8fc76cdbdfa8d6d65b81" title="&lt;&lt;public&gt;&gt; The manager is shutdown exactly in this order:" alt="" coords="391,495,516,521"/><area shape="rect" id="node7" href="../../d0/db7/group__tcmi__slotvec__class.html#gaf11359c8cb20ddd7549296737eaf348d" title="&lt;&lt;public&gt;&gt; Creates new instance." alt="" coords="619,149,743,176"/><area shape="rect" id="node8" href="../../da/d0c/group__tcmi__slot__class.html#ga347147be22f868eacdae39a2846c0e3f" title="Initializes a slot." alt="" coords="863,141,961,168"/><area shape="rect" id="node10" href="../../dc/def/group__tcmi__ctlfs__dir__class.html#ga571b8ac681691e3ceca2e833b89b6a21" title="&lt;&lt;public&gt;&gt; Creates a new directory entry in the tcmi_ctlfs tree." alt="" coords="614,208,749,235"/><area shape="rect" id="node11" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga532181c3f7224fe5aa7651a69e6ad6b4" title="&lt;&lt;public&gt;&gt; This method is used when initializing a new entry." alt="" coords="843,259,981,285"/><area shape="rect" id="node16" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga71558bf14c4a13eed4e4b9ca240fd016" title="&lt;&lt;public&gt;&gt; Increments the number of links referencing this entry&#39;s inode." alt="" coords="843,193,981,234"/><area shape="rect" id="node12" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga986b629882729daaf2c9607bfca57c3c" title="&lt;&lt;public&gt;&gt; Entry name accessor." alt="" coords="1278,368,1431,395"/><area shape="rect" id="node13" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga4fbd3f1c3789bd79d4e2c684fc08d1a2" title="&lt;&lt;private&gt;&gt; Checks whether a directory entry contains entry of the specified name" alt="" coords="1061,149,1217,176"/><area shape="rect" id="node14" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga256f5088d3434bfadcdb0cb59bf25cb7" title="&lt;&lt;private&gt;&gt; A method for inode allocation." alt="" coords="1068,200,1209,227"/><area shape="rect" id="node15" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#gaeeb7fba5f385c90d93878a60a4dcf1dc" title="&lt;&lt;private&gt;&gt; The new dentry is allocated based on the parent&#39;s dentry and the current name of the ..." alt="" coords="1065,251,1213,293"/><area shape="rect" id="node18" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#gaab2e404bb2da373a66578541e2dc4ba9" title="&lt;&lt;public&gt;&gt; Instance accessor, Calls instance custom get method and increments the reference counter..." alt="" coords="1069,368,1208,395"/><area shape="rect" id="node20" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gafcb50575d3f6cc783130766295300741" title="&lt;&lt;private&gt;&gt; This is a generic method, that creates a new instance of a file as follows:" alt="" coords="595,259,768,285"/><area shape="rect" id="node22" href="../../de/d2f/group__tcmi__task__class.html#ga2f054ae4772c0921004eebdb48d39dcf" title="&lt;&lt;public&gt;&gt; Remote PID accessor." alt="" coords="606,1009,757,1036"/><area shape="rect" id="node24" href="../../d0/db7/group__tcmi__slotvec__class.html#ga463d8dd03bd30b24c3ebfed5a0239d8a" title="&lt;&lt;public&gt;&gt; Hashmask accessor." alt="" coords="601,959,762,985"/><area shape="rect" id="node25" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4f973395848150fbebecf3cc292c80ba" title="&lt;&lt;public&gt;&gt; The index where the insertion takes place has to be a valid slot." alt="" coords="606,807,757,833"/><area shape="rect" id="node31" href="../../de/d2f/group__tcmi__task__class.html#ga00ff41ed284360c257ed41138ad58d99" title="&lt;&lt;public&gt;&gt; Computes the hash value of the task (to be used in tasks slotvec of migman)" alt="" coords="624,857,739,884"/><area shape="rect" id="node32" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="613,908,750,935"/><area shape="rect" id="node26" href="../../d0/db7/group__tcmi__slotvec__class.html#ga876670f605631a5deb930412dae02b28" title="&lt;&lt;public&gt;&gt; Accesses a slot at a given index." alt="" coords="856,883,968,909"/><area shape="rect" id="node27" href="../../da/d0c/group__tcmi__slot__class.html#gaefe294678d9d6922b3af1e452a318fa1" title="&lt;&lt;public&gt;&gt; Inserts a new node into the slot." alt="" coords="855,832,969,859"/><area shape="rect" id="node28" href="../../da/d0c/group__tcmi__slot__class.html#ga109d6d783ebf06046f364f970f84da1f" title="&lt;&lt;public&gt;&gt; Locks the slot data." alt="" coords="1085,832,1192,859"/><area shape="rect" id="node29" href="../../da/d0c/group__tcmi__slot__class.html#ga8d6885be2677819158e0d956f0cca5b2" title="&lt;&lt;private&gt;&gt; Moves a slot into the specified list." alt="" coords="1083,883,1195,909"/><area shape="rect" id="node30" href="../../da/d0c/group__tcmi__slot__class.html#ga5447231fec5f42040c40307eb2e6a13c" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="1079,781,1199,808"/><area shape="rect" id="node35" href="../../da/d0c/group__tcmi__slot__class.html#ga6dd63ff2854a9939a5aa094f6543a5d1" title="&lt;&lt;public&gt;&gt; Checks if the slot is empty." alt="" coords="1079,731,1198,757"/><area shape="rect" id="node37" href="../../d5/ddf/group__kkc__arch__class.html#ga06049c969ae0324d0607f10db99af65c" title="&lt;&lt;public&gt;&gt; Decrements the reference counter on the module owning the architecture." alt="" coords="1305,579,1405,605"/><area shape="rect" id="node38" href="../../d6/d8e/group__kkc__sock__class.html#ga00d8b033d3e1118303e7b4c54c6aafe6" title="&lt;&lt;public&gt;&gt; Socket name accessor." alt="" coords="1271,629,1438,656"/><area shape="rect" id="node40" href="../../d6/d8e/group__kkc__sock__class.html#gac8e64f52015e75cb76a34c4b7e9ef176" title="&lt;&lt;public&gt;&gt; Socket name accessor." alt="" coords="1269,680,1440,707"/><area shape="rect" id="node39" href="../../d6/d8e/group__kkc__sock__class.html#gadf1b231c727891d5ac2d32646d574931" title="&lt;&lt;public&gt;&gt; Peer socket name accessor." alt="" coords="1489,629,1649,656"/><area shape="rect" id="node41" href="../../d6/d8e/group__kkc__sock__class.html#ga3cae649f56c8f5fa18f755f6c7d53597" title="&lt;&lt;public&gt;&gt; Local socket name accessor." alt="" coords="1488,680,1651,707"/><area shape="rect" id="node43" href="../../d6/da2/group__tcmi__migman__class.html#ga94df994d6d2ad3dd9aa6543ee67bf934" title="&lt;&lt;private&gt;&gt; Free method is has two purposes:when the last reference is released, it will free all ins..." alt="" coords="617,549,745,576"/><area shape="rect" id="node44" href="../../d9/dfc/group__tcmi__comm__class.html#ga89dc5a63295a65407cc93606c79ca314" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="855,629,969,656"/><area shape="rect" id="node45" href="../../d6/da2/group__tcmi__migman__class.html#ga39c491f49b4e5b3cc533c816d27135a3" title="&lt;&lt;private&gt;&gt; Destroys all TCMI ctlfs directories" alt="" coords="817,411,1007,437"/><area shape="rect" id="node46" href="../../d6/da2/group__tcmi__migman__class.html#ga5b56a5213e9dbcba9973b9530692fd27" title="&lt;&lt;private&gt;&gt; Unregisters and releases all control files." alt="" coords="831,513,993,554"/><area shape="rect" id="node48" href="../../d6/da2/group__tcmi__migman__class.html#gae4ad418d705edeca23e38eb383343978" title="&lt;&lt;private&gt;&gt; The TCMI manager listening thread is to be terminated by forcing a signal and waiting for..." alt="" coords="825,461,999,488"/><area shape="rect" id="node49" href="../../d6/da2/group__tcmi__migman__class.html#ga71f49cd0661e81a859daab82ae7676de" title="Removes migman from a list of migration managers of the associated manager." alt="" coords="837,781,987,808"/><area shape="rect" id="node50" href="../../d3/d7e/group__tcmi__sock__class.html#gaa64951d80cedfaf76bb82ee811255d69" title="&lt;&lt;public&gt;&gt; Decrements the reference counter and if it reaches 0, the instance." alt="" coords="859,579,965,605"/><area shape="rect" id="node47" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga665210941a04fda118949874767ced93" title="&lt;&lt;public&gt;&gt; This method unregisters the file uses the semaphore lock as protection from races..." alt="" coords="1056,549,1221,576"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gafe0d1448f55b9fef0832b44a3128b2ad"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_shadowtask_process_msg </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Processes a message specified by the caller. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this task instance </td></tr>
    <tr><td class="paramname">*m</td><td>- message to be processed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>depends on the type of message that has been processed </dd></dl>

<p>Definition at line <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00127">127</a> of file <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html">tcmi_shadowtask.c</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d6/d01/dbg_8h_source.html#l00221">minfo</a>, <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00116">resp</a>, <a class="el" href="../../d0/d50/tcmi__exit__procmsg_8h_source.html#l00070">TCMI_EXIT_PROCMSG</a>, <a class="el" href="../../d0/d50/tcmi__exit__procmsg_8h_source.html#l00078">tcmi_exit_procmsg_code()</a>, <a class="el" href="../../dd/dd5/tcmi__messages__id_8h_source.html#l00132">TCMI_EXIT_PROCMSG_ID</a>, <a class="el" href="../../d3/db1/tcmi__guest__started__procmsg_8h_source.html#l00075">TCMI_GUEST_STARTED_PROCMSG</a>, <a class="el" href="../../d3/db1/tcmi__guest__started__procmsg_8h_source.html#l00083">tcmi_guest_started_procmsg_guest_pid()</a>, <a class="el" href="../../dd/dd5/tcmi__messages__id_8h_source.html#l00134">TCMI_GUEST_STARTED_PROCMSG_ID</a>, <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00194">tcmi_msg_get()</a>, <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00231">tcmi_msg_id()</a>, <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00212">tcmi_msg_put()</a>, <a class="el" href="../../dd/dd5/tcmi__messages__id_8h_source.html#l00135">TCMI_PPM_P_MIGR_BACK_GUESTREQ_PROCMSG_ID</a>, <a class="el" href="../../d2/d3e/tcmi__rpc_8h_source.html#l00091">tcmi_rpc_call2()</a>, <a class="el" href="../../df/de9/tcmi__rpc__procmsg_8h_source.html#l00100">TCMI_RPC_PROCMSG</a>, <a class="el" href="../../dd/dd5/tcmi__messages__id_8h_source.html#l00137">TCMI_RPC_PROCMSG_ID</a>, <a class="el" href="../../df/de9/tcmi__rpc__procmsg_8h_source.html#l00089">tcmi_rpc_procmsg_num()</a>, <a class="el" href="../../d6/d52/tcmi__shadow__rpc_8c_source.html#l00036">tcmi_shadow_rpc</a>, <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00467">tcmi_shadowtask_process_ppm_p_migr_back_guestreq_procmsg()</a>, <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00196">tcmi_shadowtask_vfork_done()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00648">tcmi_task_check_peer_lost()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00252">TCMI_TASK_KEEP_PUMPING</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00255">TCMI_TASK_KILL_ME</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00411">tcmi_task_local_pid()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00422">tcmi_task_remote_pid()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00524">tcmi_task_send_anonymous_msg()</a>, <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00450">tcmi_task_send_message()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00367">tcmi_task_set_exit_code()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00453">tcmi_task_set_remote_pid()</a>, <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00270">tcmi_task_submit_method()</a>, and <a class="el" href="../../dd/dd5/tcmi__messages__id_8h_source.html#l00133">TCMI_VFORK_DONE_PROCMSG_ID</a>.</p>
<div class="fragment"><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;{</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordtype">int</span> res = <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ggaa81f1a7178bfcf01d74e57d6bbcb869bafa7c813a4364ccccdc1edfd29839c675">TCMI_TASK_KEEP_PUMPING</a>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg" title="A coumpound structure that carries a generic TCMI message.">tcmi_msg</a> *<a class="code" href="../../d1/d6d/tcmi__msg_8h.html#adb26817b6c4a9eeb3f68c832f24d5471" title="response transaction ID">resp</a> = NULL;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    pid_t remote_pid;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordtype">int</span> err;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">/* struct tcmi_shadowtask *self_tsk = TCMI_SHADOWTASK(self); */</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ga73489766817f528da25369a3f4c713a1" title="&lt;&lt;public&gt;&gt; Message ID accessor.">tcmi_msg_id</a>(m)) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#gga61dadd085c1777f559549e05962b2c9eabc7c4c942574da98e10199c6b4c6e638">TCMI_RPC_PROCMSG_ID</a>:</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO1, <span class="stringliteral">&quot;Receiced RPC message: %x&quot;</span>, <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ga73489766817f528da25369a3f4c713a1" title="&lt;&lt;public&gt;&gt; Message ID accessor.">tcmi_msg_id</a>(m));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <a class="code" href="../../d2/d43/group__tcmi__rpc__class.html#gac256a36ecc415dfbf0427af0d3e7e902" title="&lt;&lt;public&gt;&gt; Do a rpc with 2 parameters.">tcmi_rpc_call2</a>(<a class="code" href="../../d5/d8f/group__tcmi__shadow__rpc__class.html#ga768b223612ab8656e18a3bdc0ae6aec8" title="tcmi_shadow_rpc class declaration">tcmi_shadow_rpc</a>, <a class="code" href="../../d2/da2/group__tcmi__rpc__procmsg__class.html#ga3faa701b0512840c23a97dc58e13e75c" title="&lt;&lt;public&gt;&gt; Return RPC number.">tcmi_rpc_procmsg_num</a>(<a class="code" href="../../d2/da2/group__tcmi__rpc__procmsg__class.html#ga31e7e4639350a91cfc415bc0620c0217" title="Casts to the tcmi_rpc_procmsg instance.">TCMI_RPC_PROCMSG</a>(m)), (<span class="keywordtype">long</span>)m, (<span class="keywordtype">long</span>)(&amp;resp));</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <span class="keywordflow">if</span> ( resp == NULL ) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                <a class="code" href="../../d6/d01/dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(ERR3, <span class="stringliteral">&quot;RPC#%d didn&#39;t returned rpc response message&quot;</span>, </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                        <a class="code" href="../../d2/da2/group__tcmi__rpc__procmsg__class.html#ga3faa701b0512840c23a97dc58e13e75c" title="&lt;&lt;public&gt;&gt; Return RPC number.">tcmi_rpc_procmsg_num</a>(<a class="code" href="../../d2/da2/group__tcmi__rpc__procmsg__class.html#ga31e7e4639350a91cfc415bc0620c0217" title="Casts to the tcmi_rpc_procmsg instance.">TCMI_RPC_PROCMSG</a>(m)));</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            <span class="keywordflow">if</span> ( <a class="code" href="../../de/d2f/group__tcmi__task__class.html#gac04862f389dea22fbd5b8dc8f642ca9c" title="Simple error checking method to be used after communication operations to detect lost peer...">tcmi_task_check_peer_lost</a>(<span class="keyword">self</span>, (err = <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga4e660ea948542a5a057e25640a762efc" title="&lt;&lt;public&gt;&gt; Sends a specified message.">tcmi_task_send_anonymous_msg</a>(<span class="keyword">self</span>, resp)) ) ){</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                <a class="code" href="../../d6/d01/dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(ERR3, <span class="stringliteral">&quot;Error sending RPC response message %d&quot;</span>, err);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                <span class="keywordflow">if</span> ( err == -ERESTARTSYS ) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                    <a class="code" href="../../d6/d01/dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(INFO3, <span class="stringliteral">&quot;Scheduling message for resubmission&quot;</span>);  </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                    <span class="comment">/* Protect response reference, retransmission method will be responsible for releasing of the msg */</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                    <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ga23d3ca435be85adedc5c1385469d707f" title="&lt;&lt;public&gt;&gt; Instance accessor, increments the reference count.">tcmi_msg_get</a>(resp);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                    <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0409e631915b37fbcfe096dfc498bbbb" title="&lt;&lt;public&gt;&gt; Submits a method for execution.">tcmi_task_submit_method</a>(<span class="keyword">self</span>, <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga85318d71dab1a903c2799134c696990d" title="&lt;&lt;public&gt;&gt; Called from method queue - Sends a message to peer task.">tcmi_task_send_message</a>, resp, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg" title="A coumpound structure that carries a generic TCMI message.">tcmi_msg</a>));</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined...">tcmi_msg_put</a>( resp );</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="comment">/* exit request */</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#gga61dadd085c1777f559549e05962b2c9ea3655cb6b34c18303cc6a15da6919b8da">TCMI_EXIT_PROCMSG_ID</a>:</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO2, <span class="stringliteral">&quot;Process &#39;%s&#39; local PID=%d, remote PID=%d terminating, &quot;</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                    <span class="stringliteral">&quot;code: %ld, anounced by guest&quot;</span>,</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                    current-&gt;comm, <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor.">tcmi_task_local_pid</a>(<span class="keyword">self</span>), </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                    <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga2f054ae4772c0921004eebdb48d39dcf" title="&lt;&lt;public&gt;&gt; Remote PID accessor.">tcmi_task_remote_pid</a>(<span class="keyword">self</span>),</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                    (<span class="keywordtype">long</span>)<a class="code" href="../../d4/d5a/group__tcmi__exit__procmsg__class.html#ga14abd449ec55da5c984307167916af0e" title="Exit code accessor.">tcmi_exit_procmsg_code</a>(<a class="code" href="../../d4/d5a/group__tcmi__exit__procmsg__class.html#ga498ab81a7b3fd783c5311c86c3400f65" title="Casts to the tcmi_exit_procmsg instance.">TCMI_EXIT_PROCMSG</a>(m)));</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <a class="code" href="../../de/d2f/group__tcmi__task__class.html#gad2304b37598ad3c64f6a24f0ed0064de" title="&lt;&lt;public&gt;&gt; Exit code setter.">tcmi_task_set_exit_code</a>(<span class="keyword">self</span>, <a class="code" href="../../d4/d5a/group__tcmi__exit__procmsg__class.html#ga14abd449ec55da5c984307167916af0e" title="Exit code accessor.">tcmi_exit_procmsg_code</a>(<a class="code" href="../../d4/d5a/group__tcmi__exit__procmsg__class.html#ga498ab81a7b3fd783c5311c86c3400f65" title="Casts to the tcmi_exit_procmsg instance.">TCMI_EXIT_PROCMSG</a>(m)));</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            res = <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ggaa81f1a7178bfcf01d74e57d6bbcb869bad619e483cc5231333ada87518fb2b301">TCMI_TASK_KILL_ME</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="comment">/* vfork done on guest side */</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#gga61dadd085c1777f559549e05962b2c9eacbe4a89e5620a43b51b1889ea5e4713a">TCMI_VFORK_DONE_PROCMSG_ID</a>:</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO2, <span class="stringliteral">&quot;Process &#39;%s&#39; local PID=%d, remote PID=%d vfork done&quot;</span>,</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                    current-&gt;comm, <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor.">tcmi_task_local_pid</a>(<span class="keyword">self</span>), </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                    <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga2f054ae4772c0921004eebdb48d39dcf" title="&lt;&lt;public&gt;&gt; Remote PID accessor.">tcmi_task_remote_pid</a>(<span class="keyword">self</span>));</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <a class="code" href="../../dc/dff/group__tcmi__shadowtask__class.html#ga13c386f8b5320b2aa774cf5ec9010407">tcmi_shadowtask_vfork_done</a>(<span class="keyword">self</span>);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="comment">/* migrate back request */</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#gga61dadd085c1777f559549e05962b2c9eaa41d6302c56a5fbe80be4a688ac77301">TCMI_PPM_P_MIGR_BACK_GUESTREQ_PROCMSG_ID</a>:</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            res = <a class="code" href="../../dc/dff/group__tcmi__shadowtask__class.html#ga0329a0dc8d8d862cb40c66faebc21211" title="&lt;&lt;private&gt;&gt; Processes the PPM_P emigrate process message.">tcmi_shadowtask_process_ppm_p_migr_back_guestreq_procmsg</a>(<span class="keyword">self</span>, m);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#gga61dadd085c1777f559549e05962b2c9ea1fff522372aae1c3fa549658ef13d5ab">TCMI_GUEST_STARTED_PROCMSG_ID</a>: <span class="comment">// We can get here only in double-fork</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            remote_pid = <a class="code" href="../../d1/dc2/group__tcmi__guest__started__procmsg__class.html#gad1e35a7478f07eccff72ce8d47045d1a" title="&lt;&lt;public&gt;&gt; Stub PID accessor.">tcmi_guest_started_procmsg_guest_pid</a>(<a class="code" href="../../d1/dc2/group__tcmi__guest__started__procmsg__class.html#ga47d048883e032d7dfdfb9c7421bd91b6" title="Casts to the tcmi_guest_started_procmsg instance.">TCMI_GUEST_STARTED_PROCMSG</a>(m));</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Fork confirmation from guesttask - task migrated, local PID %d, guest PID %d&quot;</span>, <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor.">tcmi_task_local_pid</a>(<span class="keyword">self</span>), remote_pid);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga60a2a872664867b7a86ec278b570fef2" title="&lt;&lt;public&gt;&gt; Remote PID setter.">tcmi_task_set_remote_pid</a>(<span class="keyword">self</span>, remote_pid);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Unexpected message from the guest task: %x&quot;</span>, <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ga73489766817f528da25369a3f4c713a1" title="&lt;&lt;public&gt;&gt; Message ID accessor.">tcmi_msg_id</a>(m));</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../dc/dff/group__tcmi__shadowtask__class_gafe0d1448f55b9fef0832b44a3128b2ad_cgraph.png" border="0" usemap="#dc/dff/group__tcmi__shadowtask__class_gafe0d1448f55b9fef0832b44a3128b2ad_cgraph" alt=""/></div>
<map name="dc/dff/group__tcmi__shadowtask__class_gafe0d1448f55b9fef0832b44a3128b2ad_cgraph" id="dc/dff/group__tcmi__shadowtask__class_gafe0d1448f55b9fef0832b44a3128b2ad_cgraph">
<area shape="rect" id="node2" href="../../d4/d5a/group__tcmi__exit__procmsg__class.html#ga14abd449ec55da5c984307167916af0e" title="Exit code accessor." alt="" coords="274,83,441,109"/><area shape="rect" id="node3" href="../../d1/dc2/group__tcmi__guest__started__procmsg__class.html#gad1e35a7478f07eccff72ce8d47045d1a" title="&lt;&lt;public&gt;&gt; Stub PID accessor." alt="" coords="286,134,429,175"/><area shape="rect" id="node4" href="../../d6/dc2/group__tcmi__msg__class.html#ga23d3ca435be85adedc5c1385469d707f" title="&lt;&lt;public&gt;&gt; Instance accessor, increments the reference count." alt="" coords="560,200,664,227"/><area shape="rect" id="node5" href="../../d6/dc2/group__tcmi__msg__class.html#ga73489766817f528da25369a3f4c713a1" title="&lt;&lt;public&gt;&gt; Message ID accessor." alt="" coords="309,765,405,792"/><area shape="rect" id="node6" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined..." alt="" coords="560,352,664,379"/><area shape="rect" id="node15" href="../../d2/d43/group__tcmi__rpc__class.html#gac256a36ecc415dfbf0427af0d3e7e902" title="&lt;&lt;public&gt;&gt; Do a rpc with 2 parameters." alt="" coords="304,816,411,843"/><area shape="rect" id="node17" href="../../d2/da2/group__tcmi__rpc__procmsg__class.html#ga3faa701b0512840c23a97dc58e13e75c" title="&lt;&lt;public&gt;&gt; Return RPC number." alt="" coords="277,867,438,893"/><area shape="rect" id="node18" href="../../dc/dff/group__tcmi__shadowtask__class.html#ga0329a0dc8d8d862cb40c66faebc21211" title="&lt;&lt;private&gt;&gt; Processes the PPM_P emigrate process message." alt="" coords="261,533,453,589"/><area shape="rect" id="node36" href="../../dc/dff/group__tcmi__shadowtask__class.html#ga13c386f8b5320b2aa774cf5ec9010407" title="tcmi_shadowtask_vfork_done" alt="" coords="262,917,453,944"/><area shape="rect" id="node37" href="../../de/d2f/group__tcmi__task__class.html#gac04862f389dea22fbd5b8dc8f642ca9c" title="Simple error checking method to be used after communication operations to detect lost peer..." alt="" coords="267,664,448,691"/><area shape="rect" id="node24" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="1235,676,1373,703"/><area shape="rect" id="node20" href="../../de/d2f/group__tcmi__task__class.html#ga2f054ae4772c0921004eebdb48d39dcf" title="&lt;&lt;public&gt;&gt; Remote PID accessor." alt="" coords="537,723,687,749"/><area shape="rect" id="node40" href="../../de/d2f/group__tcmi__task__class.html#ga4e660ea948542a5a057e25640a762efc" title="&lt;&lt;public&gt;&gt; Sends a specified message." alt="" coords="502,251,722,277"/><area shape="rect" id="node43" href="../../de/d2f/group__tcmi__task__class.html#ga85318d71dab1a903c2799134c696990d" title="&lt;&lt;public&gt;&gt; Called from method queue &#45; Sends a message to peer task." alt="" coords="270,325,445,352"/><area shape="rect" id="node46" href="../../de/d2f/group__tcmi__task__class.html#gad2304b37598ad3c64f6a24f0ed0064de" title="&lt;&lt;public&gt;&gt; Exit code setter." alt="" coords="274,968,441,995"/><area shape="rect" id="node47" href="../../de/d2f/group__tcmi__task__class.html#ga60a2a872664867b7a86ec278b570fef2" title="&lt;&lt;public&gt;&gt; Remote PID setter." alt="" coords="270,715,445,741"/><area shape="rect" id="node45" href="../../de/d2f/group__tcmi__task__class.html#ga0409e631915b37fbcfe096dfc498bbbb" title="&lt;&lt;public&gt;&gt; Submits a method for execution." alt="" coords="525,403,699,429"/><area shape="rect" id="node7" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2748d267a8fddd1ced86e73ba8efd079" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="794,157,937,184"/><area shape="rect" id="node8" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="1035,56,1160,83"/><area shape="rect" id="node9" href="../../d4/d8c/group__tcmi__transaction__class.html#gaac666feaaab1fe5c341237a3e0283501" title="&lt;&lt;public&gt;&gt; Transaction ID accessor." alt="" coords="1030,107,1165,133"/><area shape="rect" id="node10" href="../../da/d0c/group__tcmi__slot__class.html#ga1d6232adcf00094597a66d9f5740d5f8" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="1036,157,1159,184"/><area shape="rect" id="node14" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="1028,208,1167,235"/><area shape="rect" id="node11" href="../../da/d0c/group__tcmi__slot__class.html#ga29d8101c5815a6519567c548da4a3c7e" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="1235,157,1373,184"/><area shape="rect" id="node12" href="../../da/d0c/group__tcmi__slot__class.html#ga109d6d783ebf06046f364f970f84da1f" title="&lt;&lt;public&gt;&gt; Locks the slot data." alt="" coords="1251,208,1357,235"/><area shape="rect" id="node13" href="../../da/d0c/group__tcmi__slot__class.html#ga5447231fec5f42040c40307eb2e6a13c" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="1244,107,1364,133"/><area shape="rect" id="node16" href="../../d2/d43/group__tcmi__rpc__class.html#ga3b19dd529d8c1bc18d24bca70107003f" title="&lt;&lt;public&gt;&gt; Universal procedure to do RPC" alt="" coords="565,925,659,952"/><area shape="rect" id="node19" href="../../d4/d84/group__tcmi__ppm__p__migr__back__guestreq__procmsg__class.html#ga595504c7571b0e3a1e50b198672cc9dc" title="Checkpoint name accessor." alt="" coords="509,657,715,698"/><area shape="rect" id="node21" href="../../d8/d87/director_8c.html#a9fd5fd27dc9136a646bb89efa3c909f7" title="Called, when a task migrates home." alt="" coords="531,605,693,632"/><area shape="rect" id="node25" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga1ff741911c123bcd7eb94d193f3bdc59" title="&lt;&lt;public&gt;&gt; Schedules a task restart from a given checkpoint image." alt="" coords="533,504,691,531"/><area shape="rect" id="node22" href="../../d7/d8d/migrated__home__msg_8c.html#a9b2ead1e47b190743680527571b54d63" title="Called, when a task is migrated home (called on ccn)" alt="" coords="810,716,921,743"/><area shape="rect" id="node23" href="../../d9/df4/comm_8c.html#af68cf85dec3fb86013cb79568bb30026" title="Performs a netlink transaction." alt="" coords="1028,781,1167,808"/><area shape="rect" id="node26" href="../../de/d2f/group__tcmi__task__class.html#ga24a9d8c612da1a4484b1b3a28a181c15" title="&lt;&lt;public&gt;&gt; Prepares execution of a file given the arrays of arguments and environment." alt="" coords="777,571,953,597"/><area shape="rect" id="node29" href="../../de/d2f/group__tcmi__task__class.html#ga2bf62635c09738ef0c1385ea258bec2f" title="&lt;&lt;public&gt;&gt; Flushes all pending methods in the queue submits a method for execution." alt="" coords="795,439,936,481"/><area shape="rect" id="node35" href="../../de/d2f/group__tcmi__task__class.html#gab1a418ac9d8b708dcee524671db07518" title="&lt;&lt;public&gt;&gt; Executes the file that has been previously setup for execution." alt="" coords="802,509,929,536"/><area shape="rect" id="node27" href="../../de/d2f/group__tcmi__task__class.html#gad41453e0aefb9dd79c2d3b65d8b9b16c" title="&lt;&lt;private&gt;&gt; Releases the execve context (execve file, argv, envp) Since the argv/envp have alloca..." alt="" coords="1010,614,1185,655"/><area shape="rect" id="node28" href="../../de/d84/tcmi__task_8c.html#ab73603e4adaf2a1bb6b7cf6a01a1c2f3" title="&lt;&lt;private&gt;&gt; Class method &#45; copies an array of strings terminated by NULL string (standard argv/envp f..." alt="" coords="1017,680,1177,707"/><area shape="rect" id="node30" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#ga57cd57a64f1ec847f1b71452daf4b3b1" title="&lt;&lt;public&gt;&gt; Creates a new wrapper for the specified method." alt="" coords="1008,309,1187,336"/><area shape="rect" id="node31" href="../../dc/d0c/group__tcmi__queue__class.html#ga3ae4d7e0a4d5d21ec8b9fff138f5b0d4" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="1037,411,1157,437"/><area shape="rect" id="node32" href="../../dc/d0c/group__tcmi__queue__class.html#ga2b0f1376bcd561196e77599cbc23090f" title="tcmi_queue_empty" alt="" coords="1031,461,1163,488"/><area shape="rect" id="node33" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#gad93018cc0894a434a94703eed0f869f9" title="&lt;&lt;public&gt;&gt; Decrements the reference counter, when the count reaches 0, the instance is destroyed..." alt="" coords="1010,512,1185,539"/><area shape="rect" id="node34" href="../../dc/d0c/group__tcmi__queue__class.html#ga40921ea3b077d55d70fb7b94ac666292" title="&lt;&lt;public&gt;&gt; Adds an element to the queue &#45; lock free version, assumes the lock is already held..." alt="" coords="1032,360,1163,387"/><area shape="rect" id="node38" href="../../de/d2f/group__tcmi__task__class.html#gad2d3dad02cf555da12cb2926cebb25f6" title="Notifies task that it peer is lost and sends a kill signal to that task." alt="" coords="522,773,702,800"/><area shape="rect" id="node39" href="../../de/d2f/group__tcmi__task__class.html#gac263213bf219960dea9c7d4b4e6f3b34" title="Returns a task_struct associated with the tcmi_task." alt="" coords="781,773,950,800"/><area shape="rect" id="node41" href="../../d6/dc2/group__tcmi__msg__class.html#ga7a8fe8cbfd4b25c15589c8599f66e574" title="&lt;&lt;public&gt;&gt; Sends a message via a specified connection." alt="" coords="771,56,959,83"/><area shape="rect" id="node42" href="../../d6/dc2/group__tcmi__msg__class.html#ga1c21eeafb9a0d56dabb025d5fbdc0bc3" title="&lt;&lt;private&gt;&gt; Sends a message via a specified connection." alt="" coords="1040,5,1155,32"/><area shape="rect" id="node44" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#gaaf4d02eac4338a675bd5ed2df9943c97" title="&lt;&lt;public&gt;&gt; Accessor for the data stored in the method wrapper." alt="" coords="521,301,703,328"/><area shape="rect" id="node48" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gac720ca77312808db7cbbc645be8e3541" title="&lt;&lt;public&gt;&gt; Creates a new instance of a file." alt="" coords="539,824,685,851"/><area shape="rect" id="node50" href="../../de/d2f/group__tcmi__task__class.html#ga401654abdc812f0a923d05c95b412fb1" title="tcmi_task_show_remote\l_pid_rev" alt="" coords="784,875,947,917"/><area shape="rect" id="node49" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gafcb50575d3f6cc783130766295300741" title="&lt;&lt;private&gt;&gt; This is a generic method, that creates a new instance of a file as follows:" alt="" coords="779,824,952,851"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga0329a0dc8d8d862cb40c66faebc21211"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_shadowtask_process_ppm_p_migr_back_guestreq_procmsg </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Processes the PPM_P emigrate process message. </p>
<p>The remote PID is extracted from the emigration message and stored in the guest task. The checkpoint name is also extracted and passed to the task helper to schedule a restart. This also sets the checkpoint image as the most recent checkpoint of the task.</p>
<p>A response is sent back that will contain the guest task local PID. This PID is needed for further communication between the shadow and guest tasks.</p>
<p>The restart is only scheduled and will be processed upon next iteration of the method pump.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- this guest task instance </td></tr>
    <tr><td class="paramname">*m</td><td>- PPM_P migrate back guest request </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TASK_KEEP_PUMPING if the restart has been successfully scheduled </dd></dl>

<p>Definition at line <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00467">467</a> of file <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html">tcmi_shadowtask.c</a>.</p>

<p>References <a class="el" href="../../d8/d87/director_8c_source.html#l00118">director_migrated_home()</a>, <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d0/def/tcmi__ppm__p__migr__back__guestreq__procmsg_8h_source.html#l00074">TCMI_PPM_P_MIGR_BACK_GUESTREQ_PROCMSG</a>, <a class="el" href="../../d0/def/tcmi__ppm__p__migr__back__guestreq__procmsg_8h_source.html#l00082">tcmi_ppm_p_migr_back_guestreq_procmsg_ckpt_name()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00252">TCMI_TASK_KEEP_PUMPING</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00255">TCMI_TASK_KILL_ME</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00411">tcmi_task_local_pid()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00422">tcmi_task_remote_pid()</a>, and <a class="el" href="../../d7/d05/tcmi__taskhelper_8h_source.html#l00700">tcmi_taskhelper_restart()</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00127">tcmi_shadowtask_process_msg()</a>.</p>
<div class="fragment"><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;{</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordtype">char</span> *ckpt_name;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="comment">/* extract the checkpoint name */</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    ckpt_name =  <a class="code" href="../../d4/d84/group__tcmi__ppm__p__migr__back__guestreq__procmsg__class.html#ga595504c7571b0e3a1e50b198672cc9dc" title="Checkpoint name accessor.">tcmi_ppm_p_migr_back_guestreq_procmsg_ckpt_name</a></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        (<a class="code" href="../../d4/d84/group__tcmi__ppm__p__migr__back__guestreq__procmsg__class.html#ga407c2dcfc13e9cf95f56f6ca10dc386e" title="Casts to the tcmi_ppm_p_migr_back_guestreq_procmsg instance.">TCMI_PPM_P_MIGR_BACK_GUESTREQ_PROCMSG</a>(m));</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO2, <span class="stringliteral">&quot;Processing migrate back request, remote PID=%d, checkpoint: &#39;%s&#39;&quot;</span>,</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;             <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga2f054ae4772c0921004eebdb48d39dcf" title="&lt;&lt;public&gt;&gt; Remote PID accessor.">tcmi_task_remote_pid</a>(<span class="keyword">self</span>), ckpt_name);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <a class="code" href="../../d8/d87/director_8c.html#a9fd5fd27dc9136a646bb89efa3c909f7" title="Called, when a task migrates home.">director_migrated_home</a>(<a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor.">tcmi_task_local_pid</a>(<span class="keyword">self</span>));</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">/* schedules process restart from a checkpoint image */</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga1ff741911c123bcd7eb94d193f3bdc59" title="&lt;&lt;public&gt;&gt; Schedules a task restart from a given checkpoint image.">tcmi_taskhelper_restart</a>(<span class="keyword">self</span>, ckpt_name) &lt; 0) {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Cannot setup task restart!!&quot;</span>);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    }</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ggaa81f1a7178bfcf01d74e57d6bbcb869bafa7c813a4364ccccdc1edfd29839c675">TCMI_TASK_KEEP_PUMPING</a>;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; exit0:</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ggaa81f1a7178bfcf01d74e57d6bbcb869bad619e483cc5231333ada87518fb2b301">TCMI_TASK_KILL_ME</a>;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../dc/dff/group__tcmi__shadowtask__class_ga0329a0dc8d8d862cb40c66faebc21211_cgraph.png" border="0" usemap="#dc/dff/group__tcmi__shadowtask__class_ga0329a0dc8d8d862cb40c66faebc21211_cgraph" alt=""/></div>
<map name="dc/dff/group__tcmi__shadowtask__class_ga0329a0dc8d8d862cb40c66faebc21211_cgraph" id="dc/dff/group__tcmi__shadowtask__class_ga0329a0dc8d8d862cb40c66faebc21211_cgraph">
<area shape="rect" id="node2" href="../../d8/d87/director_8c.html#a9fd5fd27dc9136a646bb89efa3c909f7" title="Called, when a task migrates home." alt="" coords="269,107,430,133"/><area shape="rect" id="node15" href="../../d4/d84/group__tcmi__ppm__p__migr__back__guestreq__procmsg__class.html#ga595504c7571b0e3a1e50b198672cc9dc" title="Checkpoint name accessor." alt="" coords="246,158,453,199"/><area shape="rect" id="node16" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="973,637,1110,664"/><area shape="rect" id="node17" href="../../de/d2f/group__tcmi__task__class.html#ga2f054ae4772c0921004eebdb48d39dcf" title="&lt;&lt;public&gt;&gt; Remote PID accessor." alt="" coords="274,351,425,377"/><area shape="rect" id="node18" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga1ff741911c123bcd7eb94d193f3bdc59" title="&lt;&lt;public&gt;&gt; Schedules a task restart from a given checkpoint image." alt="" coords="270,300,429,327"/><area shape="rect" id="node3" href="../../d7/d8d/migrated__home__msg_8c.html#a9b2ead1e47b190743680527571b54d63" title="Called, when a task is migrated home (called on ccn)" alt="" coords="534,107,645,133"/><area shape="rect" id="node4" href="../../d9/df4/comm_8c.html#af68cf85dec3fb86013cb79568bb30026" title="Performs a netlink transaction." alt="" coords="745,107,884,133"/><area shape="rect" id="node5" href="../../d9/df4/comm_8c.html#ab708cd00ae28bb68e7a53b6784f6f937" title="Helper method to create&amp;send request." alt="" coords="957,81,1125,108"/><area shape="rect" id="node11" href="../../d9/df4/comm_8c.html#a66ea56ce29053fb1d9ab6d337429652d" title="msg_transaction_response" alt="" coords="952,157,1131,184"/><area shape="rect" id="node6" href="../../d8/d7c/genl__ext_8c.html#ac461d0210fcfe8dde0588f23aebf9aab" title="genlmsg_unicast_tx &#45; wrapper around generic netlink unicast." alt="" coords="1191,56,1329,83"/><area shape="rect" id="node9" href="../../d9/df4/comm_8c.html#a4559dadd35469f8de48ab278303e40a0" title="Returns unique sequence number for transaction." alt="" coords="1203,107,1317,133"/><area shape="rect" id="node10" href="../../d9/df4/comm_8c.html#a5f190e32af9d5c630100bee151c00717" title="Returns pid of director process if there is user&#45;space director connected, 0 otherwise." alt="" coords="1185,5,1335,32"/><area shape="rect" id="node7" href="../../d8/d7c/genl__ext_8c.html#ad7afbee4ce89bce50e383aa7b2cce80c" title="genl_ext_lock" alt="" coords="1397,69,1499,96"/><area shape="rect" id="node8" href="../../d8/d7c/genl__ext_8c.html#a9ea9dfe0b2ad73e1306c736e66755b1d" title="genl_ext_unlock" alt="" coords="1390,132,1506,159"/><area shape="rect" id="node12" href="../../d9/df4/comm_8c.html#ae2479089f7107aec24a9c89a13101d0d" title="Checks, if the transaction returned an error." alt="" coords="1205,157,1315,184"/><area shape="rect" id="node13" href="../../d8/d7c/genl__ext_8c.html#a98fc505709c73b6933abbacd5a656cb9" title="Blocking read call that will read netlink response for the specified transaction." alt="" coords="1179,208,1341,235"/><area shape="rect" id="node14" href="../../d8/d7c/genl__ext_8c.html#a96c79abdde8010527de40d4806b4942c" title="__find_itx" alt="" coords="1409,208,1487,235"/><area shape="rect" id="node19" href="../../de/d2f/group__tcmi__task__class.html#ga24a9d8c612da1a4484b1b3a28a181c15" title="&lt;&lt;public&gt;&gt; Prepares execution of a file given the arrays of arguments and environment." alt="" coords="501,667,677,693"/><area shape="rect" id="node22" href="../../de/d2f/group__tcmi__task__class.html#ga2bf62635c09738ef0c1385ea258bec2f" title="&lt;&lt;public&gt;&gt; Flushes all pending methods in the queue submits a method for execution." alt="" coords="519,419,660,461"/><area shape="rect" id="node29" href="../../de/d2f/group__tcmi__task__class.html#gab1a418ac9d8b708dcee524671db07518" title="&lt;&lt;public&gt;&gt; Executes the file that has been previously setup for execution." alt="" coords="526,300,653,327"/><area shape="rect" id="node20" href="../../de/d2f/group__tcmi__task__class.html#gad41453e0aefb9dd79c2d3b65d8b9b16c" title="&lt;&lt;private&gt;&gt; Releases the execve context (execve file, argv, envp) Since the argv/envp have alloca..." alt="" coords="727,630,902,671"/><area shape="rect" id="node21" href="../../de/d84/tcmi__task_8c.html#ab73603e4adaf2a1bb6b7cf6a01a1c2f3" title="&lt;&lt;private&gt;&gt; Class method &#45; copies an array of strings terminated by NULL string (standard argv/envp f..." alt="" coords="735,696,895,723"/><area shape="rect" id="node23" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#ga57cd57a64f1ec847f1b71452daf4b3b1" title="&lt;&lt;public&gt;&gt; Creates a new wrapper for the specified method." alt="" coords="725,427,904,453"/><area shape="rect" id="node24" href="../../dc/d0c/group__tcmi__queue__class.html#ga3ae4d7e0a4d5d21ec8b9fff138f5b0d4" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="755,477,875,504"/><area shape="rect" id="node25" href="../../dc/d0c/group__tcmi__queue__class.html#ga2b0f1376bcd561196e77599cbc23090f" title="tcmi_queue_empty" alt="" coords="749,528,881,555"/><area shape="rect" id="node26" href="../../d1/d5d/group__tcmi__method__wrapper__class.html#gad93018cc0894a434a94703eed0f869f9" title="&lt;&lt;public&gt;&gt; Decrements the reference counter, when the count reaches 0, the instance is destroyed..." alt="" coords="727,325,902,352"/><area shape="rect" id="node27" href="../../dc/d0c/group__tcmi__queue__class.html#ga40921ea3b077d55d70fb7b94ac666292" title="&lt;&lt;public&gt;&gt; Adds an element to the queue &#45; lock free version, assumes the lock is already held..." alt="" coords="749,579,880,605"/><area shape="rect" id="node28" href="../../dc/d0c/group__tcmi__queue__class.html#ga2e0e25eec1d5e4ea6e89dfde81ed43f4" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="747,376,882,403"/><area shape="rect" id="node30" href="../../da/d7c/i386_2make__syscall_8h.html#a042af8adc43a2caa376c6a5dfddfeb6c" title="TODO: Export the original kernel_execve in kernel and use that instead." alt="" coords="740,275,889,301"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gac80577a00603ae888241ced646f230e7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_shadowtask_verify_migration </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *&#160;</td>
          <td class="paramname"><em>resp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Verifies, that the task has been successfully migrated. </p>
<p>The verification is done based on response message the has to be TCMI_GUEST_STARTED_PROCMSG and has to carry a non-zero guest PID. If the verification is positive, the guest PID is stored inside this shadow instance. It will be used for further communication with the guest.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this task instance </td></tr>
    <tr><td class="paramname">*resp</td><td>- pointer to the response to be processed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if the task has been successfully migrated </dd></dl>

<p>Definition at line <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00412">412</a> of file <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html">tcmi_shadowtask.c</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d3/db1/tcmi__guest__started__procmsg_8h_source.html#l00075">TCMI_GUEST_STARTED_PROCMSG</a>, <a class="el" href="../../d3/db1/tcmi__guest__started__procmsg_8h_source.html#l00083">tcmi_guest_started_procmsg_guest_pid()</a>, <a class="el" href="../../dd/dd5/tcmi__messages__id_8h_source.html#l00134">TCMI_GUEST_STARTED_PROCMSG_ID</a>, <a class="el" href="../../dd/dd5/tcmi__messages__id_8h_source.html#l00102">TCMI_MSG_FLG_SET_ERR</a>, <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00231">tcmi_msg_id()</a>, <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00411">tcmi_task_local_pid()</a>, and <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00453">tcmi_task_set_remote_pid()</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00205">tcmi_shadowtask_emigrate_p()</a>.</p>
<div class="fragment"><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;{</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordtype">int</span> err = -EINVAL;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    pid_t remote_pid;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordflow">if</span> (!resp) {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;No response from guest task has arrived..&quot;</span>);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ga73489766817f528da25369a3f4c713a1" title="&lt;&lt;public&gt;&gt; Message ID accessor.">tcmi_msg_id</a>(resp)) {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="comment">/* regular version */</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#gga61dadd085c1777f559549e05962b2c9ea1fff522372aae1c3fa549658ef13d5ab">TCMI_GUEST_STARTED_PROCMSG_ID</a>:</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        remote_pid = <a class="code" href="../../d1/dc2/group__tcmi__guest__started__procmsg__class.html#gad1e35a7478f07eccff72ce8d47045d1a" title="&lt;&lt;public&gt;&gt; Stub PID accessor.">tcmi_guest_started_procmsg_guest_pid</a>(<a class="code" href="../../d1/dc2/group__tcmi__guest__started__procmsg__class.html#ga47d048883e032d7dfdfb9c7421bd91b6" title="Casts to the tcmi_guest_started_procmsg instance.">TCMI_GUEST_STARTED_PROCMSG</a>(resp));</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Confirmation from guesttask - task migrated, local PID %d, guest PID %d&quot;</span>, <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor.">tcmi_task_local_pid</a>(<span class="keyword">self</span>), remote_pid);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keywordflow">if</span> ( remote_pid == -1 ) {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            err = -EINVAL;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;          <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga60a2a872664867b7a86ec278b570fef2" title="&lt;&lt;public&gt;&gt; Remote PID setter.">tcmi_task_set_remote_pid</a>(<span class="keyword">self</span>, remote_pid);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;          err = 0;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="comment">/* error version */</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#gaa343f0b91b9cee9415f0fcf40f53b2ea" title="Sets an error flag.">TCMI_MSG_FLG_SET_ERR</a>(<a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#gga61dadd085c1777f559549e05962b2c9ea1fff522372aae1c3fa549658ef13d5ab">TCMI_GUEST_STARTED_PROCMSG_ID</a>):</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Stub hasn&#39;t been started, migration failed..&quot;</span>);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Unexpected response from the guest task: %x&quot;</span>, <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ga73489766817f528da25369a3f4c713a1" title="&lt;&lt;public&gt;&gt; Message ID accessor.">tcmi_msg_id</a>(resp));</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; exit0:</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../dc/dff/group__tcmi__shadowtask__class_gac80577a00603ae888241ced646f230e7_cgraph.png" border="0" usemap="#dc/dff/group__tcmi__shadowtask__class_gac80577a00603ae888241ced646f230e7_cgraph" alt=""/></div>
<map name="dc/dff/group__tcmi__shadowtask__class_gac80577a00603ae888241ced646f230e7_cgraph" id="dc/dff/group__tcmi__shadowtask__class_gac80577a00603ae888241ced646f230e7_cgraph">
<area shape="rect" id="node2" href="../../d1/dc2/group__tcmi__guest__started__procmsg__class.html#gad1e35a7478f07eccff72ce8d47045d1a" title="&lt;&lt;public&gt;&gt; Stub PID accessor." alt="" coords="230,5,373,46"/><area shape="rect" id="node3" href="../../d6/dc2/group__tcmi__msg__class.html#ga73489766817f528da25369a3f4c713a1" title="&lt;&lt;public&gt;&gt; Message ID accessor." alt="" coords="253,71,349,97"/><area shape="rect" id="node4" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="666,151,803,177"/><area shape="rect" id="node5" href="../../de/d2f/group__tcmi__task__class.html#ga60a2a872664867b7a86ec278b570fef2" title="&lt;&lt;public&gt;&gt; Remote PID setter." alt="" coords="214,180,389,207"/><area shape="rect" id="node6" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gac720ca77312808db7cbbc645be8e3541" title="&lt;&lt;public&gt;&gt; Creates a new instance of a file." alt="" coords="446,239,591,265"/><area shape="rect" id="node13" href="../../de/d2f/group__tcmi__task__class.html#ga401654abdc812f0a923d05c95b412fb1" title="tcmi_task_show_remote\l_pid_rev" alt="" coords="437,173,600,214"/><area shape="rect" id="node7" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gafcb50575d3f6cc783130766295300741" title="&lt;&lt;private&gt;&gt; This is a generic method, that creates a new instance of a file as follows:" alt="" coords="648,239,821,265"/><area shape="rect" id="node8" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga532181c3f7224fe5aa7651a69e6ad6b4" title="&lt;&lt;public&gt;&gt; This method is used when initializing a new entry." alt="" coords="869,239,1008,265"/><area shape="rect" id="node9" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga986b629882729daaf2c9607bfca57c3c" title="&lt;&lt;public&gt;&gt; Entry name accessor." alt="" coords="1058,163,1211,189"/><area shape="rect" id="node10" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga4fbd3f1c3789bd79d4e2c684fc08d1a2" title="&lt;&lt;private&gt;&gt; Checks whether a directory entry contains entry of the specified name" alt="" coords="1057,213,1213,240"/><area shape="rect" id="node11" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga256f5088d3434bfadcdb0cb59bf25cb7" title="&lt;&lt;private&gt;&gt; A method for inode allocation." alt="" coords="1064,264,1205,291"/><area shape="rect" id="node12" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#gaeeb7fba5f385c90d93878a60a4dcf1dc" title="&lt;&lt;private&gt;&gt; The new dentry is allocated based on the parent&#39;s dentry and the current name of the ..." alt="" coords="1061,315,1209,357"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga13c386f8b5320b2aa774cf5ec9010407"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_shadowtask_vfork_done </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00196">196</a> of file <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html">tcmi_shadowtask.c</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00127">tcmi_shadowtask_process_msg()</a>.</p>
<div class="fragment"><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                                                               {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keyword">struct </span>completion *vfork_done = current-&gt;vfork_done;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">if</span> ( current-&gt;vfork_done ) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        current-&gt;vfork_done = NULL;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        complete(vfork_done);               </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="ga4ce31f95511b3a387b75a304c9464f3e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d5/d04/structtcmi__task__ops">tcmi_task_ops</a> shadowtask_ops</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .process_msg = <a class="code" href="../../dc/dff/group__tcmi__shadowtask__class.html#gafe0d1448f55b9fef0832b44a3128b2ad" title="&lt;&lt;private&gt;&gt; Processes a message specified by the caller.">tcmi_shadowtask_process_msg</a>,</div>
<div class="line">    .emigrate_ppm_p = <a class="code" href="../../dc/dff/group__tcmi__shadowtask__class.html#gae54626726bfe8d29214acb323742e49e" title="&lt;&lt;private&gt;&gt; Emigrates a task to a PEN.">tcmi_shadowtask_emigrate_ppm_p</a>,</div>
<div class="line">    .emigrate_npm = <a class="code" href="../../dc/dff/group__tcmi__shadowtask__class.html#gae6a187e64a35dcea926a89060ce6bdae">tcmi_shadowtask_emigrate_npm</a>,</div>
<div class="line">    .migrateback_ppm_p = <a class="code" href="../../dc/dff/group__tcmi__shadowtask__class.html#gacff748e4399d3c718a848f9e914e2c04" title="&lt;&lt;private&gt;&gt; Migrates a task back to CCN.">tcmi_shadowtask_migrateback_ppm_p</a>,</div>
<div class="line">    .execve = <a class="code" href="../../dc/dff/group__tcmi__shadowtask__class.html#ga5aabc354e036491ef0b5466fab4808fb" title="&lt;&lt;private&gt;&gt; Execve notification when merging shadow with migrating process on CCN.">tcmi_shadowtask_execve</a>,</div>
<div class="line">    .get_type = <a class="code" href="../../dc/dff/group__tcmi__shadowtask__class.html#ga3224d8fc9ab8c8765f1b803cb91c861c" title="Return type of task.">tcmi_shadowtask_get_type</a>,</div>
<div class="line">    .do_signal = <a class="code" href="../../dc/dff/group__tcmi__shadowtask__class.html#gad36c4dd7e78162d76c7341688a8f42b5" title="&lt;&lt;private&gt;&gt; Processes a specified signal.">tcmi_shadowtask_do_signal</a>,</div>
<div class="line">    .free = <a class="code" href="../../dc/dff/group__tcmi__shadowtask__class.html#ga881ec0021bc7db3f376bde3d04e77541" title="&lt;&lt;private&gt;&gt; Custom free method">tcmi_shadowtask_free</a></div>
<div class="line">}</div>
</div><!-- fragment -->
<p>TCMI task operations that support polymorphism. </p>

<p>Definition at line <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00508">508</a> of file <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html">tcmi_shadowtask.c</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00089">tcmi_shadowtask_new()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun Apr 7 2013 23:20:23 for Clondike by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
