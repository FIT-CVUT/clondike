<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Clondike: C:/CLONDIKE/clondike/sources/kernel_3.7.1/src/tcmi/manager/tcmi_migman.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Clondike
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">tcmi_migman.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;linux/types.h&gt;</code><br/>
<code>#include &lt;linux/random.h&gt;</code><br/>
<code>#include &lt;linux/kthread.h&gt;</code><br/>
<code>#include &lt;linux/string.h&gt;</code><br/>
<code>#include &lt;linux/sched.h&gt;</code><br/>
<code>#include &lt;tcmi/task/tcmi_taskhelper.h&gt;</code><br/>
<code>#include &lt;tcmi/task/tcmi_task.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="../../de/de5/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8h_source.html">tcmi_migman.h</a>&quot;</code><br/>
<code>#include &lt;dbg.h&gt;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Include dependency graph for tcmi_migman.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d3/df0/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c__incl.png" border="0" usemap="#C_1_2CLONDIKE_2clondike_2sources_2kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c" alt=""/></div>
<map name="C_1_2CLONDIKE_2clondike_2sources_2kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c" id="C_1_2CLONDIKE_2clondike_2sources_2kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c">
<area shape="rect" id="node9" href="../../de/de5/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8h.html" title="tcmi_migman.h" alt="" coords="937,125,1047,152"/></map>
</div>
</div>
<p><a href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ab69417d37d7a2d096fbe4684a3d4993c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ab69417d37d7a2d096fbe4684a3d4993c">TCMI_MIGMAN_PRIVATE</a></td></tr>
<tr class="separator:ab69417d37d7a2d096fbe4684a3d4993c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e2213bf1ab2d8a6210c3e58e363a2ae"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#a7e2213bf1ab2d8a6210c3e58e363a2ae">TRANSACTION_ORDER</a>&#160;&#160;&#160;8</td></tr>
<tr class="memdesc:a7e2213bf1ab2d8a6210c3e58e363a2ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">2^8 elements in the transaction process hash  <a href="#a7e2213bf1ab2d8a6210c3e58e363a2ae">More...</a><br/></td></tr>
<tr class="separator:a7e2213bf1ab2d8a6210c3e58e363a2ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a308d7744efb6fa9fc9d41f4f2ec84afe"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#a308d7744efb6fa9fc9d41f4f2ec84afe">TASK_ORDER</a>&#160;&#160;&#160;9</td></tr>
<tr class="memdesc:a308d7744efb6fa9fc9d41f4f2ec84afe"><td class="mdescLeft">&#160;</td><td class="mdescRight">2^9 elements in the process hash  <a href="#a308d7744efb6fa9fc9d41f4f2ec84afe">More...</a><br/></td></tr>
<tr class="separator:a308d7744efb6fa9fc9d41f4f2ec84afe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af23ef88a7f5ee038746a70d12d73ecac"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#af23ef88a7f5ee038746a70d12d73ecac">TCMI_MIGMAN_STATE_LENGTH</a>&#160;&#160;&#160;40</td></tr>
<tr class="memdesc:af23ef88a7f5ee038746a70d12d73ecac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max length of the state description.  <a href="#af23ef88a7f5ee038746a70d12d73ecac">More...</a><br/></td></tr>
<tr class="separator:af23ef88a7f5ee038746a70d12d73ecac"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga9bdb189ca17e989ab59c89c2dc912600"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/da2/group__tcmi__migman__class.html#ga9bdb189ca17e989ab59c89c2dc912600">tcmi_migman_init</a> (struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, struct <a class="el" href="../../d6/d8e/group__kkc__sock__class.html#da/d0d/structkkc__sock">kkc_sock</a> *sock, u_int32_t ccn_id, u_int32_t pen_id, enum <a class="el" href="../../dd/d06/kernel__2_86_833_81_2src_2arch_2arch__ids_8h.html#adbc45da5aabb1eb49345f13d3eed13a9">arch_ids</a> peer_arch_type, struct <a class="el" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot">tcmi_slot</a> *manager_slot, struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *root, struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *migproc, struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d6/d88/structtcmi__migman__ops">tcmi_migman_ops</a> *ops, const char namefmt[], va_list <a class="el" href="../../df/d60/kernel__3_87_81_2src_2tcmi_2migration_2tcmi__npm__params_8h.html#aa24f72e6a4d6a997528142211b375496">args</a>)</td></tr>
<tr class="memdesc:ga9bdb189ca17e989ab59c89c2dc912600"><td class="mdescLeft">&#160;</td><td class="mdescRight">TCMI migration manager initializer.  <a href="../../d6/da2/group__tcmi__migman__class.html#ga9bdb189ca17e989ab59c89c2dc912600">More...</a><br/></td></tr>
<tr class="separator:ga9bdb189ca17e989ab59c89c2dc912600"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab536c262c24d8fc76cdbdfa8d6d65b81"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/da2/group__tcmi__migman__class.html#gab536c262c24d8fc76cdbdfa8d6d65b81">tcmi_migman_put</a> (struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:gab536c262c24d8fc76cdbdfa8d6d65b81"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; The manager is shutdown exactly in this order:  <a href="../../d6/da2/group__tcmi__migman__class.html#gab536c262c24d8fc76cdbdfa8d6d65b81">More...</a><br/></td></tr>
<tr class="separator:gab536c262c24d8fc76cdbdfa8d6d65b81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga71f49cd0661e81a859daab82ae7676de"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga71f49cd0661e81a859daab82ae7676de">tcmi_migman_unhash</a> (struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:ga71f49cd0661e81a859daab82ae7676de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes migman from a list of migration managers of the associated manager.  <a href="#ga71f49cd0661e81a859daab82ae7676de">More...</a><br/></td></tr>
<tr class="separator:ga71f49cd0661e81a859daab82ae7676de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga94df994d6d2ad3dd9aa6543ee67bf934"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga94df994d6d2ad3dd9aa6543ee67bf934">tcmi_migman_free</a> (struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:ga94df994d6d2ad3dd9aa6543ee67bf934"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Free method is has two purposes:</p>
<ol type="1">
<li>when the last reference is released, it will free all instance resources, except for the instance itself. </li>
</ol>
 <a href="#ga94df994d6d2ad3dd9aa6543ee67bf934">More...</a><br/></td></tr>
<tr class="separator:ga94df994d6d2ad3dd9aa6543ee67bf934"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad131e3ab84c0ce68226c297b508dfcc4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/da2/group__tcmi__migman__class.html#gad131e3ab84c0ce68226c297b508dfcc4">tcmi_migman_stop</a> (struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:gad131e3ab84c0ce68226c297b508dfcc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Requests asynchronous shutdown of connection with peer.  <a href="../../d6/da2/group__tcmi__migman__class.html#gad131e3ab84c0ce68226c297b508dfcc4">More...</a><br/></td></tr>
<tr class="separator:gad131e3ab84c0ce68226c297b508dfcc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga510ce89add226478847ff0bbeb56a6c4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga510ce89add226478847ff0bbeb56a6c4">tcmi_migman_notify_peer_disconnect</a> (struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="separator:ga510ce89add226478847ff0bbeb56a6c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga42cc54b16a70368b84405761bf8780d5"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga42cc54b16a70368b84405761bf8780d5">tcmi_migman_stop_perform</a> (struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, int remote_requested)</td></tr>
<tr class="memdesc:ga42cc54b16a70368b84405761bf8780d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Actual implementation of stop, see tcmi_migman_stop.  <a href="#ga42cc54b16a70368b84405761bf8780d5">More...</a><br/></td></tr>
<tr class="separator:ga42cc54b16a70368b84405761bf8780d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gade0457c5e0d6da06f17c62636ff17fe8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#gade0457c5e0d6da06f17c62636ff17fe8">kill_all_tasks</a> (struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:gade0457c5e0d6da06f17c62636ff17fe8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a kill signal to all tasks managed by this manager.  <a href="#gade0457c5e0d6da06f17c62636ff17fe8">More...</a><br/></td></tr>
<tr class="separator:gade0457c5e0d6da06f17c62636ff17fe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga246a095eba1258bb860f9ade10506cd7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/da2/group__tcmi__migman__class.html#ga246a095eba1258bb860f9ade10506cd7">tcmi_migman_kill</a> (struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:ga246a095eba1258bb860f9ade10506cd7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Kills all tasks associated with this migman and drops reference to the migman (in case it was not already shutting down).  <a href="../../d6/da2/group__tcmi__migman__class.html#ga246a095eba1258bb860f9ade10506cd7">More...</a><br/></td></tr>
<tr class="separator:ga246a095eba1258bb860f9ade10506cd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf3923f508f4f54440732f33c4f0356dc"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#gaf3923f508f4f54440732f33c4f0356dc">tcmi_migman_init_ctlfs_dirs</a> (struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *root, struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *migproc, const char namefmt[], va_list <a class="el" href="../../df/d60/kernel__3_87_81_2src_2tcmi_2migration_2tcmi__npm__params_8h.html#aa24f72e6a4d6a997528142211b375496">args</a>)</td></tr>
<tr class="memdesc:gaf3923f508f4f54440732f33c4f0356dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Creates the directories as described in <a class="el" href="../../d6/da2/group__tcmi__migman__class.html">here </a>.  <a href="#gaf3923f508f4f54440732f33c4f0356dc">More...</a><br/></td></tr>
<tr class="separator:gaf3923f508f4f54440732f33c4f0356dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0f519d477e445de52505689f56c968e6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga0f519d477e445de52505689f56c968e6">tcmi_migman_init_ctlfs_files</a> (struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:ga0f519d477e445de52505689f56c968e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Creates the static files described <a class="el" href="../../d6/da2/group__tcmi__migman__class.html">here </a>.  <a href="#ga0f519d477e445de52505689f56c968e6">More...</a><br/></td></tr>
<tr class="separator:ga0f519d477e445de52505689f56c968e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga39c491f49b4e5b3cc533c816d27135a3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga39c491f49b4e5b3cc533c816d27135a3">tcmi_migman_stop_ctlfs_dirs</a> (struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:ga39c491f49b4e5b3cc533c816d27135a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Destroys all TCMI ctlfs directories  <a href="#ga39c491f49b4e5b3cc533c816d27135a3">More...</a><br/></td></tr>
<tr class="separator:ga39c491f49b4e5b3cc533c816d27135a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5b56a5213e9dbcba9973b9530692fd27"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga5b56a5213e9dbcba9973b9530692fd27">tcmi_migman_stop_ctlfs_files</a> (struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:ga5b56a5213e9dbcba9973b9530692fd27"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Unregisters and releases all control files.  <a href="#ga5b56a5213e9dbcba9973b9530692fd27">More...</a><br/></td></tr>
<tr class="separator:ga5b56a5213e9dbcba9973b9530692fd27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4bcd1bc07e002ed4bc6fafcd44215749"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga4bcd1bc07e002ed4bc6fafcd44215749">tcmi_migman_stop_request</a> (void *obj, void *<a class="el" href="../../df/d60/kernel__3_87_81_2src_2tcmi_2migration_2tcmi__npm__params_8h.html#ab9090ca30e7609aecaf540276e3c5084">data</a>)</td></tr>
<tr class="memdesc:ga4bcd1bc07e002ed4bc6fafcd44215749"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Requests asynchronous shutdown of this migration manager  <a href="#ga4bcd1bc07e002ed4bc6fafcd44215749">More...</a><br/></td></tr>
<tr class="separator:ga4bcd1bc07e002ed4bc6fafcd44215749"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7250c98a0358cb6c95dfbe5fd427c09c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga7250c98a0358cb6c95dfbe5fd427c09c">tcmi_migman_kill_request</a> (void *obj, void *<a class="el" href="../../df/d60/kernel__3_87_81_2src_2tcmi_2migration_2tcmi__npm__params_8h.html#ab9090ca30e7609aecaf540276e3c5084">data</a>)</td></tr>
<tr class="memdesc:ga7250c98a0358cb6c95dfbe5fd427c09c"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Requests asynchronous kill of this migration manager  <a href="#ga7250c98a0358cb6c95dfbe5fd427c09c">More...</a><br/></td></tr>
<tr class="separator:ga7250c98a0358cb6c95dfbe5fd427c09c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac71618221f842f2032e6141c21eed095"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#gac71618221f842f2032e6141c21eed095">tcmi_migman_show_state</a> (void *obj, void *<a class="el" href="../../df/d60/kernel__3_87_81_2src_2tcmi_2migration_2tcmi__npm__params_8h.html#ab9090ca30e7609aecaf540276e3c5084">data</a>)</td></tr>
<tr class="memdesc:gac71618221f842f2032e6141c21eed095"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Read method for the TCMI ctlfs - reports migration manager state.  <a href="#gac71618221f842f2032e6141c21eed095">More...</a><br/></td></tr>
<tr class="separator:gac71618221f842f2032e6141c21eed095"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad4006fee98cc9ef9bba73a33dc28bc66"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#gad4006fee98cc9ef9bba73a33dc28bc66">tcmi_migman_start_thread</a> (struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:gad4006fee98cc9ef9bba73a33dc28bc66"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Starts the listening thread.  <a href="#gad4006fee98cc9ef9bba73a33dc28bc66">More...</a><br/></td></tr>
<tr class="separator:gad4006fee98cc9ef9bba73a33dc28bc66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae4ad418d705edeca23e38eb383343978"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#gae4ad418d705edeca23e38eb383343978">tcmi_migman_stop_thread</a> (struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:gae4ad418d705edeca23e38eb383343978"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; The TCMI manager listening thread is to be terminated by forcing a signal and waiting for it to terminate.  <a href="#gae4ad418d705edeca23e38eb383343978">More...</a><br/></td></tr>
<tr class="separator:gae4ad418d705edeca23e38eb383343978"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafa1e34536a26378cc123baadbde5452e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#gafa1e34536a26378cc123baadbde5452e">tcmi_migman_deliver_msg</a> (void *obj, struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *m)</td></tr>
<tr class="memdesc:gafa1e34536a26378cc123baadbde5452e"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Message delivering method that is called back from the receiving thread of TCMI comm component instance.  <a href="#gafa1e34536a26378cc123baadbde5452e">More...</a><br/></td></tr>
<tr class="separator:gafa1e34536a26378cc123baadbde5452e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga698d639006881752225f808c1d345b1b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga698d639006881752225f808c1d345b1b">tcmi_migman_msg_thread</a> (void *<a class="el" href="../../df/d60/kernel__3_87_81_2src_2tcmi_2migration_2tcmi__npm__params_8h.html#ab9090ca30e7609aecaf540276e3c5084">data</a>)</td></tr>
<tr class="memdesc:ga698d639006881752225f808c1d345b1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Message processing thread.  <a href="#ga698d639006881752225f808c1d345b1b">More...</a><br/></td></tr>
<tr class="separator:ga698d639006881752225f808c1d345b1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga936802da41af02ca6c660e18ade52dbb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/da2/group__tcmi__migman__class.html#ga936802da41af02ca6c660e18ade52dbb">tcmi_migman_add_task</a> (struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *task)</td></tr>
<tr class="memdesc:ga936802da41af02ca6c660e18ade52dbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Registers tcmi task into the migration manager tasks slotvec  <a href="../../d6/da2/group__tcmi__migman__class.html#ga936802da41af02ca6c660e18ade52dbb">More...</a><br/></td></tr>
<tr class="separator:ga936802da41af02ca6c660e18ade52dbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga73763ae6fc849730aa1346f16208908f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/da2/group__tcmi__migman__class.html#ga73763ae6fc849730aa1346f16208908f">tcmi_migman_remove_task</a> (struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, struct <a class="el" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task">tcmi_task</a> *task)</td></tr>
<tr class="memdesc:ga73763ae6fc849730aa1346f16208908f"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Removes tcmi task from the migration manager tasks slotvec  <a href="../../d6/da2/group__tcmi__migman__class.html#ga73763ae6fc849730aa1346f16208908f">More...</a><br/></td></tr>
<tr class="separator:ga73763ae6fc849730aa1346f16208908f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa481ed8e2b5db852737e1591af2d3202"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/da2/group__tcmi__migman__class.html#gaa481ed8e2b5db852737e1591af2d3202">tcmi_migman_create_symlink</a> (struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *root, struct <a class="el" href="../../d6/d8e/group__kkc__sock__class.html#da/d0d/structkkc__sock">kkc_sock</a> *sock)</td></tr>
<tr class="separator:gaa481ed8e2b5db852737e1591af2d3202"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga5ed214ca4e27ad66cf1cb1eefd650e77"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/da2/group__tcmi__migman__class.html#ga5ed214ca4e27ad66cf1cb1eefd650e77">tcmi_migman_states</a> []</td></tr>
<tr class="memdesc:ga5ed214ca4e27ad66cf1cb1eefd650e77"><td class="mdescLeft">&#160;</td><td class="mdescRight">String descriptor for the states of migration manager.  <a href="../../d6/da2/group__tcmi__migman__class.html#ga5ed214ca4e27ad66cf1cb1eefd650e77">More...</a><br/></td></tr>
<tr class="separator:ga5ed214ca4e27ad66cf1cb1eefd650e77"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a308d7744efb6fa9fc9d41f4f2ec84afe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TASK_ORDER&#160;&#160;&#160;9</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>2^9 elements in the process hash </p>

<p>Definition at line <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00049">49</a> of file <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html">tcmi_migman.c</a>.</p>

<p>Referenced by <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00081">tcmi_migman_init()</a>.</p>

</div>
</div>
<a class="anchor" id="ab69417d37d7a2d096fbe4684a3d4993c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCMI_MIGMAN_PRIVATE</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00041">41</a> of file <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html">tcmi_migman.c</a>.</p>

</div>
</div>
<a class="anchor" id="af23ef88a7f5ee038746a70d12d73ecac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCMI_MIGMAN_STATE_LENGTH&#160;&#160;&#160;40</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Max length of the state description. </p>

<p>Definition at line <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00051">51</a> of file <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html">tcmi_migman.c</a>.</p>

<p>Referenced by <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00404">tcmi_migman_init_ctlfs_files()</a>, and <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00526">tcmi_migman_show_state()</a>.</p>

</div>
</div>
<a class="anchor" id="a7e2213bf1ab2d8a6210c3e58e363a2ae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TRANSACTION_ORDER&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>2^8 elements in the transaction process hash </p>

<p>Definition at line <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00047">47</a> of file <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html">tcmi_migman.c</a>.</p>

<p>Referenced by <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00081">tcmi_migman_init()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gade0457c5e0d6da06f17c62636ff17fe8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kill_all_tasks </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sends a kill signal to all tasks managed by this manager. </p>

<p>Definition at line <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00307">307</a> of file <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html">tcmi_migman.c</a>.</p>

<p>References <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d9/d03/kernel__2_86_833_81_2src_2proxyfs_2proxyfs__server_8c_source.html#l00059">self</a>, <a class="el" href="../../de/dd2/kernel__2_86_833_81_2src_2tcmi_2lib_2tcmi__slot_8h_source.html#l00071">tcmi_slot_entry</a>, <a class="el" href="../../de/dd2/kernel__2_86_833_81_2src_2tcmi_2lib_2tcmi__slot_8h_source.html#l00079">tcmi_slot_for_each</a>, <a class="el" href="../../db/d21/kernel__2_86_833_81_2src_2tcmi_2lib_2tcmi__slotvec_8h_source.html#l00100">tcmi_slotvec_for_each_used_slot</a>, <a class="el" href="../../db/d21/kernel__2_86_833_81_2src_2tcmi_2lib_2tcmi__slotvec_8h_source.html#l00226">tcmi_slotvec_lock()</a>, <a class="el" href="../../db/d21/kernel__2_86_833_81_2src_2tcmi_2lib_2tcmi__slotvec_8h_source.html#l00237">tcmi_slotvec_unlock()</a>, <a class="el" href="../../d8/d48/kernel__2_86_833_81_2src_2tcmi_2task_2tcmi__task_8h_source.html#l00411">tcmi_task_local_pid()</a>, and <a class="el" href="../../d8/d48/kernel__2_86_833_81_2src_2tcmi_2task_2tcmi__task_8h_source.html#l00577">tcmi_task_signal_peer_lost()</a>.</p>
<div class="fragment"><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                                     {  </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task" title="Compound structure that gathers necessary process information.">tcmi_task</a>* task;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot" title="A slot compound structure.">tcmi_slot</a> *slot;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="../../da/d0c/group__tcmi__slot__class.html#ga97f49e924fec185311972baf87d31897" title="A slot node is in fact a hlist node.">tcmi_slot_node_t</a>* node;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data.">tcmi_slotvec_lock</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a46c97bf5098bd2c6c78da4e82f481db5" title="slot container for TCMI tasks(shadows on CCN /guests on PEN) that it controls.">tasks</a>);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">/* Iterate over all managed tasks */</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#ga49082f04567681a98c6d39eacbc1e4ed" title="Iterates through all used slots in the slot vector.">tcmi_slotvec_for_each_used_slot</a>(slot, self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a46c97bf5098bd2c6c78da4e82f481db5" title="slot container for TCMI tasks(shadows on CCN /guests on PEN) that it controls.">tasks</a>) {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <a class="code" href="../../da/d0c/group__tcmi__slot__class.html#ga344314dfdafec96ad6d8398963749fa4" title="&lt;&lt;public&gt;&gt; Iterates through all nodes in the slot.">tcmi_slot_for_each</a>(node, slot) {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            task = <a class="code" href="../../da/d0c/group__tcmi__slot__class.html#ga25ff69a7b6d4ba8ef5b85079c0320872" title="&lt;&lt;public&gt;&gt; Extracts the actual entry from a slot node">tcmi_slot_entry</a>(node, <span class="keyword">struct</span> <a class="code" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task" title="Compound structure that gathers necessary process information.">tcmi_task</a>, node);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Killing task: local_pid=%d&quot;</span>, <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor.">tcmi_task_local_pid</a>(task));           </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            <a class="code" href="../../de/d2f/group__tcmi__task__class.html#gad2d3dad02cf555da12cb2926cebb25f6" title="Notifies task that it peer is lost and sends a kill signal to that task.">tcmi_task_signal_peer_lost</a>(task);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        };</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    };</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data.">tcmi_slotvec_unlock</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a46c97bf5098bd2c6c78da4e82f481db5" title="slot container for TCMI tasks(shadows on CCN /guests on PEN) that it controls.">tasks</a>);  </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_gade0457c5e0d6da06f17c62636ff17fe8_cgraph.png" border="0" usemap="#da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_gade0457c5e0d6da06f17c62636ff17fe8_cgraph" alt=""/></div>
<map name="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_gade0457c5e0d6da06f17c62636ff17fe8_cgraph" id="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_gade0457c5e0d6da06f17c62636ff17fe8_cgraph">
<area shape="rect" id="node2" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="180,5,305,32"/><area shape="rect" id="node3" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="173,56,312,83"/><area shape="rect" id="node4" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="601,107,738,133"/><area shape="rect" id="node5" href="../../de/d2f/group__tcmi__task__class.html#gad2d3dad02cf555da12cb2926cebb25f6" title="Notifies task that it peer is lost and sends a kill signal to that task." alt="" coords="153,157,333,184"/><area shape="rect" id="node6" href="../../de/d2f/group__tcmi__task__class.html#gac263213bf219960dea9c7d4b4e6f3b34" title="Returns a task_struct associated with the tcmi_task." alt="" coords="382,157,551,184"/><area shape="rect" id="node7" href="../../d7/d75/kernel__2_86_833_81_2src_2tcmi_2lib_2util_8h.html#a5f449355b8f54aaed664de85f89092ea" title="task_find_by_pid" alt="" coords="610,157,729,184"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gafa1e34536a26378cc123baadbde5452e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_migman_deliver_msg </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Message delivering method that is called back from the receiving thread of TCMI comm component instance. </p>
<p>This method is reponsible for delivering the message reliably to its destination which can be:</p>
<ul>
<li>local migration manager message queue</li>
<li>local migration manager transaction slot vector</li>
<li>TCMI task message queue</li>
<li>TCMI task transaction slot vector</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*obj</td><td>- pointer to the migration manager instance. passed to the TCMI comm component upon creation </td></tr>
    <tr><td class="paramname">*m</td><td>- points to the message that is to be delivered. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon successful delivery </dd></dl>

<p>Definition at line <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00604">604</a> of file <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html">tcmi_migman.c</a>.</p>

<p>References <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d2/d82/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__signal__msg_8h_source.html#l00069">pid</a>, <a class="el" href="../../d9/d03/kernel__2_86_833_81_2src_2proxyfs_2proxyfs__server_8c_source.html#l00059">self</a>, <a class="el" href="../../df/d9b/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__migman_8h_source.html#l00180">TCMI_MIGMAN</a>, <a class="el" href="../../df/d9b/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__migman_8h_source.html#l00332">tcmi_migman_id()</a>, <a class="el" href="../../dd/ddb/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__msg_8c_source.html#l00297">tcmi_msg_deliver()</a>, <a class="el" href="../../de/df5/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__messages__id_8h_source.html#l00083">TCMI_MSG_GROUP</a>, <a class="el" href="../../de/df5/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__messages__id_8h_source.html#l00108">TCMI_MSG_GROUP_PROC</a>, <a class="el" href="../../df/d27/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__msg_8h_source.html#l00231">tcmi_msg_id()</a>, <a class="el" href="../../d8/dd5/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__procmsg_8h_source.html#l00115">TCMI_PROCMSG</a>, <a class="el" href="../../d8/dd5/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__procmsg_8h_source.html#l00097">tcmi_procmsg_dst_pid()</a>, <a class="el" href="../../dd/d5d/kernel__2_86_833_81_2src_2tcmi_2task_2tcmi__task_8c_source.html#l00904">tcmi_task_deliver_msg()</a>, <a class="el" href="../../d8/d48/kernel__2_86_833_81_2src_2tcmi_2task_2tcmi__task_8h_source.html#l00411">tcmi_task_local_pid()</a>, <a class="el" href="../../dd/d5d/kernel__2_86_833_81_2src_2tcmi_2task_2tcmi__task_8c_source.html#l00934">tcmi_task_migman_id()</a>, <a class="el" href="../../dd/d5d/kernel__2_86_833_81_2src_2tcmi_2task_2tcmi__task_8c_source.html#l00209">tcmi_task_put()</a>, and <a class="el" href="../../dd/d82/kernel__2_86_833_81_2src_2tcmi_2task_2tcmi__taskhelper_8h_source.html#l00128">tcmi_taskhelper_find_by_pid()</a>.</p>

<p>Referenced by <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00081">tcmi_migman_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;{</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordtype">int</span> err = 0;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman" title="A compound structure that holds all current shadow processes and other migration related data...">tcmi_migman</a> *<span class="keyword">self</span> = <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ga6e53ef2488c50427056d3a56e9b6c045" title="Casts to the migration manager.">TCMI_MIGMAN</a>(obj);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task" title="Compound structure that gathers necessary process information.">tcmi_task</a> *task;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#ga9526a29f88aecae5da9f8c28be9bea4f" title="Extracts group number.">TCMI_MSG_GROUP</a>(<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ga73489766817f528da25369a3f4c713a1" title="&lt;&lt;public&gt;&gt; Message ID accessor.">tcmi_msg_id</a>(m)) == <a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#ggabc6126af1d45847bc59afa0aa3216b04a6725f18f4d3a5f445b6917c9a22a3f16">TCMI_MSG_GROUP_PROC</a>) {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="comment">/* try finding the task based on PID  in the message */</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        pid_t <a class="code" href="../../d2/d82/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__signal__msg_8h.html#ae0d46a978d5cd6707411f276ad869b9c" title="Target PID.">pid</a> = <a class="code" href="../../d7/dc8/group__tcmi__procmsg__class.html#ga00174c2d363b1861e4c14e1804602df8" title="&lt;&lt;public&gt;&gt; Destination PID accessor.">tcmi_procmsg_dst_pid</a>(<a class="code" href="../../d7/dc8/group__tcmi__procmsg__class.html#gaba00344eba012e8234726bd601b06aaf" title="Casts to the tcmi_procmsg instance.">TCMI_PROCMSG</a>(m));</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Process message %08x arrived as expected for PID=%d&quot;</span>, </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;             <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ga73489766817f528da25369a3f4c713a1" title="&lt;&lt;public&gt;&gt; Message ID accessor.">tcmi_msg_id</a>(m), pid);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="comment">/* find task by PID */</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="keywordflow">if</span> (!(task = <a class="code" href="../../d2/daf/group__tcmi__taskhelper__class.html#gab89ca5c0deb987d20cf94fe2d000c58f" title="&lt;&lt;public&gt;&gt; Finds a TCMI task based on PID, in addition checks whether the task has a valid migration ...">tcmi_taskhelper_find_by_pid</a>(pid))) {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR2, <span class="stringliteral">&quot;Can&#39;t find dest. task for msg ID=%08x&quot;</span>, </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                 <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ga73489766817f528da25369a3f4c713a1" title="&lt;&lt;public&gt;&gt; Message ID accessor.">tcmi_msg_id</a>(m));</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        }</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="comment">/* Verify it belongs to us */</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../de/d2f/group__tcmi__task__class.html#gaf8ffeed5183656312cb65d1bdf1b495c" title="&lt;&lt;public&gt;&gt; Accessor of id of the migration manager associated with this task.">tcmi_task_migman_id</a>(task) != <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ga5d70369a7eb27d7aac550ce6a2ca12e2" title="&lt;&lt;public&gt;&gt; Migration manager ID accessor.">tcmi_migman_id</a>(<span class="keyword">self</span>)) {</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR2, <span class="stringliteral">&quot;Task(PID=%d, migman ID=%08x) doesn&#39;t belong&quot;</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                 <span class="stringliteral">&quot;to migration manager ID=%08x&quot;</span>, <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor.">tcmi_task_local_pid</a>(task),</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                 <a class="code" href="../../de/d2f/group__tcmi__task__class.html#gaf8ffeed5183656312cb65d1bdf1b495c" title="&lt;&lt;public&gt;&gt; Accessor of id of the migration manager associated with this task.">tcmi_task_migman_id</a>(task), <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ga5d70369a7eb27d7aac550ce6a2ca12e2" title="&lt;&lt;public&gt;&gt; Migration manager ID accessor.">tcmi_migman_id</a>(<span class="keyword">self</span>));</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            <span class="keywordflow">goto</span> exit1;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        }</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        err = <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga87f10a21c32bf05db4c36e7304f0a881" title="&lt;&lt;public&gt;&gt; Delivers a specified message.">tcmi_task_deliver_msg</a>(task, m);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga9317afe43a9b9343c70eaf42409864b7" title="&lt;&lt;public&gt;&gt; Releases the instance.">tcmi_task_put</a>(task);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    }</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Delivering regular migration message %08x&quot;</span>,</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;             <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ga73489766817f528da25369a3f4c713a1" title="&lt;&lt;public&gt;&gt; Message ID accessor.">tcmi_msg_id</a>(m));</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        err = <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ga8e7c8f734e50ec514ed77795ad41b050" title="&lt;&lt;public&gt;&gt; A message always delivers itself.">tcmi_msg_deliver</a>(m, &amp;<a class="code" href="../../d9/d03/kernel__2_86_833_81_2src_2proxyfs_2proxyfs__server_8c.html#acffc38573c809dad4512ce637724ab7e">self</a>-&gt;msg_queue, <a class="code" href="../../d9/d03/kernel__2_86_833_81_2src_2proxyfs_2proxyfs__server_8c.html#acffc38573c809dad4512ce637724ab7e">self</a>-&gt;transactions);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; exit1:</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga9317afe43a9b9343c70eaf42409864b7" title="&lt;&lt;public&gt;&gt; Releases the instance.">tcmi_task_put</a>(task);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; exit0:</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_gafa1e34536a26378cc123baadbde5452e_cgraph.png" border="0" usemap="#da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_gafa1e34536a26378cc123baadbde5452e_cgraph" alt=""/></div>
<map name="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_gafa1e34536a26378cc123baadbde5452e_cgraph" id="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_gafa1e34536a26378cc123baadbde5452e_cgraph">
<area shape="rect" id="node2" href="../../d6/da2/group__tcmi__migman__class.html#ga5d70369a7eb27d7aac550ce6a2ca12e2" title="&lt;&lt;public&gt;&gt; Migration manager ID accessor." alt="" coords="461,31,579,57"/><area shape="rect" id="node3" href="../../d6/dc2/group__tcmi__msg__class.html#ga8e7c8f734e50ec514ed77795ad41b050" title="&lt;&lt;public&gt;&gt; A message always delivers itself." alt="" coords="459,157,581,184"/><area shape="rect" id="node4" href="../../d6/dc2/group__tcmi__msg__class.html#ga73489766817f528da25369a3f4c713a1" title="&lt;&lt;public&gt;&gt; Message ID accessor." alt="" coords="472,208,568,235"/><area shape="rect" id="node5" href="../../d7/dc8/group__tcmi__procmsg__class.html#ga00174c2d363b1861e4c14e1804602df8" title="&lt;&lt;public&gt;&gt; Destination PID accessor." alt="" coords="230,157,383,184"/><area shape="rect" id="node6" href="../../de/d2f/group__tcmi__task__class.html#ga87f10a21c32bf05db4c36e7304f0a881" title="&lt;&lt;public&gt;&gt; Delivers a specified message." alt="" coords="229,317,384,344"/><area shape="rect" id="node8" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="875,503,1013,529"/><area shape="rect" id="node15" href="../../de/d2f/group__tcmi__task__class.html#gaf8ffeed5183656312cb65d1bdf1b495c" title="&lt;&lt;public&gt;&gt; Accessor of id of the migration manager associated with this task." alt="" coords="232,5,381,32"/><area shape="rect" id="node16" href="../../de/d2f/group__tcmi__task__class.html#ga9317afe43a9b9343c70eaf42409864b7" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="255,368,359,395"/><area shape="rect" id="node17" href="../../d2/daf/group__tcmi__taskhelper__class.html#gab89ca5c0deb987d20cf94fe2d000c58f" title="&lt;&lt;public&gt;&gt; Finds a TCMI task based on PID, in addition checks whether the task has a valid migration ..." alt="" coords="236,622,377,663"/><area shape="rect" id="node7" href="../../d7/dc8/group__tcmi__procmsg__class.html#ga460e4aa5dcb20680794c04a07712e59f" title="&lt;&lt;public&gt;&gt; Getter of flag idicating whether we should switch to migmode or not" alt="" coords="443,259,597,301"/><area shape="rect" id="node9" href="../../dc/d0c/group__tcmi__queue__class.html#ga2b0f1376bcd561196e77599cbc23090f" title="tcmi_queue_empty" alt="" coords="454,325,586,352"/><area shape="rect" id="node10" href="../../de/d2f/group__tcmi__task__class.html#ga0409e631915b37fbcfe096dfc498bbbb" title="&lt;&lt;public&gt;&gt; Submits a method for execution." alt="" coords="433,376,607,403"/><area shape="rect" id="node11" href="../../de/d2f/group__tcmi__task__class.html#ga491523e65c3fb2f665013a2f15899cb8" title="&lt;&lt;public&gt;&gt; Called from method queue &#45; Processes one message from the message queue." alt="" coords="438,427,602,453"/><area shape="rect" id="node12" href="../../d2/daf/group__tcmi__taskhelper__class.html#ga9dbb48f23b9ec6a00498db53f026ef4b" title="&lt;&lt;public&gt;&gt; Switches the task into migration mode." alt="" coords="445,529,595,570"/><area shape="rect" id="node13" href="../../de/d2f/group__tcmi__task__class.html#gac263213bf219960dea9c7d4b4e6f3b34" title="Returns a task_struct associated with the tcmi_task." alt="" coords="657,579,826,605"/><area shape="rect" id="node14" href="../../d7/d75/kernel__2_86_833_81_2src_2tcmi_2lib_2util_8h.html#a5f449355b8f54aaed664de85f89092ea" title="task_find_by_pid" alt="" coords="885,604,1003,631"/><area shape="rect" id="node18" href="../../de/d2f/group__tcmi__task__class.html#gafb7d2e6227e173c0bdc6fb99ff12bcbc" title="&lt;&lt;public&gt;&gt; Instance accessor, increments the reference counter." alt="" coords="468,680,572,707"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga94df994d6d2ad3dd9aa6543ee67bf934"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_migman_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Free method is has two purposes:</p>
<ol type="1">
<li>when the last reference is released, it will free all instance resources, except for the instance itself. </li>
</ol>
</p>
<ol type="1">
<li>calls the child class free method if defined</li>
</ol>
<p>Note: It is important to free communication channels first, i.e. communication socket, processing thread and files. This ensures, that no new messages that may require reference to migman for processing will arrive. File operations are synchronized with releasing so it may be possible that some file works with the migman during the free method, but only until the file is ''synchronously'' released. </p>

<p>Definition at line <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00228">228</a> of file <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html">tcmi_migman.c</a>.</p>

<p>References <a class="el" href="../../d9/d03/kernel__2_86_833_81_2src_2proxyfs_2proxyfs__server_8c_source.html#l00059">self</a>, <a class="el" href="../../d9/d01/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__comm_8c_source.html#l00109">tcmi_comm_put()</a>, <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00454">tcmi_migman_stop_ctlfs_dirs()</a>, <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00472">tcmi_migman_stop_ctlfs_files()</a>, <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00572">tcmi_migman_stop_thread()</a>, <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00208">tcmi_migman_unhash()</a>, <a class="el" href="../../d1/da1/kernel__2_86_833_81_2src_2tcmi_2lib_2tcmi__slotvec_8c_source.html#l00117">tcmi_slotvec_put()</a>, and <a class="el" href="../../d9/dec/kernel__2_86_833_81_2src_2tcmi_2lib_2tcmi__sock_8c_source.html#l00128">tcmi_sock_put()</a>.</p>

<p>Referenced by <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00189">tcmi_migman_put()</a>.</p>
<div class="fragment"><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;{ </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">/* terminate the processing thread first to prevent any</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">     * message processing */</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#gae4ad418d705edeca23e38eb383343978" title="&lt;&lt;private&gt;&gt; The TCMI manager listening thread is to be terminated by forcing a signal and waiting for...">tcmi_migman_stop_thread</a>(<span class="keyword">self</span>);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">/* also stop receiving all messages */</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <a class="code" href="../../d9/dfc/group__tcmi__comm__class.html#ga89dc5a63295a65407cc93606c79ca314" title="&lt;&lt;public&gt;&gt; Releases the instance.">tcmi_comm_put</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a9ffec42cf0e311eecc49865482348408" title="Communication component used for message receiving and delivery.">comm</a>);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <a class="code" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga5b56a5213e9dbcba9973b9530692fd27" title="&lt;&lt;private&gt;&gt; Unregisters and releases all control files.">tcmi_migman_stop_ctlfs_files</a>(<span class="keyword">self</span>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <a class="code" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga39c491f49b4e5b3cc533c816d27135a3" title="&lt;&lt;private&gt;&gt; Destroys all TCMI ctlfs directories">tcmi_migman_stop_ctlfs_dirs</a>(<span class="keyword">self</span>);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="../../d3/d7e/group__tcmi__sock__class.html#gaa64951d80cedfaf76bb82ee811255d69" title="&lt;&lt;public&gt;&gt; Decrements the reference counter and if it reaches 0, the instance.">tcmi_sock_put</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a856ff808898e0dcbac4aec587a14753c" title="TCMI socket that represents an active connection to the PEN.">sock</a>);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga71f49cd0661e81a859daab82ae7676de" title="Removes migman from a list of migration managers of the associated manager.">tcmi_migman_unhash</a>(<span class="keyword">self</span>);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">/* now we are safe and we can start cleaning the rest */</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">if</span> (self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#aebe1cd8c73d81cf09edcd4bdc72d476d" title="Operations specific to CCN/PEN migration manager resp.">ops</a>-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a4365d06985fa2f073a3ba98b4802b82d" title="Releases the instance specific resources.">free</a>)</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keyword">self</span>-&gt;ops-&gt;free(<span class="keyword">self</span>);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">/* TODO: check for stale transactions.. */</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#ga2376bcc84e5bbd48a8f92400f5ad5f25" title="&lt;&lt;public&gt;&gt; Decrements the reference counter, when the count reaches 0, the instance is destroyed...">tcmi_slotvec_put</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ae61ae3921b893ebf834b7561ae6d8b56" title="Message transactions.">transactions</a>);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">/* Note: Assumes, all tasks are already migrated back. */</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#ga2376bcc84e5bbd48a8f92400f5ad5f25" title="&lt;&lt;public&gt;&gt; Decrements the reference counter, when the count reaches 0, the instance is destroyed...">tcmi_slotvec_put</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a46c97bf5098bd2c6c78da4e82f481db5" title="slot container for TCMI tasks(shadows on CCN /guests on PEN) that it controls.">tasks</a>);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga94df994d6d2ad3dd9aa6543ee67bf934_cgraph.png" border="0" usemap="#da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga94df994d6d2ad3dd9aa6543ee67bf934_cgraph" alt=""/></div>
<map name="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga94df994d6d2ad3dd9aa6543ee67bf934_cgraph" id="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga94df994d6d2ad3dd9aa6543ee67bf934_cgraph">
<area shape="rect" id="node2" href="../../d9/dfc/group__tcmi__comm__class.html#ga89dc5a63295a65407cc93606c79ca314" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="220,5,335,32"/><area shape="rect" id="node3" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga39c491f49b4e5b3cc533c816d27135a3" title="&lt;&lt;private&gt;&gt; Destroys all TCMI ctlfs directories" alt="" coords="182,56,373,83"/><area shape="rect" id="node6" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga5b56a5213e9dbcba9973b9530692fd27" title="&lt;&lt;private&gt;&gt; Unregisters and releases all control files." alt="" coords="196,107,359,149"/><area shape="rect" id="node9" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#gae4ad418d705edeca23e38eb383343978" title="&lt;&lt;private&gt;&gt; The TCMI manager listening thread is to be terminated by forcing a signal and waiting for..." alt="" coords="190,173,365,200"/><area shape="rect" id="node10" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga71f49cd0661e81a859daab82ae7676de" title="Removes migman from a list of migration managers of the associated manager." alt="" coords="203,224,352,251"/><area shape="rect" id="node13" href="../../d0/db7/group__tcmi__slotvec__class.html#ga2376bcc84e5bbd48a8f92400f5ad5f25" title="&lt;&lt;public&gt;&gt; Decrements the reference counter, when the count reaches 0, the instance is destroyed..." alt="" coords="218,275,337,301"/><area shape="rect" id="node14" href="../../d3/d7e/group__tcmi__sock__class.html#gaa64951d80cedfaf76bb82ee811255d69" title="&lt;&lt;public&gt;&gt; Decrements the reference counter and if it reaches 0, the instance." alt="" coords="224,325,331,352"/><area shape="rect" id="node4" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d..." alt="" coords="439,59,577,85"/><area shape="rect" id="node5" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga986b629882729daaf2c9607bfca57c3c" title="&lt;&lt;public&gt;&gt; Entry name accessor." alt="" coords="643,59,797,85"/><area shape="rect" id="node7" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gaead344003750e43cb4a0326876a191bc" title="&lt;&lt;public&gt;&gt; This method unregisters the file and allows the user to specify the preferred way of unreg..." alt="" coords="422,113,594,140"/><area shape="rect" id="node8" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga665210941a04fda118949874767ced93" title="&lt;&lt;public&gt;&gt; This method unregisters the file uses the semaphore lock as protection from races..." alt="" coords="425,164,591,191"/><area shape="rect" id="node11" href="../../da/d0c/group__tcmi__slot__class.html#ga109d6d783ebf06046f364f970f84da1f" title="&lt;&lt;public&gt;&gt; Locks the slot data." alt="" coords="455,220,561,247"/><area shape="rect" id="node12" href="../../da/d0c/group__tcmi__slot__class.html#ga5447231fec5f42040c40307eb2e6a13c" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="448,271,568,297"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gaf3923f508f4f54440732f33c4f0356dc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_migman_init_ctlfs_dirs </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *&#160;</td>
          <td class="paramname"><em>root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *&#160;</td>
          <td class="paramname"><em>migproc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>namefmt</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">va_list&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Creates the directories as described in <a class="el" href="../../d6/da2/group__tcmi__migman__class.html">here </a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this migration manager instance </td></tr>
    <tr><td class="paramname">*root</td><td>- root directory where to create TCMI ctlfs entries </td></tr>
    <tr><td class="paramname">*migproc</td><td>- directory where the migrated process will have their info </td></tr>
    <tr><td class="paramname">namefmt</td><td>- nameformat string for the main manager directory name (printf style) </td></tr>
    <tr><td class="paramname">args</td><td>- arguments to the format string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon success </dd></dl>

<p>Definition at line <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00358">358</a> of file <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html">tcmi_migman.c</a>.</p>

<p>References <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d9/d03/kernel__2_86_833_81_2src_2proxyfs_2proxyfs__server_8c_source.html#l00059">self</a>, <a class="el" href="../../de/d85/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__dir_8c_source.html#l00048">tcmi_ctlfs_dir_new()</a>, <a class="el" href="../../de/d85/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__dir_8c_source.html#l00072">tcmi_ctlfs_dir_vnew()</a>, <a class="el" href="../../d6/d77/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8h_source.html#l00180">tcmi_ctlfs_entry_get()</a>, <a class="el" href="../../d6/d77/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8h_source.html#l00214">tcmi_ctlfs_entry_put()</a>, and <a class="el" href="../../d5/da2/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs_8h_source.html#l00087">TCMI_PERMS_DIR</a>.</p>

<p>Referenced by <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00081">tcmi_migman_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;{</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO4, <span class="stringliteral">&quot;Creating directories&quot;</span>);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">if</span> (!(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a3551ff300819c9346483060594586873" title="TCMI ctlfs - directory where all migration control files/directories reside.">d_migman</a> = <a class="code" href="../../dc/def/group__tcmi__ctlfs__dir__class.html#ga571b8ac681691e3ceca2e833b89b6a21" title="&lt;&lt;public&gt;&gt; Creates a new directory entry in the tcmi_ctlfs tree.">tcmi_ctlfs_dir_vnew</a>(root, <a class="code" href="../../d9/d0a/group__tcmi__ctlfs__class.html#gaf838aee6d2933dc427bf9d47ac09c610" title="Preferred directory rights.">TCMI_PERMS_DIR</a>, namefmt, <a class="code" href="../../da/d3b/kernel__2_86_833_81_2src_2tcmi_2migration_2tcmi__npm__params_8h.html#aa24f72e6a4d6a997528142211b375496" title="Arrays of args and envps.">args</a>)))</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">if</span> (!(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a9e4e35e4ed0ca0e80a75d9b6e14516e6" title="TCMI ctlfs - directory for active connections.">d_conns</a> = </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;          <a class="code" href="../../dc/def/group__tcmi__ctlfs__dir__class.html#ga1f51ad6279415ce522a3a932178702d6" title="&lt;&lt;public&gt;&gt; Creates a new directory entry in the tcmi_ctlfs tree.">tcmi_ctlfs_dir_new</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a3551ff300819c9346483060594586873" title="TCMI ctlfs - directory where all migration control files/directories reside.">d_migman</a>, <a class="code" href="../../d9/d0a/group__tcmi__ctlfs__class.html#gaf838aee6d2933dc427bf9d47ac09c610" title="Preferred directory rights.">TCMI_PERMS_DIR</a>, <span class="stringliteral">&quot;connections&quot;</span>)))</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="keywordflow">goto</span> exit1;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordflow">if</span> (!(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a36f294e633ab983b27117a9bb5a7c822" title="TCMI ctlfs - reference to the migproc directory - needed when immigrating a process.">d_migproc</a> = <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#gaab2e404bb2da373a66578541e2dc4ba9" title="&lt;&lt;public&gt;&gt; Instance accessor, Calls instance custom get method and increments the reference counter...">tcmi_ctlfs_entry_get</a>(migproc))) {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Missing migproc directory for migration manager!&quot;</span>);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keywordflow">goto</span> exit2;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">if</span> (self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#aebe1cd8c73d81cf09edcd4bdc72d476d" title="Operations specific to CCN/PEN migration manager resp.">ops</a>-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a3adf20fa1a2a4618eb50783e54b2978c" title="Initializes TCMI ctlfs directories.">init_ctlfs_dirs</a> &amp;&amp; self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#aebe1cd8c73d81cf09edcd4bdc72d476d" title="Operations specific to CCN/PEN migration manager resp.">ops</a>-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a3adf20fa1a2a4618eb50783e54b2978c" title="Initializes TCMI ctlfs directories.">init_ctlfs_dirs</a>(<span class="keyword">self</span>)) {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Failed to create specific ctlfs directories!&quot;</span>);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="keywordflow">goto</span> exit3;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; exit3:</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d...">tcmi_ctlfs_entry_put</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a36f294e633ab983b27117a9bb5a7c822" title="TCMI ctlfs - reference to the migproc directory - needed when immigrating a process.">d_migproc</a>);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; exit2:</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d...">tcmi_ctlfs_entry_put</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a9e4e35e4ed0ca0e80a75d9b6e14516e6" title="TCMI ctlfs - directory for active connections.">d_conns</a>);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; exit1:</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d...">tcmi_ctlfs_entry_put</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a3551ff300819c9346483060594586873" title="TCMI ctlfs - directory where all migration control files/directories reside.">d_migman</a>);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; exit0:</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_gaf3923f508f4f54440732f33c4f0356dc_cgraph.png" border="0" usemap="#da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_gaf3923f508f4f54440732f33c4f0356dc_cgraph" alt=""/></div>
<map name="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_gaf3923f508f4f54440732f33c4f0356dc_cgraph" id="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_gaf3923f508f4f54440732f33c4f0356dc_cgraph">
<area shape="rect" id="node2" href="../../dc/def/group__tcmi__ctlfs__dir__class.html#ga1f51ad6279415ce522a3a932178702d6" title="&lt;&lt;public&gt;&gt; Creates a new directory entry in the tcmi_ctlfs tree." alt="" coords="242,5,371,32"/><area shape="rect" id="node3" href="../../dc/def/group__tcmi__ctlfs__dir__class.html#ga571b8ac681691e3ceca2e833b89b6a21" title="&lt;&lt;public&gt;&gt; Creates a new directory entry in the tcmi_ctlfs tree." alt="" coords="239,56,374,83"/><area shape="rect" id="node4" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#gaab2e404bb2da373a66578541e2dc4ba9" title="&lt;&lt;public&gt;&gt; Instance accessor, Calls instance custom get method and increments the reference counter..." alt="" coords="237,107,376,133"/><area shape="rect" id="node6" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d..." alt="" coords="237,157,376,184"/><area shape="rect" id="node5" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga986b629882729daaf2c9607bfca57c3c" title="&lt;&lt;public&gt;&gt; Entry name accessor." alt="" coords="425,132,578,159"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga0f519d477e445de52505689f56c968e6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_migman_init_ctlfs_files </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Creates the static files described <a class="el" href="../../d6/da2/group__tcmi__migman__class.html">here </a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this migration manager instance </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon success </dd></dl>

<p>Definition at line <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00404">404</a> of file <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html">tcmi_migman.c</a>.</p>

<p>References <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d9/d03/kernel__2_86_833_81_2src_2proxyfs_2proxyfs__server_8c_source.html#l00059">self</a>, <a class="el" href="../../d6/d77/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8h_source.html#l00214">tcmi_ctlfs_entry_put()</a>, <a class="el" href="../../d0/def/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__file_8c_source.html#l00154">tcmi_ctlfs_file_unregister()</a>, <a class="el" href="../../d0/def/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__file_8c_source.html#l00062">tcmi_ctlfs_intfile_new()</a>, <a class="el" href="../../d0/def/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__file_8c_source.html#l00099">tcmi_ctlfs_strfile_new()</a>, <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00511">tcmi_migman_kill_request()</a>, <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00526">tcmi_migman_show_state()</a>, <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00051">TCMI_MIGMAN_STATE_LENGTH</a>, <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00497">tcmi_migman_stop_request()</a>, <a class="el" href="../../d5/da2/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs_8h_source.html#l00091">TCMI_PERMS_FILE_R</a>, and <a class="el" href="../../d5/da2/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs_8h_source.html#l00089">TCMI_PERMS_FILE_W</a>.</p>

<p>Referenced by <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00081">tcmi_migman_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;{</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO4, <span class="stringliteral">&quot;Creating files&quot;</span>);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">if</span> (!(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a41ae3f93bd0c0bcecb5dad6b848b9cba" title="TCMI ctlfs - reports current state of the manager.">f_state</a> = </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;          <a class="code" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gaeaa21c9f35d22ab9ea81f97a39ef3e95" title="&lt;&lt;public&gt;&gt; Creates a new instance of a file.">tcmi_ctlfs_strfile_new</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a3551ff300819c9346483060594586873" title="TCMI ctlfs - directory where all migration control files/directories reside.">d_migman</a>, <a class="code" href="../../d9/d0a/group__tcmi__ctlfs__class.html#ga84907a0ffd1393cf8b462e14c9b4140a" title="Preferred read file rights.">TCMI_PERMS_FILE_R</a>,</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                     <span class="keyword">self</span>, <a class="code" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#gac71618221f842f2032e6141c21eed095" title="&lt;&lt;private&gt;&gt; Read method for the TCMI ctlfs - reports migration manager state.">tcmi_migman_show_state</a>, NULL,</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                     <a class="code" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#af23ef88a7f5ee038746a70d12d73ecac" title="Max length of the state description.">TCMI_MIGMAN_STATE_LENGTH</a>, <span class="stringliteral">&quot;state&quot;</span>)))</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">if</span> (!(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a49fa02e14f41977c88717f9a1bb5cdf8" title="TCMI ctlfs - request shutdown of this migration manager.">f_stop</a> = </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;          <a class="code" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gac720ca77312808db7cbbc645be8e3541" title="&lt;&lt;public&gt;&gt; Creates a new instance of a file.">tcmi_ctlfs_intfile_new</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a3551ff300819c9346483060594586873" title="TCMI ctlfs - directory where all migration control files/directories reside.">d_migman</a>, <a class="code" href="../../d9/d0a/group__tcmi__ctlfs__class.html#gaa901982b6e65df648201a7a7f80f232b" title="Preferred write file rights.">TCMI_PERMS_FILE_W</a>,</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                     <span class="keyword">self</span>, NULL, <a class="code" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga4bcd1bc07e002ed4bc6fafcd44215749" title="&lt;&lt;private&gt;&gt; Requests asynchronous shutdown of this migration manager">tcmi_migman_stop_request</a>,</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                     <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), <span class="stringliteral">&quot;stop&quot;</span>)))</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keywordflow">goto</span> exit1;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">if</span> (!(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a64c914f4e6c982903afe779af3f53698" title="TCMI ctlfs - request kill of this migration manager.">f_kill</a> = </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;          <a class="code" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gac720ca77312808db7cbbc645be8e3541" title="&lt;&lt;public&gt;&gt; Creates a new instance of a file.">tcmi_ctlfs_intfile_new</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a3551ff300819c9346483060594586873" title="TCMI ctlfs - directory where all migration control files/directories reside.">d_migman</a>, <a class="code" href="../../d9/d0a/group__tcmi__ctlfs__class.html#gaa901982b6e65df648201a7a7f80f232b" title="Preferred write file rights.">TCMI_PERMS_FILE_W</a>,</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                     <span class="keyword">self</span>, NULL, <a class="code" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga7250c98a0358cb6c95dfbe5fd427c09c" title="&lt;&lt;private&gt;&gt; Requests asynchronous kill of this migration manager">tcmi_migman_kill_request</a>,</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                     <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), <span class="stringliteral">&quot;kill&quot;</span>)))</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keywordflow">goto</span> exit2;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">if</span> (self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#aebe1cd8c73d81cf09edcd4bdc72d476d" title="Operations specific to CCN/PEN migration manager resp.">ops</a>-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a2f5a49addfd9139ba2f3e29bc1f9633f" title="Initializes TCMI ctlfs files.">init_ctlfs_files</a> &amp;&amp; self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#aebe1cd8c73d81cf09edcd4bdc72d476d" title="Operations specific to CCN/PEN migration manager resp.">ops</a>-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a2f5a49addfd9139ba2f3e29bc1f9633f" title="Initializes TCMI ctlfs files.">init_ctlfs_files</a>(<span class="keyword">self</span>)) {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Failed to create specific ctlfs files!&quot;</span>);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="keywordflow">goto</span> exit3;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; exit3:</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <a class="code" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga665210941a04fda118949874767ced93" title="&lt;&lt;public&gt;&gt; This method unregisters the file uses the semaphore lock as protection from races...">tcmi_ctlfs_file_unregister</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a64c914f4e6c982903afe779af3f53698" title="TCMI ctlfs - request kill of this migration manager.">f_kill</a>);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d...">tcmi_ctlfs_entry_put</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a64c914f4e6c982903afe779af3f53698" title="TCMI ctlfs - request kill of this migration manager.">f_kill</a>);     </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; exit2:</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <a class="code" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga665210941a04fda118949874767ced93" title="&lt;&lt;public&gt;&gt; This method unregisters the file uses the semaphore lock as protection from races...">tcmi_ctlfs_file_unregister</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a49fa02e14f41977c88717f9a1bb5cdf8" title="TCMI ctlfs - request shutdown of this migration manager.">f_stop</a>);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d...">tcmi_ctlfs_entry_put</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a49fa02e14f41977c88717f9a1bb5cdf8" title="TCMI ctlfs - request shutdown of this migration manager.">f_stop</a>); </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; exit1:</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <a class="code" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga665210941a04fda118949874767ced93" title="&lt;&lt;public&gt;&gt; This method unregisters the file uses the semaphore lock as protection from races...">tcmi_ctlfs_file_unregister</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a41ae3f93bd0c0bcecb5dad6b848b9cba" title="TCMI ctlfs - reports current state of the manager.">f_state</a>);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d...">tcmi_ctlfs_entry_put</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a41ae3f93bd0c0bcecb5dad6b848b9cba" title="TCMI ctlfs - reports current state of the manager.">f_state</a>);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; exit0:</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga0f519d477e445de52505689f56c968e6_cgraph.png" border="0" usemap="#da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga0f519d477e445de52505689f56c968e6_cgraph" alt=""/></div>
<map name="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga0f519d477e445de52505689f56c968e6_cgraph" id="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga0f519d477e445de52505689f56c968e6_cgraph">
<area shape="rect" id="node2" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d..." alt="" coords="231,5,369,32"/><area shape="rect" id="node4" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga665210941a04fda118949874767ced93" title="&lt;&lt;public&gt;&gt; This method unregisters the file uses the semaphore lock as protection from races..." alt="" coords="217,56,383,83"/><area shape="rect" id="node5" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gac720ca77312808db7cbbc645be8e3541" title="&lt;&lt;public&gt;&gt; Creates a new instance of a file." alt="" coords="227,107,373,133"/><area shape="rect" id="node6" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gaeaa21c9f35d22ab9ea81f97a39ef3e95" title="&lt;&lt;public&gt;&gt; Creates a new instance of a file." alt="" coords="227,157,373,184"/><area shape="rect" id="node7" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga7250c98a0358cb6c95dfbe5fd427c09c" title="&lt;&lt;private&gt;&gt; Requests asynchronous kill of this migration manager" alt="" coords="440,208,613,235"/><area shape="rect" id="node21" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#gac71618221f842f2032e6141c21eed095" title="&lt;&lt;private&gt;&gt; Read method for the TCMI ctlfs &#45; reports migration manager state." alt="" coords="667,309,840,336"/><area shape="rect" id="node22" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga4bcd1bc07e002ed4bc6fafcd44215749" title="&lt;&lt;private&gt;&gt; Requests asynchronous shutdown of this migration manager" alt="" coords="209,259,391,285"/><area shape="rect" id="node3" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga986b629882729daaf2c9607bfca57c3c" title="&lt;&lt;public&gt;&gt; Entry name accessor." alt="" coords="450,5,603,32"/><area shape="rect" id="node8" href="../../d6/da2/group__tcmi__migman__class.html#ga246a095eba1258bb860f9ade10506cd7" title="Kills all tasks associated with this migman and drops reference to the migman (in case it was not alr..." alt="" coords="692,208,815,235"/><area shape="rect" id="node9" href="../../d6/da2/group__tcmi__migman__class.html#gafca6221a82ff480ee067fcfa39745719" title="&lt;&lt;public&gt;&gt; Migration manager slot index getter" alt="" coords="894,259,1061,285"/><area shape="rect" id="node11" href="../../d6/da2/group__tcmi__migman__class.html#gade0457c5e0d6da06f17c62636ff17fe8" title="Sends a kill signal to all tasks managed by this manager." alt="" coords="929,91,1026,117"/><area shape="rect" id="node18" href="../../d6/da2/group__tcmi__migman__class.html#ga9115d78a679e54cf4bf78cf051d6782e" title="&lt;&lt;public&gt;&gt; Set atomically a new state of the migration manager, assuming current state == old_state..." alt="" coords="903,142,1052,183"/><area shape="rect" id="node19" href="../../d6/da2/group__tcmi__migman__class.html#gab536c262c24d8fc76cdbdfa8d6d65b81" title="&lt;&lt;public&gt;&gt; The manager is shutdown exactly in this order:" alt="" coords="915,208,1040,235"/><area shape="rect" id="node20" href="../../d6/da2/group__tcmi__migman__class.html#ga828da1bb7df2ccb80dd93c62f1b0731c" title="&lt;&lt;public&gt;&gt; Migration manager state accessor." alt="" coords="909,309,1045,336"/><area shape="rect" id="node10" href="../../da/d0c/group__tcmi__slot__class.html#ga821f6b686443bfc7fff52dd3b155de37" title="&lt;&lt;public&gt;&gt; Slot index accessor." alt="" coords="1147,259,1261,285"/><area shape="rect" id="node12" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="1141,167,1267,193"/><area shape="rect" id="node13" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="1566,15,1703,41"/><area shape="rect" id="node14" href="../../de/d2f/group__tcmi__task__class.html#gad2d3dad02cf555da12cb2926cebb25f6" title="Notifies task that it peer is lost and sends a kill signal to that task." alt="" coords="1114,65,1294,92"/><area shape="rect" id="node17" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="1135,116,1273,143"/><area shape="rect" id="node15" href="../../de/d2f/group__tcmi__task__class.html#gac263213bf219960dea9c7d4b4e6f3b34" title="Returns a task_struct associated with the tcmi_task." alt="" coords="1347,65,1517,92"/><area shape="rect" id="node16" href="../../d7/d75/kernel__2_86_833_81_2src_2tcmi_2lib_2util_8h.html#a5f449355b8f54aaed664de85f89092ea" title="task_find_by_pid" alt="" coords="1575,65,1694,92"/><area shape="rect" id="node23" href="../../d6/da2/group__tcmi__migman__class.html#gad131e3ab84c0ce68226c297b508dfcc4" title="Requests asynchronous shutdown of connection with peer." alt="" coords="461,259,593,285"/><area shape="rect" id="node24" href="../../d6/da2/group__tcmi__migman__class.html#ga42cc54b16a70368b84405761bf8780d5" title="Actual implementation of stop, see tcmi_migman_stop." alt="" coords="662,259,845,285"/><area shape="rect" id="node25" href="../../d6/da2/group__tcmi__migman__class.html#ga510ce89add226478847ff0bbeb56a6c4" title="tcmi_migman_notify\l_peer_disconnect" alt="" coords="908,361,1047,402"/><area shape="rect" id="node26" href="../../d4/de6/group__tcmi__disconnect__msg__class.html#ga19a79788a771ec551e8b131a90966665" title="&lt;&lt;public&gt;&gt; Disconnect message tx constructor." alt="" coords="1129,466,1279,507"/><area shape="rect" id="node27" href="../../d6/dc2/group__tcmi__msg__class.html#ga7a8fe8cbfd4b25c15589c8599f66e574" title="&lt;&lt;public&gt;&gt; Sends a message via a specified connection." alt="" coords="1110,313,1298,340"/><area shape="rect" id="node28" href="../../d6/da2/group__tcmi__migman__class.html#ga91bf5b41a1d4faa3eab11e6867ec34e4" title="&lt;&lt;public&gt;&gt; Communication socket accesor." alt="" coords="1137,364,1271,391"/><area shape="rect" id="node30" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined..." alt="" coords="1152,415,1256,441"/><area shape="rect" id="node29" href="../../d3/d7e/group__tcmi__sock__class.html#ga8573cfac9adbb5996cd90395d8a78502" title="&lt;&lt;public&gt;&gt; KKC socket accessor." alt="" coords="1347,364,1517,391"/><area shape="rect" id="node31" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2748d267a8fddd1ced86e73ba8efd079" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="1361,415,1503,441"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga7250c98a0358cb6c95dfbe5fd427c09c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_migman_kill_request </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Requests asynchronous kill of this migration manager </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*obj</td><td>- this migration manager instance </td></tr>
    <tr><td class="paramname">*data</td><td>- ignored </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon success </dd></dl>

<p>Definition at line <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00511">511</a> of file <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html">tcmi_migman.c</a>.</p>

<p>References <a class="el" href="../../df/d9b/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__migman_8h_source.html#l00180">TCMI_MIGMAN</a>, and <a class="el" href="../../d6/d0b/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00330">tcmi_migman_kill()</a>.</p>

<p>Referenced by <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00404">tcmi_migman_init_ctlfs_files()</a>.</p>
<div class="fragment"><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                                                           {</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman" title="A compound structure that holds all current shadow processes and other migration related data...">tcmi_migman</a> *<span class="keyword">self</span> = <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ga6e53ef2488c50427056d3a56e9b6c045" title="Casts to the migration manager.">TCMI_MIGMAN</a>(obj);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ga246a095eba1258bb860f9ade10506cd7" title="Kills all tasks associated with this migman and drops reference to the migman (in case it was not alr...">tcmi_migman_kill</a>(<span class="keyword">self</span>);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga7250c98a0358cb6c95dfbe5fd427c09c_cgraph.png" border="0" usemap="#da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga7250c98a0358cb6c95dfbe5fd427c09c_cgraph" alt=""/></div>
<map name="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga7250c98a0358cb6c95dfbe5fd427c09c_cgraph" id="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga7250c98a0358cb6c95dfbe5fd427c09c_cgraph">
<area shape="rect" id="node2" href="../../d6/da2/group__tcmi__migman__class.html#ga246a095eba1258bb860f9ade10506cd7" title="Kills all tasks associated with this migman and drops reference to the migman (in case it was not alr..." alt="" coords="227,165,349,192"/><area shape="rect" id="node3" href="../../d6/da2/group__tcmi__migman__class.html#gafca6221a82ff480ee067fcfa39745719" title="&lt;&lt;public&gt;&gt; Migration manager slot index getter" alt="" coords="398,31,565,57"/><area shape="rect" id="node5" href="../../d6/da2/group__tcmi__migman__class.html#gade0457c5e0d6da06f17c62636ff17fe8" title="Sends a kill signal to all tasks managed by this manager." alt="" coords="433,107,530,133"/><area shape="rect" id="node12" href="../../d6/da2/group__tcmi__migman__class.html#ga9115d78a679e54cf4bf78cf051d6782e" title="&lt;&lt;public&gt;&gt; Set atomically a new state of the migration manager, assuming current state == old_state..." alt="" coords="407,158,556,199"/><area shape="rect" id="node13" href="../../d6/da2/group__tcmi__migman__class.html#gab536c262c24d8fc76cdbdfa8d6d65b81" title="&lt;&lt;public&gt;&gt; The manager is shutdown exactly in this order:" alt="" coords="419,224,544,251"/><area shape="rect" id="node14" href="../../d6/da2/group__tcmi__migman__class.html#ga828da1bb7df2ccb80dd93c62f1b0731c" title="&lt;&lt;public&gt;&gt; Migration manager state accessor." alt="" coords="413,275,549,301"/><area shape="rect" id="node4" href="../../da/d0c/group__tcmi__slot__class.html#ga821f6b686443bfc7fff52dd3b155de37" title="&lt;&lt;public&gt;&gt; Slot index accessor." alt="" coords="647,5,761,32"/><area shape="rect" id="node6" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="641,56,767,83"/><area shape="rect" id="node7" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="1062,107,1199,133"/><area shape="rect" id="node8" href="../../de/d2f/group__tcmi__task__class.html#gad2d3dad02cf555da12cb2926cebb25f6" title="Notifies task that it peer is lost and sends a kill signal to that task." alt="" coords="614,157,794,184"/><area shape="rect" id="node11" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="635,208,773,235"/><area shape="rect" id="node9" href="../../de/d2f/group__tcmi__task__class.html#gac263213bf219960dea9c7d4b4e6f3b34" title="Returns a task_struct associated with the tcmi_task." alt="" coords="843,157,1013,184"/><area shape="rect" id="node10" href="../../d7/d75/kernel__2_86_833_81_2src_2tcmi_2lib_2util_8h.html#a5f449355b8f54aaed664de85f89092ea" title="task_find_by_pid" alt="" coords="1071,157,1190,184"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga698d639006881752225f808c1d345b1b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_migman_msg_thread </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Message processing thread. </p>
<p>Sleeps on the message queue and notifies the migration manager instance to process each incoming message.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*data</td><td>- migration manager instance </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon successful thread termination. </dd></dl>

<p>Definition at line <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00654">654</a> of file <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html">tcmi_migman.c</a>.</p>

<p>References <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00221">minfo</a>, <a class="el" href="../../df/d9b/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__migman_8h_source.html#l00096">tcmi_migman::node</a>, <a class="el" href="../../d9/d03/kernel__2_86_833_81_2src_2proxyfs_2proxyfs__server_8c_source.html#l00059">self</a>, <a class="el" href="../../de/df5/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__messages__id_8h_source.html#l00121">TCMI_DISCONNECT_MSG_ID</a>, <a class="el" href="../../df/d9b/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__migman_8h_source.html#l00180">TCMI_MIGMAN</a>, <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00282">tcmi_migman_stop_perform()</a>, <a class="el" href="../../df/d27/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__msg_8h_source.html#l00231">tcmi_msg_id()</a>, <a class="el" href="../../d3/d83/kernel__2_86_833_81_2src_2tcmi_2lib_2tcmi__queue_8h_source.html#l00266">tcmi_queue_remove_entry</a>, <a class="el" href="../../d3/d83/kernel__2_86_833_81_2src_2tcmi_2lib_2tcmi__queue_8h_source.html#l00297">tcmi_queue_wait_on_empty_interruptible()</a>, and <a class="el" href="../../d8/d3d/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__comm_8h_source.html#l00112">wait_on_should_stop</a>.</p>

<p>Referenced by <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00547">tcmi_migman_start_thread()</a>.</p>
<div class="fragment"><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;{</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordtype">int</span> err = 0;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="keywordtype">int</span> migman_freed = 0;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg" title="A coumpound structure that carries a generic TCMI message.">tcmi_msg</a> *m;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman" title="A compound structure that holds all current shadow processes and other migration related data...">tcmi_migman</a> *<span class="keyword">self</span> = <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ga6e53ef2488c50427056d3a56e9b6c045" title="Casts to the migration manager.">TCMI_MIGMAN</a>(<a class="code" href="../../da/d3b/kernel__2_86_833_81_2src_2tcmi_2migration_2tcmi__npm__params_8h.html#ab9090ca30e7609aecaf540276e3c5084" title="Helper field that stores content of args/envp for the serialization.">data</a>);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="comment">/* saves 2 derefences when calling the process msg method */</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ga9cb8f073f000f6904ba204f01c95a044" title="Message processing method type for the message processing thread.">process_msg_t</a> *process_msg = <span class="keyword">self</span>-&gt;ops-&gt;process_msg;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordflow">if</span> (!process_msg) {</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Missing method to process messages!&quot;</span>);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Message processing thread up and running %p&quot;</span>, current);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordflow">while</span> (!(kthread_should_stop() || signal_pending(current))) {</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="keywordflow">if</span> ((err = <a class="code" href="../../dc/d0c/group__tcmi__queue__class.html#gae749f14f4593f9b0b48cf31fc43eaa17" title="&lt;&lt;public&gt;&gt; Puts the calling process to sleep as long as the queue is empty.">tcmi_queue_wait_on_empty_interruptible</a>(&amp;<a class="code" href="../../d9/d03/kernel__2_86_833_81_2src_2proxyfs_2proxyfs__server_8c.html#acffc38573c809dad4512ce637724ab7e">self</a>-&gt;msg_queue)) &lt; 0) {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(INFO1, <span class="stringliteral">&quot;Signal arrived %d&quot;</span>, err);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <a class="code" href="../../dc/d0c/group__tcmi__queue__class.html#gad1083b0f8850c7e9ff98175807920929" title="&lt;&lt;public&gt;&gt; Removes an entry from the head of the queue.">tcmi_queue_remove_entry</a>(&amp;<a class="code" href="../../d9/d03/kernel__2_86_833_81_2src_2proxyfs_2proxyfs__server_8c.html#acffc38573c809dad4512ce637724ab7e">self</a>-&gt;msg_queue, m, <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ab8cd47809d251779626127f751048f3e" title="A slot node, used for insertion of the manager into a slot.">node</a>);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <span class="keywordflow">if</span> (m) {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Processing message..&quot;</span>);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            <span class="keywordflow">switch</span>(<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ga73489766817f528da25369a3f4c713a1" title="&lt;&lt;public&gt;&gt; Message ID accessor.">tcmi_msg_id</a>(m)) {</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                process_msg(<span class="keyword">self</span>, m);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#ggadc29c2ff13d900c2f185ee95427fb06caca0bd17acecf4909d29a12200341045e">TCMI_DISCONNECT_MSG_ID</a>:</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                    <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(INFO3, <span class="stringliteral">&quot;Received disconnect message&quot;</span>);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                <span class="comment">/* </span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">                  Initiate shutdown upon reception of disconnect message </span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">                  Note: It is important not to touch self after this call and before should_stop is checked again, because self reference may be already invalid!</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">                */</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                migman_freed = <a class="code" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga42cc54b16a70368b84405761bf8780d5" title="Actual implementation of stop, see tcmi_migman_stop.">tcmi_migman_stop_perform</a>(<span class="keyword">self</span>, 1);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            }</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        }</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Processing thread woken up, queue is still empty..&quot;</span>);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        }</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; exit0:</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="comment">/* In case the migman was freed by this thread, no should_stop sync is performed */</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keywordflow">if</span> ( !migman_freed ) {</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        <span class="comment">/* We have to wait for thread terminating us as it is going to call stop at some tim */</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <a class="code" href="../../d9/dfc/group__tcmi__comm__class.html#ga9db330620d4a0492584227e29697ae94" title="This macro implements atomic check for thread stop request and puts the task to sleep until such requ...">wait_on_should_stop</a>();</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Message processing thread terminating&quot;</span>);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga698d639006881752225f808c1d345b1b_cgraph.png" border="0" usemap="#da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga698d639006881752225f808c1d345b1b_cgraph" alt=""/></div>
<map name="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga698d639006881752225f808c1d345b1b_cgraph" id="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga698d639006881752225f808c1d345b1b_cgraph">
<area shape="rect" id="node2" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga42cc54b16a70368b84405761bf8780d5" title="Actual implementation of stop, see tcmi_migman_stop." alt="" coords="230,136,413,163"/><area shape="rect" id="node15" href="../../d6/dc2/group__tcmi__msg__class.html#ga73489766817f528da25369a3f4c713a1" title="&lt;&lt;public&gt;&gt; Message ID accessor." alt="" coords="273,193,369,220"/><area shape="rect" id="node16" href="../../dc/d0c/group__tcmi__queue__class.html#gae749f14f4593f9b0b48cf31fc43eaa17" title="&lt;&lt;public&gt;&gt; Puts the calling process to sleep as long as the queue is empty." alt="" coords="251,257,391,298"/><area shape="rect" id="node3" href="../../d6/da2/group__tcmi__migman__class.html#gafca6221a82ff480ee067fcfa39745719" title="&lt;&lt;public&gt;&gt; Migration manager slot index getter" alt="" coords="462,5,629,32"/><area shape="rect" id="node5" href="../../d6/da2/group__tcmi__migman__class.html#ga9115d78a679e54cf4bf78cf051d6782e" title="&lt;&lt;public&gt;&gt; Set atomically a new state of the migration manager, assuming current state == old_state..." alt="" coords="471,57,620,98"/><area shape="rect" id="node6" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga510ce89add226478847ff0bbeb56a6c4" title="tcmi_migman_notify\l_peer_disconnect" alt="" coords="476,122,615,163"/><area shape="rect" id="node13" href="../../d6/da2/group__tcmi__migman__class.html#gab536c262c24d8fc76cdbdfa8d6d65b81" title="&lt;&lt;public&gt;&gt; The manager is shutdown exactly in this order:" alt="" coords="483,188,608,215"/><area shape="rect" id="node14" href="../../d6/da2/group__tcmi__migman__class.html#ga828da1bb7df2ccb80dd93c62f1b0731c" title="&lt;&lt;public&gt;&gt; Migration manager state accessor." alt="" coords="477,239,613,265"/><area shape="rect" id="node4" href="../../da/d0c/group__tcmi__slot__class.html#ga821f6b686443bfc7fff52dd3b155de37" title="&lt;&lt;public&gt;&gt; Slot index accessor." alt="" coords="715,5,829,32"/><area shape="rect" id="node7" href="../../d4/de6/group__tcmi__disconnect__msg__class.html#ga19a79788a771ec551e8b131a90966665" title="&lt;&lt;public&gt;&gt; Disconnect message tx constructor." alt="" coords="697,59,847,101"/><area shape="rect" id="node8" href="../../d6/dc2/group__tcmi__msg__class.html#ga7a8fe8cbfd4b25c15589c8599f66e574" title="&lt;&lt;public&gt;&gt; Sends a message via a specified connection." alt="" coords="678,125,866,152"/><area shape="rect" id="node9" href="../../d6/da2/group__tcmi__migman__class.html#ga91bf5b41a1d4faa3eab11e6867ec34e4" title="&lt;&lt;public&gt;&gt; Communication socket accesor." alt="" coords="705,176,839,203"/><area shape="rect" id="node11" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined..." alt="" coords="720,227,824,253"/><area shape="rect" id="node10" href="../../d3/d7e/group__tcmi__sock__class.html#ga8573cfac9adbb5996cd90395d8a78502" title="&lt;&lt;public&gt;&gt; KKC socket accessor." alt="" coords="915,176,1085,203"/><area shape="rect" id="node12" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2748d267a8fddd1ced86e73ba8efd079" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="929,227,1071,253"/><area shape="rect" id="node17" href="../../dc/d0c/group__tcmi__queue__class.html#ga2b0f1376bcd561196e77599cbc23090f" title="tcmi_queue_empty" alt="" coords="479,289,611,316"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga510ce89add226478847ff0bbeb56a6c4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_migman_notify_peer_disconnect </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00262">262</a> of file <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html">tcmi_migman.c</a>.</p>

<p>References <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00221">minfo</a>, <a class="el" href="../../dd/dde/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__disconnect__msg_8c_source.html#l00061">tcmi_disconnect_msg_new_tx()</a>, <a class="el" href="../../df/d9b/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__migman_8h_source.html#l00307">tcmi_migman_sock()</a>, <a class="el" href="../../df/d27/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__msg_8h_source.html#l00159">TCMI_MSG</a>, <a class="el" href="../../df/d27/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__msg_8h_source.html#l00212">tcmi_msg_put()</a>, and <a class="el" href="../../dd/ddb/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__msg_8c_source.html#l00138">tcmi_msg_send_anonymous()</a>.</p>

<p>Referenced by <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00282">tcmi_migman_stop_perform()</a>.</p>
<div class="fragment"><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                                                                         {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg" title="A coumpound structure that carries a generic TCMI message.">tcmi_msg</a>* msg;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordtype">int</span> err;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">if</span> ( !( msg = <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ga91f3fd64c88d27100f1e4c7125a73a0e" title="Casts to the tcmi_msg instance.">TCMI_MSG</a>(<a class="code" href="../../d4/de6/group__tcmi__disconnect__msg__class.html#ga19a79788a771ec551e8b131a90966665" title="&lt;&lt;public&gt;&gt; Disconnect message tx constructor.">tcmi_disconnect_msg_new_tx</a>()) ) ) { </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(ERR3, <span class="stringliteral">&quot;Error creating disconnect message&quot;</span>);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">if</span> ((err = <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ga7a8fe8cbfd4b25c15589c8599f66e574" title="&lt;&lt;public&gt;&gt; Sends a message via a specified connection.">tcmi_msg_send_anonymous</a>(msg, <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ga91bf5b41a1d4faa3eab11e6867ec34e4" title="&lt;&lt;public&gt;&gt; Communication socket accesor.">tcmi_migman_sock</a>(<span class="keyword">self</span>)))) {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(ERR3, <span class="stringliteral">&quot;Error sending disconnect message %d&quot;</span>, err);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined...">tcmi_msg_put</a>(msg);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    }       </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga510ce89add226478847ff0bbeb56a6c4_cgraph.png" border="0" usemap="#da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga510ce89add226478847ff0bbeb56a6c4_cgraph" alt=""/></div>
<map name="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga510ce89add226478847ff0bbeb56a6c4_cgraph" id="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga510ce89add226478847ff0bbeb56a6c4_cgraph">
<area shape="rect" id="node2" href="../../d4/de6/group__tcmi__disconnect__msg__class.html#ga19a79788a771ec551e8b131a90966665" title="&lt;&lt;public&gt;&gt; Disconnect message tx constructor." alt="" coords="212,5,361,46"/><area shape="rect" id="node3" href="../../d6/da2/group__tcmi__migman__class.html#ga91bf5b41a1d4faa3eab11e6867ec34e4" title="&lt;&lt;public&gt;&gt; Communication socket accesor." alt="" coords="219,71,354,97"/><area shape="rect" id="node5" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined..." alt="" coords="235,121,339,148"/><area shape="rect" id="node7" href="../../d6/dc2/group__tcmi__msg__class.html#ga7a8fe8cbfd4b25c15589c8599f66e574" title="&lt;&lt;public&gt;&gt; Sends a message via a specified connection." alt="" coords="193,172,381,199"/><area shape="rect" id="node4" href="../../d3/d7e/group__tcmi__sock__class.html#ga8573cfac9adbb5996cd90395d8a78502" title="&lt;&lt;public&gt;&gt; KKC socket accessor." alt="" coords="429,71,600,97"/><area shape="rect" id="node6" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2748d267a8fddd1ced86e73ba8efd079" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="443,121,586,148"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gac71618221f842f2032e6141c21eed095"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_migman_show_state </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Read method for the TCMI ctlfs - reports migration manager state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*obj</td><td>- this migration manager instance </td></tr>
    <tr><td class="paramname">*data</td><td>- pointer to this migration manager instance </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon success </dd></dl>

<p>Definition at line <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00526">526</a> of file <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html">tcmi_migman.c</a>.</p>

<p>References <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../df/d9b/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__migman_8h_source.html#l00180">TCMI_MIGMAN</a>, <a class="el" href="../../df/d9b/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__migman_8h_source.html#l00248">tcmi_migman_state()</a>, <a class="el" href="../../df/d9b/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__migman_8h_source.html#l00086">TCMI_MIGMAN_STATE_COUNT</a>, <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00051">TCMI_MIGMAN_STATE_LENGTH</a>, and <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00768">tcmi_migman_states</a>.</p>

<p>Referenced by <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00404">tcmi_migman_init_ctlfs_files()</a>.</p>
<div class="fragment"><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;{</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman" title="A compound structure that holds all current shadow processes and other migration related data...">tcmi_migman</a> *<span class="keyword">self</span> = <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ga6e53ef2488c50427056d3a56e9b6c045" title="Casts to the migration manager.">TCMI_MIGMAN</a>(obj);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;state %d, maxcount %d&quot;</span>, <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ga828da1bb7df2ccb80dd93c62f1b0731c" title="&lt;&lt;public&gt;&gt; Migration manager state accessor.">tcmi_migman_state</a>(<span class="keyword">self</span>), <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#gga94094c5c702e25dbb12be0bb63b32875a0ecc4ea08c917e6a65f2b18c999f03c1">TCMI_MIGMAN_STATE_COUNT</a>);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ga828da1bb7df2ccb80dd93c62f1b0731c" title="&lt;&lt;public&gt;&gt; Migration manager state accessor.">tcmi_migman_state</a>(<span class="keyword">self</span>) &lt; <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#gga94094c5c702e25dbb12be0bb63b32875a0ecc4ea08c917e6a65f2b18c999f03c1">TCMI_MIGMAN_STATE_COUNT</a>) {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        strncpy((<span class="keywordtype">char</span>*)<a class="code" href="../../da/d3b/kernel__2_86_833_81_2src_2tcmi_2migration_2tcmi__npm__params_8h.html#ab9090ca30e7609aecaf540276e3c5084" title="Helper field that stores content of args/envp for the serialization.">data</a>, </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ga5ed214ca4e27ad66cf1cb1eefd650e77" title="String descriptor for the states of migration manager.">tcmi_migman_states</a>[<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ga828da1bb7df2ccb80dd93c62f1b0731c" title="&lt;&lt;public&gt;&gt; Migration manager state accessor.">tcmi_migman_state</a>(<span class="keyword">self</span>)], </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            <a class="code" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#af23ef88a7f5ee038746a70d12d73ecac" title="Max length of the state description.">TCMI_MIGMAN_STATE_LENGTH</a>);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Displaying state %s&quot;</span>, <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ga5ed214ca4e27ad66cf1cb1eefd650e77" title="String descriptor for the states of migration manager.">tcmi_migman_states</a>[<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ga828da1bb7df2ccb80dd93c62f1b0731c" title="&lt;&lt;public&gt;&gt; Migration manager state accessor.">tcmi_migman_state</a>(<span class="keyword">self</span>)]);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    }</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_gac71618221f842f2032e6141c21eed095_cgraph.png" border="0" usemap="#da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_gac71618221f842f2032e6141c21eed095_cgraph" alt=""/></div>
<map name="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_gac71618221f842f2032e6141c21eed095_cgraph" id="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_gac71618221f842f2032e6141c21eed095_cgraph">
<area shape="rect" id="node2" href="../../d6/da2/group__tcmi__migman__class.html#ga828da1bb7df2ccb80dd93c62f1b0731c" title="&lt;&lt;public&gt;&gt; Migration manager state accessor." alt="" coords="227,5,363,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gad4006fee98cc9ef9bba73a33dc28bc66"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_migman_start_thread </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Starts the listening thread. </p>
<p>The kernel thread is started by using kernel services. No additional actions are needed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this migration manager instance </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon sucessful thread creation </dd></dl>

<p>Definition at line <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00547">547</a> of file <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html">tcmi_migman.c</a>.</p>

<p>References <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d9/d03/kernel__2_86_833_81_2src_2proxyfs_2proxyfs__server_8c_source.html#l00059">self</a>, and <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00654">tcmi_migman_msg_thread()</a>.</p>

<p>Referenced by <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00081">tcmi_migman_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;{</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keywordtype">int</span> err = 0;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keyword">self</span>-&gt;msg_thread = kthread_run(<a class="code" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga698d639006881752225f808c1d345b1b" title="&lt;&lt;private&gt;&gt; Message processing thread.">tcmi_migman_msg_thread</a>, <span class="keyword">self</span>, </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                       <span class="stringliteral">&quot;tcmi_migmsgd&quot;</span>);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordflow">if</span> (IS_ERR(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a5db9ffb9a04b2f793930533e9fd02afd" title="Message processing thread.">msg_thread</a>)) {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        err = -EINVAL;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Created message processing thread %p&quot;</span>, self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a5db9ffb9a04b2f793930533e9fd02afd" title="Message processing thread.">msg_thread</a>);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="comment">/* error hanlding */</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; exit0:</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_gad4006fee98cc9ef9bba73a33dc28bc66_cgraph.png" border="0" usemap="#da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_gad4006fee98cc9ef9bba73a33dc28bc66_cgraph" alt=""/></div>
<map name="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_gad4006fee98cc9ef9bba73a33dc28bc66_cgraph" id="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_gad4006fee98cc9ef9bba73a33dc28bc66_cgraph">
<area shape="rect" id="node2" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga698d639006881752225f808c1d345b1b" title="&lt;&lt;private&gt;&gt; Message processing thread." alt="" coords="230,193,405,220"/><area shape="rect" id="node3" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga42cc54b16a70368b84405761bf8780d5" title="Actual implementation of stop, see tcmi_migman_stop." alt="" coords="454,136,637,163"/><area shape="rect" id="node16" href="../../d6/dc2/group__tcmi__msg__class.html#ga73489766817f528da25369a3f4c713a1" title="&lt;&lt;public&gt;&gt; Message ID accessor." alt="" coords="497,193,593,220"/><area shape="rect" id="node17" href="../../dc/d0c/group__tcmi__queue__class.html#gae749f14f4593f9b0b48cf31fc43eaa17" title="&lt;&lt;public&gt;&gt; Puts the calling process to sleep as long as the queue is empty." alt="" coords="475,257,615,298"/><area shape="rect" id="node4" href="../../d6/da2/group__tcmi__migman__class.html#gafca6221a82ff480ee067fcfa39745719" title="&lt;&lt;public&gt;&gt; Migration manager slot index getter" alt="" coords="686,5,853,32"/><area shape="rect" id="node6" href="../../d6/da2/group__tcmi__migman__class.html#ga9115d78a679e54cf4bf78cf051d6782e" title="&lt;&lt;public&gt;&gt; Set atomically a new state of the migration manager, assuming current state == old_state..." alt="" coords="695,57,844,98"/><area shape="rect" id="node7" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga510ce89add226478847ff0bbeb56a6c4" title="tcmi_migman_notify\l_peer_disconnect" alt="" coords="700,122,839,163"/><area shape="rect" id="node14" href="../../d6/da2/group__tcmi__migman__class.html#gab536c262c24d8fc76cdbdfa8d6d65b81" title="&lt;&lt;public&gt;&gt; The manager is shutdown exactly in this order:" alt="" coords="707,188,832,215"/><area shape="rect" id="node15" href="../../d6/da2/group__tcmi__migman__class.html#ga828da1bb7df2ccb80dd93c62f1b0731c" title="&lt;&lt;public&gt;&gt; Migration manager state accessor." alt="" coords="701,239,837,265"/><area shape="rect" id="node5" href="../../da/d0c/group__tcmi__slot__class.html#ga821f6b686443bfc7fff52dd3b155de37" title="&lt;&lt;public&gt;&gt; Slot index accessor." alt="" coords="939,5,1053,32"/><area shape="rect" id="node8" href="../../d4/de6/group__tcmi__disconnect__msg__class.html#ga19a79788a771ec551e8b131a90966665" title="&lt;&lt;public&gt;&gt; Disconnect message tx constructor." alt="" coords="921,59,1071,101"/><area shape="rect" id="node9" href="../../d6/da2/group__tcmi__migman__class.html#ga91bf5b41a1d4faa3eab11e6867ec34e4" title="&lt;&lt;public&gt;&gt; Communication socket accesor." alt="" coords="929,125,1063,152"/><area shape="rect" id="node11" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined..." alt="" coords="944,176,1048,203"/><area shape="rect" id="node13" href="../../d6/dc2/group__tcmi__msg__class.html#ga7a8fe8cbfd4b25c15589c8599f66e574" title="&lt;&lt;public&gt;&gt; Sends a message via a specified connection." alt="" coords="902,227,1090,253"/><area shape="rect" id="node10" href="../../d3/d7e/group__tcmi__sock__class.html#ga8573cfac9adbb5996cd90395d8a78502" title="&lt;&lt;public&gt;&gt; KKC socket accessor." alt="" coords="1139,125,1309,152"/><area shape="rect" id="node12" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2748d267a8fddd1ced86e73ba8efd079" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="1153,176,1295,203"/><area shape="rect" id="node18" href="../../dc/d0c/group__tcmi__queue__class.html#ga2b0f1376bcd561196e77599cbc23090f" title="tcmi_queue_empty" alt="" coords="703,289,835,316"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga39c491f49b4e5b3cc533c816d27135a3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_migman_stop_ctlfs_dirs </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Destroys all TCMI ctlfs directories </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this migration manager instance </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00454">454</a> of file <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html">tcmi_migman.c</a>.</p>

<p>References <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d9/d03/kernel__2_86_833_81_2src_2proxyfs_2proxyfs__server_8c_source.html#l00059">self</a>, and <a class="el" href="../../d6/d77/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8h_source.html#l00214">tcmi_ctlfs_entry_put()</a>.</p>

<p>Referenced by <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00228">tcmi_migman_free()</a>, and <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00081">tcmi_migman_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;{</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Destroying  TCMI migmanager ctlfs directories&quot;</span>);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">if</span> (self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#aebe1cd8c73d81cf09edcd4bdc72d476d" title="Operations specific to CCN/PEN migration manager resp.">ops</a>-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a8608ffcfb58f28b9bc12225171a58da7" title="Destroys all TCMI ctlfs directories.">stop_ctlfs_dirs</a>) </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="keyword">self</span>-&gt;ops-&gt;stop_ctlfs_dirs(<span class="keyword">self</span>);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d...">tcmi_ctlfs_entry_put</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a3551ff300819c9346483060594586873" title="TCMI ctlfs - directory where all migration control files/directories reside.">d_migman</a>);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d...">tcmi_ctlfs_entry_put</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a676e8a8c652cdfead8b780141e3b0564">s_migman</a>);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d...">tcmi_ctlfs_entry_put</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a9e4e35e4ed0ca0e80a75d9b6e14516e6" title="TCMI ctlfs - directory for active connections.">d_conns</a>);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d...">tcmi_ctlfs_entry_put</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a36f294e633ab983b27117a9bb5a7c822" title="TCMI ctlfs - reference to the migproc directory - needed when immigrating a process.">d_migproc</a>);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga39c491f49b4e5b3cc533c816d27135a3_cgraph.png" border="0" usemap="#da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga39c491f49b4e5b3cc533c816d27135a3_cgraph" alt=""/></div>
<map name="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga39c491f49b4e5b3cc533c816d27135a3_cgraph" id="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga39c491f49b4e5b3cc533c816d27135a3_cgraph">
<area shape="rect" id="node2" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d..." alt="" coords="245,5,384,32"/><area shape="rect" id="node3" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga986b629882729daaf2c9607bfca57c3c" title="&lt;&lt;public&gt;&gt; Entry name accessor." alt="" coords="433,5,586,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga5b56a5213e9dbcba9973b9530692fd27"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_migman_stop_ctlfs_files </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Unregisters and releases all control files. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this migration manager instance </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00472">472</a> of file <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html">tcmi_migman.c</a>.</p>

<p>References <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d9/d03/kernel__2_86_833_81_2src_2proxyfs_2proxyfs__server_8c_source.html#l00059">self</a>, <a class="el" href="../../d6/d77/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8h_source.html#l00214">tcmi_ctlfs_entry_put()</a>, <a class="el" href="../../d6/d4d/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__file_8h_source.html#l00106">TCMI_CTLFS_FILE_FROM_METHOD</a>, <a class="el" href="../../d0/def/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__file_8c_source.html#l00154">tcmi_ctlfs_file_unregister()</a>, and <a class="el" href="../../d0/def/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__file_8c_source.html#l00180">tcmi_ctlfs_file_unregister2()</a>.</p>

<p>Referenced by <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00228">tcmi_migman_free()</a>, and <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00081">tcmi_migman_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;{</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Destroying  TCMI migmanager ctlfs files&quot;</span>);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">if</span> (self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#aebe1cd8c73d81cf09edcd4bdc72d476d" title="Operations specific to CCN/PEN migration manager resp.">ops</a>-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a3251113e40f96baeeeb22a9d0d5a1699" title="Destroys all TCMI ctlfs files.">stop_ctlfs_files</a>) </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keyword">self</span>-&gt;ops-&gt;stop_ctlfs_files(<span class="keyword">self</span>);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">/* We have to use non-locking unregister, because the unregister could be called from this file&#39;s write method */</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <a class="code" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gaead344003750e43cb4a0326876a191bc" title="&lt;&lt;public&gt;&gt; This method unregisters the file and allows the user to specify the preferred way of unreg...">tcmi_ctlfs_file_unregister2</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a49fa02e14f41977c88717f9a1bb5cdf8" title="TCMI ctlfs - request shutdown of this migration manager.">f_stop</a>, <a class="code" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gga6c67af9bc3bdb400ea6f664d464aa316a99f3a5eb7ee2e58abd8bd9323937ee6b">TCMI_CTLFS_FILE_FROM_METHOD</a>);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d...">tcmi_ctlfs_entry_put</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a49fa02e14f41977c88717f9a1bb5cdf8" title="TCMI ctlfs - request shutdown of this migration manager.">f_stop</a>);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">/* We have to use non-locking unregister, because the unregister could be called from this file&#39;s write method */</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <a class="code" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gaead344003750e43cb4a0326876a191bc" title="&lt;&lt;public&gt;&gt; This method unregisters the file and allows the user to specify the preferred way of unreg...">tcmi_ctlfs_file_unregister2</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a64c914f4e6c982903afe779af3f53698" title="TCMI ctlfs - request kill of this migration manager.">f_kill</a>, <a class="code" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gga6c67af9bc3bdb400ea6f664d464aa316a99f3a5eb7ee2e58abd8bd9323937ee6b">TCMI_CTLFS_FILE_FROM_METHOD</a>);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d...">tcmi_ctlfs_entry_put</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a64c914f4e6c982903afe779af3f53698" title="TCMI ctlfs - request kill of this migration manager.">f_kill</a>);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <a class="code" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga665210941a04fda118949874767ced93" title="&lt;&lt;public&gt;&gt; This method unregisters the file uses the semaphore lock as protection from races...">tcmi_ctlfs_file_unregister</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a41ae3f93bd0c0bcecb5dad6b848b9cba" title="TCMI ctlfs - reports current state of the manager.">f_state</a>);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d...">tcmi_ctlfs_entry_put</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a41ae3f93bd0c0bcecb5dad6b848b9cba" title="TCMI ctlfs - reports current state of the manager.">f_state</a>);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga5b56a5213e9dbcba9973b9530692fd27_cgraph.png" border="0" usemap="#da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga5b56a5213e9dbcba9973b9530692fd27_cgraph" alt=""/></div>
<map name="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga5b56a5213e9dbcba9973b9530692fd27_cgraph" id="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga5b56a5213e9dbcba9973b9530692fd27_cgraph">
<area shape="rect" id="node2" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d..." alt="" coords="233,5,372,32"/><area shape="rect" id="node4" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga665210941a04fda118949874767ced93" title="&lt;&lt;public&gt;&gt; This method unregisters the file uses the semaphore lock as protection from races..." alt="" coords="220,56,385,83"/><area shape="rect" id="node5" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gaead344003750e43cb4a0326876a191bc" title="&lt;&lt;public&gt;&gt; This method unregisters the file and allows the user to specify the preferred way of unreg..." alt="" coords="217,107,389,133"/><area shape="rect" id="node3" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga986b629882729daaf2c9607bfca57c3c" title="&lt;&lt;public&gt;&gt; Entry name accessor." alt="" coords="438,5,591,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga42cc54b16a70368b84405761bf8780d5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_migman_stop_perform </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>remote_requested</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Actual implementation of stop, see tcmi_migman_stop. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">remote_requested</td><td>True, if stop request was initiated as a response to received disconnect message  1, if the migman instance was destroyed in context of this method </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00282">282</a> of file <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html">tcmi_migman.c</a>.</p>

<p>References <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00221">minfo</a>, <a class="el" href="../../d9/d03/kernel__2_86_833_81_2src_2proxyfs_2proxyfs__server_8c_source.html#l00059">self</a>, <a class="el" href="../../df/d9b/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__migman_8h_source.html#l00235">tcmi_migman_change_state()</a>, <a class="el" href="../../df/d9b/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__migman_8h_source.html#l00082">TCMI_MIGMAN_CONNECTED</a>, <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00262">tcmi_migman_notify_peer_disconnect()</a>, <a class="el" href="../../d6/d0b/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00189">tcmi_migman_put()</a>, <a class="el" href="../../df/d9b/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__migman_8h_source.html#l00083">TCMI_MIGMAN_SHUTTING_DOWN</a>, <a class="el" href="../../df/d9b/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__migman_8h_source.html#l00259">tcmi_migman_slot_index()</a>, and <a class="el" href="../../df/d9b/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__migman_8h_source.html#l00248">tcmi_migman_state()</a>.</p>

<p>Referenced by <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00654">tcmi_migman_msg_thread()</a>.</p>
<div class="fragment"><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                                                                    {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;     <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(INFO3, <span class="stringliteral">&quot;Requesting stop of migration manager: %d Remote requested: %d&quot;</span>, <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#gafca6221a82ff480ee067fcfa39745719" title="&lt;&lt;public&gt;&gt; Migration manager slot index getter">tcmi_migman_slot_index</a>(<span class="keyword">self</span>), remote_requested);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;     </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;     <span class="keywordflow">if</span> ( <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ga9115d78a679e54cf4bf78cf051d6782e" title="&lt;&lt;public&gt;&gt; Set atomically a new state of the migration manager, assuming current state == old_state...">tcmi_migman_change_state</a>(<span class="keyword">self</span>, <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#gga94094c5c702e25dbb12be0bb63b32875a5b1ca754502cdb6ddba6b3a263e2a919">TCMI_MIGMAN_CONNECTED</a>, <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#gga94094c5c702e25dbb12be0bb63b32875a98a50e72214094b8fdc3a790cd8e2ad8">TCMI_MIGMAN_SHUTTING_DOWN</a>) ) {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">/* We are the first to request stop operation */</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">if</span> (self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#aebe1cd8c73d81cf09edcd4bdc72d476d" title="Operations specific to CCN/PEN migration manager resp.">ops</a>-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a8fc30157e38606e90a001be732ab1c64" title="Request to stop this migration manager and terminate its connection with peer.">stop</a>)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keyword">self</span>-&gt;ops-&gt;stop(<span class="keyword">self</span>, remote_requested);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">if</span> ( !remote_requested ) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="comment">/* Sent notification to peer about disconnection being performed.. even if this fails (peer may be dead already), we proceed further */</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <a class="code" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga510ce89add226478847ff0bbeb56a6c4">tcmi_migman_notify_peer_disconnect</a>(<span class="keyword">self</span>);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    }       </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">/* Finally drop the reference to &quot;self&quot;. If this is the last reference, the instance is going to be unhased and deleted.</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">       At this phase it is possible some tasks are still running and so they have reference to this instance. Asynchronous emigration requests were already issued */</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#gab536c262c24d8fc76cdbdfa8d6d65b81" title="&lt;&lt;public&gt;&gt; The manager is shutdown exactly in this order:">tcmi_migman_put</a>(<span class="keyword">self</span>);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;     } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(INFO3, <span class="stringliteral">&quot;Migration manager stop was already requested -&gt; Ignoring this call. Manager state is: %d&quot;</span>, <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ga828da1bb7df2ccb80dd93c62f1b0731c" title="&lt;&lt;public&gt;&gt; Migration manager state accessor.">tcmi_migman_state</a>(<span class="keyword">self</span>));</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;     }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;     </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;     <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga42cc54b16a70368b84405761bf8780d5_cgraph.png" border="0" usemap="#da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga42cc54b16a70368b84405761bf8780d5_cgraph" alt=""/></div>
<map name="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga42cc54b16a70368b84405761bf8780d5_cgraph" id="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga42cc54b16a70368b84405761bf8780d5_cgraph">
<area shape="rect" id="node2" href="../../d6/da2/group__tcmi__migman__class.html#ga9115d78a679e54cf4bf78cf051d6782e" title="&lt;&lt;public&gt;&gt; Set atomically a new state of the migration manager, assuming current state == old_state..." alt="" coords="247,45,396,86"/><area shape="rect" id="node3" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html#ga510ce89add226478847ff0bbeb56a6c4" title="tcmi_migman_notify\l_peer_disconnect" alt="" coords="252,110,391,151"/><area shape="rect" id="node10" href="../../d6/da2/group__tcmi__migman__class.html#gab536c262c24d8fc76cdbdfa8d6d65b81" title="&lt;&lt;public&gt;&gt; The manager is shutdown exactly in this order:" alt="" coords="259,176,384,203"/><area shape="rect" id="node11" href="../../d6/da2/group__tcmi__migman__class.html#gafca6221a82ff480ee067fcfa39745719" title="&lt;&lt;public&gt;&gt; Migration manager slot index getter" alt="" coords="238,227,405,253"/><area shape="rect" id="node13" href="../../d6/da2/group__tcmi__migman__class.html#ga828da1bb7df2ccb80dd93c62f1b0731c" title="&lt;&lt;public&gt;&gt; Migration manager state accessor." alt="" coords="253,277,389,304"/><area shape="rect" id="node4" href="../../d4/de6/group__tcmi__disconnect__msg__class.html#ga19a79788a771ec551e8b131a90966665" title="&lt;&lt;public&gt;&gt; Disconnect message tx constructor." alt="" coords="473,5,623,46"/><area shape="rect" id="node5" href="../../d6/da2/group__tcmi__migman__class.html#ga91bf5b41a1d4faa3eab11e6867ec34e4" title="&lt;&lt;public&gt;&gt; Communication socket accesor." alt="" coords="481,71,615,97"/><area shape="rect" id="node7" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined..." alt="" coords="496,121,600,148"/><area shape="rect" id="node9" href="../../d6/dc2/group__tcmi__msg__class.html#ga7a8fe8cbfd4b25c15589c8599f66e574" title="&lt;&lt;public&gt;&gt; Sends a message via a specified connection." alt="" coords="454,172,642,199"/><area shape="rect" id="node6" href="../../d3/d7e/group__tcmi__sock__class.html#ga8573cfac9adbb5996cd90395d8a78502" title="&lt;&lt;public&gt;&gt; KKC socket accessor." alt="" coords="691,71,861,97"/><area shape="rect" id="node8" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2748d267a8fddd1ced86e73ba8efd079" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="705,121,847,148"/><area shape="rect" id="node12" href="../../da/d0c/group__tcmi__slot__class.html#ga821f6b686443bfc7fff52dd3b155de37" title="&lt;&lt;public&gt;&gt; Slot index accessor." alt="" coords="491,227,605,253"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga4bcd1bc07e002ed4bc6fafcd44215749"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_migman_stop_request </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Requests asynchronous shutdown of this migration manager </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*obj</td><td>- this migration manager instance </td></tr>
    <tr><td class="paramname">*data</td><td>- ignored </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon success </dd></dl>

<p>Definition at line <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00497">497</a> of file <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html">tcmi_migman.c</a>.</p>

<p>References <a class="el" href="../../df/d9b/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__migman_8h_source.html#l00180">TCMI_MIGMAN</a>, and <a class="el" href="../../d6/d0b/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00258">tcmi_migman_stop()</a>.</p>

<p>Referenced by <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00404">tcmi_migman_init_ctlfs_files()</a>.</p>
<div class="fragment"><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                                                           {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman" title="A compound structure that holds all current shadow processes and other migration related data...">tcmi_migman</a> *<span class="keyword">self</span> = <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ga6e53ef2488c50427056d3a56e9b6c045" title="Casts to the migration manager.">TCMI_MIGMAN</a>(obj);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#gad131e3ab84c0ce68226c297b508dfcc4" title="Requests asynchronous shutdown of connection with peer.">tcmi_migman_stop</a>(<span class="keyword">self</span>);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga4bcd1bc07e002ed4bc6fafcd44215749_cgraph.png" border="0" usemap="#da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga4bcd1bc07e002ed4bc6fafcd44215749_cgraph" alt=""/></div>
<map name="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga4bcd1bc07e002ed4bc6fafcd44215749_cgraph" id="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga4bcd1bc07e002ed4bc6fafcd44215749_cgraph">
<area shape="rect" id="node2" href="../../d6/da2/group__tcmi__migman__class.html#gad131e3ab84c0ce68226c297b508dfcc4" title="Requests asynchronous shutdown of connection with peer." alt="" coords="238,129,370,156"/><area shape="rect" id="node3" href="../../d6/da2/group__tcmi__migman__class.html#ga42cc54b16a70368b84405761bf8780d5" title="Actual implementation of stop, see tcmi_migman_stop." alt="" coords="419,129,602,156"/><area shape="rect" id="node4" href="../../d6/da2/group__tcmi__migman__class.html#gafca6221a82ff480ee067fcfa39745719" title="&lt;&lt;public&gt;&gt; Migration manager slot index getter" alt="" coords="651,5,818,32"/><area shape="rect" id="node6" href="../../d6/da2/group__tcmi__migman__class.html#ga9115d78a679e54cf4bf78cf051d6782e" title="&lt;&lt;public&gt;&gt; Set atomically a new state of the migration manager, assuming current state == old_state..." alt="" coords="660,57,809,98"/><area shape="rect" id="node7" href="../../d6/da2/group__tcmi__migman__class.html#ga510ce89add226478847ff0bbeb56a6c4" title="tcmi_migman_notify\l_peer_disconnect" alt="" coords="665,122,804,163"/><area shape="rect" id="node14" href="../../d6/da2/group__tcmi__migman__class.html#gab536c262c24d8fc76cdbdfa8d6d65b81" title="&lt;&lt;public&gt;&gt; The manager is shutdown exactly in this order:" alt="" coords="672,188,797,215"/><area shape="rect" id="node15" href="../../d6/da2/group__tcmi__migman__class.html#ga828da1bb7df2ccb80dd93c62f1b0731c" title="&lt;&lt;public&gt;&gt; Migration manager state accessor." alt="" coords="667,239,803,265"/><area shape="rect" id="node5" href="../../da/d0c/group__tcmi__slot__class.html#ga821f6b686443bfc7fff52dd3b155de37" title="&lt;&lt;public&gt;&gt; Slot index accessor." alt="" coords="905,5,1018,32"/><area shape="rect" id="node8" href="../../d4/de6/group__tcmi__disconnect__msg__class.html#ga19a79788a771ec551e8b131a90966665" title="&lt;&lt;public&gt;&gt; Disconnect message tx constructor." alt="" coords="887,61,1036,102"/><area shape="rect" id="node9" href="../../d6/dc2/group__tcmi__msg__class.html#ga7a8fe8cbfd4b25c15589c8599f66e574" title="&lt;&lt;public&gt;&gt; Sends a message via a specified connection." alt="" coords="867,127,1055,153"/><area shape="rect" id="node10" href="../../d6/da2/group__tcmi__migman__class.html#ga91bf5b41a1d4faa3eab11e6867ec34e4" title="&lt;&lt;public&gt;&gt; Communication socket accesor." alt="" coords="894,177,1029,204"/><area shape="rect" id="node12" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined..." alt="" coords="909,228,1013,255"/><area shape="rect" id="node11" href="../../d3/d7e/group__tcmi__sock__class.html#ga8573cfac9adbb5996cd90395d8a78502" title="&lt;&lt;public&gt;&gt; KKC socket accessor." alt="" coords="1104,177,1275,204"/><area shape="rect" id="node13" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2748d267a8fddd1ced86e73ba8efd079" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="1118,228,1261,255"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gae4ad418d705edeca23e38eb383343978"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_migman_stop_thread </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; The TCMI manager listening thread is to be terminated by forcing a signal and waiting for it to terminate. </p>
<p>The thread notices the request from the manager and terminates.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this migration manager instance </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00572">572</a> of file <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html">tcmi_migman.c</a>.</p>

<p>References <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00220">mdbg</a>, and <a class="el" href="../../d9/d03/kernel__2_86_833_81_2src_2proxyfs_2proxyfs__server_8c_source.html#l00059">self</a>.</p>

<p>Referenced by <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00228">tcmi_migman_free()</a>.</p>
<div class="fragment"><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;{</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">if</span> (self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a5db9ffb9a04b2f793930533e9fd02afd" title="Message processing thread.">msg_thread</a>) {</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Stopping message processing thread&quot;</span>);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        force_sig(SIGTERM, self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a5db9ffb9a04b2f793930533e9fd02afd" title="Message processing thread.">msg_thread</a>);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="keywordflow">if</span> ( self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a5db9ffb9a04b2f793930533e9fd02afd" title="Message processing thread.">msg_thread</a> != current ) {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;          <span class="comment">/* We can only call stop if we are not actually the thread being stopped! */</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;          kthread_stop(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a5db9ffb9a04b2f793930533e9fd02afd" title="Message processing thread.">msg_thread</a>);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    }</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga71f49cd0661e81a859daab82ae7676de"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_migman_unhash </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Removes migman from a list of migration managers of the associated manager. </p>
<p>Check if we were not already unhashed </p>

<p>Definition at line <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00208">208</a> of file <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html">tcmi_migman.c</a>.</p>

<p>References <a class="el" href="../../d9/d03/kernel__2_86_833_81_2src_2proxyfs_2proxyfs__server_8c_source.html#l00059">self</a>, <a class="el" href="../../de/dd2/kernel__2_86_833_81_2src_2tcmi_2lib_2tcmi__slot_8h_source.html#l00239">tcmi_slot_lock()</a>, <a class="el" href="../../de/dd2/kernel__2_86_833_81_2src_2tcmi_2lib_2tcmi__slot_8h_source.html#l00148">tcmi_slot_node_unhashed</a>, <a class="el" href="../../de/dd2/kernel__2_86_833_81_2src_2tcmi_2lib_2tcmi__slot_8h_source.html#l00135">tcmi_slot_remove_first</a>, and <a class="el" href="../../de/dd2/kernel__2_86_833_81_2src_2tcmi_2lib_2tcmi__slot_8h_source.html#l00250">tcmi_slot_unlock()</a>.</p>

<p>Referenced by <a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_source.html#l00228">tcmi_migman_free()</a>.</p>
<div class="fragment"><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                                                         {<span class="comment"></span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">      /** Check if we were not already unhashed */</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keywordflow">if</span> ( !<a class="code" href="../../da/d0c/group__tcmi__slot__class.html#ga096c99c25b450d849e11c5e7aa57bb09" title="Check for node being removed from the hlist.">tcmi_slot_node_unhashed</a>(&amp;self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ab8cd47809d251779626127f751048f3e" title="A slot node, used for insertion of the manager into a slot.">node</a>) ) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <a class="code" href="../../da/d0c/group__tcmi__slot__class.html#ga109d6d783ebf06046f364f970f84da1f" title="&lt;&lt;public&gt;&gt; Locks the slot data.">tcmi_slot_lock</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a62fae8ec14ec1f7f1d143c5a130600e6" title="Reference to slot in an associated manager migmans vector.">manager_slot</a>);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <a class="code" href="../../da/d0c/group__tcmi__slot__class.html#ga4e77d9cb5dbafc0fb6759fa09838d547" title="&lt;&lt;public&gt;&gt; Removes the first object in the slot.">tcmi_slot_remove_first</a>(<span class="keyword">self</span>, self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a62fae8ec14ec1f7f1d143c5a130600e6" title="Reference to slot in an associated manager migmans vector.">manager_slot</a>, <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ab8cd47809d251779626127f751048f3e" title="A slot node, used for insertion of the manager into a slot.">node</a>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <a class="code" href="../../da/d0c/group__tcmi__slot__class.html#ga5447231fec5f42040c40307eb2e6a13c" title="&lt;&lt;public&gt;&gt; Unlocks the instance data">tcmi_slot_unlock</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a62fae8ec14ec1f7f1d143c5a130600e6" title="Reference to slot in an associated manager migmans vector.">manager_slot</a>);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga71f49cd0661e81a859daab82ae7676de_cgraph.png" border="0" usemap="#da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga71f49cd0661e81a859daab82ae7676de_cgraph" alt=""/></div>
<map name="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga71f49cd0661e81a859daab82ae7676de_cgraph" id="da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c_ga71f49cd0661e81a859daab82ae7676de_cgraph">
<area shape="rect" id="node2" href="../../da/d0c/group__tcmi__slot__class.html#ga109d6d783ebf06046f364f970f84da1f" title="&lt;&lt;public&gt;&gt; Locks the slot data." alt="" coords="209,5,316,32"/><area shape="rect" id="node3" href="../../da/d0c/group__tcmi__slot__class.html#ga5447231fec5f42040c40307eb2e6a13c" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="203,56,323,83"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_08d237fc27d4ecd563f71c5d52f2fecc.html">sources</a></li><li class="navelem"><a class="el" href="../../dir_08cfbe165ea603e6d179ff1f702f26c2.html">kernel_3.7.1</a></li><li class="navelem"><a class="el" href="../../dir_54993795d38a4b0939659b8e486bb0f5.html">src</a></li><li class="navelem"><a class="el" href="../../dir_d6db29d45a6ebf6e3bfdbb75b7b3a396.html">tcmi</a></li><li class="navelem"><a class="el" href="../../dir_365e98d2a2e8336e64ee556e1a9b8657.html">manager</a></li><li class="navelem"><a class="el" href="../../da/d3a/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8c.html">tcmi_migman.c</a></li>
    <li class="footer">Generated on Mon Apr 1 2013 16:10:35 for Clondike by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
