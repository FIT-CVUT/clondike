<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Clondike: C:/CLONDIKE/clondike/sources/kernel_3.7.1/src/tcmi/manager/tcmi_penmigman.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Clondike
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">tcmi_penmigman.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;tcmi/migration/tcmi_migcom.h&gt;</code><br/>
<code>#include &lt;tcmi/lib/tcmi_slotvec.h&gt;</code><br/>
<code>#include &lt;tcmi/task/tcmi_task.h&gt;</code><br/>
<code>#include &lt;linux/sched.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="../../d5/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8h_source.html">tcmi_penmigman.h</a>&quot;</code><br/>
<code>#include &lt;tcmi/comm/tcmi_authenticate_msg.h&gt;</code><br/>
<code>#include &lt;tcmi/comm/tcmi_authenticate_resp_msg.h&gt;</code><br/>
<code>#include &lt;arch/current/regs.h&gt;</code><br/>
<code>#include &lt;tcmi/lib/util.h&gt;</code><br/>
<code>#include &lt;director/director.h&gt;</code><br/>
<code>#include &lt;dbg.h&gt;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Include dependency graph for tcmi_penmigman.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d2/d4d/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c__incl.png" border="0" usemap="#C_1_2CLONDIKE_2clondike_2sources_2kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c" alt=""/></div>
<map name="C_1_2CLONDIKE_2clondike_2sources_2kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c" id="C_1_2CLONDIKE_2clondike_2sources_2kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c">
<area shape="rect" id="node6" href="../../d5/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8h.html" title="tcmi_penmigman.h" alt="" coords="699,133,831,160"/><area shape="rect" id="node8" href="../../de/de5/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__migman_8h.html" title="tcmi_migman.h" alt="" coords="710,224,820,251"/></map>
</div>
</div>
<p><a href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a4f0694ce0e5dbd84c293bed5a988c27b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c.html#a4f0694ce0e5dbd84c293bed5a988c27b">TCMI_PENMIGMAN_PRIVATE</a></td></tr>
<tr class="separator:a4f0694ce0e5dbd84c293bed5a988c27b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaff726802f28d813c892ca2b77595d4f7"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c.html#gaff726802f28d813c892ca2b77595d4f7">tcmi_penmigman_migrate_all_home</a> (void *obj, void *<a class="el" href="../../df/d60/kernel__3_87_81_2src_2tcmi_2migration_2tcmi__npm__params_8h.html#ab9090ca30e7609aecaf540276e3c5084">data</a>)</td></tr>
<tr class="memdesc:gaff726802f28d813c892ca2b77595d4f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forward declaration.  <a href="#gaff726802f28d813c892ca2b77595d4f7">More...</a><br/></td></tr>
<tr class="separator:gaff726802f28d813c892ca2b77595d4f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5886121e8f5d73c313590013fe1d4483"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d6f/group__tcmi__penmigman__class.html#ga5886121e8f5d73c313590013fe1d4483">tcmi_penmigman_new</a> (struct <a class="el" href="../../d6/d8e/group__kkc__sock__class.html#da/d0d/structkkc__sock">kkc_sock</a> *sock, u_int32_t pen_id, struct <a class="el" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot">tcmi_slot</a> *manager_slot, struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *root, struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *migproc, const char namefmt[],...)</td></tr>
<tr class="memdesc:ga5886121e8f5d73c313590013fe1d4483"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; TCMI PEN migration manager constructor.  <a href="../../d5/d6f/group__tcmi__penmigman__class.html#ga5886121e8f5d73c313590013fe1d4483">More...</a><br/></td></tr>
<tr class="separator:ga5886121e8f5d73c313590013fe1d4483"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga96c4eb74a06a273be361f4322ca39dac"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d6f/group__tcmi__penmigman__class.html#ga96c4eb74a06a273be361f4322ca39dac">tcmi_penmigman_auth_ccn</a> (struct <a class="el" href="../../d5/d6f/group__tcmi__penmigman__class.html#d0/dab/structtcmi__penmigman">tcmi_penmigman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, int auth_data_length, char *auth_data)</td></tr>
<tr class="memdesc:ga96c4eb74a06a273be361f4322ca39dac"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Authenticates at the CCN, expecting either a response (accept/refused)  <a href="../../d5/d6f/group__tcmi__penmigman__class.html#ga96c4eb74a06a273be361f4322ca39dac">More...</a><br/></td></tr>
<tr class="separator:ga96c4eb74a06a273be361f4322ca39dac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4984c2296b69744feb429e933b08938f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c.html#ga4984c2296b69744feb429e933b08938f">tcmi_penmigman_init_ctlfs_files</a> (struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:ga4984c2296b69744feb429e933b08938f"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Creates the static files described <a class="el" href="../../d5/d6f/group__tcmi__penmigman__class.html">here </a>.  <a href="#ga4984c2296b69744feb429e933b08938f">More...</a><br/></td></tr>
<tr class="separator:ga4984c2296b69744feb429e933b08938f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga136f6b2ad2a2346b466e6900d9e19e74"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c.html#ga136f6b2ad2a2346b466e6900d9e19e74">tcmi_penmigman_stop_ctlfs_files</a> (struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:ga136f6b2ad2a2346b466e6900d9e19e74"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Unregisters and releases all control files.  <a href="#ga136f6b2ad2a2346b466e6900d9e19e74">More...</a><br/></td></tr>
<tr class="separator:ga136f6b2ad2a2346b466e6900d9e19e74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga60d88d5a4aae2185ce26b3d961de471d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c.html#ga60d88d5a4aae2185ce26b3d961de471d">tcmi_penmigman_free</a> (struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="separator:ga60d88d5a4aae2185ce26b3d961de471d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac75cfd1ea24bce8404092334a6535f99"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c.html#gac75cfd1ea24bce8404092334a6535f99">tcmi_penmigman_stop</a> (struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, int remote_requested)</td></tr>
<tr class="memdesc:gac75cfd1ea24bce8404092334a6535f99"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Called on stop request  <a href="#gac75cfd1ea24bce8404092334a6535f99">More...</a><br/></td></tr>
<tr class="separator:gac75cfd1ea24bce8404092334a6535f99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadd618bb4ba277280303f9618cad4aa2d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c.html#gadd618bb4ba277280303f9618cad4aa2d">tcmi_penmigman_send_signal</a> (struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, int <a class="el" href="../../db/da0/kernel__3_87_81_2src_2tcmi_2comm_2tcmi__signal__msg_8h.html#ae0d46a978d5cd6707411f276ad869b9c">pid</a>, siginfo_t *<a class="el" href="../../db/da0/kernel__3_87_81_2src_2tcmi_2comm_2tcmi__signal__msg_8h.html#a7d5c5f5b173fb960963b2c44980dc940">info</a>)</td></tr>
<tr class="memdesc:gadd618bb4ba277280303f9618cad4aa2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Send dignal to process  <a href="#gadd618bb4ba277280303f9618cad4aa2d">More...</a><br/></td></tr>
<tr class="separator:gadd618bb4ba277280303f9618cad4aa2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga915f07674406d157f89c2c8e8732314d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c.html#ga915f07674406d157f89c2c8e8732314d">tcmi_penmigman_process_msg</a> (struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *m)</td></tr>
<tr class="memdesc:ga915f07674406d157f89c2c8e8732314d"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Processes a TCMI message m.  <a href="#ga915f07674406d157f89c2c8e8732314d">More...</a><br/></td></tr>
<tr class="separator:ga915f07674406d157f89c2c8e8732314d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga9d282b5399ed6662a0d78ecb02c50b22"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d6/d88/structtcmi__migman__ops">tcmi_migman_ops</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d6f/group__tcmi__penmigman__class.html#ga9d282b5399ed6662a0d78ecb02c50b22">penmigman_ops</a></td></tr>
<tr class="memdesc:ga9d282b5399ed6662a0d78ecb02c50b22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Migration manager operations that support polymorphism.  <a href="../../d5/d6f/group__tcmi__penmigman__class.html#ga9d282b5399ed6662a0d78ecb02c50b22">More...</a><br/></td></tr>
<tr class="separator:ga9d282b5399ed6662a0d78ecb02c50b22"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a4f0694ce0e5dbd84c293bed5a988c27b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCMI_PENMIGMAN_PRIVATE</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_source.html#l00037">37</a> of file <a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_source.html">tcmi_penmigman.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga60d88d5a4aae2185ce26b3d961de471d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_penmigman_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>TODO: We cannot do it so simply as this method won't get called if there are tasks pointing to the migman.. either tasks should not keep reference to migman or we better we have to introduce some 'stop' method, that is invoked before the free is performed. This stop will migrate everything back and so we wouldn't need to migrate back here, but we'd do that in the stop method</p>

<p>Definition at line <a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_source.html#l00219">219</a> of file <a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_source.html">tcmi_penmigman.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                                                                 {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">/* struct tcmi_penmigman *self_ppn  = TCMI_PENMIGMAN(self); */</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment"></span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">    /** </span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">        TODO: We cannot do it so simply as this method won&#39;t get called if there are tasks pointing to the migman.. either tasks should not keep reference to migman</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">        or we better we have to introduce some &#39;stop&#39; method, that is invoked before the free is performed. This stop will migrate everything back and so we wouldn&#39;t need</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">        to migrate back here, but we&#39;d do that in the stop method</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">//tcmi_penmigman_migrate_all_home(self, NULL);</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">/* TODO: Wait till all migrations are finished? */</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga4984c2296b69744feb429e933b08938f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_penmigman_init_ctlfs_files </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Creates the static files described <a class="el" href="../../d5/d6f/group__tcmi__penmigman__class.html">here </a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this migration manager instance </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon success </dd></dl>

<p>Definition at line <a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_source.html#l00154">154</a> of file <a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_source.html">tcmi_penmigman.c</a>.</p>

<p>References <a class="el" href="../../d4/d33/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__penmigman_8h_source.html#l00065">tcmi_penmigman::f_mighome_all</a>, <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d9/d03/kernel__2_86_833_81_2src_2proxyfs_2proxyfs__server_8c_source.html#l00059">self</a>, <a class="el" href="../../d0/def/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__file_8c_source.html#l00062">tcmi_ctlfs_intfile_new()</a>, <a class="el" href="../../d4/d33/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__penmigman_8h_source.html#l00071">TCMI_PENMIGMAN</a>, <a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_source.html#l00195">tcmi_penmigman_migrate_all_home()</a>, and <a class="el" href="../../d5/da2/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs_8h_source.html#l00089">TCMI_PERMS_FILE_W</a>.</p>
<div class="fragment"><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;{</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d5/d6f/group__tcmi__penmigman__class.html#d0/dab/structtcmi__penmigman" title="A compound structure that holds all current shadow processes and other migration related data...">tcmi_penmigman</a> *self_pen = <a class="code" href="../../d5/d6f/group__tcmi__penmigman__class.html#ga2b47f72edc90a1cdc1ae2d5560778f67" title="Casts to the CCN migration manager.">TCMI_PENMIGMAN</a>(<span class="keyword">self</span>);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO4, <span class="stringliteral">&quot;Creating TCMI ctlfs files - PEN migman&quot;</span>);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">if</span> (!(self_pen-&gt;<a class="code" href="../../d5/d6f/group__tcmi__penmigman__class.html#a8b68619b8d2eba6ef6299f116836a0b4" title="TCMI ctlfs - migrate-home-all file.">f_mighome_all</a> = </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;          <a class="code" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gac720ca77312808db7cbbc645be8e3541" title="&lt;&lt;public&gt;&gt; Creates a new instance of a file.">tcmi_ctlfs_intfile_new</a>(self-&gt;<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#a3551ff300819c9346483060594586873" title="TCMI ctlfs - directory where all migration control files/directories reside.">d_migman</a>, <a class="code" href="../../d9/d0a/group__tcmi__ctlfs__class.html#gaa901982b6e65df648201a7a7f80f232b" title="Preferred write file rights.">TCMI_PERMS_FILE_W</a>,</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                     <span class="keyword">self</span>, NULL, <a class="code" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c.html#gaff726802f28d813c892ca2b77595d4f7" title="Forward declaration.">tcmi_penmigman_migrate_all_home</a>,</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                    <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>),<span class="stringliteral">&quot;migrate-home-all&quot;</span>)))</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;exit0:</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_ga4984c2296b69744feb429e933b08938f_cgraph.png" border="0" usemap="#d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_ga4984c2296b69744feb429e933b08938f_cgraph" alt=""/></div>
<map name="d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_ga4984c2296b69744feb429e933b08938f_cgraph" id="d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_ga4984c2296b69744feb429e933b08938f_cgraph">
<area shape="rect" id="node2" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#gac720ca77312808db7cbbc645be8e3541" title="&lt;&lt;public&gt;&gt; Creates a new instance of a file." alt="" coords="213,27,358,53"/><area shape="rect" id="node3" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c.html#gaff726802f28d813c892ca2b77595d4f7" title="Forward declaration." alt="" coords="200,78,371,119"/><area shape="rect" id="node4" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="432,5,557,32"/><area shape="rect" id="node5" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="426,56,563,83"/><area shape="rect" id="node6" href="../../da/d93/group__tcmi__migcom__class.html#gadc5871d3fb9ab2901eabc69f9e3accc4" title="&lt;&lt;public&gt;&gt; Migrates a task back to its home node using preemptive migration with physical checkpoint ..." alt="" coords="419,107,570,149"/><area shape="rect" id="node7" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="425,173,564,200"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gaff726802f28d813c892ca2b77595d4f7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_penmigman_migrate_all_home </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Forward declaration. </p>
<p>&lt;&lt;private&gt;&gt; Emigrates all contained tasks back to home node The method is asynchrounous.</p>
<p>Migrate home requests are issued to all contained tasks, but we do not wait till the migration back is performed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*obj</td><td>- pointer to this migration manager instance </td></tr>
    <tr><td class="paramname">*data</td><td>- not used </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_source.html#l00195">195</a> of file <a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_source.html">tcmi_penmigman.c</a>.</p>

<p>References <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d9/d03/kernel__2_86_833_81_2src_2proxyfs_2proxyfs__server_8c_source.html#l00059">self</a>, <a class="el" href="../../d3/d2d/kernel__2_86_833_81_2src_2tcmi_2migration_2tcmi__migcom_8c_source.html#l00409">tcmi_migcom_migrate_home_ppm_p()</a>, <a class="el" href="../../df/d9b/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__migman_8h_source.html#l00180">TCMI_MIGMAN</a>, <a class="el" href="../../de/dd2/kernel__2_86_833_81_2src_2tcmi_2lib_2tcmi__slot_8h_source.html#l00071">tcmi_slot_entry</a>, <a class="el" href="../../de/dd2/kernel__2_86_833_81_2src_2tcmi_2lib_2tcmi__slot_8h_source.html#l00079">tcmi_slot_for_each</a>, <a class="el" href="../../db/d21/kernel__2_86_833_81_2src_2tcmi_2lib_2tcmi__slotvec_8h_source.html#l00100">tcmi_slotvec_for_each_used_slot</a>, <a class="el" href="../../db/d21/kernel__2_86_833_81_2src_2tcmi_2lib_2tcmi__slotvec_8h_source.html#l00226">tcmi_slotvec_lock()</a>, <a class="el" href="../../db/d21/kernel__2_86_833_81_2src_2tcmi_2lib_2tcmi__slotvec_8h_source.html#l00237">tcmi_slotvec_unlock()</a>, and <a class="el" href="../../d8/d48/kernel__2_86_833_81_2src_2tcmi_2task_2tcmi__task_8h_source.html#l00411">tcmi_task_local_pid()</a>.</p>

<p>Referenced by <a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_source.html#l00154">tcmi_penmigman_init_ctlfs_files()</a>, and <a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_source.html#l00238">tcmi_penmigman_stop()</a>.</p>
<div class="fragment"><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                                                  {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task" title="Compound structure that gathers necessary process information.">tcmi_task</a>* task;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot" title="A slot compound structure.">tcmi_slot</a> *slot;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="../../da/d0c/group__tcmi__slot__class.html#ga97f49e924fec185311972baf87d31897" title="A slot node is in fact a hlist node.">tcmi_slot_node_t</a>* node;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman" title="A compound structure that holds all current shadow processes and other migration related data...">tcmi_migman</a> *<span class="keyword">self</span>  = <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ga6e53ef2488c50427056d3a56e9b6c045" title="Casts to the migration manager.">TCMI_MIGMAN</a>(obj);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Penmigman migrate all home requested&quot;</span>);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">/* we protect the iteration so that migration backs do not interfere with the iteration */</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data.">tcmi_slotvec_lock</a>(<a class="code" href="../../d9/d03/kernel__2_86_833_81_2src_2proxyfs_2proxyfs__server_8c.html#acffc38573c809dad4512ce637724ab7e">self</a>-&gt;tasks);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">/* Iterate over all managed tasks */</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#ga49082f04567681a98c6d39eacbc1e4ed" title="Iterates through all used slots in the slot vector.">tcmi_slotvec_for_each_used_slot</a>(slot, <a class="code" href="../../d9/d03/kernel__2_86_833_81_2src_2proxyfs_2proxyfs__server_8c.html#acffc38573c809dad4512ce637724ab7e">self</a>-&gt;tasks) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <a class="code" href="../../da/d0c/group__tcmi__slot__class.html#ga344314dfdafec96ad6d8398963749fa4" title="&lt;&lt;public&gt;&gt; Iterates through all nodes in the slot.">tcmi_slot_for_each</a>(node, slot) {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            task = <a class="code" href="../../da/d0c/group__tcmi__slot__class.html#ga25ff69a7b6d4ba8ef5b85079c0320872" title="&lt;&lt;public&gt;&gt; Extracts the actual entry from a slot node">tcmi_slot_entry</a>(node, <span class="keyword">struct</span> <a class="code" href="../../de/d2f/group__tcmi__task__class.html#d1/dd2/structtcmi__task" title="Compound structure that gathers necessary process information.">tcmi_task</a>, node);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Sending migrate home request to task: local_pid=%d&quot;</span>, <a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor.">tcmi_task_local_pid</a>(task));</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <a class="code" href="../../da/d93/group__tcmi__migcom__class.html#gadc5871d3fb9ab2901eabc69f9e3accc4" title="&lt;&lt;public&gt;&gt; Migrates a task back to its home node using preemptive migration with physical checkpoint ...">tcmi_migcom_migrate_home_ppm_p</a>(<a class="code" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor.">tcmi_task_local_pid</a>(task));</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        };</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    };</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data.">tcmi_slotvec_unlock</a>(<a class="code" href="../../d9/d03/kernel__2_86_833_81_2src_2proxyfs_2proxyfs__server_8c.html#acffc38573c809dad4512ce637724ab7e">self</a>-&gt;tasks);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Penmigman migrate all home done&quot;</span>);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_gaff726802f28d813c892ca2b77595d4f7_cgraph.png" border="0" usemap="#d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_gaff726802f28d813c892ca2b77595d4f7_cgraph" alt=""/></div>
<map name="d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_gaff726802f28d813c892ca2b77595d4f7_cgraph" id="d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_gaff726802f28d813c892ca2b77595d4f7_cgraph">
<area shape="rect" id="node2" href="../../da/d93/group__tcmi__migcom__class.html#gadc5871d3fb9ab2901eabc69f9e3accc4" title="&lt;&lt;public&gt;&gt; Migrates a task back to its home node using preemptive migration with physical checkpoint ..." alt="" coords="225,5,375,46"/><area shape="rect" id="node3" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="237,71,363,97"/><area shape="rect" id="node4" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="231,121,369,148"/><area shape="rect" id="node5" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="231,172,369,199"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga915f07674406d157f89c2c8e8732314d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_penmigman_process_msg </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Processes a TCMI message m. </p>
<p>The message is disposed afterwords.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this migration manager instance </td></tr>
    <tr><td class="paramname">*m</td><td>- pointer to a message to be processed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_source.html#l00271">271</a> of file <a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_source.html">tcmi_penmigman.c</a>.</p>

<p>References <a class="el" href="../../d7/d4a/kernel__2_86_833_81_2src_2director_2director_8c_source.html#l00084">director_generic_user_message_recv()</a>, <a class="el" href="../../d2/d82/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__signal__msg_8h_source.html#l00071">info</a>, <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00221">minfo</a>, <a class="el" href="../../dc/d4d/kernel__2_86_833_81_2src_2tcmi_2migration_2fs_2fs__mount__params_8h_source.html#l00018">fs_mount_params::mount_device</a>, <a class="el" href="../../dc/d4d/kernel__2_86_833_81_2src_2tcmi_2migration_2fs_2fs__mount__params_8h_source.html#l00016">fs_mount_params::mount_options</a>, <a class="el" href="../../d4/d33/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__penmigman_8h_source.html#l00068">tcmi_penmigman::mount_params</a>, <a class="el" href="../../dc/d4d/kernel__2_86_833_81_2src_2tcmi_2migration_2fs_2fs__mount__params_8h_source.html#l00014">fs_mount_params::mount_type</a>, <a class="el" href="../../d2/d82/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__signal__msg_8h_source.html#l00069">pid</a>, <a class="el" href="../../df/d27/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__msg_8h_source.html#l00116">resp</a>, <a class="el" href="../../d5/d17/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__authenticate__resp__msg_8h_source.html#l00032">tcmi_authenticate_resp_msg::result_code</a>, <a class="el" href="../../d5/d17/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__authenticate__resp__msg_8h_source.html#l00050">TCMI_AUTHENTICATE_RESP_MSG</a>, <a class="el" href="../../d5/d17/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__authenticate__resp__msg_8h_source.html#l00069">tcmi_authenticate_resp_msg_arch()</a>, <a class="el" href="../../d5/d17/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__authenticate__resp__msg_8h_source.html#l00058">tcmi_authenticate_resp_msg_ccn_id()</a>, <a class="el" href="../../de/df5/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__messages__id_8h_source.html#l00120">TCMI_AUTHENTICATE_RESP_MSG_ID</a>, <a class="el" href="../../d5/d17/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__authenticate__resp__msg_8h_source.html#l00091">tcmi_authenticate_resp_msg_mount_params()</a>, <a class="el" href="../../db/d66/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__err__procmsg_8c_source.html#l00095">tcmi_err_procmsg_new_tx()</a>, <a class="el" href="../../dc/d03/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__generic__user__msg_8h_source.html#l00047">TCMI_GENERIC_USER_MSG</a>, <a class="el" href="../../de/df5/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__messages__id_8h_source.html#l00124">TCMI_GENERIC_USER_MSG_ID</a>, <a class="el" href="../../dc/d03/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__generic__user__msg_8h_source.html#l00055">tcmi_generic_user_msg_node_id()</a>, <a class="el" href="../../dc/d03/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__generic__user__msg_8h_source.html#l00077">tcmi_generic_user_msg_user_data()</a>, <a class="el" href="../../dc/d03/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__generic__user__msg_8h_source.html#l00066">tcmi_generic_user_msg_user_data_size()</a>, <a class="el" href="../../de/df5/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__messages__id_8h_source.html#l00134">TCMI_GUEST_STARTED_PROCMSG_ID</a>, <a class="el" href="../../d3/d2d/kernel__2_86_833_81_2src_2tcmi_2migration_2tcmi__migcom_8c_source.html#l00293">tcmi_migcom_immigrate()</a>, <a class="el" href="../../df/d9b/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__migman_8h_source.html#l00082">TCMI_MIGMAN_CONNECTED</a>, <a class="el" href="../../df/d9b/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__migman_8h_source.html#l00221">tcmi_migman_set_state()</a>, <a class="el" href="../../df/d9b/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__migman_8h_source.html#l00259">tcmi_migman_slot_index()</a>, <a class="el" href="../../df/d9b/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__migman_8h_source.html#l00307">tcmi_migman_sock()</a>, <a class="el" href="../../de/df5/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__messages__id_8h_source.html#l00102">TCMI_MSG_FLG_SET_ERR</a>, <a class="el" href="../../df/d27/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__msg_8h_source.html#l00231">tcmi_msg_id()</a>, <a class="el" href="../../df/d27/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__msg_8h_source.html#l00212">tcmi_msg_put()</a>, <a class="el" href="../../df/d27/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__msg_8h_source.html#l00255">tcmi_msg_req_id()</a>, <a class="el" href="../../dd/ddb/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__msg_8c_source.html#l00138">tcmi_msg_send_anonymous()</a>, <a class="el" href="../../d9/d05/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__p__emigrate__msg_8h_source.html#l00106">TCMI_P_EMIGRATE_MSG</a>, <a class="el" href="../../de/df5/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__messages__id_8h_source.html#l00122">TCMI_P_EMIGRATE_MSG_ID</a>, <a class="el" href="../../d9/d05/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__p__emigrate__msg_8h_source.html#l00114">tcmi_p_emigrate_msg_reply_pid()</a>, <a class="el" href="../../d4/d33/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__penmigman_8h_source.html#l00071">TCMI_PENMIGMAN</a>, <a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_source.html#l00249">tcmi_penmigman_send_signal()</a>, <a class="el" href="../../d2/d82/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__signal__msg_8h_source.html#l00084">TCMI_SIGNAL_MSG</a>, and <a class="el" href="../../de/df5/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__messages__id_8h_source.html#l00123">TCMI_SIGNAL_MSG_ID</a>.</p>

<p>Referenced by <a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_source.html#l00108">tcmi_penmigman_auth_ccn()</a>.</p>
<div class="fragment"><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;{</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d1/da3/group__tcmi__authenticate__resp__msg__class.html#d9/dc3/structtcmi__authenticate__resp__msg" title="Authentication response message structure.">tcmi_authenticate_resp_msg</a> *auth_msg;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d4/dbe/group__tcmi__generic__user__class.html#d3/de1/structtcmi__generic__user__msg" title="Generic user message structure.">tcmi_generic_user_msg</a> *user_msg;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg" title="A coumpound structure that carries a generic TCMI message.">tcmi_msg</a> *<a class="code" href="../../df/d27/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__msg_8h.html#adb26817b6c4a9eeb3f68c832f24d5471" title="response transaction ID">resp</a>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d5/d6f/group__tcmi__penmigman__class.html#d0/dab/structtcmi__penmigman" title="A compound structure that holds all current shadow processes and other migration related data...">tcmi_penmigman</a> *self_pen  = <a class="code" href="../../d5/d6f/group__tcmi__penmigman__class.html#ga2b47f72edc90a1cdc1ae2d5560778f67" title="Casts to the CCN migration manager.">TCMI_PENMIGMAN</a>(<span class="keyword">self</span>);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordtype">int</span> err;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO4, <span class="stringliteral">&quot;Processing message (%p)&quot;</span>, m);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordflow">if</span> ( !m )</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">switch</span>(<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ga73489766817f528da25369a3f4c713a1" title="&lt;&lt;public&gt;&gt; Message ID accessor.">tcmi_msg_id</a>(m)) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#ggadc29c2ff13d900c2f185ee95427fb06caedb4f23136a59cd9caf5c956bdf8a0a9">TCMI_AUTHENTICATE_RESP_MSG_ID</a>:</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            auth_msg = <a class="code" href="../../d1/da3/group__tcmi__authenticate__resp__msg__class.html#gaeb1f65f095d420c04a64126b4b386a69" title="Casts to the tcmi_authenticate_resp_msg instance.">TCMI_AUTHENTICATE_RESP_MSG</a>(m);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            <span class="keywordflow">if</span> ( auth_msg-&gt;<a class="code" href="../../d1/da3/group__tcmi__authenticate__resp__msg__class.html#a7f84cbc5f4bc978ac930f274310c6394" title="0 if authentication succeeded, negative otherwise">result_code</a> == 0) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(INFO1, <span class="stringliteral">&quot;Authentication at CCN successful..&quot;</span>);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                <span class="keyword">self</span>-&gt;peer_arch_type = <a class="code" href="../../d1/da3/group__tcmi__authenticate__resp__msg__class.html#gad69a30de4d22734a3830a8513e2b336b" title="&lt;&lt;public&gt;&gt; CCN architecture getter">tcmi_authenticate_resp_msg_arch</a>(auth_msg);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                <span class="keyword">self</span>-&gt;ccn_id = <a class="code" href="../../d1/da3/group__tcmi__authenticate__resp__msg__class.html#ga8dedce1c52ab3d0738f155fc27922972" title="&lt;&lt;public&gt;&gt; CCN id getter">tcmi_authenticate_resp_msg_ccn_id</a>(auth_msg);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                self_pen-&gt;<a class="code" href="../../d5/d6f/group__tcmi__penmigman__class.html#abd5433771cf003ae1a23b3f926167453" title="Mount params to be used when starting processes from associated CCN.">mount_params</a> = *<a class="code" href="../../d1/da3/group__tcmi__authenticate__resp__msg__class.html#gaa8d32a4dae0d024544ff29c1482e4606" title="&lt;&lt;public&gt;&gt; Mount params getter">tcmi_authenticate_resp_msg_mount_params</a>(auth_msg);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(INFO1, <span class="stringliteral">&quot;received mount_params - type: %s device: %s options: %s&quot;</span>, </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                        self_pen-&gt;<a class="code" href="../../d5/d6f/group__tcmi__penmigman__class.html#abd5433771cf003ae1a23b3f926167453" title="Mount params to be used when starting processes from associated CCN.">mount_params</a>.<a class="code" href="../../d4/d45/kernel__3_87_81_2src_2tcmi_2migration_2fs_2fs__mount__params_8h.html#a6a62a16e0834dad4ab2f05bf30201f1b" title="Mounter to be used.">mount_type</a>, self_pen-&gt;<a class="code" href="../../d5/d6f/group__tcmi__penmigman__class.html#abd5433771cf003ae1a23b3f926167453" title="Mount params to be used when starting processes from associated CCN.">mount_params</a>.<a class="code" href="../../d4/d45/kernel__3_87_81_2src_2tcmi_2migration_2fs_2fs__mount__params_8h.html#a301fde241f73fd71d2a3df629a66d9fb" title="Mounter device.">mount_device</a>,</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                        self_pen-&gt;<a class="code" href="../../d5/d6f/group__tcmi__penmigman__class.html#abd5433771cf003ae1a23b3f926167453" title="Mount params to be used when starting processes from associated CCN.">mount_params</a>.<a class="code" href="../../d4/d45/kernel__3_87_81_2src_2tcmi_2migration_2fs_2fs__mount__params_8h.html#a1755c06a7baa97849a43e2fd22128d2b" title="Mounter options.">mount_options</a>);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ga1826451d879f914f53f0717f363aa914" title="&lt;&lt;public&gt;&gt; Set atomically a new state of the migration manager.">tcmi_migman_set_state</a>(<span class="keyword">self</span>, <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#gga94094c5c702e25dbb12be0bb63b32875a5b1ca754502cdb6ddba6b3a263e2a919">TCMI_MIGMAN_CONNECTED</a>);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(INFO1, <span class="stringliteral">&quot;Authentication at CCN failed with error=%d..&quot;</span>, auth_msg-&gt;<a class="code" href="../../d1/da3/group__tcmi__authenticate__resp__msg__class.html#a7f84cbc5f4bc978ac930f274310c6394" title="0 if authentication succeeded, negative otherwise">result_code</a>);            </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#gaa343f0b91b9cee9415f0fcf40f53b2ea" title="Sets an error flag.">TCMI_MSG_FLG_SET_ERR</a>(<a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#ggadc29c2ff13d900c2f185ee95427fb06caedb4f23136a59cd9caf5c956bdf8a0a9">TCMI_AUTHENTICATE_RESP_MSG_ID</a>):</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(INFO1, <span class="stringliteral">&quot;Authentication at CCN failed, error received..&quot;</span>);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#ggadc29c2ff13d900c2f185ee95427fb06cae115fae7de14598b32a901acae956b96">TCMI_SIGNAL_MSG_ID</a>:</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            <a class="code" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c.html#gadd618bb4ba277280303f9618cad4aa2d" title="&lt;&lt;public&gt;&gt; Send dignal to process">tcmi_penmigman_send_signal</a>(<span class="keyword">self</span>, <a class="code" href="../../d8/d7b/group__tcmi__signal__msg__class.html#gafd6fa599c2c163886f9690c63f0ce253" title="Casts to the tcmi_signal_msg instance.">TCMI_SIGNAL_MSG</a>(m)-&gt;<a class="code" href="../../d2/d82/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__signal__msg_8h.html#ae0d46a978d5cd6707411f276ad869b9c" title="Target PID.">pid</a>,</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                    &amp;<a class="code" href="../../d8/d7b/group__tcmi__signal__msg__class.html#gafd6fa599c2c163886f9690c63f0ce253" title="Casts to the tcmi_signal_msg instance.">TCMI_SIGNAL_MSG</a>(m)-&gt;<a class="code" href="../../d2/d82/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__signal__msg_8h.html#a7d5c5f5b173fb960963b2c44980dc940" title="Siginfo structure (we can use directly this structure as it is padded to be exactly 128 bytes)...">info</a>);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#ggadc29c2ff13d900c2f185ee95427fb06caa8805a547c5695d62df4ae7e7b91e845">TCMI_P_EMIGRATE_MSG_ID</a>:</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(INFO1, <span class="stringliteral">&quot;Physical emigrate message has arrived..&quot;</span>);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../da/d93/group__tcmi__migcom__class.html#ga5a1e3a32dd2d833a0dbba0da47daaa1d" title="&lt;&lt;public&gt;&gt; Immigrates a task - handles accepting the task on the PEN side.">tcmi_migcom_immigrate</a>(m, <span class="keyword">self</span>) &lt; 0) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(ERR3, <span class="stringliteral">&quot;Error immigrating process&quot;</span>);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                                                </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                <span class="keywordflow">if</span> (!(resp = <a class="code" href="../../d2/d60/group__tcmi__err__procmsg__class.html#gae5322efeefc565378866b96c6cb101b3" title="&lt;&lt;public&gt;&gt; Error message constructor for transferring.">tcmi_err_procmsg_new_tx</a>(<a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#gga61dadd085c1777f559549e05962b2c9ea1fff522372aae1c3fa549658ef13d5ab">TCMI_GUEST_STARTED_PROCMSG_ID</a>, <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ga5a09e9d377637eba6c3df1236fc97926" title="&lt;&lt;public&gt;&gt; Request transaction ID accessor.">tcmi_msg_req_id</a>(m), -EINVAL, <a class="code" href="../../df/df9/group__tcmi__p__emigrate__msg__class.html#ga4a20154039e0b8fe71be244c0cdb0919" title="&lt;&lt;public&gt;&gt; Remote PID accessor.">tcmi_p_emigrate_msg_reply_pid</a>(<a class="code" href="../../df/df9/group__tcmi__p__emigrate__msg__class.html#gaff84a941c39a708a128fb640ede3e9b4" title="Casts to the tcmi_p_emigrate_msg instance.">TCMI_P_EMIGRATE_MSG</a>(m))))) {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                      <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(ERR3, <span class="stringliteral">&quot;Failed to send error response&quot;</span>);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                      <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ga7a8fe8cbfd4b25c15589c8599f66e574" title="&lt;&lt;public&gt;&gt; Sends a message via a specified connection.">tcmi_msg_send_anonymous</a>(resp, <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#ga91bf5b41a1d4faa3eab11e6867ec34e4" title="&lt;&lt;public&gt;&gt; Communication socket accesor.">tcmi_migman_sock</a>(<span class="keyword">self</span>));                      </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#ggadc29c2ff13d900c2f185ee95427fb06ca0573d290a5baa0461010cca329e9f7de">TCMI_GENERIC_USER_MSG_ID</a>:</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            user_msg = <a class="code" href="../../d4/dbe/group__tcmi__generic__user__class.html#gaf01d78e69ce5a8dafea3b986c1ef5485" title="Casts to the tcmi_generic_user_msg instance.">TCMI_GENERIC_USER_MSG</a>(m);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(INFO1, <span class="stringliteral">&quot;User message arrived in pen.&quot;</span>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            err = <a class="code" href="../../d7/d4a/kernel__2_86_833_81_2src_2director_2director_8c.html#ad03eefeffc228336be26ea451c990a8b" title="Called, when a generic user message arrives.">director_generic_user_message_recv</a>(<a class="code" href="../../d4/dbe/group__tcmi__generic__user__class.html#gac4823fe4153e1c15518c1a4837abd1da" title="&lt;&lt;public&gt;&gt; Node id getter">tcmi_generic_user_msg_node_id</a>(user_msg), 0, <a class="code" href="../../d6/da2/group__tcmi__migman__class.html#gafca6221a82ff480ee067fcfa39745719" title="&lt;&lt;public&gt;&gt; Migration manager slot index getter">tcmi_migman_slot_index</a>(<span class="keyword">self</span>), <a class="code" href="../../d4/dbe/group__tcmi__generic__user__class.html#ga5c50da2fa82cf7efcc7e2673a71b5952" title="&lt;&lt;public&gt;&gt; User data length getter">tcmi_generic_user_msg_user_data_size</a>(user_msg), <a class="code" href="../../d4/dbe/group__tcmi__generic__user__class.html#gad7a3e40e415de6dafa25c1d914a1ec56" title="&lt;&lt;public&gt;&gt; User data data getter">tcmi_generic_user_msg_user_data</a>(user_msg));</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            <span class="keywordflow">if</span> ( err ) {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Error in processing user message %d&quot;</span>, err);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(INFO1, <span class="stringliteral">&quot;Unexpected message ID %x, no handler available.&quot;</span>, </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ga73489766817f528da25369a3f4c713a1" title="&lt;&lt;public&gt;&gt; Message ID accessor.">tcmi_msg_id</a>(m));</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">/* release the message */</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined...">tcmi_msg_put</a>(m);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_ga915f07674406d157f89c2c8e8732314d_cgraph.png" border="0" usemap="#d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_ga915f07674406d157f89c2c8e8732314d_cgraph" alt=""/></div>
<map name="d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_ga915f07674406d157f89c2c8e8732314d_cgraph" id="d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_ga915f07674406d157f89c2c8e8732314d_cgraph">
<area shape="rect" id="node2" href="../../d7/d4a/kernel__2_86_833_81_2src_2director_2director_8c.html#ad03eefeffc228336be26ea451c990a8b" title="Called, when a generic user message arrives." alt="" coords="283,5,429,46"/><area shape="rect" id="node3" href="../../d1/da3/group__tcmi__authenticate__resp__msg__class.html#gad69a30de4d22734a3830a8513e2b336b" title="&lt;&lt;public&gt;&gt; CCN architecture getter" alt="" coords="277,70,435,111"/><area shape="rect" id="node4" href="../../d1/da3/group__tcmi__authenticate__resp__msg__class.html#ga8dedce1c52ab3d0738f155fc27922972" title="&lt;&lt;public&gt;&gt; CCN id getter" alt="" coords="277,135,435,177"/><area shape="rect" id="node5" href="../../d1/da3/group__tcmi__authenticate__resp__msg__class.html#gaa8d32a4dae0d024544ff29c1482e4606" title="&lt;&lt;public&gt;&gt; Mount params getter" alt="" coords="277,201,435,242"/><area shape="rect" id="node6" href="../../d2/d60/group__tcmi__err__procmsg__class.html#gae5322efeefc565378866b96c6cb101b3" title="&lt;&lt;public&gt;&gt; Error message constructor for transferring." alt="" coords="269,267,443,293"/><area shape="rect" id="node7" href="../../d4/dbe/group__tcmi__generic__user__class.html#gac4823fe4153e1c15518c1a4837abd1da" title="&lt;&lt;public&gt;&gt; Node id getter" alt="" coords="276,318,436,359"/><area shape="rect" id="node8" href="../../d4/dbe/group__tcmi__generic__user__class.html#gad7a3e40e415de6dafa25c1d914a1ec56" title="&lt;&lt;public&gt;&gt; User data data getter" alt="" coords="276,383,436,425"/><area shape="rect" id="node9" href="../../d4/dbe/group__tcmi__generic__user__class.html#ga5c50da2fa82cf7efcc7e2673a71b5952" title="&lt;&lt;public&gt;&gt; User data length getter" alt="" coords="276,449,436,490"/><area shape="rect" id="node10" href="../../da/d93/group__tcmi__migcom__class.html#ga5a1e3a32dd2d833a0dbba0da47daaa1d" title="&lt;&lt;public&gt;&gt; Immigrates a task &#45; handles accepting the task on the PEN side." alt="" coords="274,515,438,541"/><area shape="rect" id="node11" href="../../d6/da2/group__tcmi__migman__class.html#ga1826451d879f914f53f0717f363aa914" title="&lt;&lt;public&gt;&gt; Set atomically a new state of the migration manager." alt="" coords="275,565,437,592"/><area shape="rect" id="node12" href="../../d6/da2/group__tcmi__migman__class.html#gafca6221a82ff480ee067fcfa39745719" title="&lt;&lt;public&gt;&gt; Migration manager slot index getter" alt="" coords="273,616,439,643"/><area shape="rect" id="node14" href="../../d6/da2/group__tcmi__migman__class.html#ga91bf5b41a1d4faa3eab11e6867ec34e4" title="&lt;&lt;public&gt;&gt; Communication socket accesor." alt="" coords="289,667,423,693"/><area shape="rect" id="node16" href="../../d6/dc2/group__tcmi__msg__class.html#ga73489766817f528da25369a3f4c713a1" title="&lt;&lt;public&gt;&gt; Message ID accessor." alt="" coords="308,717,404,744"/><area shape="rect" id="node17" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281" title="&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined..." alt="" coords="304,768,408,795"/><area shape="rect" id="node19" href="../../d6/dc2/group__tcmi__msg__class.html#ga5a09e9d377637eba6c3df1236fc97926" title="&lt;&lt;public&gt;&gt; Request transaction ID accessor." alt="" coords="295,819,417,845"/><area shape="rect" id="node20" href="../../d6/dc2/group__tcmi__msg__class.html#ga7a8fe8cbfd4b25c15589c8599f66e574" title="&lt;&lt;public&gt;&gt; Sends a message via a specified connection." alt="" coords="262,869,450,896"/><area shape="rect" id="node21" href="../../df/df9/group__tcmi__p__emigrate__msg__class.html#ga4a20154039e0b8fe71be244c0cdb0919" title="&lt;&lt;public&gt;&gt; Remote PID accessor." alt="" coords="281,921,431,962"/><area shape="rect" id="node22" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c.html#gadd618bb4ba277280303f9618cad4aa2d" title="&lt;&lt;public&gt;&gt; Send dignal to process" alt="" coords="278,986,434,1027"/><area shape="rect" id="node13" href="../../da/d0c/group__tcmi__slot__class.html#ga821f6b686443bfc7fff52dd3b155de37" title="&lt;&lt;public&gt;&gt; Slot index accessor." alt="" coords="527,616,641,643"/><area shape="rect" id="node15" href="../../d3/d7e/group__tcmi__sock__class.html#ga8573cfac9adbb5996cd90395d8a78502" title="&lt;&lt;public&gt;&gt; KKC socket accessor." alt="" coords="499,667,669,693"/><area shape="rect" id="node18" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2748d267a8fddd1ced86e73ba8efd079" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="513,768,655,795"/><area shape="rect" id="node23" href="../../d7/d75/kernel__2_86_833_81_2src_2tcmi_2lib_2util_8h.html#a5f449355b8f54aaed664de85f89092ea" title="task_find_by_pid" alt="" coords="525,993,643,1020"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gadd618bb4ba277280303f9618cad4aa2d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_penmigman_send_signal </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">siginfo_t *&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Send dignal to process </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this penmigman instance </td></tr>
    <tr><td class="paramname">pid</td><td>- signal target pid </td></tr>
    <tr><td class="paramname">*info</td><td>- info for signal to be send </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_source.html#l00249">249</a> of file <a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_source.html">tcmi_penmigman.c</a>.</p>

<p>References <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00220">mdbg</a>, and <a class="el" href="../../d7/d75/kernel__2_86_833_81_2src_2tcmi_2lib_2util_8h_source.html#l00007">task_find_by_pid()</a>.</p>

<p>Referenced by <a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_source.html#l00271">tcmi_penmigman_process_msg()</a>.</p>
<div class="fragment"><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;{</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordtype">int</span> sig;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keyword">struct </span>task_struct *task;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    rcu_read_lock();</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    task = <a class="code" href="../../d7/d75/kernel__2_86_833_81_2src_2tcmi_2lib_2util_8h.html#a5f449355b8f54aaed664de85f89092ea">task_find_by_pid</a>(<a class="code" href="../../d2/d82/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__signal__msg_8h.html#ae0d46a978d5cd6707411f276ad869b9c" title="Target PID.">pid</a>);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    rcu_read_unlock();</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    sig = <a class="code" href="../../d2/d82/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__signal__msg_8h.html#a7d5c5f5b173fb960963b2c44980dc940" title="Siginfo structure (we can use directly this structure as it is padded to be exactly 128 bytes)...">info</a>-&gt;si_signo;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO2, <span class="stringliteral">&quot;Sending signal %d to task %p (PID %d)&quot;</span>, sig, task, <a class="code" href="../../d2/d82/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__signal__msg_8h.html#ae0d46a978d5cd6707411f276ad869b9c" title="Target PID.">pid</a>);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">if</span>(task)</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        send_sig_info(sig, <a class="code" href="../../d2/d82/kernel__2_86_833_81_2src_2tcmi_2comm_2tcmi__signal__msg_8h.html#a7d5c5f5b173fb960963b2c44980dc940" title="Siginfo structure (we can use directly this structure as it is padded to be exactly 128 bytes)...">info</a>, task);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_gadd618bb4ba277280303f9618cad4aa2d_cgraph.png" border="0" usemap="#d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_gadd618bb4ba277280303f9618cad4aa2d_cgraph" alt=""/></div>
<map name="d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_gadd618bb4ba277280303f9618cad4aa2d_cgraph" id="d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_gadd618bb4ba277280303f9618cad4aa2d_cgraph">
<area shape="rect" id="node2" href="../../d7/d75/kernel__2_86_833_81_2src_2tcmi_2lib_2util_8h.html#a5f449355b8f54aaed664de85f89092ea" title="task_find_by_pid" alt="" coords="211,12,330,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gac75cfd1ea24bce8404092334a6535f99"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_penmigman_stop </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>remote_requested</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Called on stop request </p>
<p>Emigrates all contained tasks back to home node (asynchronously - only emigration requests are issued in context of this method)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this migration manager instance </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_source.html#l00238">238</a> of file <a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_source.html">tcmi_penmigman.c</a>.</p>

<p>References <a class="el" href="../../d7/d4a/kernel__2_86_833_81_2src_2director_2director_8c_source.html#l00076">director_node_disconnected()</a>, <a class="el" href="../../df/d9b/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__migman_8h_source.html#l00259">tcmi_migman_slot_index()</a>, and <a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_source.html#l00195">tcmi_penmigman_migrate_all_home()</a>.</p>
<div class="fragment"><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                                                                                {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c.html#gaff726802f28d813c892ca2b77595d4f7" title="Forward declaration.">tcmi_penmigman_migrate_all_home</a>(<span class="keyword">self</span>, NULL);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="../../d7/d4a/kernel__2_86_833_81_2src_2director_2director_8c.html#ad59c56c478f3a91729eded5d6da33615" title="Called, when a peer node disconnets.">director_node_disconnected</a>(<a class="code" href="../../d6/da2/group__tcmi__migman__class.html#gafca6221a82ff480ee067fcfa39745719" title="&lt;&lt;public&gt;&gt; Migration manager slot index getter">tcmi_migman_slot_index</a>(<span class="keyword">self</span>), 0, remote_requested);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_gac75cfd1ea24bce8404092334a6535f99_cgraph.png" border="0" usemap="#d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_gac75cfd1ea24bce8404092334a6535f99_cgraph" alt=""/></div>
<map name="d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_gac75cfd1ea24bce8404092334a6535f99_cgraph" id="d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_gac75cfd1ea24bce8404092334a6535f99_cgraph">
<area shape="rect" id="node2" href="../../d7/d4a/kernel__2_86_833_81_2src_2director_2director_8c.html#ad59c56c478f3a91729eded5d6da33615" title="Called, when a peer node disconnets." alt="" coords="208,5,392,32"/><area shape="rect" id="node3" href="../../d6/da2/group__tcmi__migman__class.html#gafca6221a82ff480ee067fcfa39745719" title="&lt;&lt;public&gt;&gt; Migration manager slot index getter" alt="" coords="217,56,383,83"/><area shape="rect" id="node5" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c.html#gaff726802f28d813c892ca2b77595d4f7" title="Forward declaration." alt="" coords="215,137,385,178"/><area shape="rect" id="node4" href="../../da/d0c/group__tcmi__slot__class.html#ga821f6b686443bfc7fff52dd3b155de37" title="&lt;&lt;public&gt;&gt; Slot index accessor." alt="" coords="459,27,573,53"/><area shape="rect" id="node6" href="../../da/d93/group__tcmi__migcom__class.html#gadc5871d3fb9ab2901eabc69f9e3accc4" title="&lt;&lt;public&gt;&gt; Migrates a task back to its home node using preemptive migration with physical checkpoint ..." alt="" coords="441,78,591,119"/><area shape="rect" id="node7" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="453,144,579,171"/><area shape="rect" id="node8" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="447,195,585,221"/><area shape="rect" id="node9" href="../../de/d2f/group__tcmi__task__class.html#ga0232aeae006148ffa6c760e7f1979865" title="&lt;&lt;public&gt;&gt; Local PID accessor." alt="" coords="447,245,585,272"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga136f6b2ad2a2346b466e6900d9e19e74"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_penmigman_stop_ctlfs_files </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/da2/group__tcmi__migman__class.html#d2/d8c/structtcmi__migman">tcmi_migman</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Unregisters and releases all control files. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this migration manager instance </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_source.html#l00177">177</a> of file <a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_source.html">tcmi_penmigman.c</a>.</p>

<p>References <a class="el" href="../../d4/d33/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__penmigman_8h_source.html#l00065">tcmi_penmigman::f_mighome_all</a>, <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d6/d77/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8h_source.html#l00214">tcmi_ctlfs_entry_put()</a>, <a class="el" href="../../d0/def/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__file_8c_source.html#l00154">tcmi_ctlfs_file_unregister()</a>, and <a class="el" href="../../d4/d33/kernel__2_86_833_81_2src_2tcmi_2manager_2tcmi__penmigman_8h_source.html#l00071">TCMI_PENMIGMAN</a>.</p>
<div class="fragment"><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;{</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d5/d6f/group__tcmi__penmigman__class.html#d0/dab/structtcmi__penmigman" title="A compound structure that holds all current shadow processes and other migration related data...">tcmi_penmigman</a> *self_pen = <a class="code" href="../../d5/d6f/group__tcmi__penmigman__class.html#ga2b47f72edc90a1cdc1ae2d5560778f67" title="Casts to the CCN migration manager.">TCMI_PENMIGMAN</a>(<span class="keyword">self</span>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Destroying  TCMI ctlfs files - PEN migman&quot;</span>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga665210941a04fda118949874767ced93" title="&lt;&lt;public&gt;&gt; This method unregisters the file uses the semaphore lock as protection from races...">tcmi_ctlfs_file_unregister</a>(self_pen-&gt;<a class="code" href="../../d5/d6f/group__tcmi__penmigman__class.html#a8b68619b8d2eba6ef6299f116836a0b4" title="TCMI ctlfs - migrate-home-all file.">f_mighome_all</a>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d...">tcmi_ctlfs_entry_put</a>(self_pen-&gt;<a class="code" href="../../d5/d6f/group__tcmi__penmigman__class.html#a8b68619b8d2eba6ef6299f116836a0b4" title="TCMI ctlfs - migrate-home-all file.">f_mighome_all</a>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_ga136f6b2ad2a2346b466e6900d9e19e74_cgraph.png" border="0" usemap="#d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_ga136f6b2ad2a2346b466e6900d9e19e74_cgraph" alt=""/></div>
<map name="d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_ga136f6b2ad2a2346b466e6900d9e19e74_cgraph" id="d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c_ga136f6b2ad2a2346b466e6900d9e19e74_cgraph">
<area shape="rect" id="node2" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6d6cbcd957efaaa590b335ac3150bb30" title="&lt;&lt;public&gt;&gt; Calls the instance custom put method(if any) and Decrements the reference counter of the d..." alt="" coords="221,5,360,32"/><area shape="rect" id="node4" href="../../d1/de7/group__tcmi__ctlfs__file__class.html#ga665210941a04fda118949874767ced93" title="&lt;&lt;public&gt;&gt; This method unregisters the file uses the semaphore lock as protection from races..." alt="" coords="208,56,373,83"/><area shape="rect" id="node3" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga986b629882729daaf2c9607bfca57c3c" title="&lt;&lt;public&gt;&gt; Entry name accessor." alt="" coords="422,5,575,32"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_08d237fc27d4ecd563f71c5d52f2fecc.html">sources</a></li><li class="navelem"><a class="el" href="../../dir_08cfbe165ea603e6d179ff1f702f26c2.html">kernel_3.7.1</a></li><li class="navelem"><a class="el" href="../../dir_54993795d38a4b0939659b8e486bb0f5.html">src</a></li><li class="navelem"><a class="el" href="../../dir_d6db29d45a6ebf6e3bfdbb75b7b3a396.html">tcmi</a></li><li class="navelem"><a class="el" href="../../dir_365e98d2a2e8336e64ee556e1a9b8657.html">manager</a></li><li class="navelem"><a class="el" href="../../d9/de8/kernel__3_87_81_2src_2tcmi_2manager_2tcmi__penmigman_8c.html">tcmi_penmigman.c</a></li>
    <li class="footer">Generated on Mon Apr 1 2013 16:10:39 for Clondike by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
