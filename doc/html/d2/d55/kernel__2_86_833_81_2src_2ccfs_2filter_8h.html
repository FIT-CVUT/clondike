<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Clondike: C:/CLONDIKE/clondike/sources/kernel_2.6.33.1/src/ccfs/filter.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Clondike
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d2/d55/kernel__2_86_833_81_2src_2ccfs_2filter_8h.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">filter.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d6/d4c/kernel__2_86_833_81_2src_2ccfs_2filter_8h__dep__incl.png" border="0" usemap="#C_1_2CLONDIKE_2clondike_2sources_2kernel__2_86_833_81_2src_2ccfs_2filter_8hdep" alt=""/></div>
<map name="C_1_2CLONDIKE_2clondike_2sources_2kernel__2_86_833_81_2src_2ccfs_2filter_8hdep" id="C_1_2CLONDIKE_2clondike_2sources_2kernel__2_86_833_81_2src_2ccfs_2filter_8hdep">
<area shape="rect" id="node2" href="../../d5/dc0/kernel__2_86_833_81_2src_2ccfs_2ccfs_8h.html" title="C:/CLONDIKE/clondike\l/sources/kernel_2.6.33.1\l/src/ccfs/ccfs.h" alt="" coords="573,109,739,165"/><area shape="rect" id="node10" href="../../d8/df1/kernel__2_86_833_81_2src_2ccfs_2filter_8c.html" title="C:/CLONDIKE/clondike\l/sources/kernel_2.6.33.1\l/src/ccfs/filter.c" alt="" coords="763,109,928,165"/><area shape="rect" id="node3" href="../../dd/d66/kernel__2_86_833_81_2src_2ccfs_2dentry_8c.html" title="C:/CLONDIKE/clondike\l/sources/kernel_2.6.33.1\l/src/ccfs/dentry.c" alt="" coords="5,213,171,269"/><area shape="rect" id="node4" href="../../df/dd6/kernel__2_86_833_81_2src_2ccfs_2file_8c.html" title="C:/CLONDIKE/clondike\l/sources/kernel_2.6.33.1\l/src/ccfs/file.c" alt="" coords="195,213,360,269"/><area shape="rect" id="node5" href="../../de/d43/kernel__2_86_833_81_2src_2ccfs_2inode_8c.html" title="C:/CLONDIKE/clondike\l/sources/kernel_2.6.33.1\l/src/ccfs/inode.c" alt="" coords="384,213,549,269"/><area shape="rect" id="node6" href="../../d8/d11/kernel__2_86_833_81_2src_2ccfs_2main_8c.html" title="C:/CLONDIKE/clondike\l/sources/kernel_2.6.33.1\l/src/ccfs/main.c" alt="" coords="573,213,739,269"/><area shape="rect" id="node7" href="../../d5/d52/kernel__2_86_833_81_2src_2ccfs_2mmap_8c.html" title="C:/CLONDIKE/clondike\l/sources/kernel_2.6.33.1\l/src/ccfs/mmap.c" alt="" coords="763,213,928,269"/><area shape="rect" id="node8" href="../../da/d6e/kernel__2_86_833_81_2src_2ccfs_2read__write_8c.html" title="C:/CLONDIKE/clondike\l/sources/kernel_2.6.33.1\l/src/ccfs/read_write.c" alt="" coords="952,213,1117,269"/><area shape="rect" id="node9" href="../../d7/dd4/kernel__2_86_833_81_2src_2ccfs_2super_8c.html" title="C:/CLONDIKE/clondike\l/sources/kernel_2.6.33.1\l/src/ccfs/super.c" alt="" coords="1141,213,1307,269"/></map>
</div>
</div>
<p><a href="../../d2/d55/kernel__2_86_833_81_2src_2ccfs_2filter_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:d2/d9e/structfilter"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/kernel__3_87_81_2src_2ccfs_2filter_8h.html#d2/d9e/structfilter">filter</a></td></tr>
<tr class="memdesc:d2/d9e/structfilter"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container of filters.  <a href="../../dd/db2/kernel__3_87_81_2src_2ccfs_2filter_8h.html#d2/d9e/structfilter">More...</a><br/></td></tr>
<tr class="separator:d2/d9e/structfilter"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af5b8b6927e23132bc034e75a5956a107"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../dd/db2/kernel__3_87_81_2src_2ccfs_2filter_8h.html#d2/d9e/structfilter">filter</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d55/kernel__2_86_833_81_2src_2ccfs_2filter_8h.html#af5b8b6927e23132bc034e75a5956a107">create_filter</a> (void)</td></tr>
<tr class="separator:af5b8b6927e23132bc034e75a5956a107"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7889c58e021a442a2a428a598dfd6a5a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d55/kernel__2_86_833_81_2src_2ccfs_2filter_8h.html#a7889c58e021a442a2a428a598dfd6a5a">destroy_filter</a> (struct <a class="el" href="../../dd/db2/kernel__3_87_81_2src_2ccfs_2filter_8h.html#d2/d9e/structfilter">filter</a> *<a class="el" href="../../dd/db2/kernel__3_87_81_2src_2ccfs_2filter_8h.html#d2/d9e/structfilter">filter</a>)</td></tr>
<tr class="separator:a7889c58e021a442a2a428a598dfd6a5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddef6be4dfcbe3f731883a35791ef47"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d55/kernel__2_86_833_81_2src_2ccfs_2filter_8h.html#a0ddef6be4dfcbe3f731883a35791ef47">add_filter_pattern</a> (struct <a class="el" href="../../dd/db2/kernel__3_87_81_2src_2ccfs_2filter_8h.html#d2/d9e/structfilter">filter</a> *<a class="el" href="../../dd/db2/kernel__3_87_81_2src_2ccfs_2filter_8h.html#d2/d9e/structfilter">filter</a>, const char *pattern, int pattern_length)</td></tr>
<tr class="memdesc:a0ddef6be4dfcbe3f731883a35791ef47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a new patter to the filter.  <a href="#a0ddef6be4dfcbe3f731883a35791ef47">More...</a><br/></td></tr>
<tr class="separator:a0ddef6be4dfcbe3f731883a35791ef47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac80972c80264c0b761a863e60d8f9af"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d55/kernel__2_86_833_81_2src_2ccfs_2filter_8h.html#aac80972c80264c0b761a863e60d8f9af">parse_filter</a> (struct <a class="el" href="../../dd/db2/kernel__3_87_81_2src_2ccfs_2filter_8h.html#d2/d9e/structfilter">filter</a> *<a class="el" href="../../dd/db2/kernel__3_87_81_2src_2ccfs_2filter_8h.html#d2/d9e/structfilter">filter</a>, char *definition)</td></tr>
<tr class="memdesc:aac80972c80264c0b761a863e60d8f9af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses filter definition.  <a href="#aac80972c80264c0b761a863e60d8f9af">More...</a><br/></td></tr>
<tr class="separator:aac80972c80264c0b761a863e60d8f9af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b54778905740cdbd3ff85527360b9df"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d55/kernel__2_86_833_81_2src_2ccfs_2filter_8h.html#a5b54778905740cdbd3ff85527360b9df">filter_matches</a> (struct <a class="el" href="../../dd/db2/kernel__3_87_81_2src_2ccfs_2filter_8h.html#d2/d9e/structfilter">filter</a> *<a class="el" href="../../dd/db2/kernel__3_87_81_2src_2ccfs_2filter_8h.html#d2/d9e/structfilter">filter</a>, const char *name, int name_length, struct timespec *ctime, umode_t umode)</td></tr>
<tr class="memdesc:a5b54778905740cdbd3ff85527360b9df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns 1, if name matches any of the filter patterns.  <a href="#a5b54778905740cdbd3ff85527360b9df">More...</a><br/></td></tr>
<tr class="separator:a5b54778905740cdbd3ff85527360b9df"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="d2/d9e/structfilter" id="d2/d9e/structfilter"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct filter</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Container of filters. </p>
<p>Used for pattern matching of cacheable files. </p>

<p>Definition at line <a class="el" href="../../d2/d55/kernel__2_86_833_81_2src_2ccfs_2filter_8h_source.html#l00008">8</a> of file <a class="el" href="../../d2/d55/kernel__2_86_833_81_2src_2ccfs_2filter_8h_source.html">filter.h</a>.</p>
</div><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for filter:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d6/d0b/structfilter__coll__graph.png" border="0" usemap="#filter_coll__map" alt="Collaboration graph"/></div>
</div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a206d0ddbbf11a630e9cfdcd3f9fb747e"></a>struct list_head</td>
<td class="fieldname">
patterns</td>
<td class="fielddoc">
Pattterns, that can be matched. <p>Currently only full name or * wildcard at the beginning are supported. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a0ddef6be4dfcbe3f731883a35791ef47"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int add_filter_pattern </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/db2/kernel__3_87_81_2src_2ccfs_2filter_8h.html#d2/d9e/structfilter">filter</a> *&#160;</td>
          <td class="paramname"><em>filter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pattern</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pattern_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a new patter to the filter. </p>
<p>Returns 0 upon succes, error code otherwise </p>

<p>Definition at line <a class="el" href="../../d8/df1/kernel__2_86_833_81_2src_2ccfs_2filter_8c_source.html#l00064">64</a> of file <a class="el" href="../../d8/df1/kernel__2_86_833_81_2src_2ccfs_2filter_8c_source.html">filter.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                                                                                       {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d6/d3a/kernel__3_87_81_2src_2ccfs_2filter_8c.html#d6/dff/structfilter__pattern">filter_pattern</a>* <a class="code" href="../../d6/d3a/kernel__3_87_81_2src_2ccfs_2filter_8c.html#d6/dff/structfilter__pattern">filter_pattern</a> = kmalloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> filter_pattern), GFP_KERNEL);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    printk(<span class="stringliteral">&quot;Adding filter pattern: %s (%d)\n&quot;</span>, <a class="code" href="../../d6/d3a/kernel__3_87_81_2src_2ccfs_2filter_8c.html#a48881496dd9d822896b8e6a1e58ee6e1" title="Pattern itself.">pattern</a>, <a class="code" href="../../d6/d3a/kernel__3_87_81_2src_2ccfs_2filter_8c.html#ab986ffec74774721261107794e4ecf76">pattern_length</a>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">if</span> ( !filter_pattern )</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">if</span> ( strcmp(<a class="code" href="../../d6/d3a/kernel__3_87_81_2src_2ccfs_2filter_8c.html#a48881496dd9d822896b8e6a1e58ee6e1" title="Pattern itself.">pattern</a>, <span class="stringliteral">&quot;OLD&quot;</span>) == 0 ) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      filter_pattern-&gt;<a class="code" href="../../d6/d3a/kernel__3_87_81_2src_2ccfs_2filter_8c.html#a48881496dd9d822896b8e6a1e58ee6e1" title="Pattern itself.">pattern</a> = NULL;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      filter_pattern-&gt;<a class="code" href="../../d6/d3a/kernel__3_87_81_2src_2ccfs_2filter_8c.html#a5fa25dd49a377f4bdb3c50df3ce37a0a" title="Files creation data has to be older than this time.">older_than</a> = CURRENT_TIME;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="comment">// Consider also files created in last hour to be new files.. as we may assume they may change again soon (not realy smart but should be good enough for our purposes)     </span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      filter_pattern-&gt;<a class="code" href="../../d6/d3a/kernel__3_87_81_2src_2ccfs_2filter_8c.html#a5fa25dd49a377f4bdb3c50df3ce37a0a" title="Files creation data has to be older than this time.">older_than</a>.tv_sec = filter_pattern-&gt;<a class="code" href="../../d6/d3a/kernel__3_87_81_2src_2ccfs_2filter_8c.html#a5fa25dd49a377f4bdb3c50df3ce37a0a" title="Files creation data has to be older than this time.">older_than</a>.tv_sec - 3600;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    } <span class="keywordflow">else</span> {    </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      filter_pattern-&gt;<a class="code" href="../../d6/d3a/kernel__3_87_81_2src_2ccfs_2filter_8c.html#a48881496dd9d822896b8e6a1e58ee6e1" title="Pattern itself.">pattern</a> = kmalloc(<a class="code" href="../../d6/d3a/kernel__3_87_81_2src_2ccfs_2filter_8c.html#ab986ffec74774721261107794e4ecf76">pattern_length</a>, GFP_KERNEL);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="keywordflow">if</span> ( !filter_pattern-&gt;<a class="code" href="../../d6/d3a/kernel__3_87_81_2src_2ccfs_2filter_8c.html#a48881496dd9d822896b8e6a1e58ee6e1" title="Pattern itself.">pattern</a> ) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;          kfree(filter_pattern);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;          <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      memcpy(filter_pattern-&gt;<a class="code" href="../../d6/d3a/kernel__3_87_81_2src_2ccfs_2filter_8c.html#a48881496dd9d822896b8e6a1e58ee6e1" title="Pattern itself.">pattern</a>, <a class="code" href="../../d6/d3a/kernel__3_87_81_2src_2ccfs_2filter_8c.html#a48881496dd9d822896b8e6a1e58ee6e1" title="Pattern itself.">pattern</a>, <a class="code" href="../../d6/d3a/kernel__3_87_81_2src_2ccfs_2filter_8c.html#ab986ffec74774721261107794e4ecf76">pattern_length</a>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      filter_pattern-&gt;<a class="code" href="../../d6/d3a/kernel__3_87_81_2src_2ccfs_2filter_8c.html#ab986ffec74774721261107794e4ecf76">pattern_length</a> = <a class="code" href="../../d6/d3a/kernel__3_87_81_2src_2ccfs_2filter_8c.html#ab986ffec74774721261107794e4ecf76">pattern_length</a>;        </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    list_add(&amp;filter_pattern-&gt;<a class="code" href="../../d6/d3a/kernel__3_87_81_2src_2ccfs_2filter_8c.html#a75bc468446679ab70be85b5d9c6a5437" title="For enlistment.">head</a>, &amp;filter-&gt;<a class="code" href="../../dd/db2/kernel__3_87_81_2src_2ccfs_2filter_8h.html#a206d0ddbbf11a630e9cfdcd3f9fb747e" title="Pattterns, that can be matched.">patterns</a>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af5b8b6927e23132bc034e75a5956a107"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/db2/kernel__3_87_81_2src_2ccfs_2filter_8h.html#d2/d9e/structfilter">filter</a>* create_filter </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/df1/kernel__2_86_833_81_2src_2ccfs_2filter_8c_source.html#l00028">28</a> of file <a class="el" href="../../d8/df1/kernel__2_86_833_81_2src_2ccfs_2filter_8c_source.html">filter.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;                                   {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../dd/db2/kernel__3_87_81_2src_2ccfs_2filter_8h.html#d2/d9e/structfilter" title="Container of filters.">filter</a>* <a class="code" href="../../dd/db2/kernel__3_87_81_2src_2ccfs_2filter_8h.html#d2/d9e/structfilter" title="Container of filters.">filter</a> = kmalloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> filter), GFP_KERNEL);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordflow">if</span> ( !filter )</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    INIT_LIST_HEAD(&amp;filter-&gt;<a class="code" href="../../dd/db2/kernel__3_87_81_2src_2ccfs_2filter_8h.html#a206d0ddbbf11a630e9cfdcd3f9fb747e" title="Pattterns, that can be matched.">patterns</a>);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">return</span> filter;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7889c58e021a442a2a428a598dfd6a5a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void destroy_filter </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/db2/kernel__3_87_81_2src_2ccfs_2filter_8h.html#d2/d9e/structfilter">filter</a> *&#160;</td>
          <td class="paramname"><em>filter</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/df1/kernel__2_86_833_81_2src_2ccfs_2filter_8c_source.html#l00038">38</a> of file <a class="el" href="../../d8/df1/kernel__2_86_833_81_2src_2ccfs_2filter_8c_source.html">filter.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                                           {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d6/d3a/kernel__3_87_81_2src_2ccfs_2filter_8c.html#d6/dff/structfilter__pattern">filter_pattern</a> *<a class="code" href="../../d6/d3a/kernel__3_87_81_2src_2ccfs_2filter_8c.html#a75bc468446679ab70be85b5d9c6a5437" title="For enlistment.">head</a>, *tmp;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordflow">if</span> ( !filter )</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        list_for_each_entry_safe(head, tmp, &amp;filter-&gt;<a class="code" href="../../dd/db2/kernel__3_87_81_2src_2ccfs_2filter_8h.html#a206d0ddbbf11a630e9cfdcd3f9fb747e" title="Pattterns, that can be matched.">patterns</a>, head) {          </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                list_del(&amp;head-&gt;<a class="code" href="../../d6/d3a/kernel__3_87_81_2src_2ccfs_2filter_8c.html#a75bc468446679ab70be85b5d9c6a5437" title="For enlistment.">head</a>);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        kfree(head);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;         </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    kfree(filter);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5b54778905740cdbd3ff85527360b9df"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int filter_matches </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/db2/kernel__3_87_81_2src_2ccfs_2filter_8h.html#d2/d9e/structfilter">filter</a> *&#160;</td>
          <td class="paramname"><em>filter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>name_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timespec *&#160;</td>
          <td class="paramname"><em>ctime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">umode_t&#160;</td>
          <td class="paramname"><em>umode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns 1, if name matches any of the filter patterns. </p>
<p>0 otherwise </p>

<p>Definition at line <a class="el" href="../../d8/df1/kernel__2_86_833_81_2src_2ccfs_2filter_8c_source.html#l00122">122</a> of file <a class="el" href="../../d8/df1/kernel__2_86_833_81_2src_2ccfs_2filter_8c_source.html">filter.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                                                                                                                    {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d6/d3a/kernel__3_87_81_2src_2ccfs_2filter_8c.html#d6/dff/structfilter__pattern">filter_pattern</a> *<a class="code" href="../../d6/d3a/kernel__3_87_81_2src_2ccfs_2filter_8c.html#a75bc468446679ab70be85b5d9c6a5437" title="For enlistment.">head</a>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">if</span> ( !filter )</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        list_for_each_entry(head, &amp;filter-&gt;<a class="code" href="../../dd/db2/kernel__3_87_81_2src_2ccfs_2filter_8h.html#a206d0ddbbf11a630e9cfdcd3f9fb747e" title="Pattterns, that can be matched.">patterns</a>, head) {            </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;         <span class="keywordflow">if</span> ( <a class="code" href="../../d8/df1/kernel__2_86_833_81_2src_2ccfs_2filter_8c.html#a5443f0b8c8ff54516356c8c813d8b5c1">pattern_matches</a>(head, name, name_length, ctime, umode) )</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aac80972c80264c0b761a863e60d8f9af"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void parse_filter </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/db2/kernel__3_87_81_2src_2ccfs_2filter_8h.html#d2/d9e/structfilter">filter</a> *&#160;</td>
          <td class="paramname"><em>filter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>definition</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses filter definition. </p>
<p>Expects colon separated patterns </p>

<p>Definition at line <a class="el" href="../../d8/df1/kernel__2_86_833_81_2src_2ccfs_2filter_8c_source.html#l00052">52</a> of file <a class="el" href="../../d8/df1/kernel__2_86_833_81_2src_2ccfs_2filter_8c_source.html">filter.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                                                           {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordtype">char</span>* p;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">while</span> ((p = strsep(&amp;definition, <span class="stringliteral">&quot;:&quot;</span>)) != NULL) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keywordflow">if</span> (!*p)</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <a class="code" href="../../d8/df1/kernel__2_86_833_81_2src_2ccfs_2filter_8c.html#a0ddef6be4dfcbe3f731883a35791ef47" title="Registers a new patter to the filter.">add_filter_pattern</a>(filter, p, strcspn(p, <span class="stringliteral">&quot;:&quot;</span>));</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_08d237fc27d4ecd563f71c5d52f2fecc.html">sources</a></li><li class="navelem"><a class="el" href="../../dir_351788bb6e23fe2c44c0fb926ab59c0b.html">kernel_2.6.33.1</a></li><li class="navelem"><a class="el" href="../../dir_20c5e2ce0b5aae09914675fb60613a2c.html">src</a></li><li class="navelem"><a class="el" href="../../dir_68be239379f2e7d29b0f054b419a7500.html">ccfs</a></li><li class="navelem"><a class="el" href="../../d2/d55/kernel__2_86_833_81_2src_2ccfs_2filter_8h.html">filter.h</a></li>
    <li class="footer">Generated on Mon Apr 1 2013 16:10:05 for Clondike by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
