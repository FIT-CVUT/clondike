<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Clondike: tcmi_msg class</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Clondike
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d6/dc2/group__tcmi__msg__class.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">tcmi_msg class<div class="ingroups"><a class="el" href="../../d4/d6b/group__tcmi__comm__group.html">communication</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>This class represents a generic message in TCMI communication protocol.  
<a href="#details">More...</a></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for tcmi_msg class:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<center><table><tr><td><img src="../../d6/dc2/group__tcmi__msg__class.png" border="0" alt="" usemap="#d6_2dc2_2group____tcmi____msg____class"/>
<map name="d6_2dc2_2group____tcmi____msg____class" id="d6_2dc2_2group____tcmi____msg____class">
<area shape="rect" id="node1" href="../../d4/d6b/group__tcmi__comm__group.html" title="Classes in this group provide TCMI communication features." alt="" coords="6,325,117,352"/><area shape="rect" id="node5" href="../../d1/db0/group__tcmi__authenticate__msg__class.html" title="This message is send by PEN when it wants authenticate to CCN." alt="" coords="335,5,492,46"/><area shape="rect" id="node6" href="../../d1/da3/group__tcmi__authenticate__resp__msg__class.html" title="This message is send as a response to authentication request by the CCN to PEN." alt="" coords="335,70,492,111"/><area shape="rect" id="node7" href="../../d4/de6/group__tcmi__disconnect__msg__class.html" title="This message is send by PEN or CCN when it is going to disconnect from its peer." alt="" coords="339,135,488,177"/><area shape="rect" id="node8" href="../../d5/dbd/group__tcmi__err__msg__class.html" title="This class represents a generic error message." alt="" coords="345,201,481,228"/><area shape="rect" id="node3" href="../../d4/dbe/group__tcmi__generic__user__class.html" title="This message can be send both by PEN or CCN." alt="" coords="333,253,493,294"/><area shape="rect" id="node13" href="../../df/df9/group__tcmi__p__emigrate__msg__class.html" title="This class represents a message for preemptive/non&#45;preemtive process migration via a physical checkpo..." alt="" coords="338,318,489,359"/><area shape="rect" id="node10" href="../../d1/d26/group__tcmi__ppm__p__emigrate__msg__class.html" title="This class represents a message for preemptive process migration via a physical checkpoint image..." alt="" coords="338,383,489,425"/><area shape="rect" id="node11" href="../../d7/dc8/group__tcmi__procmsg__class.html" title="This class represents a generic process message." alt="" coords="344,449,483,476"/><area shape="rect" id="node9" href="../../d8/d7b/group__tcmi__signal__msg__class.html" title="This class represents a test message and is intended to be used as a skeleton when implementing new m..." alt="" coords="336,500,491,527"/><area shape="rect" id="node12" href="../../d4/d32/group__tcmi__skel__msg__class.html" title="This class represents a test message and is intended to be used as a skeleton when implementing new m..." alt="" coords="341,551,486,577"/><area shape="rect" id="node4" href="../../dc/d35/group__tcmi__skelresp__msg__class.html" title="This class represents a test message and is intended to be used as a skeleton when implementing new m..." alt="" coords="328,601,499,628"/></map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:d1/db0/group__tcmi__authenticate__msg__class"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/db0/group__tcmi__authenticate__msg__class.html">tcmi_authenticate_msg class</a></td></tr>
<tr class="memdesc:d1/db0/group__tcmi__authenticate__msg__class"><td class="mdescLeft">&#160;</td><td class="mdescRight">This message is send by PEN when it wants authenticate to CCN. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d1/da3/group__tcmi__authenticate__resp__msg__class"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/da3/group__tcmi__authenticate__resp__msg__class.html">tcmi_authenticate_resp_msg class</a></td></tr>
<tr class="memdesc:d1/da3/group__tcmi__authenticate__resp__msg__class"><td class="mdescLeft">&#160;</td><td class="mdescRight">This message is send as a response to authentication request by the CCN to PEN. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d4/de6/group__tcmi__disconnect__msg__class"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/de6/group__tcmi__disconnect__msg__class.html">tcmi_disconnect_msg class</a></td></tr>
<tr class="memdesc:d4/de6/group__tcmi__disconnect__msg__class"><td class="mdescLeft">&#160;</td><td class="mdescRight">This message is send by PEN or CCN when it is going to disconnect from its peer. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d5/dbd/group__tcmi__err__msg__class"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dbd/group__tcmi__err__msg__class.html">tcmi_err_msg class</a></td></tr>
<tr class="memdesc:d5/dbd/group__tcmi__err__msg__class"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class represents a generic error message. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d4/dbe/group__tcmi__generic__user__class"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/dbe/group__tcmi__generic__user__class.html">tcmi_generic_user_msg class</a></td></tr>
<tr class="memdesc:d4/dbe/group__tcmi__generic__user__class"><td class="mdescLeft">&#160;</td><td class="mdescRight">This message can be send both by PEN or CCN. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:df/df9/group__tcmi__p__emigrate__msg__class"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/df9/group__tcmi__p__emigrate__msg__class.html">tcmi_p_emigrate_msg class</a></td></tr>
<tr class="memdesc:df/df9/group__tcmi__p__emigrate__msg__class"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class represents a message for preemptive/non-preemtive process migration via a physical checkpoint image. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d1/d26/group__tcmi__ppm__p__emigrate__msg__class"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d26/group__tcmi__ppm__p__emigrate__msg__class.html">tcmi_ppm_p_emigrate_msg class</a></td></tr>
<tr class="memdesc:d1/d26/group__tcmi__ppm__p__emigrate__msg__class"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class represents a message for preemptive process migration via a physical checkpoint image. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d7/dc8/group__tcmi__procmsg__class"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dc8/group__tcmi__procmsg__class.html">tcmi_procmsg class</a></td></tr>
<tr class="memdesc:d7/dc8/group__tcmi__procmsg__class"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class represents a generic process message. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d8/d7b/group__tcmi__signal__msg__class"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d7b/group__tcmi__signal__msg__class.html">tcmi_signal_msg class</a></td></tr>
<tr class="memdesc:d8/d7b/group__tcmi__signal__msg__class"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class represents a test message and is intended to be used as a skeleton when implementing new messages in the TCMI protocol. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d4/d32/group__tcmi__skel__msg__class"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d32/group__tcmi__skel__msg__class.html">tcmi_skel_msg class</a></td></tr>
<tr class="memdesc:d4/d32/group__tcmi__skel__msg__class"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class represents a test message and is intended to be used as a skeleton when implementing new messages in the TCMI protocol. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:dc/d35/group__tcmi__skelresp__msg__class"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d35/group__tcmi__skelresp__msg__class.html">tcmi_skelresp_msg class</a></td></tr>
<tr class="memdesc:dc/d35/group__tcmi__skelresp__msg__class"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class represents a test message and is intended to be used as a skeleton when implementing new messages in the TCMI protocol. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:d0/d5b/structtcmi__msg"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a></td></tr>
<tr class="memdesc:d0/d5b/structtcmi__msg"><td class="mdescLeft">&#160;</td><td class="mdescRight">A coumpound structure that carries a generic TCMI message.  <a href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">More...</a><br/></td></tr>
<tr class="separator:d0/d5b/structtcmi__msg"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d8/de4/structtcmi__msg__ops"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d8/de4/structtcmi__msg__ops">tcmi_msg_ops</a></td></tr>
<tr class="memdesc:d8/de4/structtcmi__msg__ops"><td class="mdescLeft">&#160;</td><td class="mdescRight">Message operations that support polymorphism.  <a href="../../d6/dc2/group__tcmi__msg__class.html#d8/de4/structtcmi__msg__ops">More...</a><br/></td></tr>
<tr class="separator:d8/de4/structtcmi__msg__ops"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d6/d81/structtcmi__msg__dsc"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d6/d81/structtcmi__msg__dsc">tcmi_msg_dsc</a></td></tr>
<tr class="memdesc:d6/d81/structtcmi__msg__dsc"><td class="mdescLeft">&#160;</td><td class="mdescRight">This descriptor is to be provided by every individual message class for the <a class="el" href="../../de/dc6/group__tcmi__msg__factory__class.html">factory </a>.  <a href="../../d6/dc2/group__tcmi__msg__class.html#d6/d81/structtcmi__msg__dsc">More...</a><br/></td></tr>
<tr class="separator:d6/d81/structtcmi__msg__dsc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga82cf8f5f561f28f5bebf952eb796df73"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#ga82cf8f5f561f28f5bebf952eb796df73">TCMI_MSG_DSC</a>(id, new_rx_m, new_rx_err_m)&#160;&#160;&#160;{.msg_id = id, .new_rx = new_rx_m, .new_rx_err = new_rx_err_m}</td></tr>
<tr class="memdesc:ga82cf8f5f561f28f5bebf952eb796df73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Macro that fills the descriptor.  <a href="#ga82cf8f5f561f28f5bebf952eb796df73">More...</a><br/></td></tr>
<tr class="separator:ga82cf8f5f561f28f5bebf952eb796df73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaad9433ff1400610e1ee4ba0e9de766bc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#gaad9433ff1400610e1ee4ba0e9de766bc">TCMI_DEFAULT_MSG_TIMEOUT</a>&#160;&#160;&#160;60*HZ</td></tr>
<tr class="memdesc:gaad9433ff1400610e1ee4ba0e9de766bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Message transaction default timeout set to 60 seconds.  <a href="#gaad9433ff1400610e1ee4ba0e9de766bc">More...</a><br/></td></tr>
<tr class="separator:gaad9433ff1400610e1ee4ba0e9de766bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga91f3fd64c88d27100f1e4c7125a73a0e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#ga91f3fd64c88d27100f1e4c7125a73a0e">TCMI_MSG</a>(m)&#160;&#160;&#160;((struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a>*)m)</td></tr>
<tr class="memdesc:ga91f3fd64c88d27100f1e4c7125a73a0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Casts to the <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg" title="A coumpound structure that carries a generic TCMI message.">tcmi_msg</a> instance.  <a href="#ga91f3fd64c88d27100f1e4c7125a73a0e">More...</a><br/></td></tr>
<tr class="separator:ga91f3fd64c88d27100f1e4c7125a73a0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga1c21eeafb9a0d56dabb025d5fbdc0bc3"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#ga1c21eeafb9a0d56dabb025d5fbdc0bc3">tcmi_msg_send</a> (struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, struct <a class="el" href="../../d6/d8e/group__kkc__sock__class.html#da/d0d/structkkc__sock">kkc_sock</a> *sock, int <a class="el" href="../../d4/d83/tcmi__ckpt__openfile_8h.html#a38a8a1678784eecc1ffcc0685dbcce97">flags</a>)</td></tr>
<tr class="memdesc:ga1c21eeafb9a0d56dabb025d5fbdc0bc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Sends a message via a specified connection.  <a href="#ga1c21eeafb9a0d56dabb025d5fbdc0bc3">More...</a><br/></td></tr>
<tr class="separator:ga1c21eeafb9a0d56dabb025d5fbdc0bc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0f81cf27b94206abc95c5b0002f66d2c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#ga0f81cf27b94206abc95c5b0002f66d2c">tcmi_msg_init_rx</a> (struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, u_int32_t msg_id, struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d8/de4/structtcmi__msg__ops">tcmi_msg_ops</a> *msg_ops)</td></tr>
<tr class="memdesc:ga0f81cf27b94206abc95c5b0002f66d2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Initializes the message for receiving.  <a href="#ga0f81cf27b94206abc95c5b0002f66d2c">More...</a><br/></td></tr>
<tr class="separator:ga0f81cf27b94206abc95c5b0002f66d2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gace79df438ec4f7c8f7cee3bfe42f6d93"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#gace79df438ec4f7c8f7cee3bfe42f6d93">tcmi_msg_init_tx</a> (struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, u_int32_t msg_id, struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d8/de4/structtcmi__msg__ops">tcmi_msg_ops</a> *msg_ops, struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *transactions, u_int32_t resp_msg_id, u_int timeout, u_int32_t resp_trans_id)</td></tr>
<tr class="memdesc:gace79df438ec4f7c8f7cee3bfe42f6d93"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Initializes the message for transferring.  <a href="#gace79df438ec4f7c8f7cee3bfe42f6d93">More...</a><br/></td></tr>
<tr class="separator:gace79df438ec4f7c8f7cee3bfe42f6d93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga84688215ef9615fdc2699eea0dbb8031"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#ga84688215ef9615fdc2699eea0dbb8031">tcmi_msg_recv</a> (struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *, struct <a class="el" href="../../d6/d8e/group__kkc__sock__class.html#da/d0d/structkkc__sock">kkc_sock</a> *sock)</td></tr>
<tr class="memdesc:ga84688215ef9615fdc2699eea0dbb8031"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Receives the message via a specified connection.  <a href="#ga84688215ef9615fdc2699eea0dbb8031">More...</a><br/></td></tr>
<tr class="separator:ga84688215ef9615fdc2699eea0dbb8031"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7a8fe8cbfd4b25c15589c8599f66e574"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#ga7a8fe8cbfd4b25c15589c8599f66e574">tcmi_msg_send_anonymous</a> (struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, struct <a class="el" href="../../d6/d8e/group__kkc__sock__class.html#da/d0d/structkkc__sock">kkc_sock</a> *sock)</td></tr>
<tr class="memdesc:ga7a8fe8cbfd4b25c15589c8599f66e574"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Sends a message via a specified connection.  <a href="#ga7a8fe8cbfd4b25c15589c8599f66e574">More...</a><br/></td></tr>
<tr class="separator:ga7a8fe8cbfd4b25c15589c8599f66e574"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadcb05f36b8afb930d1a825ae12ff7d3c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#gadcb05f36b8afb930d1a825ae12ff7d3c">tcmi_msg_send_and_receive</a> (struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, struct <a class="el" href="../../d6/d8e/group__kkc__sock__class.html#da/d0d/structkkc__sock">kkc_sock</a> *sock, struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> **<a class="el" href="../../d1/d6d/tcmi__msg_8h.html#adb26817b6c4a9eeb3f68c832f24d5471">resp</a>)</td></tr>
<tr class="memdesc:gadcb05f36b8afb930d1a825ae12ff7d3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Sends a message via a specified connection and waits for the response.  <a href="#gadcb05f36b8afb930d1a825ae12ff7d3c">More...</a><br/></td></tr>
<tr class="separator:gadcb05f36b8afb930d1a825ae12ff7d3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8e7c8f734e50ec514ed77795ad41b050"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#ga8e7c8f734e50ec514ed77795ad41b050">tcmi_msg_deliver</a> (struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, struct <a class="el" href="../../dc/d0c/group__tcmi__queue__class.html#d5/d9a/structtcmi__queue">tcmi_queue</a> *requests, struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *transactions)</td></tr>
<tr class="memdesc:ga8e7c8f734e50ec514ed77795ad41b050"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Message delivers itself.  <a href="#ga8e7c8f734e50ec514ed77795ad41b050">More...</a><br/></td></tr>
<tr class="separator:ga8e7c8f734e50ec514ed77795ad41b050"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacd1d8503b665439b2562b4ca8806ca12"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#gacd1d8503b665439b2562b4ca8806ca12">tcmi_msg_new_rx</a> (u_int32_t msg_id, struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d6/d81/structtcmi__msg__dsc">tcmi_msg_dsc</a> *dsc)</td></tr>
<tr class="memdesc:gacd1d8503b665439b2562b4ca8806ca12"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Class method - creates a message based on a descriptor.  <a href="#gacd1d8503b665439b2562b4ca8806ca12">More...</a><br/></td></tr>
<tr class="separator:gacd1d8503b665439b2562b4ca8806ca12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga23d3ca435be85adedc5c1385469d707f"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#ga23d3ca435be85adedc5c1385469d707f">tcmi_msg_get</a> (struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:ga23d3ca435be85adedc5c1385469d707f"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Instance accessor, increments the reference count.  <a href="#ga23d3ca435be85adedc5c1385469d707f">More...</a><br/></td></tr>
<tr class="separator:ga23d3ca435be85adedc5c1385469d707f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac86a4090b7e1902ef603cb03191d6281"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#gac86a4090b7e1902ef603cb03191d6281">tcmi_msg_put</a> (struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:gac86a4090b7e1902ef603cb03191d6281"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined.  <a href="#gac86a4090b7e1902ef603cb03191d6281">More...</a><br/></td></tr>
<tr class="separator:gac86a4090b7e1902ef603cb03191d6281"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga73489766817f528da25369a3f4c713a1"><td class="memItemLeft" align="right" valign="top">static u_int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#ga73489766817f528da25369a3f4c713a1">tcmi_msg_id</a> (struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:ga73489766817f528da25369a3f4c713a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Message ID accessor.  <a href="#ga73489766817f528da25369a3f4c713a1">More...</a><br/></td></tr>
<tr class="separator:ga73489766817f528da25369a3f4c713a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4db62a1a76e13885a429b6212a77385f"><td class="memItemLeft" align="right" valign="top">static u_int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#ga4db62a1a76e13885a429b6212a77385f">tcmi_msg_errid</a> (struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:ga4db62a1a76e13885a429b6212a77385f"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Message error ID accessor.  <a href="#ga4db62a1a76e13885a429b6212a77385f">More...</a><br/></td></tr>
<tr class="separator:ga4db62a1a76e13885a429b6212a77385f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5a09e9d377637eba6c3df1236fc97926"><td class="memItemLeft" align="right" valign="top">static u_int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#ga5a09e9d377637eba6c3df1236fc97926">tcmi_msg_req_id</a> (struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:ga5a09e9d377637eba6c3df1236fc97926"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Request transaction ID accessor.  <a href="#ga5a09e9d377637eba6c3df1236fc97926">More...</a><br/></td></tr>
<tr class="separator:ga5a09e9d377637eba6c3df1236fc97926"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>This class represents a generic message in TCMI communication protocol. </p>
<p>A message can be part of a <a class="el" href="../../d4/d8c/group__tcmi__transaction__class.html">transaction</a>. For that reason it carries two extra ID's</p>
<ol type="1">
<li>a transaction request ID - identifies a transaction started by the sending party. The sending party expects a message with response transaction ID set to this value. This ID is assigned automatically upon message creation depending on a particular messagere type.</li>
<li>a transaction response ID - this value comes from the transaction request ID of the original request message that the new message is replying to. This ID has to be specified explicitely when building the response message.</li>
</ol>
<p>A message is instantiated always twice during its lifetime:</p>
<ul>
<li>the sender builds the message based on parameters specified by the message instantiator.</li>
<li>the receiver performs message materialization from the data stream.</li>
</ul>
<p>These two cases are substantially different. In the first case the instantiator knows what message is to be built. While the receiver is left to the very last moment upon discovery of the message ID to build the message. A suitable solution to this problem is provided by a a &lt;&lt;factory&gt;&gt; design pattern. The message instantiation on the receiver side is carried out by <a class="el" href="../../de/dc6/group__tcmi__msg__factory__class.html">message factory </a>.</p>
<p>A generic message consists of following parts:</p>
<ul>
<li>message id - unique identifier that describes a particular message type. This is specified by particular subclasses.</li>
<li>transaction request ID - explained above</li>
<li>transaction response ID - explained above</li>
</ul>
<p>Generic message methods:</p>
<ul>
<li>init_rx - initializes a new message so that it is ready to be received.</li>
<li>init_tx - initializes a new message for sending based on parameters specified by the user.</li>
<li>recv - receives a message via a communication channel</li>
<li>send - sends out a message via a communication channel</li>
<li>deliver - delivers a request message to a queue or delivers a response message to a transaction and completes the transaction.</li>
</ul>
<p>A particular message of the protocol then provides following interface:</p>
<ul>
<li>new_rx - this method is registered with the factory class, so that the build process is fully automated.</li>
<li>new_rx_err - also registered with the factory class, provides an alternate(error) version of the message.</li>
<li>new_tx - builds a message based on parameters specified by the user </li>
</ul>
<hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="d0/d5b/structtcmi__msg" id="d0/d5b/structtcmi__msg"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct tcmi_msg</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>A coumpound structure that carries a generic TCMI message. </p>

<p>Definition at line <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00103">103</a> of file <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html">tcmi_msg.h</a>.</p>
</div><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for tcmi_msg:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../df/d3a/structtcmi__msg__coll__graph.png" border="0" usemap="#tcmi__msg_coll__map" alt="Collaboration graph"/></div>
<map name="tcmi__msg_coll__map" id="tcmi__msg_coll__map">
<area shape="rect" id="node2" href="../../d6/dc2/group__tcmi__msg__class.html#d8/de4/structtcmi__msg__ops" title="Message operations that support polymorphism." alt="" coords="5,516,112,623"/><area shape="rect" id="node3" href="../../d4/d8c/group__tcmi__transaction__class.html#d7/d6e/structtcmi__transaction" title="Compound structure holding transaction attributes." alt="" coords="137,465,255,674"/><area shape="rect" id="node4" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec" title="A slot vector compound structure." alt="" coords="89,235,199,400"/><area shape="rect" id="node5" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot" title="A slot compound structure." alt="" coords="151,5,261,171"/></map>
</div>
<table class="memberdecls">
<tr><td colspan="2"><h3>Public Member Functions</h3></td></tr>
<tr class="memitem:a83aa5a533a0275c572ac0c6e4883205d"><td class="memItemLeft" >struct {</td></tr>
<tr class="memitem:a8475ba1ba77ce4d58c5fddfd527848ed"><td class="memItemLeft" align="right" valign="top">u_int32_t&#160;</td><td class="memItemRight" valign="bottom"><b>req</b></td></tr>
<tr class="memdesc:a8475ba1ba77ce4d58c5fddfd527848ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">request transaction ID  <a href="#a8475ba1ba77ce4d58c5fddfd527848ed">More...</a><br/></td></tr>
<tr class="separator:a8475ba1ba77ce4d58c5fddfd527848ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c92ce9e2c5c6fee7abb35d6f948dc66"><td class="memItemLeft" align="right" valign="top">u_int32_t&#160;</td><td class="memItemRight" valign="bottom"><b>resp</b></td></tr>
<tr class="memdesc:a5c92ce9e2c5c6fee7abb35d6f948dc66"><td class="mdescLeft">&#160;</td><td class="mdescRight">response transaction ID  <a href="#a5c92ce9e2c5c6fee7abb35d6f948dc66">More...</a><br/></td></tr>
<tr class="separator:a5c92ce9e2c5c6fee7abb35d6f948dc66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83aa5a533a0275c572ac0c6e4883205d"><td class="memItemLeft" valign="top">}&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#a83aa5a533a0275c572ac0c6e4883205d">__attribute__</a> ((__packed__))</td></tr>
<tr class="separator:a83aa5a533a0275c572ac0c6e4883205d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><h3>Data Fields</h3></td></tr>
<tr class="memitem:a51693aab24a0678dbd8c46766c2855fe"><td class="memItemLeft" align="right" valign="top">u_int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#a51693aab24a0678dbd8c46766c2855fe">msg_id</a></td></tr>
<tr class="memdesc:a51693aab24a0678dbd8c46766c2855fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">message id  <a href="#a51693aab24a0678dbd8c46766c2855fe">More...</a><br/></td></tr>
<tr class="separator:a51693aab24a0678dbd8c46766c2855fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14d1c04acb1f841df160229c01983276"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d4/d8c/group__tcmi__transaction__class.html#d7/d6e/structtcmi__transaction">tcmi_transaction</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#a14d1c04acb1f841df160229c01983276">transaction</a></td></tr>
<tr class="memdesc:a14d1c04acb1f841df160229c01983276"><td class="mdescLeft">&#160;</td><td class="mdescRight">transaction associated with the message  <a href="#a14d1c04acb1f841df160229c01983276">More...</a><br/></td></tr>
<tr class="separator:a14d1c04acb1f841df160229c01983276"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34e09e067676b68511c309d06a0cdaf8"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d8/de4/structtcmi__msg__ops">tcmi_msg_ops</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#a34e09e067676b68511c309d06a0cdaf8">msg_ops</a></td></tr>
<tr class="memdesc:a34e09e067676b68511c309d06a0cdaf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">message operations  <a href="#a34e09e067676b68511c309d06a0cdaf8">More...</a><br/></td></tr>
<tr class="separator:a34e09e067676b68511c309d06a0cdaf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6db666137db409d2606500f483fd1dca"><td class="memItemLeft" align="right" valign="top">atomic_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#a6db666137db409d2606500f483fd1dca">ref_count</a></td></tr>
<tr class="memdesc:a6db666137db409d2606500f483fd1dca"><td class="mdescLeft">&#160;</td><td class="mdescRight">reference counter  <a href="#a6db666137db409d2606500f483fd1dca">More...</a><br/></td></tr>
<tr class="separator:a6db666137db409d2606500f483fd1dca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28d522d781c96a324197685a68c07a89"><td class="memItemLeft" align="right" valign="top">struct list_head&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#a28d522d781c96a324197685a68c07a89">node</a></td></tr>
<tr class="memdesc:a28d522d781c96a324197685a68c07a89"><td class="mdescLeft">&#160;</td><td class="mdescRight">list entry for the message queue  <a href="#a28d522d781c96a324197685a68c07a89">More...</a><br/></td></tr>
<tr class="separator:a28d522d781c96a324197685a68c07a89"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h4 class="groupheader">Member Function Documentation</h4>
<a class="anchor" id="a83aa5a533a0275c572ac0c6e4883205d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct tcmi_msg::@6 tcmi_msg::__attribute__ </td>
          <td>(</td>
          <td class="paramtype">(__packed__)&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h4 class="groupheader">Field Documentation</h4>
<a class="anchor" id="a51693aab24a0678dbd8c46766c2855fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u_int32_t tcmi_msg::msg_id</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>message id </p>

<p>Definition at line <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00105">105</a> of file <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html">tcmi_msg.h</a>.</p>

<p>Referenced by <a class="el" href="../../de/df4/tcmi__comm_8c_source.html#l00145">tcmi_comm_thread()</a>.</p>

</div>
</div>
<a class="anchor" id="a34e09e067676b68511c309d06a0cdaf8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d8/de4/structtcmi__msg__ops">tcmi_msg_ops</a>* tcmi_msg::msg_ops</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>message operations </p>

<p>Definition at line <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00117">117</a> of file <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html">tcmi_msg.h</a>.</p>

</div>
</div>
<a class="anchor" id="a28d522d781c96a324197685a68c07a89"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct list_head tcmi_msg::node</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>list entry for the message queue </p>

<p>Definition at line <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00122">122</a> of file <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html">tcmi_msg.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6db666137db409d2606500f483fd1dca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">atomic_t tcmi_msg::ref_count</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>reference counter </p>

<p>Definition at line <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00120">120</a> of file <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html">tcmi_msg.h</a>.</p>

</div>
</div>
<a class="anchor" id="a14d1c04acb1f841df160229c01983276"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d4/d8c/group__tcmi__transaction__class.html#d7/d6e/structtcmi__transaction">tcmi_transaction</a>* tcmi_msg::transaction</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>transaction associated with the message </p>

<p>Definition at line <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00114">114</a> of file <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html">tcmi_msg.h</a>.</p>

</div>
</div>

</div>
</div>
<a name="d8/de4/structtcmi__msg__ops" id="d8/de4/structtcmi__msg__ops"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct tcmi_msg_ops</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Message operations that support polymorphism. </p>

<p>Definition at line <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00127">127</a> of file <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html">tcmi_msg.h</a>.</p>
</div><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for tcmi_msg_ops:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d8/dde/structtcmi__msg__ops__coll__graph.png" border="0" usemap="#tcmi__msg__ops_coll__map" alt="Collaboration graph"/></div>
</div>
<table class="memberdecls">
<tr><td colspan="2"><h3>Data Fields</h3></td></tr>
<tr class="memitem:af0c362acebcc908de7b5135d4e0f03b9"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#af0c362acebcc908de7b5135d4e0f03b9">recv</a> )(struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *, struct <a class="el" href="../../d6/d8e/group__kkc__sock__class.html#da/d0d/structkkc__sock">kkc_sock</a> *)</td></tr>
<tr class="memdesc:af0c362acebcc908de7b5135d4e0f03b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receives the message via a specified connection.  <a href="#af0c362acebcc908de7b5135d4e0f03b9">More...</a><br/></td></tr>
<tr class="separator:af0c362acebcc908de7b5135d4e0f03b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade162f3c56d38bbbcf4f5c4f119f1bd5"><td class="memItemLeft" align="right" valign="top">int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#ade162f3c56d38bbbcf4f5c4f119f1bd5">send</a> )(struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *, struct <a class="el" href="../../d6/d8e/group__kkc__sock__class.html#da/d0d/structkkc__sock">kkc_sock</a> *)</td></tr>
<tr class="memdesc:ade162f3c56d38bbbcf4f5c4f119f1bd5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends the message via a specified connection.  <a href="#ade162f3c56d38bbbcf4f5c4f119f1bd5">More...</a><br/></td></tr>
<tr class="separator:ade162f3c56d38bbbcf4f5c4f119f1bd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6aea925df7908fbc8c05bd10f3dbd04"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#ad6aea925df7908fbc8c05bd10f3dbd04">free</a> )(struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *)</td></tr>
<tr class="memdesc:ad6aea925df7908fbc8c05bd10f3dbd04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees custom message resources.  <a href="#ad6aea925df7908fbc8c05bd10f3dbd04">More...</a><br/></td></tr>
<tr class="separator:ad6aea925df7908fbc8c05bd10f3dbd04"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h4 class="groupheader">Field Documentation</h4>
<a class="anchor" id="ad6aea925df7908fbc8c05bd10f3dbd04"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* tcmi_msg_ops::free)(struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees custom message resources. </p>
<p>The destruction of the actual message instance is handled internally by this class </p>

<p>Definition at line <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00135">135</a> of file <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html">tcmi_msg.h</a>.</p>

</div>
</div>
<a class="anchor" id="af0c362acebcc908de7b5135d4e0f03b9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* tcmi_msg_ops::recv)(struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *, struct <a class="el" href="../../d6/d8e/group__kkc__sock__class.html#da/d0d/structkkc__sock">kkc_sock</a> *)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receives the message via a specified connection. </p>

<p>Definition at line <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00129">129</a> of file <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html">tcmi_msg.h</a>.</p>

<p>Referenced by <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html#l00237">tcmi_msg_recv()</a>.</p>

</div>
</div>
<a class="anchor" id="ade162f3c56d38bbbcf4f5c4f119f1bd5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int(* tcmi_msg_ops::send)(struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *, struct <a class="el" href="../../d6/d8e/group__kkc__sock__class.html#da/d0d/structkkc__sock">kkc_sock</a> *)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends the message via a specified connection. </p>

<p>Definition at line <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00131">131</a> of file <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html">tcmi_msg.h</a>.</p>

<p>Referenced by <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html#l00413">tcmi_msg_send()</a>.</p>

</div>
</div>

</div>
</div>
<a name="d6/d81/structtcmi__msg__dsc" id="d6/d81/structtcmi__msg__dsc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct tcmi_msg_dsc</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>This descriptor is to be provided by every individual message class for the <a class="el" href="../../de/dc6/group__tcmi__msg__factory__class.html">factory </a>. </p>

<p>Definition at line <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00140">140</a> of file <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html">tcmi_msg.h</a>.</p>
</div><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for tcmi_msg_dsc:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../da/d69/structtcmi__msg__dsc__coll__graph.png" border="0" usemap="#tcmi__msg__dsc_coll__map" alt="Collaboration graph"/></div>
<map name="tcmi__msg__dsc_coll__map" id="tcmi__msg__dsc_coll__map">
<area shape="rect" id="node2" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg" title="A coumpound structure that carries a generic TCMI message." alt="" coords="57,739,175,845"/><area shape="rect" id="node3" href="../../d6/dc2/group__tcmi__msg__class.html#d8/de4/structtcmi__msg__ops" title="Message operations that support polymorphism." alt="" coords="5,516,112,623"/><area shape="rect" id="node4" href="../../d4/d8c/group__tcmi__transaction__class.html#d7/d6e/structtcmi__transaction" title="Compound structure holding transaction attributes." alt="" coords="137,465,255,674"/><area shape="rect" id="node5" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec" title="A slot vector compound structure." alt="" coords="89,235,199,400"/><area shape="rect" id="node6" href="../../da/d0c/group__tcmi__slot__class.html#d9/dbb/structtcmi__slot" title="A slot compound structure." alt="" coords="151,5,261,171"/></map>
</div>
<table class="memberdecls">
<tr><td colspan="2"><h3>Data Fields</h3></td></tr>
<tr class="memitem:a432db71c45d22dda192b4b4ee67b63d8"><td class="memItemLeft" align="right" valign="top">u_int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#a432db71c45d22dda192b4b4ee67b63d8">msg_id</a></td></tr>
<tr class="memdesc:a432db71c45d22dda192b4b4ee67b63d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">message id  <a href="#a432db71c45d22dda192b4b4ee67b63d8">More...</a><br/></td></tr>
<tr class="separator:a432db71c45d22dda192b4b4ee67b63d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75c310dfbb2de3895ac59b4c3cd1fcba"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#a75c310dfbb2de3895ac59b4c3cd1fcba">new_rx</a> )(u_int32_t <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#a432db71c45d22dda192b4b4ee67b63d8">msg_id</a>)</td></tr>
<tr class="memdesc:a75c310dfbb2de3895ac59b4c3cd1fcba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Builds the regular version of the message.  <a href="#a75c310dfbb2de3895ac59b4c3cd1fcba">More...</a><br/></td></tr>
<tr class="separator:a75c310dfbb2de3895ac59b4c3cd1fcba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaee00dc8e07b87cacd565308244ffa55"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#aaee00dc8e07b87cacd565308244ffa55">new_rx_err</a> )(u_int32_t <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#a432db71c45d22dda192b4b4ee67b63d8">msg_id</a>)</td></tr>
<tr class="memdesc:aaee00dc8e07b87cacd565308244ffa55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Builds the error version of the message.  <a href="#aaee00dc8e07b87cacd565308244ffa55">More...</a><br/></td></tr>
<tr class="separator:aaee00dc8e07b87cacd565308244ffa55"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h4 class="groupheader">Field Documentation</h4>
<a class="anchor" id="a432db71c45d22dda192b4b4ee67b63d8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u_int32_t tcmi_msg_dsc::msg_id</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>message id </p>

<p>Definition at line <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00142">142</a> of file <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html">tcmi_msg.h</a>.</p>

<p>Referenced by <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html#l00357">tcmi_msg_new_rx()</a>.</p>

</div>
</div>
<a class="anchor" id="a75c310dfbb2de3895ac59b4c3cd1fcba"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a>*(* tcmi_msg_dsc::new_rx)(u_int32_t <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#a432db71c45d22dda192b4b4ee67b63d8">msg_id</a>)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Builds the regular version of the message. </p>

<p>Definition at line <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00144">144</a> of file <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html">tcmi_msg.h</a>.</p>

<p>Referenced by <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html#l00357">tcmi_msg_new_rx()</a>.</p>

</div>
</div>
<a class="anchor" id="aaee00dc8e07b87cacd565308244ffa55"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a>*(* tcmi_msg_dsc::new_rx_err)(u_int32_t <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#a432db71c45d22dda192b4b4ee67b63d8">msg_id</a>)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Builds the error version of the message. </p>

<p>Definition at line <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00146">146</a> of file <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html">tcmi_msg.h</a>.</p>

<p>Referenced by <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html#l00357">tcmi_msg_new_rx()</a>.</p>

</div>
</div>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="gaad9433ff1400610e1ee4ba0e9de766bc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCMI_DEFAULT_MSG_TIMEOUT&#160;&#160;&#160;60*HZ</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Message transaction default timeout set to 60 seconds. </p>

<p>Definition at line <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00156">156</a> of file <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html">tcmi_msg.h</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d99/tcmi__authenticate__msg_8c_source.html#l00065">tcmi_authenticate_msg_new_tx()</a>.</p>

</div>
</div>
<a class="anchor" id="ga91f3fd64c88d27100f1e4c7125a73a0e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCMI_MSG</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">m</td><td>)</td>
          <td>&#160;&#160;&#160;((struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a>*)m)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Casts to the <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg" title="A coumpound structure that carries a generic TCMI message.">tcmi_msg</a> instance. </p>

<p>Definition at line <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00159">159</a> of file <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html">tcmi_msg.h</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d99/tcmi__authenticate__msg_8c_source.html#l00025">tcmi_authenticate_msg_new_rx()</a>, <a class="el" href="../../d0/d99/tcmi__authenticate__msg_8c_source.html#l00065">tcmi_authenticate_msg_new_tx()</a>, <a class="el" href="../../d8/d37/tcmi__authenticate__resp__msg_8c_source.html#l00024">tcmi_authenticate_resp_msg_new_rx()</a>, <a class="el" href="../../d8/d37/tcmi__authenticate__resp__msg_8c_source.html#l00065">tcmi_authenticate_resp_msg_new_tx()</a>, <a class="el" href="../../d4/dbc/tcmi__disconnect__msg_8c_source.html#l00023">tcmi_disconnect_msg_new_rx()</a>, <a class="el" href="../../d4/dbc/tcmi__disconnect__msg_8c_source.html#l00061">tcmi_disconnect_msg_new_tx()</a>, <a class="el" href="../../d4/d08/tcmi__err__msg_8c_source.html#l00051">tcmi_err_msg_new_rx()</a>, <a class="el" href="../../d4/d08/tcmi__err__msg_8c_source.html#l00096">tcmi_err_msg_new_tx()</a>, <a class="el" href="../../d9/dc1/tcmi__err__procmsg_8c_source.html#l00051">tcmi_err_procmsg_new_rx()</a>, <a class="el" href="../../d9/dc1/tcmi__err__procmsg_8c_source.html#l00095">tcmi_err_procmsg_new_tx()</a>, <a class="el" href="../../d3/dbc/tcmi__exit__procmsg_8c_source.html#l00051">tcmi_exit_procmsg_new_rx()</a>, <a class="el" href="../../d3/dbc/tcmi__exit__procmsg_8c_source.html#l00092">tcmi_exit_procmsg_new_tx()</a>, <a class="el" href="../../d3/d3d/tcmi__generic__user__msg_8c_source.html#l00024">tcmi_generic_user_msg_new_rx()</a>, <a class="el" href="../../d3/d3d/tcmi__generic__user__msg_8c_source.html#l00062">tcmi_generic_user_msg_new_tx()</a>, <a class="el" href="../../da/dc4/tcmi__generic__user__procmsg_8c_source.html#l00024">tcmi_generic_user_procmsg_new_rx()</a>, <a class="el" href="../../da/dc4/tcmi__generic__user__procmsg_8c_source.html#l00062">tcmi_generic_user_procmsg_new_tx()</a>, <a class="el" href="../../d3/dce/tcmi__guest__started__procmsg_8c_source.html#l00052">tcmi_guest_started_procmsg_new_rx()</a>, <a class="el" href="../../d3/dce/tcmi__guest__started__procmsg_8c_source.html#l00094">tcmi_guest_started_procmsg_new_tx()</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00155">tcmi_man_do_send_generic_user_message()</a>, <a class="el" href="../../d6/d82/tcmi__migman_8c_source.html#l00262">tcmi_migman_notify_peer_disconnect()</a>, <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html#l00178">tcmi_msg_send_and_receive()</a>, <a class="el" href="../../d3/d1b/tcmi__p__emigrate__msg_8c_source.html#l00053">tcmi_p_emigrate_msg_new_rx()</a>, <a class="el" href="../../d3/d1b/tcmi__p__emigrate__msg_8c_source.html#l00102">tcmi_p_emigrate_msg_new_tx()</a>, <a class="el" href="../../d9/d25/tcmi__ppm__p__emigrate__msg_8c_source.html#l00053">tcmi_ppm_p_emigrate_msg_new_rx()</a>, <a class="el" href="../../d9/d25/tcmi__ppm__p__emigrate__msg_8c_source.html#l00102">tcmi_ppm_p_emigrate_msg_new_tx()</a>, <a class="el" href="../../d2/dd7/tcmi__ppm__p__migr__back__guestreq__procmsg_8c_source.html#l00053">tcmi_ppm_p_migr_back_guestreq_procmsg_new_rx()</a>, <a class="el" href="../../d2/dd7/tcmi__ppm__p__migr__back__guestreq__procmsg_8c_source.html#l00096">tcmi_ppm_p_migr_back_guestreq_procmsg_new_tx()</a>, <a class="el" href="../../d0/dc6/tcmi__ppm__p__migr__back__shadowreq__procmsg_8c_source.html#l00025">tcmi_ppm_p_migr_back_shadowreq_procmsg_new_rx()</a>, <a class="el" href="../../d0/dc6/tcmi__ppm__p__migr__back__shadowreq__procmsg_8c_source.html#l00065">tcmi_ppm_p_migr_back_shadowreq_procmsg_new_tx()</a>, <a class="el" href="../../d5/d1c/tcmi__procmsg_8c_source.html#l00053">tcmi_procmsg_init_rx()</a>, <a class="el" href="../../d5/d1c/tcmi__procmsg_8c_source.html#l00082">tcmi_procmsg_init_tx()</a>, <a class="el" href="../../d2/d95/tcmi__rpc__procmsg_8c_source.html#l00050">tcmi_rpc_procmsg_new_rx()</a>, <a class="el" href="../../d2/d95/tcmi__rpc__procmsg_8c_source.html#l00093">tcmi_rpc_procmsg_new_tx()</a>, <a class="el" href="../../df/d9d/tcmi__rpcresp__procmsg_8c_source.html#l00098">tcmi_rpcresp_procmsg_create()</a>, <a class="el" href="../../df/d9d/tcmi__rpcresp__procmsg_8c_source.html#l00056">tcmi_rpcresp_procmsg_new_rx()</a>, <a class="el" href="../../df/d9d/tcmi__rpcresp__procmsg_8c_source.html#l00209">tcmi_rpcresp_procmsg_new_tx()</a>, <a class="el" href="../../d3/d5b/tcmi__signal__msg_8c_source.html#l00051">tcmi_signal_msg_new_rx()</a>, <a class="el" href="../../d3/d5b/tcmi__signal__msg_8c_source.html#l00095">tcmi_signal_msg_new_tx()</a>, <a class="el" href="../../d8/d37/tcmi__skel__msg_8c_source.html#l00052">tcmi_skel_msg_new_rx()</a>, <a class="el" href="../../d8/d37/tcmi__skel__msg_8c_source.html#l00096">tcmi_skel_msg_new_tx()</a>, <a class="el" href="../../d5/d4c/tcmi__skel__procmsg_8c_source.html#l00051">tcmi_skel_procmsg_new_rx()</a>, <a class="el" href="../../d5/d4c/tcmi__skel__procmsg_8c_source.html#l00097">tcmi_skel_procmsg_new_tx()</a>, <a class="el" href="../../dd/d48/tcmi__skelresp__msg_8c_source.html#l00051">tcmi_skelresp_msg_new_rx()</a>, <a class="el" href="../../dd/d48/tcmi__skelresp__msg_8c_source.html#l00094">tcmi_skelresp_msg_new_tx()</a>, <a class="el" href="../../d2/d8a/tcmi__skelresp__procmsg_8c_source.html#l00052">tcmi_skelresp_procmsg_new_rx()</a>, <a class="el" href="../../d2/d8a/tcmi__skelresp__procmsg_8c_source.html#l00097">tcmi_skelresp_procmsg_new_tx()</a>, <a class="el" href="../../d2/d89/tcmi__vfork__done__procmsg_8c_source.html#l00025">tcmi_vfork_done_procmsg_new_rx()</a>, and <a class="el" href="../../d2/d89/tcmi__vfork__done__procmsg_8c_source.html#l00064">tcmi_vfork_done_procmsg_new_tx()</a>.</p>

</div>
</div>
<a class="anchor" id="ga82cf8f5f561f28f5bebf952eb796df73"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCMI_MSG_DSC</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">id, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">new_rx_m, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">new_rx_err_m&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;{.msg_id = id, .new_rx = new_rx_m, .new_rx_err = new_rx_err_m}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Macro that fills the descriptor. </p>

<p>Definition at line <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00150">150</a> of file <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html">tcmi_msg.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga8e7c8f734e50ec514ed77795ad41b050"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tcmi_msg_deliver </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dc/d0c/group__tcmi__queue__class.html#d5/d9a/structtcmi__queue">tcmi_queue</a> *&#160;</td>
          <td class="paramname"><em>requests</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *&#160;</td>
          <td class="paramname"><em>transactions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Message delivers itself. </p>
<p>&lt;&lt;public&gt;&gt; Message delivers itself.</p>
<p>A delivery of a message depends on the message type. If it is the request part of the message or a one-way message, then the receiving party/thread wants to have it in the associated message queue. If it is a response to a previously sent message and the receiving party/thread expects it, it will get associated with its transaction.</p>
<ul>
<li>a message is of request type if it has a request transaction ID. In that case, it will be appended to the regular request queue and the queue processing thread will pick it up.</li>
<li>a message is of response type - has a response transaction ID. In that case, it will find its transaction. On success, it will associate itself with the transaction and complete it. Completing the transaction is handled by <a class="el" href="../../d4/d8c/group__tcmi__transaction__class.html#ga283a3e7e1414ff2eb5a49300c4af3208">the transaction class </a> internally.</li>
<li>in addition, if the transaction is marked anonymous (nobody is synchronously waiting for the response), the message will also be delivered into the regular message queue.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this message instance </td></tr>
    <tr><td class="paramname">*requests</td><td>- queue where the message is stored if it is not a response to other message. </td></tr>
    <tr><td class="paramname">*transactions</td><td>- contains all active transactions, the message tries to find its matching transaction. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon success </dd></dl>

<p>Definition at line <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html#l00297">297</a> of file <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html">tcmi_msg.c</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d0/dc1/proxyfs__server_8c_source.html#l00059">self</a>, <a class="el" href="../../dd/dd5/tcmi__messages__id_8h_source.html#l00087">TCMI_MSG_TYPE</a>, <a class="el" href="../../d8/d86/tcmi__queue_8h_source.html#l00217">tcmi_queue_add()</a>, <a class="el" href="../../d4/d2c/tcmi__transaction_8c_source.html#l00223">tcmi_transaction_complete()</a>, <a class="el" href="../../dd/d1d/tcmi__transaction_8h_source.html#l00213">tcmi_transaction_id()</a>, <a class="el" href="../../dd/d1d/tcmi__transaction_8h_source.html#l00099">TCMI_TRANSACTION_INVAL_ID</a>, <a class="el" href="../../dd/d1d/tcmi__transaction_8h_source.html#l00297">tcmi_transaction_is_anon()</a>, and <a class="el" href="../../d4/d2c/tcmi__transaction_8c_source.html#l00279">tcmi_transaction_lookup()</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d82/tcmi__migman_8c_source.html#l00604">tcmi_migman_deliver_msg()</a>, and <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00904">tcmi_task_deliver_msg()</a>.</p>
<div class="fragment"><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;{</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordtype">int</span> error = 0;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="comment">/* storage for the potential transaction associated with the message */</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d4/d8c/group__tcmi__transaction__class.html#d7/d6e/structtcmi__transaction" title="Compound structure holding transaction attributes.">tcmi_transaction</a> *tran;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">/* request message handling */</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">if</span> (self-&gt;trans_id.resp == <a class="code" href="../../d4/d8c/group__tcmi__transaction__class.html#gac546d01fab4d43f08caecc3f4fd7a90f" title="denotes an invalid transaction ID">TCMI_TRANSACTION_INVAL_ID</a>) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Adding message(ID=%x req=%x resp=%x) to the request queue&quot;</span>, </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;             self-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a51693aab24a0678dbd8c46766c2855fe" title="message id">msg_id</a>, self-&gt;trans_id.req, self-&gt;trans_id.resp);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <a class="code" href="../../dc/d0c/group__tcmi__queue__class.html#ga640f6067e72f77558cac6c58ca898c46" title="&lt;&lt;public&gt;&gt; Locks the queue and appends a new element to the tail.">tcmi_queue_add</a>(requests, &amp;self-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a28d522d781c96a324197685a68c07a89" title="list entry for the message queue">node</a>);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">/* response message handling */</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="comment">/* search for the transaction */</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keywordflow">if</span> (!(tran = <a class="code" href="../../d4/d8c/group__tcmi__transaction__class.html#gacb04fbb3689a2fffdef88873aa6cda62" title="&lt;&lt;public&gt;&gt; Tries to find a transaction based on its ID.">tcmi_transaction_lookup</a>(transactions, self-&gt;trans_id.resp))) {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Message(ID=%x req=%x resp=%x) - &quot;</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                 <span class="stringliteral">&quot;can&#39;t find response transaction ID among transactions&quot;</span>,</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                 self-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a51693aab24a0678dbd8c46766c2855fe" title="message id">msg_id</a>, self-&gt;trans_id.req, self-&gt;trans_id.resp);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            error = -1;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="comment">/* store the transaction in the message, reference</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">         * counter has been increased by the successful</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">         * lookup */</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keyword">self</span>-&gt;transaction = tran;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="comment">/* try completing it - only message type from the</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">        * message ID is taken, to verify that the message</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">        * being delivered matches the message expected by the</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">        * transaction */</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d8c/group__tcmi__transaction__class.html#ga283a3e7e1414ff2eb5a49300c4af3208" title="&lt;&lt;public&gt;&gt; Completes a transaction and wakes up the processing thread.">tcmi_transaction_complete</a>(tran, <span class="keyword">self</span>, <a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#ga8b36848530c08a745515c7f5e1daa098" title="Extracts the message type.">TCMI_MSG_TYPE</a>(self-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a51693aab24a0678dbd8c46766c2855fe" title="message id">msg_id</a>))) {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Error completing transaction %x&quot;</span>, </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                 <a class="code" href="../../d4/d8c/group__tcmi__transaction__class.html#gaac666feaaab1fe5c341237a3e0283501" title="&lt;&lt;public&gt;&gt; Transaction ID accessor.">tcmi_transaction_id</a>(tran));</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            error = -EINVAL;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d8c/group__tcmi__transaction__class.html#ga96d22d09c9571b01fee1eacf0b0c0b6b" title="&lt;&lt;public&gt;&gt; Checks on an anonymous transaction.">tcmi_transaction_is_anon</a>(tran)) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Detected anonymous transaction, queueing the message too..&quot;</span>);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <a class="code" href="../../dc/d0c/group__tcmi__queue__class.html#ga640f6067e72f77558cac6c58ca898c46" title="&lt;&lt;public&gt;&gt; Locks the queue and appends a new element to the tail.">tcmi_queue_add</a>(requests, &amp;self-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a28d522d781c96a324197685a68c07a89" title="list entry for the message queue">node</a>);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Message (ID=%x req=%x resp=%x) delivered, transaction completed&quot;</span>, </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;             self-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a51693aab24a0678dbd8c46766c2855fe" title="message id">msg_id</a>, self-&gt;trans_id.req, self-&gt;trans_id.resp);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; exit0:</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d6/dc2/group__tcmi__msg__class_ga8e7c8f734e50ec514ed77795ad41b050_cgraph.png" border="0" usemap="#d6/dc2/group__tcmi__msg__class_ga8e7c8f734e50ec514ed77795ad41b050_cgraph" alt=""/></div>
<map name="d6/dc2/group__tcmi__msg__class_ga8e7c8f734e50ec514ed77795ad41b050_cgraph" id="d6/dc2/group__tcmi__msg__class_ga8e7c8f734e50ec514ed77795ad41b050_cgraph">
<area shape="rect" id="node2" href="../../dc/d0c/group__tcmi__queue__class.html#ga640f6067e72f77558cac6c58ca898c46" title="&lt;&lt;public&gt;&gt; Locks the queue and appends a new element to the tail." alt="" coords="207,81,324,108"/><area shape="rect" id="node6" href="../../d4/d8c/group__tcmi__transaction__class.html#ga283a3e7e1414ff2eb5a49300c4af3208" title="&lt;&lt;public&gt;&gt; Completes a transaction and wakes up the processing thread." alt="" coords="176,296,355,323"/><area shape="rect" id="node13" href="../../d4/d8c/group__tcmi__transaction__class.html#gaac666feaaab1fe5c341237a3e0283501" title="&lt;&lt;public&gt;&gt; Transaction ID accessor." alt="" coords="627,376,762,403"/><area shape="rect" id="node22" href="../../d4/d8c/group__tcmi__transaction__class.html#ga96d22d09c9571b01fee1eacf0b0c0b6b" title="&lt;&lt;public&gt;&gt; Checks on an anonymous transaction." alt="" coords="180,528,351,555"/><area shape="rect" id="node23" href="../../d4/d8c/group__tcmi__transaction__class.html#gacb04fbb3689a2fffdef88873aa6cda62" title="&lt;&lt;public&gt;&gt; Tries to find a transaction based on its ID." alt="" coords="403,477,565,504"/><area shape="rect" id="node3" href="../../dc/d0c/group__tcmi__queue__class.html#ga3ae4d7e0a4d5d21ec8b9fff138f5b0d4" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="424,5,544,32"/><area shape="rect" id="node4" href="../../dc/d0c/group__tcmi__queue__class.html#ga40921ea3b077d55d70fb7b94ac666292" title="&lt;&lt;public&gt;&gt; Adds an element to the queue &#45; lock free version, assumes the lock is already held..." alt="" coords="419,56,549,83"/><area shape="rect" id="node5" href="../../dc/d0c/group__tcmi__queue__class.html#ga2e0e25eec1d5e4ea6e89dfde81ed43f4" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="417,107,551,133"/><area shape="rect" id="node7" href="../../d4/d8c/group__tcmi__transaction__class.html#gaba57811a17b10df187e7918d02e3679e" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="409,157,559,184"/><area shape="rect" id="node8" href="../../d4/d8c/group__tcmi__transaction__class.html#ga01baf770d7a3fdaa6931024d50f9d039" title="&lt;&lt;public&gt;&gt; Transaction state accessor." alt="" coords="407,208,561,235"/><area shape="rect" id="node9" href="../../d4/d8c/group__tcmi__transaction__class.html#gaf09ca8b38517289edf0bdb43ec06360d" title="&lt;&lt;public&gt;&gt; Checks on a running transaction." alt="" coords="417,259,551,301"/><area shape="rect" id="node10" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2c5c24c4b88dae68aa68c7b043d105b8" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="403,325,565,352"/><area shape="rect" id="node11" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2748d267a8fddd1ced86e73ba8efd079" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="413,376,555,403"/><area shape="rect" id="node12" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="632,477,757,504"/><area shape="rect" id="node14" href="../../da/d0c/group__tcmi__slot__class.html#ga1d6232adcf00094597a66d9f5740d5f8" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="633,325,756,352"/><area shape="rect" id="node21" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="625,427,764,453"/><area shape="rect" id="node15" href="../../da/d0c/group__tcmi__slot__class.html#ga29d8101c5815a6519567c548da4a3c7e" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="825,275,962,301"/><area shape="rect" id="node19" href="../../da/d0c/group__tcmi__slot__class.html#ga109d6d783ebf06046f364f970f84da1f" title="&lt;&lt;public&gt;&gt; Locks the slot data." alt="" coords="840,325,947,352"/><area shape="rect" id="node20" href="../../da/d0c/group__tcmi__slot__class.html#ga5447231fec5f42040c40307eb2e6a13c" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="833,376,953,403"/><area shape="rect" id="node16" href="../../da/d0c/group__tcmi__slot__class.html#ga6dd63ff2854a9939a5aa094f6543a5d1" title="&lt;&lt;public&gt;&gt; Checks if the slot is empty." alt="" coords="1033,249,1151,276"/><area shape="rect" id="node17" href="../../da/d0c/group__tcmi__slot__class.html#ga2550a3e6624b54e323c73cb1d06e6cd0" title="&lt;&lt;public&gt;&gt; Moves a slot among unused_slots." alt="" coords="1011,300,1173,327"/><area shape="rect" id="node18" href="../../da/d0c/group__tcmi__slot__class.html#ga8d6885be2677819158e0d956f0cca5b2" title="&lt;&lt;private&gt;&gt; Moves a slot into the specified list." alt="" coords="1221,300,1333,327"/><area shape="rect" id="node24" href="../../d0/db7/group__tcmi__slotvec__class.html#ga463d8dd03bd30b24c3ebfed5a0239d8a" title="&lt;&lt;public&gt;&gt; Hashmask accessor." alt="" coords="614,629,775,656"/><area shape="rect" id="node25" href="../../d0/db7/group__tcmi__slotvec__class.html#ga876670f605631a5deb930412dae02b28" title="&lt;&lt;public&gt;&gt; Accesses a slot at a given index." alt="" coords="639,528,751,555"/><area shape="rect" id="node26" href="../../d4/d8c/group__tcmi__transaction__class.html#ga176151d0f528ed8cda13e21da8551519" title="&lt;&lt;public&gt;&gt; Instance accessor." alt="" coords="623,579,766,605"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga4db62a1a76e13885a429b6212a77385f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u_int32_t tcmi_msg_errid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Message error ID accessor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this message instance </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>message ID extended with error flags </dd></dl>

<p>Definition at line <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00242">242</a> of file <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html">tcmi_msg.h</a>.</p>

<p>References <a class="el" href="../../d0/dc1/proxyfs__server_8c_source.html#l00059">self</a>, and <a class="el" href="../../dd/dd5/tcmi__messages__id_8h_source.html#l00102">TCMI_MSG_FLG_SET_ERR</a>.</p>
<div class="fragment"><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;{</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#gaa343f0b91b9cee9415f0fcf40f53b2ea" title="Sets an error flag.">TCMI_MSG_FLG_SET_ERR</a>(self-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a51693aab24a0678dbd8c46766c2855fe" title="message id">msg_id</a>);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga23d3ca435be85adedc5c1385469d707f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a>* tcmi_msg_get </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Instance accessor, increments the reference count. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this message instance </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00194">194</a> of file <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html">tcmi_msg.h</a>.</p>

<p>References <a class="el" href="../../d0/dc1/proxyfs__server_8c_source.html#l00059">self</a>.</p>

<p>Referenced by <a class="el" href="../../dc/d44/tcmi__migcom_8c_source.html#l00293">tcmi_migcom_immigrate()</a>, <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00127">tcmi_shadowtask_process_msg()</a>, and <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00450">tcmi_task_send_message()</a>.</p>
<div class="fragment"><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;{</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">self</span>) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        atomic_inc(&amp;self-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a6db666137db409d2606500f483fd1dca" title="reference counter">ref_count</a>);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">self</span>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga73489766817f528da25369a3f4c713a1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u_int32_t tcmi_msg_id </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Message ID accessor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this message instance </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>message ID </dd></dl>

<p>Definition at line <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00231">231</a> of file <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html">tcmi_msg.h</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d56/tcmi__ccnmigman_8c_source.html#l00214">tcmi_ccnmigman_process_msg()</a>, <a class="el" href="../../da/d61/tcmi__guesttask_8c_source.html#l00101">tcmi_guesttask_process_msg()</a>, <a class="el" href="../../d6/d82/tcmi__migman_8c_source.html#l00604">tcmi_migman_deliver_msg()</a>, <a class="el" href="../../d6/d82/tcmi__migman_8c_source.html#l00654">tcmi_migman_msg_thread()</a>, <a class="el" href="../../d9/ded/tcmi__penmigman_8c_source.html#l00271">tcmi_penmigman_process_msg()</a>, <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00127">tcmi_shadowtask_process_msg()</a>, <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00412">tcmi_shadowtask_verify_migration()</a>, <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00904">tcmi_task_deliver_msg()</a>, <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00398">tcmi_task_process_msg()</a>, and <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00209">tcmi_task_put()</a>.</p>
<div class="fragment"><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;{</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">self</span>-&gt;msg_id;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga0f81cf27b94206abc95c5b0002f66d2c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tcmi_msg_init_rx </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>msg_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d8/de4/structtcmi__msg__ops">tcmi_msg_ops</a> *&#160;</td>
          <td class="paramname"><em>msg_ops</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Initializes the message for receiving. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this message instance </td></tr>
    <tr><td class="paramname">msg_id</td><td>- ID of a particular message type </td></tr>
    <tr><td class="paramname">*msg_ops</td><td>- pointer to the message operations </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon success </dd></dl>

<p>Definition at line <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html#l00065">65</a> of file <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html">tcmi_msg.c</a>.</p>

<p>References <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html#l00041">tcmi_msg_init_shared()</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d99/tcmi__authenticate__msg_8c_source.html#l00025">tcmi_authenticate_msg_new_rx()</a>, <a class="el" href="../../d8/d37/tcmi__authenticate__resp__msg_8c_source.html#l00024">tcmi_authenticate_resp_msg_new_rx()</a>, <a class="el" href="../../d4/dbc/tcmi__disconnect__msg_8c_source.html#l00023">tcmi_disconnect_msg_new_rx()</a>, <a class="el" href="../../d4/d08/tcmi__err__msg_8c_source.html#l00051">tcmi_err_msg_new_rx()</a>, <a class="el" href="../../d3/d3d/tcmi__generic__user__msg_8c_source.html#l00024">tcmi_generic_user_msg_new_rx()</a>, <a class="el" href="../../da/dc4/tcmi__generic__user__procmsg_8c_source.html#l00024">tcmi_generic_user_procmsg_new_rx()</a>, <a class="el" href="../../d3/d1b/tcmi__p__emigrate__msg_8c_source.html#l00053">tcmi_p_emigrate_msg_new_rx()</a>, <a class="el" href="../../d9/d25/tcmi__ppm__p__emigrate__msg_8c_source.html#l00053">tcmi_ppm_p_emigrate_msg_new_rx()</a>, <a class="el" href="../../d5/d1c/tcmi__procmsg_8c_source.html#l00053">tcmi_procmsg_init_rx()</a>, <a class="el" href="../../d3/d5b/tcmi__signal__msg_8c_source.html#l00051">tcmi_signal_msg_new_rx()</a>, <a class="el" href="../../d8/d37/tcmi__skel__msg_8c_source.html#l00052">tcmi_skel_msg_new_rx()</a>, and <a class="el" href="../../dd/d48/tcmi__skelresp__msg_8c_source.html#l00051">tcmi_skelresp_msg_new_rx()</a>.</p>
<div class="fragment"><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;{</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../db/dc8/tcmi__msg_8c.html#a5c394462e393c496f11d949b265b8a9e" title="Shared initialization fuction of both rx and tx messages.">tcmi_msg_init_shared</a>(<span class="keyword">self</span>, msg_id, msg_ops);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d6/dc2/group__tcmi__msg__class_ga0f81cf27b94206abc95c5b0002f66d2c_cgraph.png" border="0" usemap="#d6/dc2/group__tcmi__msg__class_ga0f81cf27b94206abc95c5b0002f66d2c_cgraph" alt=""/></div>
<map name="d6/dc2/group__tcmi__msg__class_ga0f81cf27b94206abc95c5b0002f66d2c_cgraph" id="d6/dc2/group__tcmi__msg__class_ga0f81cf27b94206abc95c5b0002f66d2c_cgraph">
<area shape="rect" id="node2" href="../../db/dc8/tcmi__msg_8c.html#a5c394462e393c496f11d949b265b8a9e" title="Shared initialization fuction of both rx and tx messages." alt="" coords="176,5,325,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gace79df438ec4f7c8f7cee3bfe42f6d93"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tcmi_msg_init_tx </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>msg_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d8/de4/structtcmi__msg__ops">tcmi_msg_ops</a> *&#160;</td>
          <td class="paramname"><em>msg_ops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/db7/group__tcmi__slotvec__class.html#da/ded/structtcmi__slotvec">tcmi_slotvec</a> *&#160;</td>
          <td class="paramname"><em>transactions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>resp_msg_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int&#160;</td>
          <td class="paramname"><em>timeout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>resp_trans_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Initializes the message for transferring. </p>
<p>For oneway messages sets only message ID and message operations and associated transaction ID (for responses). If there is a response expected, sets up a new transaction.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this message instance </td></tr>
    <tr><td class="paramname">msg_id</td><td>- ID of a particular message type </td></tr>
    <tr><td class="paramname">*msg_ops</td><td>- pointer to the message specific operations </td></tr>
    <tr><td class="paramname">*transactions</td><td>- storage for the new transaction(NULL for one-way messages) </td></tr>
    <tr><td class="paramname">resp_msg_id</td><td>- response message ID - required for the transaction if the transaction expires(NULL for one-way messages) </td></tr>
    <tr><td class="paramname">timeout</td><td>- transaction time out (0 for one-way messages) </td></tr>
    <tr><td class="paramname">resp_trans_id</td><td>- response transaction ID - used when this message is a response to a particular request. The user must set this ID based on the value ofr req_trans_id of the previously received message. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon success </dd></dl>

<p>Definition at line <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html#l00089">89</a> of file <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html">tcmi_msg.c</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d0/dc1/proxyfs__server_8c_source.html#l00059">self</a>, <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html#l00041">tcmi_msg_init_shared()</a>, <a class="el" href="../../dd/dd5/tcmi__messages__id_8h_source.html#l00087">TCMI_MSG_TYPE</a>, <a class="el" href="../../dd/d1d/tcmi__transaction_8h_source.html#l00213">tcmi_transaction_id()</a>, and <a class="el" href="../../d4/d2c/tcmi__transaction_8c_source.html#l00067">tcmi_transaction_new()</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d99/tcmi__authenticate__msg_8c_source.html#l00065">tcmi_authenticate_msg_new_tx()</a>, <a class="el" href="../../d8/d37/tcmi__authenticate__resp__msg_8c_source.html#l00065">tcmi_authenticate_resp_msg_new_tx()</a>, <a class="el" href="../../d4/dbc/tcmi__disconnect__msg_8c_source.html#l00061">tcmi_disconnect_msg_new_tx()</a>, <a class="el" href="../../d4/d08/tcmi__err__msg_8c_source.html#l00096">tcmi_err_msg_new_tx()</a>, <a class="el" href="../../d3/d3d/tcmi__generic__user__msg_8c_source.html#l00062">tcmi_generic_user_msg_new_tx()</a>, <a class="el" href="../../da/dc4/tcmi__generic__user__procmsg_8c_source.html#l00062">tcmi_generic_user_procmsg_new_tx()</a>, <a class="el" href="../../d3/d1b/tcmi__p__emigrate__msg_8c_source.html#l00102">tcmi_p_emigrate_msg_new_tx()</a>, <a class="el" href="../../d9/d25/tcmi__ppm__p__emigrate__msg_8c_source.html#l00102">tcmi_ppm_p_emigrate_msg_new_tx()</a>, <a class="el" href="../../d5/d1c/tcmi__procmsg_8c_source.html#l00082">tcmi_procmsg_init_tx()</a>, <a class="el" href="../../d3/d5b/tcmi__signal__msg_8c_source.html#l00095">tcmi_signal_msg_new_tx()</a>, <a class="el" href="../../d8/d37/tcmi__skel__msg_8c_source.html#l00096">tcmi_skel_msg_new_tx()</a>, and <a class="el" href="../../dd/d48/tcmi__skelresp__msg_8c_source.html#l00094">tcmi_skelresp_msg_new_tx()</a>.</p>
<div class="fragment"><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;{</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordtype">int</span> error = 0;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">/* basic init is the same as when receiving a message */</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="../../db/dc8/tcmi__msg_8c.html#a5c394462e393c496f11d949b265b8a9e" title="Shared initialization fuction of both rx and tx messages.">tcmi_msg_init_shared</a>(<span class="keyword">self</span>, msg_id, msg_ops);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">/* transaction ID, needed if this message is a response to a previously sent message */</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keyword">self</span>-&gt;trans_id.resp = resp_trans_id;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">/* setup transaction when needed */</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">if</span> (transactions) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">if</span> (!(self-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a14d1c04acb1f841df160229c01983276" title="transaction associated with the message">transaction</a> = </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;              <a class="code" href="../../d4/d8c/group__tcmi__transaction__class.html#gada9d9436def8919a10997233cd6b5ea1" title="&lt;&lt;public&gt;&gt; Creates a new transaction.">tcmi_transaction_new</a>(transactions, </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                       <a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#ga8b36848530c08a745515c7f5e1daa098" title="Extracts the message type.">TCMI_MSG_TYPE</a>(resp_msg_id), timeout))) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Can&#39;t create a new transaction for message(ID=%x)&quot;</span>, msg_id);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            error = -1;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="comment">/* when a transaction was requested, set proper</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">         * request ID, so that the receiving is able to reply</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="keyword">self</span>-&gt;trans_id.req = <a class="code" href="../../d4/d8c/group__tcmi__transaction__class.html#gaac666feaaab1fe5c341237a3e0283501" title="&lt;&lt;public&gt;&gt; Transaction ID accessor.">tcmi_transaction_id</a>(self-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a14d1c04acb1f841df160229c01983276" title="transaction associated with the message">transaction</a>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d6/dc2/group__tcmi__msg__class_gace79df438ec4f7c8f7cee3bfe42f6d93_cgraph.png" border="0" usemap="#d6/dc2/group__tcmi__msg__class_gace79df438ec4f7c8f7cee3bfe42f6d93_cgraph" alt=""/></div>
<map name="d6/dc2/group__tcmi__msg__class_gace79df438ec4f7c8f7cee3bfe42f6d93_cgraph" id="d6/dc2/group__tcmi__msg__class_gace79df438ec4f7c8f7cee3bfe42f6d93_cgraph">
<area shape="rect" id="node2" href="../../db/dc8/tcmi__msg_8c.html#a5c394462e393c496f11d949b265b8a9e" title="Shared initialization fuction of both rx and tx messages." alt="" coords="176,5,325,32"/><area shape="rect" id="node3" href="../../d4/d8c/group__tcmi__transaction__class.html#gaac666feaaab1fe5c341237a3e0283501" title="&lt;&lt;public&gt;&gt; Transaction ID accessor." alt="" coords="786,157,921,184"/><area shape="rect" id="node4" href="../../d4/d8c/group__tcmi__transaction__class.html#gada9d9436def8919a10997233cd6b5ea1" title="&lt;&lt;public&gt;&gt; Creates a new transaction." alt="" coords="177,183,325,209"/><area shape="rect" id="node5" href="../../d4/d8c/group__tcmi__transaction__class.html#gad66082869d71dbe73b9a0b60cb2f437c" title="&lt;&lt;private&gt;&gt; Generates a transaction ID." alt="" coords="373,107,536,133"/><area shape="rect" id="node6" href="../../d0/db7/group__tcmi__slotvec__class.html#ga463d8dd03bd30b24c3ebfed5a0239d8a" title="&lt;&lt;public&gt;&gt; Hashmask accessor." alt="" coords="374,157,535,184"/><area shape="rect" id="node7" href="../../d4/d8c/group__tcmi__transaction__class.html#ga244e6188e1c4f9e1faba20d0892f5441" title="&lt;&lt;private&gt;&gt; Callback for the kernel timer that handles transaction timeouts." alt="" coords="377,259,532,285"/><area shape="rect" id="node18" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4f973395848150fbebecf3cc292c80ba" title="&lt;&lt;public&gt;&gt; The index where the insertion takes place has to be a valid slot." alt="" coords="585,360,735,387"/><area shape="rect" id="node8" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2748d267a8fddd1ced86e73ba8efd079" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="589,259,731,285"/><area shape="rect" id="node9" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="791,259,916,285"/><area shape="rect" id="node10" href="../../da/d0c/group__tcmi__slot__class.html#ga1d6232adcf00094597a66d9f5740d5f8" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="792,309,915,336"/><area shape="rect" id="node17" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="784,208,923,235"/><area shape="rect" id="node11" href="../../da/d0c/group__tcmi__slot__class.html#ga29d8101c5815a6519567c548da4a3c7e" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="971,259,1109,285"/><area shape="rect" id="node15" href="../../da/d0c/group__tcmi__slot__class.html#ga109d6d783ebf06046f364f970f84da1f" title="&lt;&lt;public&gt;&gt; Locks the slot data." alt="" coords="987,360,1093,387"/><area shape="rect" id="node16" href="../../da/d0c/group__tcmi__slot__class.html#ga5447231fec5f42040c40307eb2e6a13c" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="980,309,1100,336"/><area shape="rect" id="node12" href="../../da/d0c/group__tcmi__slot__class.html#ga6dd63ff2854a9939a5aa094f6543a5d1" title="&lt;&lt;public&gt;&gt; Checks if the slot is empty." alt="" coords="1179,259,1298,285"/><area shape="rect" id="node13" href="../../da/d0c/group__tcmi__slot__class.html#ga2550a3e6624b54e323c73cb1d06e6cd0" title="&lt;&lt;public&gt;&gt; Moves a slot among unused_slots." alt="" coords="1158,335,1319,361"/><area shape="rect" id="node14" href="../../da/d0c/group__tcmi__slot__class.html#ga8d6885be2677819158e0d956f0cca5b2" title="&lt;&lt;private&gt;&gt; Moves a slot into the specified list." alt="" coords="1368,373,1480,400"/><area shape="rect" id="node19" href="../../d0/db7/group__tcmi__slotvec__class.html#ga876670f605631a5deb930412dae02b28" title="&lt;&lt;public&gt;&gt; Accesses a slot at a given index." alt="" coords="797,411,909,437"/><area shape="rect" id="node20" href="../../da/d0c/group__tcmi__slot__class.html#gaefe294678d9d6922b3af1e452a318fa1" title="&lt;&lt;public&gt;&gt; Inserts a new node into the slot." alt="" coords="796,360,911,387"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gacd1d8503b665439b2562b4ca8806ca12"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a>* tcmi_msg_new_rx </td>
          <td>(</td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>msg_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d6/d81/structtcmi__msg__dsc">tcmi_msg_dsc</a> *&#160;</td>
          <td class="paramname"><em>dsc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Class method - creates a message based on a descriptor. </p>
<p>Verifies, that the message type in the message ID matches the one in the selected descriptor. Then, based on message ID flags calles the regular rx constructor or error rx constructor. This method is meant to be called by the message factory.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg_id</td><td>- this message ID is for verification </td></tr>
    <tr><td class="paramname">*dsc</td><td>- descriptor of a message that is to be built </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>new message instance or NULL </dd></dl>

<p>Definition at line <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html#l00357">357</a> of file <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html">tcmi_msg.c</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00142">tcmi_msg_dsc::msg_id</a>, <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00144">tcmi_msg_dsc::new_rx</a>, <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00146">tcmi_msg_dsc::new_rx_err</a>, <a class="el" href="../../dd/dd5/tcmi__messages__id_8h_source.html#l00100">TCMI_MSG_ERRFLGS</a>, <a class="el" href="../../dd/dd5/tcmi__messages__id_8h_source.html#l00091">TCMI_MSG_FLG</a>, <a class="el" href="../../dd/dd5/tcmi__messages__id_8h_source.html#l00098">TCMI_MSG_REGFLGS</a>, and <a class="el" href="../../dd/dd5/tcmi__messages__id_8h_source.html#l00087">TCMI_MSG_TYPE</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d10/tcmi__msg__factory_8c_source.html#l00052">tcmi_msg_factory()</a>.</p>
<div class="fragment"><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;{</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg" title="A coumpound structure that carries a generic TCMI message.">tcmi_msg</a> *msg = NULL;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#ga8b36848530c08a745515c7f5e1daa098" title="Extracts the message type.">TCMI_MSG_TYPE</a>(<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a51693aab24a0678dbd8c46766c2855fe" title="message id">msg_id</a>) != <a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#ga8b36848530c08a745515c7f5e1daa098" title="Extracts the message type.">TCMI_MSG_TYPE</a>(dsc-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a432db71c45d22dda192b4b4ee67b63d8" title="message id">msg_id</a>)) {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Requested message ID type(%x) doesn&#39;t match the descriptor(%x)&quot;</span>,</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;             <a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#ga8b36848530c08a745515c7f5e1daa098" title="Extracts the message type.">TCMI_MSG_TYPE</a>(<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a51693aab24a0678dbd8c46766c2855fe" title="message id">msg_id</a>), <a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#ga8b36848530c08a745515c7f5e1daa098" title="Extracts the message type.">TCMI_MSG_TYPE</a>(dsc-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a432db71c45d22dda192b4b4ee67b63d8" title="message id">msg_id</a>));</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">/* based on message flags call the regular or error rx constructor */</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#ga785b042b6da5ef82fe7aae9e0bf00f7d" title="Extracts the message flags.">TCMI_MSG_FLG</a>(<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a51693aab24a0678dbd8c46766c2855fe" title="message id">msg_id</a>)) {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#ga75bc9c90556793c69d79e80d07484feb" title="Regular message flag.">TCMI_MSG_REGFLGS</a>:</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keywordflow">if</span> (!dsc-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a75c310dfbb2de3895ac59b4c3cd1fcba" title="Builds the regular version of the message.">new_rx</a>) {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Regular rx message constructor not present, bailing out..&quot;</span>);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        msg = dsc-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a75c310dfbb2de3895ac59b4c3cd1fcba" title="Builds the regular version of the message.">new_rx</a>(<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a51693aab24a0678dbd8c46766c2855fe" title="message id">msg_id</a>);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="../../d8/d9d/group__tcmi__messages__id.html#gaf33258b9f9da1675ac9b59c044537305" title="Error message flag.">TCMI_MSG_ERRFLGS</a>:</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keywordflow">if</span> (!dsc-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#aaee00dc8e07b87cacd565308244ffa55" title="Builds the error version of the message.">new_rx_err</a>) {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Error rx message constructor not present, bailing out..&quot;</span>);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        msg = dsc-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#aaee00dc8e07b87cacd565308244ffa55" title="Builds the error version of the message.">new_rx_err</a>(<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a51693aab24a0678dbd8c46766c2855fe" title="message id">msg_id</a>);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Unexpected message flags value in message ID %x&quot;</span>, <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a51693aab24a0678dbd8c46766c2855fe" title="message id">msg_id</a>);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">return</span> msg;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; exit0:</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gac86a4090b7e1902ef603cb03191d6281"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_msg_put </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Decrements reference counter, if it reaches 0 the custom free method is called if defined. </p>
<p>Eventually, the instance is destroyed.</p>
<p>The user is responsible for taking the message out of the message queue or detaching it from the transaction when needed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this message instance </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00212">212</a> of file <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html">tcmi_msg.h</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d0/dc1/proxyfs__server_8c_source.html#l00059">self</a>, and <a class="el" href="../../d4/d2c/tcmi__transaction_8c_source.html#l00328">tcmi_transaction_put()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d56/tcmi__ccnmigman_8c_source.html#l00214">tcmi_ccnmigman_process_msg()</a>, <a class="el" href="../../de/df4/tcmi__comm_8c_source.html#l00145">tcmi_comm_thread()</a>, <a class="el" href="../../de/d24/tcmi__guest__fork__rpc_8c_source.html#l00021">tcmi_guest_rpc_sys_fork()</a>, <a class="el" href="../../d7/de7/tcmi__guest__groupident__rpc_8c_source.html#l00042">tcmi_guest_rpc_sys_getgroups()</a>, <a class="el" href="../../d7/de7/tcmi__guest__groupident__rpc_8c_source.html#l00103">tcmi_guest_rpc_sys_getresgid()</a>, <a class="el" href="../../dd/d09/tcmi__guest__userident__rpc_8c_source.html#l00040">tcmi_guest_rpc_sys_getresuid()</a>, <a class="el" href="../../d0/d96/tcmi__guest__signal__rpc_8c_source.html#l00040">tcmi_guest_rpc_sys_rt_sigqueueinfo()</a>, <a class="el" href="../../d7/de7/tcmi__guest__groupident__rpc_8c_source.html#l00071">tcmi_guest_rpc_sys_setgroups()</a>, <a class="el" href="../../d1/d5b/tcmi__guest__wait__rpc_8c_source.html#l00018">tcmi_guest_rpc_sys_wait4()</a>, <a class="el" href="../../da/d61/tcmi__guesttask_8c_source.html#l00237">tcmi_guesttask_exit()</a>, <a class="el" href="../../da/d61/tcmi__guesttask_8c_source.html#l00149">tcmi_guesttask_migrateback_p()</a>, <a class="el" href="../../da/d61/tcmi__guesttask_8c_source.html#l00358">tcmi_guesttask_post_fork()</a>, <a class="el" href="../../da/d61/tcmi__guesttask_8c_source.html#l00101">tcmi_guesttask_process_msg()</a>, <a class="el" href="../../da/d61/tcmi__guesttask_8c_source.html#l00307">tcmi_guesttask_process_p_emigrate_msg()</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00155">tcmi_man_do_send_generic_user_message()</a>, <a class="el" href="../../dc/d44/tcmi__migcom_8c_source.html#l00293">tcmi_migcom_immigrate()</a>, <a class="el" href="../../d9/d98/tcmi__mighooks_8c_source.html#l00215">tcmi_mighooks_execve()</a>, <a class="el" href="../../d6/d82/tcmi__migman_8c_source.html#l00262">tcmi_migman_notify_peer_disconnect()</a>, <a class="el" href="../../d9/ded/tcmi__penmigman_8c_source.html#l00108">tcmi_penmigman_auth_ccn()</a>, <a class="el" href="../../d9/ded/tcmi__penmigman_8c_source.html#l00271">tcmi_penmigman_process_msg()</a>, <a class="el" href="../../df/d9d/tcmi__rpcresp__procmsg_8c_source.html#l00157">tcmi_rpcresp_procmsg_get_response()</a>, <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00205">tcmi_shadowtask_emigrate_p()</a>, <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00328">tcmi_shadowtask_migrateback_ppm_p()</a>, <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00127">tcmi_shadowtask_process_msg()</a>, <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00398">tcmi_task_process_msg()</a>, <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00209">tcmi_task_put()</a>, and <a class="el" href="../../de/d84/tcmi__task_8c_source.html#l00450">tcmi_task_send_message()</a>.</p>
<div class="fragment"><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;{</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">if</span> (!<span class="keyword">self</span>)</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">if</span> (atomic_dec_and_test(&amp;self-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a6db666137db409d2606500f483fd1dca" title="reference counter">ref_count</a>)) {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO4, <span class="stringliteral">&quot;Destroying message ID %x, %p&quot;</span>, self-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a51693aab24a0678dbd8c46766c2855fe" title="message id">msg_id</a>, <span class="keyword">self</span>);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordflow">if</span>(self-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a34e09e067676b68511c309d06a0cdaf8" title="message operations">msg_ops</a> &amp;&amp; self-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a34e09e067676b68511c309d06a0cdaf8" title="message operations">msg_ops</a>-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ad6aea925df7908fbc8c05bd10f3dbd04" title="Frees custom message resources.">free</a>) </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <span class="keyword">self</span>-&gt;msg_ops-&gt;free(<span class="keyword">self</span>);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <a class="code" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2748d267a8fddd1ced86e73ba8efd079" title="&lt;&lt;public&gt;&gt; Releases the instance.">tcmi_transaction_put</a>(self-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a14d1c04acb1f841df160229c01983276" title="transaction associated with the message">transaction</a>);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        kfree(<span class="keyword">self</span>);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d6/dc2/group__tcmi__msg__class_gac86a4090b7e1902ef603cb03191d6281_cgraph.png" border="0" usemap="#d6/dc2/group__tcmi__msg__class_gac86a4090b7e1902ef603cb03191d6281_cgraph" alt=""/></div>
<map name="d6/dc2/group__tcmi__msg__class_gac86a4090b7e1902ef603cb03191d6281_cgraph" id="d6/dc2/group__tcmi__msg__class_gac86a4090b7e1902ef603cb03191d6281_cgraph">
<area shape="rect" id="node2" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2748d267a8fddd1ced86e73ba8efd079" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="158,81,301,108"/><area shape="rect" id="node3" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="356,5,481,32"/><area shape="rect" id="node4" href="../../d4/d8c/group__tcmi__transaction__class.html#gaac666feaaab1fe5c341237a3e0283501" title="&lt;&lt;public&gt;&gt; Transaction ID accessor." alt="" coords="351,56,486,83"/><area shape="rect" id="node5" href="../../da/d0c/group__tcmi__slot__class.html#ga1d6232adcf00094597a66d9f5740d5f8" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="357,107,480,133"/><area shape="rect" id="node12" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="349,157,488,184"/><area shape="rect" id="node6" href="../../da/d0c/group__tcmi__slot__class.html#ga29d8101c5815a6519567c548da4a3c7e" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="537,56,674,83"/><area shape="rect" id="node10" href="../../da/d0c/group__tcmi__slot__class.html#ga109d6d783ebf06046f364f970f84da1f" title="&lt;&lt;public&gt;&gt; Locks the slot data." alt="" coords="552,107,659,133"/><area shape="rect" id="node11" href="../../da/d0c/group__tcmi__slot__class.html#ga5447231fec5f42040c40307eb2e6a13c" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="545,157,665,184"/><area shape="rect" id="node7" href="../../da/d0c/group__tcmi__slot__class.html#ga6dd63ff2854a9939a5aa094f6543a5d1" title="&lt;&lt;public&gt;&gt; Checks if the slot is empty." alt="" coords="745,31,863,57"/><area shape="rect" id="node8" href="../../da/d0c/group__tcmi__slot__class.html#ga2550a3e6624b54e323c73cb1d06e6cd0" title="&lt;&lt;public&gt;&gt; Moves a slot among unused_slots." alt="" coords="723,81,885,108"/><area shape="rect" id="node9" href="../../da/d0c/group__tcmi__slot__class.html#ga8d6885be2677819158e0d956f0cca5b2" title="&lt;&lt;private&gt;&gt; Moves a slot into the specified list." alt="" coords="933,81,1045,108"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga84688215ef9615fdc2699eea0dbb8031"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tcmi_msg_recv </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d8e/group__kkc__sock__class.html#da/d0d/structkkc__sock">kkc_sock</a> *&#160;</td>
          <td class="paramname"><em>sock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Receives the message via a specified connection. </p>
<p>&lt;&lt;public&gt;&gt; Receives the message via a specified connection.</p>
<ul>
<li>reads the transaction ID from the connection</li>
<li>calls the receive method of the child class</li>
</ul>
<p>The transaction ID is temporarily stored in the instance and will be used upon delivery when searching for the corresponding transaction.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this message instance </td></tr>
    <tr><td class="paramname">*sock</td><td>- KKC socket used for receiving message data </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>&gt;=0 upon success.Unlike <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#ga1c21eeafb9a0d56dabb025d5fbdc0bc3" title="&lt;&lt;private&gt;&gt; Sends a message via a specified connection.">tcmi_msg_send()</a> we don't convert a &gt;=0 result to 0 as this will never get communicated to the user. The <a class="el" href="../../d9/dfc/group__tcmi__comm__class.html#gaef03fa6d00b3c8a916625e2d17b961d0">receiving thread </a> is the only component that should use this method. </dd></dl>

<p>Definition at line <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html#l00237">237</a> of file <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html">tcmi_msg.c</a>.</p>

<p>References <a class="el" href="../../df/dfa/kkc__sock_8h_source.html#l00064">KKC_SOCK_BLOCK</a>, <a class="el" href="../../df/dfa/kkc__sock_8h_source.html#l00325">kkc_sock_rcv_lock_interruptible()</a>, <a class="el" href="../../df/dfa/kkc__sock_8h_source.html#l00345">kkc_sock_rcv_unlock()</a>, <a class="el" href="../../d7/d5c/kkc__sock_8c_source.html#l00162">kkc_sock_recv()</a>, <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00129">tcmi_msg_ops::recv</a>, and <a class="el" href="../../d0/dc1/proxyfs__server_8c_source.html#l00059">self</a>.</p>

<p>Referenced by <a class="el" href="../../de/df4/tcmi__comm_8c_source.html#l00145">tcmi_comm_thread()</a>.</p>
<div class="fragment"><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;{</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordtype">int</span> err = 0;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#d8/de4/structtcmi__msg__ops" title="Message operations that support polymorphism.">tcmi_msg_ops</a> *ops = <span class="keyword">self</span>-&gt;msg_ops;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">if</span> ((err = <a class="code" href="../../d6/d8e/group__kkc__sock__class.html#ga111890916880384e47495e8859f57c95" title="&lt;&lt;public&gt;&gt; Locks this socket instance for receiving, interruptible version, the process can be woken ...">kkc_sock_rcv_lock_interruptible</a>(sock))) {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Socket lock - interrupted by a signal %d&quot;</span>, err);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">/* Receive the transaction ID part */</span>   </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">if</span> ((err = <a class="code" href="../../d6/d8e/group__kkc__sock__class.html#gadafc7c835c7d6d94be66f61a050108b7" title="&lt;&lt;public&gt;&gt; Receives requested number of bytes of data.">kkc_sock_recv</a>(sock, &amp;self-&gt;trans_id, </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                 <span class="keyword">sizeof</span>(self-&gt;trans_id), <a class="code" href="../../d6/d8e/group__kkc__sock__class.html#gga285317c87701990317a59884b3db40daa0766d1e1bec0bb50862530f5a53c9c70">KKC_SOCK_BLOCK</a>)) &lt; 0) {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Failed to receive transaction ID&#39;s&quot;</span>);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keywordflow">goto</span> exit1;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Receiving message(ID=%x req=%x resp=%x)&quot;</span>, </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;         self-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a51693aab24a0678dbd8c46766c2855fe" title="message id">msg_id</a>, self-&gt;trans_id.req, self-&gt;trans_id.resp);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">/* */</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">if</span> (ops &amp;&amp; ops-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#af0c362acebcc908de7b5135d4e0f03b9" title="Receives the message via a specified connection.">recv</a>) </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        err = ops-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#af0c362acebcc908de7b5135d4e0f03b9" title="Receives the message via a specified connection.">recv</a>(<span class="keyword">self</span>, sock);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <a class="code" href="../../d6/d8e/group__kkc__sock__class.html#ga82295120b31f3818bbc9b9a462a22b56" title="&lt;&lt;public&gt;&gt; Unlocks this socket instance for receiving.">kkc_sock_rcv_unlock</a>(sock);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; exit1:</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <a class="code" href="../../d6/d8e/group__kkc__sock__class.html#ga82295120b31f3818bbc9b9a462a22b56" title="&lt;&lt;public&gt;&gt; Unlocks this socket instance for receiving.">kkc_sock_rcv_unlock</a>(sock);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; exit0:</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d6/dc2/group__tcmi__msg__class_ga84688215ef9615fdc2699eea0dbb8031_cgraph.png" border="0" usemap="#d6/dc2/group__tcmi__msg__class_ga84688215ef9615fdc2699eea0dbb8031_cgraph" alt=""/></div>
<map name="d6/dc2/group__tcmi__msg__class_ga84688215ef9615fdc2699eea0dbb8031_cgraph" id="d6/dc2/group__tcmi__msg__class_ga84688215ef9615fdc2699eea0dbb8031_cgraph">
<area shape="rect" id="node2" href="../../d6/d8e/group__kkc__sock__class.html#ga111890916880384e47495e8859f57c95" title="&lt;&lt;public&gt;&gt; Locks this socket instance for receiving, interruptible version, the process can be woken ..." alt="" coords="163,5,370,32"/><area shape="rect" id="node3" href="../../d6/d8e/group__kkc__sock__class.html#ga82295120b31f3818bbc9b9a462a22b56" title="&lt;&lt;public&gt;&gt; Unlocks this socket instance for receiving." alt="" coords="193,56,340,83"/><area shape="rect" id="node4" href="../../d6/d8e/group__kkc__sock__class.html#gadafc7c835c7d6d94be66f61a050108b7" title="&lt;&lt;public&gt;&gt; Receives requested number of bytes of data." alt="" coords="213,107,321,133"/><area shape="rect" id="node5" href="../../d6/d8e/group__kkc__sock__class.html#gaff5e8804c93f0cb2a4b5e2e12f64e743" title="&lt;&lt;private&gt;&gt; Transfers a required number of bytes." alt="" coords="419,107,562,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga5a09e9d377637eba6c3df1236fc97926"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u_int32_t tcmi_msg_req_id </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Request transaction ID accessor. </p>
<p>This is needed when constructing reply messages to set a proper response transaction ID.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this message instance </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>message ID extended with error flags </dd></dl>

<p>Definition at line <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00255">255</a> of file <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html">tcmi_msg.h</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d56/tcmi__ccnmigman_8c_source.html#l00214">tcmi_ccnmigman_process_msg()</a>, <a class="el" href="../../da/d61/tcmi__guesttask_8c_source.html#l00307">tcmi_guesttask_process_p_emigrate_msg()</a>, <a class="el" href="../../d9/ded/tcmi__penmigman_8c_source.html#l00271">tcmi_penmigman_process_msg()</a>, and <a class="el" href="../../df/d9d/tcmi__rpcresp__procmsg_8c_source.html#l00098">tcmi_rpcresp_procmsg_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;{</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">self</span>-&gt;trans_id.req;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga1c21eeafb9a0d56dabb025d5fbdc0bc3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_msg_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d8e/group__kkc__sock__class.html#da/d0d/structkkc__sock">kkc_sock</a> *&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Sends a message via a specified connection. </p>
<p>Sending a message requires following steps:</p>
<ul>
<li>activate the transaction(if any)</li>
<li>send message ID,</li>
<li>send transaction ID(or TCMI_TRANSACTION_INVAL_ID for oneway messages)</li>
<li>call a specific message method</li>
</ul>
<p>It is necessary to lock the socket, so that the message won't get intermixed with some other.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this message instance </td></tr>
    <tr><td class="paramname">*sock</td><td>- KKC socket used for sending message data </td></tr>
    <tr><td class="paramname">flags</td><td>- if the message has a transaction, these are additional flags to be set in the transaction. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon success </dd></dl>
<p>try to start the transaction </p>

<p>Definition at line <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html#l00413">413</a> of file <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html">tcmi_msg.c</a>.</p>

<p>References <a class="el" href="../../df/dfa/kkc__sock_8h_source.html#l00064">KKC_SOCK_BLOCK</a>, <a class="el" href="../../d7/d5c/kkc__sock_8c_source.html#l00135">kkc_sock_send()</a>, <a class="el" href="../../df/dfa/kkc__sock_8h_source.html#l00294">kkc_sock_snd_lock_interruptible()</a>, <a class="el" href="../../df/dfa/kkc__sock_8h_source.html#l00314">kkc_sock_snd_unlock()</a>, <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d0/dc1/proxyfs__server_8c_source.html#l00059">self</a>, <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00131">tcmi_msg_ops::send</a>, and <a class="el" href="../../d4/d2c/tcmi__transaction_8c_source.html#l00130">tcmi_transaction_start()</a>.</p>

<p>Referenced by <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html#l00178">tcmi_msg_send_and_receive()</a>, and <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html#l00138">tcmi_msg_send_anonymous()</a>.</p>
<div class="fragment"><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;{</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordtype">int</span> err = 0;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#d8/de4/structtcmi__msg__ops" title="Message operations that support polymorphism.">tcmi_msg_ops</a> *ops = <span class="keyword">self</span>-&gt;msg_ops;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d4/d8c/group__tcmi__transaction__class.html#d7/d6e/structtcmi__transaction" title="Compound structure holding transaction attributes.">tcmi_transaction</a> *trans = <span class="keyword">self</span>-&gt;transaction;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">    /** try to start the transaction */</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">if</span> (trans &amp;&amp; (err = <a class="code" href="../../d4/d8c/group__tcmi__transaction__class.html#ga653b1761a1b6e9fef415196c54e00768" title="&lt;&lt;public&gt;&gt; Starts a transaction.">tcmi_transaction_start</a>(trans, <a class="code" href="../../d4/d83/tcmi__ckpt__openfile_8h.html#a38a8a1678784eecc1ffcc0685dbcce97" title="flags specified by the user when opening the file">flags</a>))) {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Failed to start the transaction %d&quot;</span>, err);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">/* Send message ID*/</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Sending message(Msg=%p ID=%x req=%x resp=%x), transaction started: %d&quot;</span>, </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;         <span class="keyword">self</span>, self-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a51693aab24a0678dbd8c46766c2855fe" title="message id">msg_id</a>, self-&gt;trans_id.req, self-&gt;trans_id.resp, (trans!=NULL));</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">if</span> ((err = <a class="code" href="../../d6/d8e/group__kkc__sock__class.html#ga141590d302ece9990e5c8cdd82a3c3d8" title="&lt;&lt;public&gt;&gt; Locks this socket instance for sending, interruptible version, the process can be woken up...">kkc_sock_snd_lock_interruptible</a>(sock))) {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Socket lock - interrupted by a signal %d&quot;</span>, err);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">if</span> ((err = <a class="code" href="../../d6/d8e/group__kkc__sock__class.html#gad734b131e2ab00e8d7fa30737fc2f5ad" title="&lt;&lt;public&gt;&gt; Sends out specified data.">kkc_sock_send</a>(sock, &amp;self-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a51693aab24a0678dbd8c46766c2855fe" title="message id">msg_id</a>, </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                 <span class="keyword">sizeof</span>(self-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a51693aab24a0678dbd8c46766c2855fe" title="message id">msg_id</a>), <a class="code" href="../../d6/d8e/group__kkc__sock__class.html#gga285317c87701990317a59884b3db40daa0766d1e1bec0bb50862530f5a53c9c70">KKC_SOCK_BLOCK</a>)) &lt; 0) {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Failed to send message ID: %d. Err: %d&quot;</span>, self-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a51693aab24a0678dbd8c46766c2855fe" title="message id">msg_id</a>, err);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="keywordflow">goto</span> exit1;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="comment">/* Send transaction ID&#39;s */</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">if</span> ((err = <a class="code" href="../../d6/d8e/group__kkc__sock__class.html#gad734b131e2ab00e8d7fa30737fc2f5ad" title="&lt;&lt;public&gt;&gt; Sends out specified data.">kkc_sock_send</a>(sock, &amp;self-&gt;trans_id, </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                 <span class="keyword">sizeof</span>(self-&gt;trans_id), <a class="code" href="../../d6/d8e/group__kkc__sock__class.html#gga285317c87701990317a59884b3db40daa0766d1e1bec0bb50862530f5a53c9c70">KKC_SOCK_BLOCK</a>)) &lt; 0) {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Failed to send transaction ID&#39;s&quot;</span>);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">goto</span> exit1;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    }</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="comment">/* Send the actual message content */</span>   </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">if</span> (ops &amp;&amp; ops-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ade162f3c56d38bbbcf4f5c4f119f1bd5" title="Sends the message via a specified connection.">send</a>) {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        err = ops-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ade162f3c56d38bbbcf4f5c4f119f1bd5" title="Sends the message via a specified connection.">send</a>(<span class="keyword">self</span>, sock);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="comment">/* convert the result to 0 if no error has occured this is</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">     * because the number of bytes sent has no meaning for us anymore */</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    err = min(err, 0);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <a class="code" href="../../d6/d8e/group__kkc__sock__class.html#ga841d6dff84842f19540eae27c37fcb4c" title="&lt;&lt;public&gt;&gt; Unlocks this socket instance for sending.">kkc_sock_snd_unlock</a>(sock);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="comment">/* error handling */</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; exit1:</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <a class="code" href="../../d6/d8e/group__kkc__sock__class.html#ga841d6dff84842f19540eae27c37fcb4c" title="&lt;&lt;public&gt;&gt; Unlocks this socket instance for sending.">kkc_sock_snd_unlock</a>(sock);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; exit0:</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d6/dc2/group__tcmi__msg__class_ga1c21eeafb9a0d56dabb025d5fbdc0bc3_cgraph.png" border="0" usemap="#d6/dc2/group__tcmi__msg__class_ga1c21eeafb9a0d56dabb025d5fbdc0bc3_cgraph" alt=""/></div>
<map name="d6/dc2/group__tcmi__msg__class_ga1c21eeafb9a0d56dabb025d5fbdc0bc3_cgraph" id="d6/dc2/group__tcmi__msg__class_ga1c21eeafb9a0d56dabb025d5fbdc0bc3_cgraph">
<area shape="rect" id="node2" href="../../d6/d8e/group__kkc__sock__class.html#gad734b131e2ab00e8d7fa30737fc2f5ad" title="&lt;&lt;public&gt;&gt; Sends out specified data." alt="" coords="217,5,330,32"/><area shape="rect" id="node4" href="../../d6/d8e/group__kkc__sock__class.html#ga141590d302ece9990e5c8cdd82a3c3d8" title="&lt;&lt;public&gt;&gt; Locks this socket instance for sending, interruptible version, the process can be woken up..." alt="" coords="168,56,379,83"/><area shape="rect" id="node5" href="../../d6/d8e/group__kkc__sock__class.html#ga841d6dff84842f19540eae27c37fcb4c" title="&lt;&lt;public&gt;&gt; Unlocks this socket instance for sending." alt="" coords="198,107,349,133"/><area shape="rect" id="node6" href="../../d4/d8c/group__tcmi__transaction__class.html#ga653b1761a1b6e9fef415196c54e00768" title="&lt;&lt;public&gt;&gt; Starts a transaction." alt="" coords="198,157,349,184"/><area shape="rect" id="node3" href="../../d6/d8e/group__kkc__sock__class.html#gaff5e8804c93f0cb2a4b5e2e12f64e743" title="&lt;&lt;private&gt;&gt; Transfers a required number of bytes." alt="" coords="437,5,579,32"/><area shape="rect" id="node7" href="../../d4/d8c/group__tcmi__transaction__class.html#gaba57811a17b10df187e7918d02e3679e" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="433,81,583,108"/><area shape="rect" id="node8" href="../../d4/d8c/group__tcmi__transaction__class.html#ga176151d0f528ed8cda13e21da8551519" title="&lt;&lt;public&gt;&gt; Instance accessor." alt="" coords="437,132,579,159"/><area shape="rect" id="node9" href="../../d4/d8c/group__tcmi__transaction__class.html#ga1dfece4fcea1c1b9ce676f560957077f" title="&lt;&lt;public&gt;&gt; Sets flags in the transaction that denote additional transaction attributes." alt="" coords="437,183,579,225"/><area shape="rect" id="node10" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2c5c24c4b88dae68aa68c7b043d105b8" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="427,249,589,276"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gadcb05f36b8afb930d1a825ae12ff7d3c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tcmi_msg_send_and_receive </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d8e/group__kkc__sock__class.html#da/d0d/structkkc__sock">kkc_sock</a> *&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> **&#160;</td>
          <td class="paramname"><em>resp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Sends a message via a specified connection and waits for the response. </p>
<p>This method is used when the message being sent out has a transaction and a response is expected. The calling thread blocks until a valid response arrives or the transaction expires.</p>
<p>The actual work is delegated to <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#ga1c21eeafb9a0d56dabb025d5fbdc0bc3" title="&lt;&lt;private&gt;&gt; Sends a message via a specified connection.">tcmi_msg_send()</a> specifying no extra flags for the transaction. The thread is then put to sleep waiting for completion of the transaction. When its woken up again, the transaction has:</p>
<ul>
<li>been aborted - the user gets NULL in the response message parameter OR</li>
<li>been completed - the response is extracted from the transaction context OR</li>
<li>a signal has arrived, in that case the transaction will be aborted, but there is still a chance that the response has arrived in the mean time and completed the transaction. In that rare case, the abort fails and returns a valid transaction context, which is our response message. The transaction stays marked as complete.</li>
</ul>
<p>The transaction is eventually released.</p>
<p>The case when there is no transaction associated with the message is handled correctly - method terminates right after sending out the message.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this message instance </td></tr>
    <tr><td class="paramname">*sock</td><td>- KKC socket used for sending message data </td></tr>
    <tr><td class="paramname">**resp</td><td>- contains response message or NULL if the transaction is aborted </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon success </dd></dl>

<p>Definition at line <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html#l00178">178</a> of file <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html">tcmi_msg.c</a>.</p>

<p>References <a class="el" href="../../d6/d01/dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d0/dc1/proxyfs__server_8c_source.html#l00059">self</a>, <a class="el" href="../../d1/d6d/tcmi__msg_8h_source.html#l00159">TCMI_MSG</a>, <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html#l00413">tcmi_msg_send()</a>, <a class="el" href="../../d4/d2c/tcmi__transaction_8c_source.html#l00168">tcmi_transaction_abort()</a>, <a class="el" href="../../dd/d1d/tcmi__transaction_8h_source.html#l00095">TCMI_TRANSACTION_ABORTED</a>, <a class="el" href="../../dd/d1d/tcmi__transaction_8h_source.html#l00094">TCMI_TRANSACTION_COMPLETE</a>, <a class="el" href="../../dd/d1d/tcmi__transaction_8h_source.html#l00238">tcmi_transaction_context()</a>, and <a class="el" href="../../dd/d1d/tcmi__transaction_8h_source.html#l00328">tcmi_transaction_wait_interruptible()</a>.</p>

<p>Referenced by <a class="el" href="../../d9/ded/tcmi__penmigman_8c_source.html#l00108">tcmi_penmigman_auth_ccn()</a>, and <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00567">tcmi_task_send_and_receive_msg()</a>.</p>
<div class="fragment"><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;{</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordtype">int</span> err = 0;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">/* increment the reference counter, does nothing when NULL */</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d4/d8c/group__tcmi__transaction__class.html#d7/d6e/structtcmi__transaction" title="Compound structure holding transaction attributes.">tcmi_transaction</a> *trans = <span class="keyword">self</span>-&gt;transaction;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    *resp = NULL;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">/* try sending the data first, quit on error or no transaction */</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    err = <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ga1c21eeafb9a0d56dabb025d5fbdc0bc3" title="&lt;&lt;private&gt;&gt; Sends a message via a specified connection.">tcmi_msg_send</a>(<span class="keyword">self</span>, sock, 0);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">if</span> (!self-&gt;<a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#a14d1c04acb1f841df160229c01983276" title="transaction associated with the message">transaction</a> || err &lt; 0)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordflow">goto</span> exit0;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">/* wait till the transaction expires */</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    ret = <a class="code" href="../../d4/d8c/group__tcmi__transaction__class.html#gaadc5d69241ec4815bf37e041ec0844dc" title="&lt;&lt;public&gt;&gt; Waits on a transaction till it expires or is completed, the task can be prematurely woken ...">tcmi_transaction_wait_interruptible</a>(trans);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">switch</span> (ret) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="../../d4/d8c/group__tcmi__transaction__class.html#ggad5b94b8d233636d6d4f48b82ae08e59da390b6a98474b9960141360353fd0ac98">TCMI_TRANSACTION_ABORTED</a>:</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Transaction has been aborted, no response arrived&quot;</span>);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="../../d4/d8c/group__tcmi__transaction__class.html#ggad5b94b8d233636d6d4f48b82ae08e59da22d0b0bfd58d5d11fe441caa7f2c6395">TCMI_TRANSACTION_COMPLETE</a>:</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Transaction complete, picking up the response&quot;</span>);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            *resp = <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ga91f3fd64c88d27100f1e4c7125a73a0e" title="Casts to the tcmi_msg instance.">TCMI_MSG</a>(<a class="code" href="../../d4/d8c/group__tcmi__transaction__class.html#ga8a1027d8451c92d105ff818b0bf09c1d" title="&lt;&lt;public&gt;&gt; Transaction context accessor.">tcmi_transaction_context</a>(trans));</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="comment">/* Aborting a transaction upon a signal arrival must</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">         * be atomic, it will fail if the transaction has been</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">         * completed in the meantime and thus the method returns a valid</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">         * transaction context and transaction stays in &#39;COMPLETE&#39; state */</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">case</span> -ERESTARTSYS:</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <a class="code" href="../../d6/d01/dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO3, <span class="stringliteral">&quot;Signal arrived, result %d. Check if we abort the transaction..&quot;</span>, ret);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        *resp = <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ga91f3fd64c88d27100f1e4c7125a73a0e" title="Casts to the tcmi_msg instance.">TCMI_MSG</a>(<a class="code" href="../../d4/d8c/group__tcmi__transaction__class.html#gaec110b630e8c0935ddddfb0529a03368" title="&lt;&lt;public&gt;&gt; Aborting the transaction requires:">tcmi_transaction_abort</a>(trans));</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="comment">/* communicate the -ERESTARTSYS to the caller */</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        err = ret;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; exit0:</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d6/dc2/group__tcmi__msg__class_gadcb05f36b8afb930d1a825ae12ff7d3c_cgraph.png" border="0" usemap="#d6/dc2/group__tcmi__msg__class_gadcb05f36b8afb930d1a825ae12ff7d3c_cgraph" alt=""/></div>
<map name="d6/dc2/group__tcmi__msg__class_gadcb05f36b8afb930d1a825ae12ff7d3c_cgraph" id="d6/dc2/group__tcmi__msg__class_gadcb05f36b8afb930d1a825ae12ff7d3c_cgraph">
<area shape="rect" id="node2" href="../../d6/dc2/group__tcmi__msg__class.html#ga1c21eeafb9a0d56dabb025d5fbdc0bc3" title="&lt;&lt;private&gt;&gt; Sends a message via a specified connection." alt="" coords="269,107,384,133"/><area shape="rect" id="node12" href="../../d4/d8c/group__tcmi__transaction__class.html#gaec110b630e8c0935ddddfb0529a03368" title="&lt;&lt;public&gt;&gt; Aborting the transaction requires:" alt="" coords="249,377,404,404"/><area shape="rect" id="node25" href="../../d4/d8c/group__tcmi__transaction__class.html#ga8a1027d8451c92d105ff818b0bf09c1d" title="&lt;&lt;public&gt;&gt; Transaction context accessor." alt="" coords="243,428,411,455"/><area shape="rect" id="node26" href="../../d4/d8c/group__tcmi__transaction__class.html#gaadc5d69241ec4815bf37e041ec0844dc" title="&lt;&lt;public&gt;&gt; Waits on a transaction till it expires or is completed, the task can be prematurely woken ..." alt="" coords="253,297,401,338"/><area shape="rect" id="node3" href="../../d6/d8e/group__kkc__sock__class.html#gad734b131e2ab00e8d7fa30737fc2f5ad" title="&lt;&lt;public&gt;&gt; Sends out specified data." alt="" coords="507,56,621,83"/><area shape="rect" id="node5" href="../../d6/d8e/group__kkc__sock__class.html#ga141590d302ece9990e5c8cdd82a3c3d8" title="&lt;&lt;public&gt;&gt; Locks this socket instance for sending, interruptible version, the process can be woken up..." alt="" coords="459,157,669,184"/><area shape="rect" id="node6" href="../../d6/d8e/group__kkc__sock__class.html#ga841d6dff84842f19540eae27c37fcb4c" title="&lt;&lt;public&gt;&gt; Unlocks this socket instance for sending." alt="" coords="489,5,639,32"/><area shape="rect" id="node7" href="../../d4/d8c/group__tcmi__transaction__class.html#ga653b1761a1b6e9fef415196c54e00768" title="&lt;&lt;public&gt;&gt; Starts a transaction." alt="" coords="489,107,639,133"/><area shape="rect" id="node4" href="../../d6/d8e/group__kkc__sock__class.html#gaff5e8804c93f0cb2a4b5e2e12f64e743" title="&lt;&lt;private&gt;&gt; Transfers a required number of bytes." alt="" coords="727,56,870,83"/><area shape="rect" id="node8" href="../../d4/d8c/group__tcmi__transaction__class.html#gaba57811a17b10df187e7918d02e3679e" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="724,240,873,267"/><area shape="rect" id="node9" href="../../d4/d8c/group__tcmi__transaction__class.html#ga176151d0f528ed8cda13e21da8551519" title="&lt;&lt;public&gt;&gt; Instance accessor." alt="" coords="727,107,870,133"/><area shape="rect" id="node10" href="../../d4/d8c/group__tcmi__transaction__class.html#ga1dfece4fcea1c1b9ce676f560957077f" title="&lt;&lt;public&gt;&gt; Sets flags in the transaction that denote additional transaction attributes." alt="" coords="727,158,870,199"/><area shape="rect" id="node11" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2c5c24c4b88dae68aa68c7b043d105b8" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="717,324,880,351"/><area shape="rect" id="node13" href="../../d4/d8c/group__tcmi__transaction__class.html#ga755c57502b82f1c20a9adcdea11990a9" title="&lt;&lt;public&gt;&gt; Checks on a complete transaction." alt="" coords="497,326,631,367"/><area shape="rect" id="node14" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2748d267a8fddd1ced86e73ba8efd079" title="&lt;&lt;public&gt;&gt; Releases the instance." alt="" coords="493,493,635,520"/><area shape="rect" id="node15" href="../../d0/db7/group__tcmi__slotvec__class.html#ga5b4586b2e897ec306862a0b6901f39e7" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="736,569,861,596"/><area shape="rect" id="node16" href="../../d4/d8c/group__tcmi__transaction__class.html#gaac666feaaab1fe5c341237a3e0283501" title="&lt;&lt;public&gt;&gt; Transaction ID accessor." alt="" coords="731,417,866,444"/><area shape="rect" id="node17" href="../../da/d0c/group__tcmi__slot__class.html#ga1d6232adcf00094597a66d9f5740d5f8" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="737,468,860,495"/><area shape="rect" id="node24" href="../../d0/db7/group__tcmi__slotvec__class.html#ga4df343d549736d3dc994ad0f43529a57" title="&lt;&lt;public&gt;&gt; Unlocks the instance data." alt="" coords="729,519,868,545"/><area shape="rect" id="node18" href="../../da/d0c/group__tcmi__slot__class.html#ga29d8101c5815a6519567c548da4a3c7e" title="&lt;&lt;public&gt;&gt; Removes a given node from a slot." alt="" coords="929,417,1066,444"/><area shape="rect" id="node22" href="../../da/d0c/group__tcmi__slot__class.html#ga109d6d783ebf06046f364f970f84da1f" title="&lt;&lt;public&gt;&gt; Locks the slot data." alt="" coords="944,468,1051,495"/><area shape="rect" id="node23" href="../../da/d0c/group__tcmi__slot__class.html#ga5447231fec5f42040c40307eb2e6a13c" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="937,519,1057,545"/><area shape="rect" id="node19" href="../../da/d0c/group__tcmi__slot__class.html#ga6dd63ff2854a9939a5aa094f6543a5d1" title="&lt;&lt;public&gt;&gt; Checks if the slot is empty." alt="" coords="1137,392,1255,419"/><area shape="rect" id="node20" href="../../da/d0c/group__tcmi__slot__class.html#ga2550a3e6624b54e323c73cb1d06e6cd0" title="&lt;&lt;public&gt;&gt; Moves a slot among unused_slots." alt="" coords="1115,443,1277,469"/><area shape="rect" id="node21" href="../../da/d0c/group__tcmi__slot__class.html#ga8d6885be2677819158e0d956f0cca5b2" title="&lt;&lt;private&gt;&gt; Moves a slot into the specified list." alt="" coords="1325,443,1437,469"/><area shape="rect" id="node27" href="../../d4/d8c/group__tcmi__transaction__class.html#gafebfbc6a51c59cbdb2bd9470b82afc18" title="&lt;&lt;public&gt;&gt; Checks on aborted transaction." alt="" coords="497,209,631,250"/><area shape="rect" id="node28" href="../../d4/d8c/group__tcmi__transaction__class.html#ga01baf770d7a3fdaa6931024d50f9d039" title="&lt;&lt;public&gt;&gt; Transaction state accessor." alt="" coords="487,275,641,301"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga7a8fe8cbfd4b25c15589c8599f66e574"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tcmi_msg_send_anonymous </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#d0/d5b/structtcmi__msg">tcmi_msg</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d8e/group__kkc__sock__class.html#da/d0d/structkkc__sock">kkc_sock</a> *&#160;</td>
          <td class="paramname"><em>sock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>&lt;&lt;public&gt;&gt; Sends a message via a specified connection. </p>
<p>Sending an anonymous message means, that if there is a transaction associated with the message, the response message will be delivered into regular message queue. This is typically used when the sending thread doesn't want to process the response message itself, but still wants the response to be checked against the transaction.</p>
<p>The actual work is delegated to <a class="el" href="../../d6/dc2/group__tcmi__msg__class.html#ga1c21eeafb9a0d56dabb025d5fbdc0bc3" title="&lt;&lt;private&gt;&gt; Sends a message via a specified connection.">tcmi_msg_send()</a> specifying the anonymous flag. Then the transaction instance is released as the sending thread doesn't needed it. The status of the send operation is communicated to the user.</p>
<p>This method is also to be used for sending one-way request messages.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this message instance </td></tr>
    <tr><td class="paramname">*sock</td><td>- KKC socket used for sending message data be set in the transaction. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon success </dd></dl>

<p>Definition at line <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html#l00138">138</a> of file <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html">tcmi_msg.c</a>.</p>

<p>References <a class="el" href="../../db/dc8/tcmi__msg_8c_source.html#l00413">tcmi_msg_send()</a>, and <a class="el" href="../../dd/d1d/tcmi__transaction_8h_source.html#l00102">TCMI_TRANS_FLAGS_ANONYMOUS</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d56/tcmi__ccnmigman_8c_source.html#l00214">tcmi_ccnmigman_process_msg()</a>, <a class="el" href="../../dd/dbd/tcmi__man_8c_source.html#l00155">tcmi_man_do_send_generic_user_message()</a>, <a class="el" href="../../d6/d82/tcmi__migman_8c_source.html#l00262">tcmi_migman_notify_peer_disconnect()</a>, <a class="el" href="../../d9/ded/tcmi__penmigman_8c_source.html#l00271">tcmi_penmigman_process_msg()</a>, <a class="el" href="../../d7/d0a/tcmi__shadowtask_8c_source.html#l00384">tcmi_shadowtask_do_signal()</a>, and <a class="el" href="../../d4/d4e/tcmi__task_8h_source.html#l00524">tcmi_task_send_anonymous_msg()</a>.</p>
<div class="fragment"><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;{</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordtype">int</span> err;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    err = <a class="code" href="../../d6/dc2/group__tcmi__msg__class.html#ga1c21eeafb9a0d56dabb025d5fbdc0bc3" title="&lt;&lt;private&gt;&gt; Sends a message via a specified connection.">tcmi_msg_send</a>(<span class="keyword">self</span>, sock, <a class="code" href="../../d4/d8c/group__tcmi__transaction__class.html#ga80351dda01e92bc0cb0f5c6695303931" title="Denotes a transaction, where nobody is waiting for the response.">TCMI_TRANS_FLAGS_ANONYMOUS</a>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d6/dc2/group__tcmi__msg__class_ga7a8fe8cbfd4b25c15589c8599f66e574_cgraph.png" border="0" usemap="#d6/dc2/group__tcmi__msg__class_ga7a8fe8cbfd4b25c15589c8599f66e574_cgraph" alt=""/></div>
<map name="d6/dc2/group__tcmi__msg__class_ga7a8fe8cbfd4b25c15589c8599f66e574_cgraph" id="d6/dc2/group__tcmi__msg__class_ga7a8fe8cbfd4b25c15589c8599f66e574_cgraph">
<area shape="rect" id="node2" href="../../d6/dc2/group__tcmi__msg__class.html#ga1c21eeafb9a0d56dabb025d5fbdc0bc3" title="&lt;&lt;private&gt;&gt; Sends a message via a specified connection." alt="" coords="243,81,357,108"/><area shape="rect" id="node3" href="../../d6/d8e/group__kkc__sock__class.html#gad734b131e2ab00e8d7fa30737fc2f5ad" title="&lt;&lt;public&gt;&gt; Sends out specified data." alt="" coords="454,5,567,32"/><area shape="rect" id="node5" href="../../d6/d8e/group__kkc__sock__class.html#ga141590d302ece9990e5c8cdd82a3c3d8" title="&lt;&lt;public&gt;&gt; Locks this socket instance for sending, interruptible version, the process can be woken up..." alt="" coords="405,56,616,83"/><area shape="rect" id="node6" href="../../d6/d8e/group__kkc__sock__class.html#ga841d6dff84842f19540eae27c37fcb4c" title="&lt;&lt;public&gt;&gt; Unlocks this socket instance for sending." alt="" coords="435,107,586,133"/><area shape="rect" id="node7" href="../../d4/d8c/group__tcmi__transaction__class.html#ga653b1761a1b6e9fef415196c54e00768" title="&lt;&lt;public&gt;&gt; Starts a transaction." alt="" coords="435,157,586,184"/><area shape="rect" id="node4" href="../../d6/d8e/group__kkc__sock__class.html#gaff5e8804c93f0cb2a4b5e2e12f64e743" title="&lt;&lt;private&gt;&gt; Transfers a required number of bytes." alt="" coords="674,5,817,32"/><area shape="rect" id="node8" href="../../d4/d8c/group__tcmi__transaction__class.html#gaba57811a17b10df187e7918d02e3679e" title="&lt;&lt;public&gt;&gt; Locks the instance data." alt="" coords="671,81,820,108"/><area shape="rect" id="node9" href="../../d4/d8c/group__tcmi__transaction__class.html#ga176151d0f528ed8cda13e21da8551519" title="&lt;&lt;public&gt;&gt; Instance accessor." alt="" coords="674,132,817,159"/><area shape="rect" id="node10" href="../../d4/d8c/group__tcmi__transaction__class.html#ga1dfece4fcea1c1b9ce676f560957077f" title="&lt;&lt;public&gt;&gt; Sets flags in the transaction that denote additional transaction attributes." alt="" coords="674,183,817,225"/><area shape="rect" id="node11" href="../../d4/d8c/group__tcmi__transaction__class.html#ga2c5c24c4b88dae68aa68c7b043d105b8" title="&lt;&lt;public&gt;&gt; Unlocks the instance data" alt="" coords="664,249,827,276"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun Apr 7 2013 23:20:14 for Clondike by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
