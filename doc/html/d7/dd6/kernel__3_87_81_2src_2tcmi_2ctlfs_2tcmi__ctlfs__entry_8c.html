<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Clondike: C:/CLONDIKE/clondike/sources/kernel_3.7.1/src/tcmi/ctlfs/tcmi_ctlfs_entry.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Clondike
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">tcmi_ctlfs_entry.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;linux/module.h&gt;</code><br/>
<code>#include &lt;linux/pagemap.h&gt;</code><br/>
<code>#include &lt;linux/slab.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="../../dc/dd5/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8h_source.html">tcmi_ctlfs_entry.h</a>&quot;</code><br/>
<code>#include &lt;dbg.h&gt;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Include dependency graph for tcmi_ctlfs_entry.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../da/def/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c__incl.png" border="0" usemap="#C_1_2CLONDIKE_2clondike_2sources_2kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c" alt=""/></div>
<map name="C_1_2CLONDIKE_2clondike_2sources_2kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c" id="C_1_2CLONDIKE_2clondike_2sources_2kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c">
<area shape="rect" id="node5" href="../../dc/dd5/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8h.html" title="tcmi_ctlfs_entry.h" alt="" coords="389,125,515,152"/></map>
</div>
</div>
<p><a href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:af8a3d15bbd4768fbc3c28438cae75a4d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c.html#af8a3d15bbd4768fbc3c28438cae75a4d">TCMI_CTLFS_ENTRY_PRIVATE</a></td></tr>
<tr class="separator:af8a3d15bbd4768fbc3c28438cae75a4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga532181c3f7224fe5aa7651a69e6ad6b4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga532181c3f7224fe5aa7651a69e6ad6b4">tcmi_ctlfs_entry_init</a> (struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *parent, mode_t <a class="el" href="../../d3/d32/kernel__3_87_81_2src_2tcmi_2ckpt_2tcmi__ckpt__openfile_8h.html#a511a8806c63b72ff1b8b5f1a7f9d7c77">mode</a>, struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#df/d10/structtcmi__ctlfs__ops">tcmi_ctlfs_ops</a> *entry_ops, const struct inode_operations *i_ops, const struct file_operations *f_ops, const char namefmt[], va_list <a class="el" href="../../df/d60/kernel__3_87_81_2src_2tcmi_2migration_2tcmi__npm__params_8h.html#aa24f72e6a4d6a997528142211b375496">args</a>)</td></tr>
<tr class="memdesc:ga532181c3f7224fe5aa7651a69e6ad6b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; This method is used when initializing a new entry.  <a href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga532181c3f7224fe5aa7651a69e6ad6b4">More...</a><br/></td></tr>
<tr class="separator:ga532181c3f7224fe5aa7651a69e6ad6b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacda4dfc581441853eea35819b0beca60"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#gacda4dfc581441853eea35819b0beca60">tcmi_ctlfs_rootentry_init</a> (struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, struct super_block *sb, mode_t <a class="el" href="../../d3/d32/kernel__3_87_81_2src_2tcmi_2ckpt_2tcmi__ckpt__openfile_8h.html#a511a8806c63b72ff1b8b5f1a7f9d7c77">mode</a>, struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#df/d10/structtcmi__ctlfs__ops">tcmi_ctlfs_ops</a> *entry_ops, const struct inode_operations *i_ops, const struct file_operations *f_ops)</td></tr>
<tr class="memdesc:gacda4dfc581441853eea35819b0beca60"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Initializes a root entry instance.  <a href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#gacda4dfc581441853eea35819b0beca60">More...</a><br/></td></tr>
<tr class="separator:gacda4dfc581441853eea35819b0beca60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga256fabe04c04ac21ed1cecbda615a137"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga256fabe04c04ac21ed1cecbda615a137">tcmi_ctlfs_entry_traverse_pred</a> (struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#gaed2ff1a579396261139d8f277f901435">callback</a> *func, void *<a class="el" href="../../df/d60/kernel__3_87_81_2src_2tcmi_2migration_2tcmi__npm__params_8h.html#ab9090ca30e7609aecaf540276e3c5084">data</a>)</td></tr>
<tr class="memdesc:ga256fabe04c04ac21ed1cecbda615a137"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Iterates through all entry predecessors and calls the specified method for each entry (including self).  <a href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga256fabe04c04ac21ed1cecbda615a137">More...</a><br/></td></tr>
<tr class="separator:ga256fabe04c04ac21ed1cecbda615a137"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8a5db62b2c9c6edfad1c1e250a1d7834"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga8a5db62b2c9c6edfad1c1e250a1d7834">tcmi_ctlfs_entry_depth</a> (struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:ga8a5db62b2c9c6edfad1c1e250a1d7834"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Calculates the depth of the entry in the tree.  <a href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga8a5db62b2c9c6edfad1c1e250a1d7834">More...</a><br/></td></tr>
<tr class="separator:ga8a5db62b2c9c6edfad1c1e250a1d7834"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad56d4df45a818d731f8c69d55b500ae3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#gad56d4df45a818d731f8c69d55b500ae3">tcmi_ctlfs_entry_path_length</a> (struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:gad56d4df45a818d731f8c69d55b500ae3"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Calculates the length of the pathname string (including '/' for every path element).  <a href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#gad56d4df45a818d731f8c69d55b500ae3">More...</a><br/></td></tr>
<tr class="separator:gad56d4df45a818d731f8c69d55b500ae3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6273db7c0aede033cd4dd2563cc4848d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6273db7c0aede033cd4dd2563cc4848d">tcmi_ctlfs_entry_fill_path</a> (struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, char *buffer, int length)</td></tr>
<tr class="memdesc:ga6273db7c0aede033cd4dd2563cc4848d"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;public&gt;&gt; Fills in the entry's pathname into the specified buffer.  <a href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga6273db7c0aede033cd4dd2563cc4848d">More...</a><br/></td></tr>
<tr class="separator:ga6273db7c0aede033cd4dd2563cc4848d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga20c8c8e2e7f6c373c438b87504f9bb44"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c.html#ga20c8c8e2e7f6c373c438b87504f9bb44">tcmi_ctlfs_add_depth</a> (struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, void *curr_depth)</td></tr>
<tr class="memdesc:ga20c8c8e2e7f6c373c438b87504f9bb44"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Helper callback function when calculating entry depth.  <a href="#ga20c8c8e2e7f6c373c438b87504f9bb44">More...</a><br/></td></tr>
<tr class="separator:ga20c8c8e2e7f6c373c438b87504f9bb44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadac6e4ac71df92c5ecdd9380e97262f5"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c.html#gadac6e4ac71df92c5ecdd9380e97262f5">tcmi_ctlfs_add_length</a> (struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, void *curr_length)</td></tr>
<tr class="memdesc:gadac6e4ac71df92c5ecdd9380e97262f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Helper callback function when calculating entry pathname length.  <a href="#gadac6e4ac71df92c5ecdd9380e97262f5">More...</a><br/></td></tr>
<tr class="separator:gadac6e4ac71df92c5ecdd9380e97262f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga34ff536143e832833c73376ef43e3c7f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c.html#ga34ff536143e832833c73376ef43e3c7f">tcmi_ctlfs_add_path</a> (struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, void *buf_data)</td></tr>
<tr class="memdesc:ga34ff536143e832833c73376ef43e3c7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Helper callback method when filling the entry's pathname The entry fills in its name and the '/' as prefix to the current end of the buffer.  <a href="#ga34ff536143e832833c73376ef43e3c7f">More...</a><br/></td></tr>
<tr class="separator:ga34ff536143e832833c73376ef43e3c7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4cb543134cb98474842fe71b27abb82c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c.html#ga4cb543134cb98474842fe71b27abb82c">tcmi_ctlfs_entry_release</a> (struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>)</td></tr>
<tr class="memdesc:ga4cb543134cb98474842fe71b27abb82c"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; This private method is responsible for freeing any resources the entry is currently using(currently nothing).  <a href="#ga4cb543134cb98474842fe71b27abb82c">More...</a><br/></td></tr>
<tr class="separator:ga4cb543134cb98474842fe71b27abb82c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga256f5088d3434bfadcdb0cb59bf25cb7"><td class="memItemLeft" align="right" valign="top">static struct inode *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c.html#ga256f5088d3434bfadcdb0cb59bf25cb7">tcmi_ctlfs_get_inode</a> (struct inode *dir, struct super_block *sb, mode_t <a class="el" href="../../d3/d32/kernel__3_87_81_2src_2tcmi_2ckpt_2tcmi__ckpt__openfile_8h.html#a511a8806c63b72ff1b8b5f1a7f9d7c77">mode</a>, const struct inode_operations *i_ops, const struct file_operations *f_ops)</td></tr>
<tr class="memdesc:ga256f5088d3434bfadcdb0cb59bf25cb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; A method for inode allocation.  <a href="#ga256f5088d3434bfadcdb0cb59bf25cb7">More...</a><br/></td></tr>
<tr class="separator:ga256f5088d3434bfadcdb0cb59bf25cb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaeeb7fba5f385c90d93878a60a4dcf1dc"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c.html#gaeeb7fba5f385c90d93878a60a4dcf1dc">tcmi_ctlfs_entry_alloc_dentry</a> (struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *parent, struct inode *inode)</td></tr>
<tr class="memdesc:gaeeb7fba5f385c90d93878a60a4dcf1dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; The new dentry is allocated based on the parent's dentry and the current name of the ctlfs entry.  <a href="#gaeeb7fba5f385c90d93878a60a4dcf1dc">More...</a><br/></td></tr>
<tr class="separator:gaeeb7fba5f385c90d93878a60a4dcf1dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4fbd3f1c3789bd79d4e2c684fc08d1a2"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c.html#ga4fbd3f1c3789bd79d4e2c684fc08d1a2">tcmi_ctlfs_entry_exists</a> (struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *<a class="el" href="../../db/d61/group__tcmi__penman__class.html#gae3924f624412b270d461d2543744407e">self</a>, const char *name)</td></tr>
<tr class="memdesc:ga4fbd3f1c3789bd79d4e2c684fc08d1a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; Checks whether a directory entry contains entry of the specified name  <a href="#ga4fbd3f1c3789bd79d4e2c684fc08d1a2">More...</a><br/></td></tr>
<tr class="separator:ga4fbd3f1c3789bd79d4e2c684fc08d1a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga63428755f08b7cf49c7876390e0f332f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga63428755f08b7cf49c7876390e0f332f">tcmi_ctlfs_dentry_delete</a> (const struct dentry *dentry)</td></tr>
<tr class="memdesc:ga63428755f08b7cf49c7876390e0f332f"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; This class method is a custom implementation of a VFS delete_dentry operation.  <a href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga63428755f08b7cf49c7876390e0f332f">More...</a><br/></td></tr>
<tr class="separator:ga63428755f08b7cf49c7876390e0f332f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga998576674f932bf983a71a04010dd07e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c.html#ga998576674f932bf983a71a04010dd07e">tcmi_ctlfs_dentry_release</a> (struct dentry *dentry)</td></tr>
<tr class="memdesc:ga998576674f932bf983a71a04010dd07e"><td class="mdescLeft">&#160;</td><td class="mdescRight">&lt;&lt;private&gt;&gt; This class method is a custom implementation of a VFS release_dentry operation.  <a href="#ga998576674f932bf983a71a04010dd07e">More...</a><br/></td></tr>
<tr class="separator:ga998576674f932bf983a71a04010dd07e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa27c07305e7918f2964b0b8186f1d17e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c.html#aa27c07305e7918f2964b0b8186f1d17e">EXPORT_SYMBOL_GPL</a> (<a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga8a5db62b2c9c6edfad1c1e250a1d7834">tcmi_ctlfs_entry_depth</a>)</td></tr>
<tr class="separator:aa27c07305e7918f2964b0b8186f1d17e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab328ac941030c0e1a36604e122b2f5ba"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c.html#ab328ac941030c0e1a36604e122b2f5ba">EXPORT_SYMBOL_GPL</a> (<a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga256fabe04c04ac21ed1cecbda615a137">tcmi_ctlfs_entry_traverse_pred</a>)</td></tr>
<tr class="separator:ab328ac941030c0e1a36604e122b2f5ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga21e13dd59db82b54720dfcdbbd7c9760"><td class="memItemLeft" align="right" valign="top">static struct dentry_operations&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga21e13dd59db82b54720dfcdbbd7c9760">tcmi_ctlfs_dentry_ops</a></td></tr>
<tr class="memdesc:ga21e13dd59db82b54720dfcdbbd7c9760"><td class="mdescLeft">&#160;</td><td class="mdescRight">Custom dentry delete operation for VFS.  <a href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga21e13dd59db82b54720dfcdbbd7c9760">More...</a><br/></td></tr>
<tr class="separator:ga21e13dd59db82b54720dfcdbbd7c9760"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="af8a3d15bbd4768fbc3c28438cae75a4d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCMI_CTLFS_ENTRY_PRIVATE</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html#l00037">37</a> of file <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html">tcmi_ctlfs_entry.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aa27c07305e7918f2964b0b8186f1d17e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXPORT_SYMBOL_GPL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga8a5db62b2c9c6edfad1c1e250a1d7834">tcmi_ctlfs_entry_depth</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab328ac941030c0e1a36604e122b2f5ba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXPORT_SYMBOL_GPL </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga256fabe04c04ac21ed1cecbda615a137">tcmi_ctlfs_entry_traverse_pred</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ga20c8c8e2e7f6c373c438b87504f9bb44"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_ctlfs_add_depth </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>curr_depth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Helper callback function when calculating entry depth. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this instance </td></tr>
    <tr><td class="paramname">*curr_depth</td><td>- pointer to the current depth </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html#l00268">268</a> of file <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html">tcmi_ctlfs_entry.c</a>.</p>

<p>Referenced by <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html#l00209">tcmi_ctlfs_entry_depth()</a>.</p>
<div class="fragment"><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;{</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    (*((<span class="keywordtype">int</span> *)curr_depth))++;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gadac6e4ac71df92c5ecdd9380e97262f5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_ctlfs_add_length </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>curr_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Helper callback function when calculating entry pathname length. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this instance </td></tr>
    <tr><td class="paramname">*curr_length</td><td>- pointer to the current length </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html#l00281">281</a> of file <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html">tcmi_ctlfs_entry.c</a>.</p>

<p>References <a class="el" href="../../d6/d77/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8h_source.html#l00151">tcmi_ctlfs_entry_name()</a>.</p>

<p>Referenced by <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html#l00224">tcmi_ctlfs_entry_path_length()</a>.</p>
<div class="fragment"><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;{</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">/* + 1 accounts for &#39;/&#39; */</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    (*((<span class="keywordtype">int</span> *)curr_length)) += strlen(<a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga986b629882729daaf2c9607bfca57c3c" title="&lt;&lt;public&gt;&gt; Entry name accessor.">tcmi_ctlfs_entry_name</a>(<span class="keyword">self</span>)) + 1;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_gadac6e4ac71df92c5ecdd9380e97262f5_cgraph.png" border="0" usemap="#d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_gadac6e4ac71df92c5ecdd9380e97262f5_cgraph" alt=""/></div>
<map name="d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_gadac6e4ac71df92c5ecdd9380e97262f5_cgraph" id="d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_gadac6e4ac71df92c5ecdd9380e97262f5_cgraph">
<area shape="rect" id="node2" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga986b629882729daaf2c9607bfca57c3c" title="&lt;&lt;public&gt;&gt; Entry name accessor." alt="" coords="203,5,357,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga34ff536143e832833c73376ef43e3c7f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_ctlfs_add_path </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Helper callback method when filling the entry's pathname The entry fills in its name and the '/' as prefix to the current end of the buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this instance </td></tr>
    <tr><td class="paramname">*buf_data</td><td>- buffer data that contain pointer to the buffer and its current length. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html#l00297">297</a> of file <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html">tcmi_ctlfs_entry.c</a>.</p>

<p>References <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00220">mdbg</a>, and <a class="el" href="../../d6/d77/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8h_source.html#l00151">tcmi_ctlfs_entry_name()</a>.</p>

<p>Referenced by <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html#l00242">tcmi_ctlfs_entry_fill_path()</a>.</p>
<div class="fragment"><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;{</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordtype">char</span> *buffer;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordtype">int</span> length;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    } *buf = buf_data;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordtype">int</span> cur = strlen(<a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga986b629882729daaf2c9607bfca57c3c" title="&lt;&lt;public&gt;&gt; Entry name accessor.">tcmi_ctlfs_entry_name</a>(<span class="keyword">self</span>));</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO4, <span class="stringliteral">&quot;Adding.. %s, buffer length=%d&quot;</span>, <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga986b629882729daaf2c9607bfca57c3c" title="&lt;&lt;public&gt;&gt; Entry name accessor.">tcmi_ctlfs_entry_name</a>(<span class="keyword">self</span>), buf-&gt;length);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">/* back up enough to print entry name with &#39;/&#39; prefix */</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    buf-&gt;length -= cur;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    strncpy(buf-&gt;buffer + buf-&gt;length, <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga986b629882729daaf2c9607bfca57c3c" title="&lt;&lt;public&gt;&gt; Entry name accessor.">tcmi_ctlfs_entry_name</a>(<span class="keyword">self</span>), cur);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    *(buf-&gt;buffer + --(buf-&gt;length)) = <span class="charliteral">&#39;/&#39;</span>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO4, <span class="stringliteral">&quot;New buffer length=%d&quot;</span>, buf-&gt;length);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_ga34ff536143e832833c73376ef43e3c7f_cgraph.png" border="0" usemap="#d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_ga34ff536143e832833c73376ef43e3c7f_cgraph" alt=""/></div>
<map name="d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_ga34ff536143e832833c73376ef43e3c7f_cgraph" id="d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_ga34ff536143e832833c73376ef43e3c7f_cgraph">
<area shape="rect" id="node2" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga986b629882729daaf2c9607bfca57c3c" title="&lt;&lt;public&gt;&gt; Entry name accessor." alt="" coords="193,5,346,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga998576674f932bf983a71a04010dd07e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_ctlfs_dentry_release </td>
          <td>(</td>
          <td class="paramtype">struct dentry *&#160;</td>
          <td class="paramname"><em>dentry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; This class method is a custom implementation of a VFS release_dentry operation. </p>
<p>The release_dentry is called by VFS when releasing the dentry associated with a particular <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry" title="An entry compound structure.">tcmi_ctlfs_entry</a> object. This happens when the dentry's reference counter reaches 0.</p>
<p>Unlike previous VFS method, we are allowed to sleep as the dcache lock and dentry lock are not held anymore (see fs/dcache.c)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*dentry</td><td>- pointer to the dentry that is to be deleted </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- always 1 since we don't want the VFS to put the dentry into the dentry_unused. This way the dentry will be unhashed and removed right away </dd></dl>

<p>Definition at line <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html#l00484">484</a> of file <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html">tcmi_ctlfs_entry.c</a>.</p>

<p>References <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00221">minfo</a>, <a class="el" href="../../d6/d77/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8h_source.html#l00124">TCMI_CTLFS_DENTRY_TO_ENTRY</a>, and <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html#l00325">tcmi_ctlfs_entry_release()</a>.</p>
<div class="fragment"><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;{</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="comment">/* get the instance first */</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry" title="An entry compound structure.">tcmi_ctlfs_entry</a> *<span class="keyword">self</span> = <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#gabd32888576caebe57e30d25081d77698" title="Extracts the entry object from the dentry.">TCMI_CTLFS_DENTRY_TO_ENTRY</a>(<a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#a1ab086e21a2e430853695112f597640a" title="VFS directory entry(dentry) that is associated with an instance.">dentry</a>);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">self</span>)</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <a class="code" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c.html#ga4cb543134cb98474842fe71b27abb82c" title="&lt;&lt;private&gt;&gt; This private method is responsible for freeing any resources the entry is currently using...">tcmi_ctlfs_entry_release</a>(<span class="keyword">self</span>);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(ERR2, <span class="stringliteral">&quot;VFS issued dentry_release on a dentry without tcmi_ctlfs_instance!!&quot;</span>);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_ga998576674f932bf983a71a04010dd07e_cgraph.png" border="0" usemap="#d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_ga998576674f932bf983a71a04010dd07e_cgraph" alt=""/></div>
<map name="d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_ga998576674f932bf983a71a04010dd07e_cgraph" id="d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_ga998576674f932bf983a71a04010dd07e_cgraph">
<area shape="rect" id="node2" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c.html#ga4cb543134cb98474842fe71b27abb82c" title="&lt;&lt;private&gt;&gt; This private method is responsible for freeing any resources the entry is currently using..." alt="" coords="224,5,387,32"/><area shape="rect" id="node3" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga986b629882729daaf2c9607bfca57c3c" title="&lt;&lt;public&gt;&gt; Entry name accessor." alt="" coords="435,5,589,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gaeeb7fba5f385c90d93878a60a4dcf1dc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_ctlfs_entry_alloc_dentry </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *&#160;</td>
          <td class="paramname"><em>parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct inode *&#160;</td>
          <td class="paramname"><em>inode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; The new dentry is allocated based on the parent's dentry and the current name of the ctlfs entry. </p>
<p>The dentry is associated with the specified inode. The dentry is assigned our custom operations vector, so that we are informed about dentry destruction.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this instance </td></tr>
    <tr><td class="paramname">*parent</td><td>- pointer to the parent entry - has to be a directory </td></tr>
    <tr><td class="paramname">*inode</td><td>- pointer to the inode, that is to be associated with the new dentry. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 upon success. </dd></dl>

<p>Definition at line <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html#l00406">406</a> of file <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html">tcmi_ctlfs_entry.c</a>.</p>

<p>References <a class="el" href="../../d6/d77/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8h_source.html#l00077">tcmi_ctlfs_entry::dentry</a>, <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d9/d03/kernel__2_86_833_81_2src_2proxyfs_2proxyfs__server_8c_source.html#l00059">self</a>, and <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html#l00495">tcmi_ctlfs_dentry_ops</a>.</p>

<p>Referenced by <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html#l00066">tcmi_ctlfs_entry_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;{</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keyword">struct </span>dentry *dentry;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordtype">int</span> error = 1;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">/* try allocating the dentry */</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">if</span> ((dentry = d_alloc_name(parent-&gt;<a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#a1ab086e21a2e430853695112f597640a" title="VFS directory entry(dentry) that is associated with an instance.">dentry</a>, self-&gt;<a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#a23b722aa00fa5f494ec83592159e0d0c" title="current entry name">name</a>))) {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        d_add(dentry, inode); <span class="comment">/* enters the dentry into hash queues */</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        dentry-&gt;d_fsdata = (<span class="keywordtype">void</span> *)<span class="keyword">self</span>; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        dentry-&gt;d_op = &amp;<a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga21e13dd59db82b54720dfcdbbd7c9760" title="Custom dentry delete operation for VFS.">tcmi_ctlfs_dentry_ops</a>; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="keyword">self</span>-&gt;dentry = dentry;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="comment">/* dget(dentry); Extra count - pin the dentry in core - not needed */</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        error = 0;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(ERR3, <span class="stringliteral">&quot;Failed to allocate a new dentry for %s&quot;</span>, self-&gt;<a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#a23b722aa00fa5f494ec83592159e0d0c" title="current entry name">name</a>);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga4fbd3f1c3789bd79d4e2c684fc08d1a2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tcmi_ctlfs_entry_exists </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; Checks whether a directory entry contains entry of the specified name </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this instance </td></tr>
    <tr><td class="paramname">*name</td><td>- pointer to the name to be checked </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 - if the entry of the specified name exists </dd></dl>

<p>Definition at line <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html#l00434">434</a> of file <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html">tcmi_ctlfs_entry.c</a>.</p>

<p>References <a class="el" href="../../d9/d03/kernel__2_86_833_81_2src_2proxyfs_2proxyfs__server_8c_source.html#l00059">self</a>.</p>

<p>Referenced by <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html#l00066">tcmi_ctlfs_entry_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;{</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keyword">struct </span>dentry *dentry;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keyword">struct </span>qstr q;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordtype">int</span> exists = 0;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    q.name = name;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    q.len = strlen(name);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    q.hash = full_name_hash(q.name, q.len);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    dentry = d_lookup(self-&gt;<a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#a1ab086e21a2e430853695112f597640a" title="VFS directory entry(dentry) that is associated with an instance.">dentry</a>, &amp;q);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="comment">/* dentry already exists, decrement its reference counter since lookup </span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">     incremented it */</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordflow">if</span> (dentry) {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        dput(dentry);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            exists = 1;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">return</span> exists;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga4cb543134cb98474842fe71b27abb82c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tcmi_ctlfs_entry_release </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#db/d2a/structtcmi__ctlfs__entry">tcmi_ctlfs_entry</a> *&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; This private method is responsible for freeing any resources the entry is currently using(currently nothing). </p>
<p>When possible the child class is also notified. The instance is eventually destroyed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*self</td><td>- pointer to this instance </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 </dd></dl>

<p>Definition at line <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html#l00325">325</a> of file <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html">tcmi_ctlfs_entry.c</a>.</p>

<p>References <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../d9/d03/kernel__2_86_833_81_2src_2proxyfs_2proxyfs__server_8c_source.html#l00059">self</a>, and <a class="el" href="../../d6/d77/kernel__2_86_833_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8h_source.html#l00151">tcmi_ctlfs_entry_name()</a>.</p>

<p>Referenced by <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html#l00484">tcmi_ctlfs_dentry_release()</a>.</p>
<div class="fragment"><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;{</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO4, <span class="stringliteral">&quot;entry &#39;%s&#39; is being freed(%p)&quot;</span>, </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;         <a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga986b629882729daaf2c9607bfca57c3c" title="&lt;&lt;public&gt;&gt; Entry name accessor.">tcmi_ctlfs_entry_name</a>(<span class="keyword">self</span>), <span class="keyword">self</span>);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">/* free child class instance data? */</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordflow">if</span> (self-&gt;<a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#a73f839daf84e95acd81a34e86ebd9e39" title="custom operations">entry_ops</a> &amp;&amp; self-&gt;<a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#a73f839daf84e95acd81a34e86ebd9e39" title="custom operations">entry_ops</a>-&gt;<a class="code" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ab3b0901bfd2d7946969402e883cc6379" title="child class method, that frees all instance resources (but keeps the instance).">entry_release</a>) {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keyword">self</span>-&gt;entry_ops-&gt;entry_release(<span class="keyword">self</span>);   </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    kfree(<span class="keyword">self</span>);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_ga4cb543134cb98474842fe71b27abb82c_cgraph.png" border="0" usemap="#d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_ga4cb543134cb98474842fe71b27abb82c_cgraph" alt=""/></div>
<map name="d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_ga4cb543134cb98474842fe71b27abb82c_cgraph" id="d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_ga4cb543134cb98474842fe71b27abb82c_cgraph">
<area shape="rect" id="node2" href="../../d8/d36/group__tcmi__ctlfs__entry__class.html#ga986b629882729daaf2c9607bfca57c3c" title="&lt;&lt;public&gt;&gt; Entry name accessor." alt="" coords="217,5,370,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga256f5088d3434bfadcdb0cb59bf25cb7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct inode* tcmi_ctlfs_get_inode </td>
          <td>(</td>
          <td class="paramtype">struct inode *&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct super_block *&#160;</td>
          <td class="paramname"><em>sb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mode_t&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct inode_operations *&#160;</td>
          <td class="paramname"><em>i_ops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct file_operations *&#160;</td>
          <td class="paramname"><em>f_ops</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>&lt;&lt;private&gt;&gt; A method for inode allocation. </p>
<p>Currently the uid and gid is assigned based on the current's fsuid and fsgid. Block size is not relevant, set to page size. If the user doesn't specify any inode or file operations, the default(empty operations, but not NULL) assigned by the VFS will be kept.</p>
<p>If the user specified a parent directory inode, it's access rights are investigated and inherited by the new inode as follows:</p>
<ul>
<li>if the parent has the SGID bit set, parent's gid is assigned to the new inode.</li>
<li>a parent SGID bit is set on the new inode, if the new inode is a directory</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*dir</td><td>- inode of the parent directory for the new inode </td></tr>
    <tr><td class="paramname">*sb</td><td>- super block of the filesystem where the inode is to be allocated </td></tr>
    <tr><td class="paramname">*mode</td><td>- file type and access rights for the inode </td></tr>
    <tr><td class="paramname">*i_ops</td><td>- inode operations </td></tr>
    <tr><td class="paramname">*f_ops</td><td>- file operations (also stored in the new inode) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a pointer to the new inode or NULL </dd></dl>

<p>Definition at line <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html#l00361">361</a> of file <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html">tcmi_ctlfs_entry.c</a>.</p>

<p>References <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00220">mdbg</a>, <a class="el" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h_source.html#l00221">minfo</a>, and <a class="el" href="../../dd/dfa/kernel__2_86_833_81_2src_2tcmi_2ckpt_2tcmi__ckpt__openfile_8h_source.html#l00129">mode</a>.</p>

<p>Referenced by <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html#l00066">tcmi_ctlfs_entry_init()</a>, and <a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c_source.html#l00130">tcmi_ctlfs_rootentry_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;{</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keyword">struct </span>inode *inode = new_inode(sb);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keywordflow">if</span> (inode) {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        inode-&gt;i_mode = <a class="code" href="../../dd/dfa/kernel__2_86_833_81_2src_2tcmi_2ckpt_2tcmi__ckpt__openfile_8h.html#a511a8806c63b72ff1b8b5f1a7f9d7c77" title="access mode for the file">mode</a>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        inode-&gt;i_uid = current_fsuid();</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        inode-&gt;i_gid = current_fsgid();</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        inode-&gt;i_blocks = 0;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        inode-&gt;i_op  = (i_ops ? i_ops : inode-&gt;i_op);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        inode-&gt;i_fop = (f_ops ? f_ops : inode-&gt;i_fop);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        inode-&gt;i_atime = inode-&gt;i_mtime = inode-&gt;i_ctime = CURRENT_TIME;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    inode-&gt;i_ino = get_next_ino();    <span class="comment">//Added number inode i_no in new kernel it must be assigned from return value function get_next_ino() which returns next number inode | by Jiri Rakosnik</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#a881516d8ffc635f7f0e87468340c80dc">mdbg</a>(INFO4, <span class="stringliteral">&quot;New inode allocated, inode number = %ld&quot;</span>, inode-&gt;i_ino);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="comment">/* check parent inode&#39;s(if any) access rights */</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keywordflow">if</span> (dir &amp;&amp; (dir-&gt;i_mode &amp; S_ISGID)) {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            inode-&gt;i_gid = dir-&gt;i_gid;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            <span class="keywordflow">if</span> (S_ISDIR(<a class="code" href="../../dd/dfa/kernel__2_86_833_81_2src_2tcmi_2ckpt_2tcmi__ckpt__openfile_8h.html#a511a8806c63b72ff1b8b5f1a7f9d7c77" title="access mode for the file">mode</a>))</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                inode-&gt;i_mode |= S_ISGID;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <a class="code" href="../../de/d8f/kernel__2_86_833_81_2src_2dbg_8h.html#abc23c8dde04f89ca72fc5035015a65e7">minfo</a>(ERR3, <span class="stringliteral">&quot;Failed to allocate a new inode&quot;</span>);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">return</span> inode;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_08d237fc27d4ecd563f71c5d52f2fecc.html">sources</a></li><li class="navelem"><a class="el" href="../../dir_08cfbe165ea603e6d179ff1f702f26c2.html">kernel_3.7.1</a></li><li class="navelem"><a class="el" href="../../dir_54993795d38a4b0939659b8e486bb0f5.html">src</a></li><li class="navelem"><a class="el" href="../../dir_d6db29d45a6ebf6e3bfdbb75b7b3a396.html">tcmi</a></li><li class="navelem"><a class="el" href="../../dir_74d40a06947933b5aca5d44734b31618.html">ctlfs</a></li><li class="navelem"><a class="el" href="../../d7/dd6/kernel__3_87_81_2src_2tcmi_2ctlfs_2tcmi__ctlfs__entry_8c.html">tcmi_ctlfs_entry.c</a></li>
    <li class="footer">Generated on Mon Apr 1 2013 16:10:30 for Clondike by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
